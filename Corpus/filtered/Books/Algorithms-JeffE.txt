tableofcontents search   preorderandpostorder  classifyingverticesandedges  detectingcycles   topologicalsort  implicittopologicalsort  memoizationanddynamicprogramming  dynamicprogrammingindags  strongconnectivity   strongcomponentsinlineartime  kosarajuandsharir salgorithm ª tarjan salgorithm exercises  minimumspanningtrees   distinctedgeweights   theonlyminimumspanningtreealgorithm   bor vka salgorithm  thisisthemstalgorithmyouwant  jarník salgorithm  ª improvingjarník salgorithm  kruskal salgorithm  exercises  shortestpaths   shortestpathtrees    ª negativeedges   theonlyssspalgorithm   unweightedgraphs search   directedacyclicgraphs search   dijkstra salgorithm  nonegativeedges ª negativeedges  relaxalltheedges  moore simprovement dynamicprogrammingformulation exercises  airsshortestpaths   introduction   lotsofsinglesources   reweighting   johnson salgorithm   dynamicprogramming   divideandconquer  xii tableofcontents  funnymatrixmultiplication    kleenwarsha  exercises  maximumflows minimumcuts   flows   cuts   themax ocuttheorem   fordandfulkerson saalgorithm  ª irrationalcapacities  combininganddecomposingflows   edmondsandkarp salgorithms  fattestaugmentingpaths shortestaugmentingpaths  furtherprogress  exercises  applicationsofflowsandcuts   intpaths   vertexcapacitiesandvintpaths   bipartitematching   tupleselection  examscheduling  disjoathcovers  minimalfacultyhiring  baseballelimination   projectselection  exercises  ardness   agameyoucan twin   pversusnp   sy andmplete    ª formalde nitions hcsvntdracones   reductionsand sat    sat circuitsat   maximumindependentset sat   thegeneralpattern   cliqueandvertexcover fromindependentset   graphcoloring sat   hamiltoniancycle  fromvertexcover sat variantsandextensions  subsetsum fromvertexcover  xiii tableofcontents caveatreductor  otherusefulproblems   choosingtherightproblem   afrivolousreaworldexample    ª onbeyondzebra  polynomialspace exponentialtime excelsior exercises   indexofpeople  indexofpseudocode  imagecredits  colophon  xiv hincincipitalgorismus haecalgorismusarspraesensdiciturinqua talibusindorumfruimurbisquinque guris0          friaralexanderdevilladei carmendealgorismo  youarerighttodemandthatanartistengagehisworkconsciously butyouconfusetwodifferentthings solvingtheproblemandcorrectlyposingthequestion antonchekhov inalettertoa suvorin october27  themorewereduceourselvestomachinesinthelowerthings themoreforceweshallsetfreetouseinthehigher annac brackett thetechniqueofrest  andhereiamat2 a writingabouttechnique inspiteofastrongconviction thatthemomentamanbeginstotalkabouttechniquethat sproofthatheisfresh outofideas raymondchandler lettertoerlestanleygardner may5  goodmendon tneedrules todayisnotthedayto ndoutwhyihavesomany thedoctor mattsmith agoodmangoestowar doctorwho   introduction  whatisanalgorithm analgorithmisanexplicit precise unambiguous mechanicaable sequenceofelementaryinstructions usuallyintendedtoaccomplishaspeci purpose forexample hereisanalgorithmforsingingthatannoyingsong bottlesofbeeronthewaforarbitraryvaluesof99 bottlesofbeer downto  sing bottlesofbeeronthewall bottlesofbeer sing takeonedown passitaround  bottlesofbeeronthewall sing nobottlesofbeeronthewall nobottlesofbeer sing gotothestore buysomemore bottlesofbeeronthewall theworddoes derive asalgorithmophobicclassicistsmight guess fromthegreekroots arithmos rijmìc meaningand algos   introduction lgoc meaningrather itisacorruptionofthenameofthe9thcentury persianscholarmu ammadibnm aa arizm ˇ  arizm ˇisperhaps bestknownasthewriterofthetreatise abaukhta arf ˇh ˇs abr wuq abala  fromwhichthemodernword algebra derives inadi erent treatise arizm ˇdescribedthemoderndecimalsystemforwritingand manipulatingnparticular theuseofasmallcircleor ifr torepresent amissingquantitchhadbeendevelopedinindiaseveralcenturiesearlier themethodsdescribedinthislattertreatise usingeitherwritten guresor countingstones becameknowninenglishas algorism augrym andits gures becameknowninenglishas ciphers althoughbothplaluenotationanda arizm ˇ sworkswerealready knownbysomeeuropeanscholars therabinumericsystemwas popularizedineuropebythemedievalitalianmathematicianandtradesman leonardoofpisa betterknownasfibonacci thanksinparttohis1202book liberabaci  written guresbegantoreplacethecountingtable thenknownas abacus ngerarithmetic  asthepreferredplatformforcalculation  europeinthe13th becausewrittendecimal gureswereeasierto learnoruse butbecausetheyprovidedanaudittrail ciphersbecamecommon inwesterneuropeonlywiththeadventofmovabletype andtrulyubiquitous onlyaftercheappaperbecameplentifulintheearly19thcentury eventuallytheword algorism evolvedintothemodern algorithm viafolk etymologyfromthegreek arithmos andperhapsthepreviouslymentioned algos  untilveryrecently theword algorithm referredexclusively  fatherofadbdulla sonofmoses thekw arizmikw arizmisanancient city nowcalledkhiva inthekhorezmprovinceofuzbekistan  compendiousbookoncalculationbycompletionandbalan  whileitistemptingtotranslatethetitle liberabaci asbookoftheabacuamore accuratetranslationisbookofcalculatiobothbeforeandafterfibonacci theitalian word abaco wasusedtodescribeanythingrelatedtonumericalcalculatioces methods schools books andsoouchinthesamewaythatmputerscienisusedtodayin english orasthechinesephraseforonstranslatesliterallyasstudyof usingcounting  reckoningwith digits  theword calculate derivesfromthelatinword calculus meaningllreferringto thestonesonacountingtable oraschaucercalledthem augrymstones in440 bce herodotus wroteinhis histories thatgreekswriteandcalculate logðzesjaiy foic literally reckon withpebbles fromlefttoright theegyptiansdotheopposite yettheysaythattheirwayof writingistowardtheright andthegreekwaytowardthel herodotusisstrangelysilenton whichendoftheeggtheegyptiansate rst  somemedievalsourcesclaimthatthegreekpre xmeansoructio othersclaimthatalgorithmswereinventedbyagreekphilosopher orakingofindia orperhaps akingofspain namedalguororarguafew possiblyincludingdantealighieri evenidenti edtheinventorwiththemythologicalgreekshipbuilderandeponymousargonaut sunclearwhetheranyoftheserisibleclaimswereintendedtobehistoricallyaccurate merelymnemonic    multiplication tomechanicaltechniquesforplaluearithmeticusingarabinumerals peopletrainedinthefastandreliableexecutionoftheseprocedureswerecalled algorists computators ormoresimply computers  multiplication althoughtheyhavebeenatopicofformalacademicstudyforonlyafewdecades algorithmshavebeenwithussincethedawnofcivilization descriptionsof arithmeticcomputationareamongtheearliestexamplesofwritten humanlanguage longpredatingtheexpositionsbyfibonaccianda arizm ˇ oreventheplaluenotationtheypopularized latticemultiplication themostfamiliarmethodformultiplyinglargenumbers atleastforamerican students isthe latticealgorithm thisalgorithmwaspopularizedbyfibonacci liberabaci wholearneditfromarabicsourcesincludinga arizm ˇ inturnlearneditfromindiansourcesincludingbrahmagupta treatise ahmasphu asiddh anta whomayhavelearneditfromchinesesources theoldestsurvivingdescriptionsofthealgorithmappearin themathematical classicofsunzi writteninchinabetweenthe3rdand5thcenturies andin eutociusofascalon scommentariesonarchimedes measurementofthecircle writtenaround500 butthereisevidencethatthealgorithmwasknownmuch earlier eutociuscreditsthemethodtoalosttreatiseofapolloniusofperga wholivedaround300 bce entitled okytokion wkutìkion  thesumerians recordedmultiplicationtablesonclaytabletsasearlyas2600 bce suggesting thattheymayhaveusedthelatticealgorithm  thelatticealgorithmassumesthattheinputnumbersarerepresentedas explicitstringsofdigits llassumeherethatwe reworkinginbaseten butthe algorithmgeneralizesimmediatelytoanyotherbase tosimplifynotation   literallycinethatpromotesquickandeasychildpappusofalexandria ducedseveralexcerptsof okytokion about200yearsbeforeeutocius buthisdescriptionofthe latticemultiplicationalgorithm ifhegaveone lost  thereisampleevidencethatancientsumerianscalculatedaccuratelywithextremely largenumbersusingtheirbaplaluenumericalsystem butiamnotawareofany survivingrecordoftheactualmethodstheyused inadditiontostandardmultiplication andreciprocaltables tableslistingthesquaresofintegersfrom   havebeenfound leadingsomemathhistorianstoconjecturethatbabyloniansmultipliedusinganidentitylike xy     butthistrickonlyworkswhen  historyissilentonhow thebabyloniansmighthavecomputed    butattheriskofin amingthehistoricalenmitybetweengreeceandegypt orlilliputand blefuscu ormacsandpcs orpeoplewhothinkzeroisanaturalnumberandpeoplewhoare wrong   introduction inputconsistsofapairofarrays     representingthe numbers       andsimilarly theoutputconsistsofasinglearray   representing theproduct    thealgorithmusesadditionand singl multiplicationasprimitive tions additioncanbeperformedusingasimplefoop inpractice singl multiplicationisperformedusingalookuptable eithercarvedintoclaytablets paintedonstripsofwoodorbamboo writtenonpaper storedinnly memory ormemorizedbythecomputator theentirelatticealgorithmcanbe summarizedbytheformula      erentvariantsofthelatticealgorithmevaluatethepartialproducts  indi erentordersandusedi erentstrategiesforcomputingtheir sum forexample liberabaco fibonaccidescribesavariantthatconsiders partialproductsinincreasingorderofsigni cance asshowninmodern pseudocodebelow fibonaccimultiply     hold    forall suchthat hold hold hold mod10 hold hold  return   fibonacci salgorithmisoftenexecutedbystoringallthepartialproductsina twonaltable oftencalledaableaororattiandthen summingalongthediagonalswithappropriatecarries asshownontherightin figure   americanelementstudentsaretaughttomultiplyone factor theultiplibyeachdigitintheotherfactor theultipli writingdownallthemultipliproductsbeforeaddingthemup shownontheleftinfigure   thiswasalsothemethoddescribedbyeutocius althoughhe ttinglyconsideredthemultiplierdigitsfromlefttoright asshown    multiplication infigure   bothofthesevariants andseveralothers aredescribedand illustratedsidebysideintheanonymous1458textbook artedell abbaco knownasthe trevisoarithmetic rst printed mathematicsbookinthewest figure0  computing934  usingmultiplication witherror checkingbycasting outnines multiplication artedell abbaco  imagecredits attheendof thebook figure0  eutocius s6th centurycalculationof1172         inhiscommentaryon archimedes measurementofthecircle transcribed left andtranslatedintomodernnotation johanheiberg  imagecredits attheendofthebook allofthesevariantsofthelatticeaothersimilarvariants describedbysunzi arizm ˇ fibonacci artedell abbaco andmanyother somputetheproductofany numberandany number time therunningtimeofeveryvariantisdominatedbythenumber ofsinglmultiplications duplationandmediation thelatticealgorithmisnottheoldestmultiplicationalgorithmforwhichwe havedirectrecordedevidence anevenolderandarguablysimpleralgorithm whichdoesnotrelyonplaluenotation issometimescalled russianpeasant multiplication ethiopianpeasantmultiplication orjust peasantmultiplication   introduction variantofthisalgorithmwascopiedintotherhindpapyrusbytheegyptian scribeahmesaround1650 bce fromadocumentheclaimedwas yearsold  thisalgorithmwasstilltaughtinelementaryschoolsineastern europeinthelate20thcentury itwasalsocommonlyusedbyearlydigital computersthatdidnotimplementintegermultiplicationdirectlyinhardware thepeasantmultiplicationalgorithmreducesthedi culttaskofmultiplying arbitrarynumberstoasequenceoffoursimpleroperations  determining parity evenorodd  addition  duplation doublinganumber  mediation halvinganumber roundingdown peasantmultiply prod   isodd prod prod  return prod xy prod                      figure0  multiplicationbyduplationandmediation thecorrectnessofthisalgorithmfollowsbyinductionfromthefollowing recursiveidentity whichholdsforallnoegativeintegers     iseven  isodd arguably thisrecurrence thepeasantmultiplicationalgorithm tletthe iterativepseudocodefoolyou thealgorithmisfundamentallyrecursive asstated peasantmultiply performs log parity addition andmedi tionoperations butwecanimprovethisboundto logmin byswapping thetwoargumentswhen assumingthenumbersarerepresentedu inganyreasonableplaluenotation likebinary babylonian hexagesimal egyptianduodecimal romannumeral chinesecountingrods beadpositionsonanabacus andsoon eachoperationrequiresatmost log xy logmax singloperations sotheoverallrunning timeofthealgorithmis logmin logmax log log  theversionofthisalgorithmactuallyusedinancientegyptdoesnotusemediationor parity butitdoesusecomparisons toavoidhalving thealgorithmmputestwotables byrepeateddoubling onecontainingallthepowersof  notexceeding theothercontaining thesamepowersof  multipliedby thepowersof  thatsumto arethenfoundbygreedy subtraction andthecorrespondingentriesintheothertableareaddedtogethertoformthe product    multiplication inotherwords thisalgorithmrequires time tomultiplyan numberbyan number uptoconstantfactors thisisthesamerunning timeasthelatticealgorithm thisalgorithmrequires aconstantfactor paperworktoexecutebyhandthanthelatticealgorithm butthenecessary primitiveoperationsarearguablyeasierforhumanstoperform infact thetwo algorithmsareequivalentwhennumbersarerepresentedinbinary compassandstraightedge classicalgreekgeometersidenti ednumbers ormoreaccurately magnitudes withlinesegmentsoftheappropriatelength whichtheymanipulatedusingtwo simplemechanicaltcompassandtheersionsofwhich hadalreadybeenincommonusebysurveyors architects andotherartisansfor centuries thesetwotools thesescholarsreducedseveralcomplex geometricconstructionstothefollowingprimitiveoperations startingwithone ormoreidenti edreferencepoints drawtheuniquelinepassingthroughtwodistinctidenti edpoints drawtheuniquecirclecenteredatoneidenti edpointandpassingthrough identifytheintersectionpoint ifany oftwolines identifytheintersectionpoints ifany ofalineandacircle identifytheintersectionpoints ifany oftwocircles inpractice greekgeometrystudentsalmostcertainlydrewtheirconstructions onan abax bax atablecoveredindustorsand  centuriesearlier egyptian surveyorscarriedoutmanyofthesameconstructionsusingropestodetermine straightlinesandcirclesontheground  euclidandothergreek geometerspresentedcompassandstraightedgeconstructionsasprecise matical abstractions intsare ideal points linesare ideal lines andcircles ideal circles figure   showsanalgorithm describedineuclid elements about2500 yearsago formultiplyingordividingtwomagnitudes theinputconsistsof fourdistinctpoints andthegoalistoconstructapoint inparticular ifwede tobeourunitof length thenthealgorithmcomputestheproductof noticethateuclid rstde nesanewprimitiveoperation rightangle asmodernprogrammerswouldphraseit writingasubroutine thecorrectness  thewrittennumerals1through9wereknownineuropeatleasttwocenturiesbefore fibonacci liberabaci asnumerafromthearabicword ghub meaningdust ultimately referringtotheindianpracticeofperformingarithmeticontablescoveredwithsand thegreek word bax istheoriginofthelatin abacus whichalsooriginallyreferredtoasandtable  rememberwhatmeans democrituswouldlaterrefertotheseegyptian surveyors somewhatderisively arpedonaptai rpedon ptai meaningasten   introduction constructthelineperpendicularto passingthrough rightangle chooseapoint  intersect circle intersect circle circle return constructapoint suchthat multiplyordivide rightangle intersect circle intersect circle rightangle rightangle return intersect figure0  multiplicationbycompassandstraightedge ofthealgorithmfollowsfromtheobservationthattriangles ace azf aresimilar thesecondandthirdlinesofthemainalgorithmareambiguous intersectsanycirclecenteredat distinctpoints butthe algorithmisactuallycorrectnomatterwhichintersectionpointsarechosen euclid salgorithmreducestheproblemofmultiplyingtwomagnitudes lengths toaseriesofprimitivecompaoperations operationsaredi culttoimplementpreciselyonamoderndigitalcomputer euclid salgorithmwasn designed foradigitalcomputer itwasdesignedforthe platonicidealgeometer wieldingtheplatonicidealcompassandtheplatonic idealstraightedge whocouldexecuteeachoperationperfectlyinconstanttime byde nition inthismodelofcomputation multiplyordivide runsin  time  congressionalapportionment hereisanotherreaorldexampleofanalgorithmofsigni cantpolitical articlei section2oftheunitedstatesconstitutionrequiresthat representativesanddirecttaxesshallbeapportionedamongtheseveral stateswhichmaybeincludedwithinthisunion accordingtotheirrespective numbers thenumberofrepresentativesshallnotexceedoneforevery thirtythousand buteachstateshallhaveatleastonerepresentative becausethereareonlya nitenumberofseatsinthehouseofrepresentatives exact proportionalrepresentationrequireseithersharedorfractional tatives neitherofwhicharelegal asaresult overthenextseveraldecades manydi erentapportionmentalgorithmswereproposedandusedtoround theidealfractionalsolutionfairly thealgorithmactuallyusedtoday called    congressionalapportionment huntingtomethod orthe methodofequalproportions rst suggestedbycensusbureaustatisticianjosephhillin1911 nedbyharvard mathematicianedwardhuntingtonin1920 adoptedintofederallaw u in1941 andsurvivedasupremecourtchallengein1992  thehuntingtomethodallocatesrepresentativestostatesoneata time inapreprocessingstage eachstateisallocatedonerepresentative thenineachiterationofthemainloop thenextrepresentativeisassigned tothestatewiththehighest priority thepriorityofeachstateisde ned tobe  isthestate spopulationand isthenumberof representativesalreadyallocatedtothatstate thealgorithmisdescribedinpseudocodeinfigure   theinputconsistsof anarray pop  storingthepopulationsofthe statesandaninteger equal tothetotalnumberofrepresentatives thealgorithmassumes intheunitedstates   theoutputarray rep  records thenumberofrepresentativesallocatedtoeachstate apportioncongress pop  newpriorityqueue giveeverystateits rstrepresentative  rep  insert pop  allocatetheremaining representatives  extractmax rep rep  priority pop rep rep  insert priority return rep  figure0  thehuntington hillapportionmentalgorithm thisimplementationofhuntingtousesapriorityqueuethatsupports theoperations newpriorityqueue insert extractmax theactual lawdoesn tsayanythingaboutpriorityqueues ofcourse theoutputofthe algorithm andthereforeitscorrectness doesnotdepend atall onhowthis  overrulinganearlierrulingbyafederaldistrictcourt thesupremecourtunanimously heldthat apportionmentmethodadoptedingoodfaithbycongressisconstitutional united statesdepartmentofcommercev montana thecurrentcongressionalapportionmentalgorithm isdescribedingruesomedetailattheu censusdepartmentwebsite census gov topics publisector congressionaapportionment html agoodhistoryoftheapportionment problemcanbefoundat thirtthousand org apportionment htm areport bythecongressionalresearchservicedescribingvariousapportionmentmethodsisavailableat fas org sgp crs misc r41382 pdf   introduction priorityqueueisimplemented thecensusbureauusesasortedarray stored inasinglecolumnofanexcelspreadsheet whichisrecalculatedfromscratch ateveryiteration shouldhave learnedamoree cientimplementation inyourundergraduatedatastructuresclass similarapportionmentalgorithmsareusedinmyparliamentary electionsaroundtheworld wherethenumberofseatsallocatedtoeachparty issupposedtobeproportionaltothenumberofvotesthatpartyreceives twomostcommonarethe hondtmethod  andthe websteraguë method  whichrespectivelyusepriorities    inplaceof thesquexpressioninhuntingtothehuntingtomethodis essentiallyuniquetotheunitedstateshouseofrepresentatives thanksinpart totheconstitutionalrequirementthateachstatemustbeallocatedatleastone representative  abadexample asaprototypicalexampleofasequenceofinstructionsthatis actuallyan algorithm martin  beamillionaireandneverpaytaxes getamilliondollars ifthetaxmancomestoyourdoorandsays youhaveneverpaidtaxes iforgot prettysimple exceptforthat rststep sadoozy agroupofbillionaireceos siliconvalleyventurecapitalists ornewyorkcityreaatehustlersmight considerthisanalgorithm becauseforthemthe rststepisbothunambiguous andtrivial  butfortherestofuspoorslobs martin sprocedureistoovagueto beconsideredanactualalgorithm ontheotherhand thisisaperfectexample ofa reduction reduces theproblemofbeingamillionaireandneverpaying taxestothesiproblemofacquiringamilliondollars llseereductions overandoveragaininthisbook ashundredsofbusinessmenandpoliticians havedemonstrated ifyouknowhowtosolvetheeasierproblem areduction tellsyouhowtosolvetheharderone  developedbythomasje ersonin1792 usedforu congressionalapportionmentfrom to1832 rediscoveredbybelgianmathematicianvictord hondtin1878 andre nedbyswiss physicisteduardh in1888  developedbydanielwebsterin1832 usedforu congressionalapportionmentfrom1842 to1911 rediscoveredbyfrenchmathematicianandréaguëin1910 andrediscovered againbygermanphysicisthansschepersin1980  stevemartin oucanbeamillion saturdaynightlive january21  appearson comedyisnotpretty warnerbros records   somethingsomethingsecurequantumblockchainearningsomething    describingalgorithms martin salgorithm likesomeofourpreviousexamples isnotthekind ofalgorithmthatcomputerscientistsareusedtothinkingabout becauseit isphrasedintermsofoperationsthataredi cultforcomputerstoperform thisbookfocuses exclusivelyonalgorithmsthatcanbereasonably implementedonastandarddigitalcomputer eachstepinthesealgorithms iseitherdirectlysupportedbycommonprogramminglanguages suchas arithmetic assignments loops orrecursion orsomethingthatyou vealready learnedhowtodo likesorting binarysearch treetraversal orsinging bottlesofbeeronthewa  describingalgorithms theskillsrequiredtoe ectively designandanalyze algorithmsareentangled withtheskillsrequiredtoe ectively algorithms atleastinmyclasses acompletedescriptionofanyalgorithmhasfourcomponents aprecisespeci cationoftheproblemthatthealgorithmsolves aprecisedescriptionofthealgorithmitself aproofthatthealgorithmsolvestheproblemitissupposedtosolve howfast ananalysisoftherunningtimeofthealgorithm itisnotnecessary orevenadvisable develop thesefourcomponentsinthis particularorder problemspeci cations algorithmdescriptions correctness proofs andtimeanalysesusuallyevolvesimultaneously withthedevelopment ofeachcomponentinformingthedevelopmentoftheothers forexample wemayneedtotweaktheproblemdescriptiontosupportafasteralgorithm ormodifythealgorithmtohandleatrickycaseintheproofofcorrectness presenting thesecomponentsseparatelyisusuallyclearestforthe reader aswithanywriting simportanttoaimyourdescriptionsattheright audience irecommendwritingforacompetentbutskepticalprogrammer isnotascleverasyouare thinkofyourselfsixmonthsago asyoudevelopany newalgorithm youwillnaturallybuilduplotsofintuitionabouttheproblem andabouthowyouralgorithmsolvesit andyourinformalreasoningwillbe guidedbythatintuition butanyone reading youralgorithmlater orthecode youderivefromit tshareyourintuitionorexperience neitherwillyour compiler neitherwillyousixmonthsfromnow alltheywillhaveisyour writtendescription evenifyouneverhavetoexplainyouralgorithmstoanyoneelse sstill importanttodevelopthemwithanaudienceinmind tryingtocommunicate clearlyforcesyouto moreclearly inparticular writingfora novice audience whowillinterpretyourwords aswritten forcesyoutowork   introduction nedetails nomatterhowouorvyourevelideas mayseematthemoment writingfora skeptical audienceforcesyou todeveloprobustargumentsforcorrectnessande ciency insteadoftrusting yourintuitionoryourintelligence  icannotemphasizethispointenough yourprimaryjobasanalgorithm designeris teachingotherpeople howandwhyyouralgorithmswork youcan tcommunicateyourideastootherhumanbeings theymayaswell notexist producingcorrectande cientexecutablecodeisanimportant butsecondarygoal convincingyourself yourprofessors prospective employers yourcolleagues oryourstudentsthatyouaresmartisatbesta distantthird specifyingtheproblem beforewecanevenstartdevelopinganewalgorithm wehavetoagreeonwhat problemouralgorithmissupposedtosolve beforewecanevenstart describing analgorithm wehaveto theproblemthatthealgorithmis supposedtosolve algorithmicproblemsareoftenpresentedusingstandardenglish interms ofreaorldobjects suptous thealgorithmdesigners torestatethese problemsintermsofformal abstract mathematical umbers arrays lists graphs trees andsoowecanreasonaboutformally wemustalso determineiftheproblemstatementcarriesanyhiddenassumptions andstate thoseassumptionsexplicitly forexample inthesong bottlesofbeeronthe isalwaysanoegativeinteger  wemayneedtore neourspeci cationaswedevelopthealgorithm ouralgorithmmayrequireaparticularinputrepresentation produceaparticularoutputrepresentation thatwasleftunspeci edinthe originalinformalproblemdescription orouralgorithmmightactuallysolvea moregeneral problemthanwewereoriginallyaskedtosolve thisisacommon featureofrecursivealgorithms thespeci cationshouldincludejustenoughdetailthatsomeoneelsecould ouralgorithmasablackbox withoutknowinghoworwhythealgorithm actuallyworks inparticular wemustdescribethetype andmeaning ofeach inputparameter andexactlyhowtheeventualoutputdependsontheinput parameters ontheotherhand ourspeci cationshould deliberatelyhide detailsthatare necessarytousethealgorithmasablackbox letthatwhich doesnotmattertrulyslide  inparticular iassumethat areaskepticalnovice  veneverheardanyonesing  bottlesofbeeronthewaoccasionallyi heardset theoristssinging  bottlesofbeeronthewabutforsomereasontheyalwaysgaveupbefore thesongwasover    describingalgorithms forexample thelatticeandduplatioationalgorithmsbothsolve thesameproblem giventwonoegativeintegers eachrepresented asanarrayofdigits computetheproduct alsorepresentedasanarrayof digits tosomeone thesealgorithms thechoiceofalgorithmiscompletely irrelevant ontheotherhand thegreekmpassalgorithm solvesa erentproblem becausetheinputandoutputvaluesarerepresented bylinesegmentsinsteadofarraysofdigits describingthealgorithm computerprogramsareconcreterepresentationsofalgorithms butalgorithms programs algorithmsareabstractmechanicalprocedures thatcanbeimplementedin programminglanguage thatsupportsthe underlyingprimitiveoperations theidiosyncraticsyntacticdetailsofyour favoriteprogramminglanguageareutterlyirrelevant focusingonthesewill onlydistractyou andyourreaders fromwhat goingon  agood algorithmdescriptionisclosertowhatweshouldwriteinthe comments ofa realprogramthanthecodeitself codeisapoormediumforstorytelling ontheotherhand aplainenglishprosedescriptionisusuallynotagoodidea algorithmshavelotsofidiomaticstrupeciallyconditionals loops functioncalls andrecursioarefartooeasilyhiddenbyunstructured prose colloquialenglishisfullofambiguitiesandshadesofmeaning algorithmsmustbedescribedasunambiguouslyaspossible proseisapoor mediumforprecision inmyopinion theclearestwaytopresentanalgorithmisusingacombination pseudo codeandstructuredenglish pseudocodeusesthe structure offormal programminglanguagesandmathematicstobreakalgorithmsintoprimitive steps theprimitivestepsthemselvescanbewrittenusingmathematicalnotation pureenglish oranappropriatemixtureofthetwo whateverisclearest writtenpseudocoderevealstheinternalstructureofthealgorithmbuthides irrelevantimplementationdetails makingthealgorithmeasiertounderstand analyze debug andimplement  thisis ofcourse amatterofreligiousconviction armchairlinguistsargueincessantlyover sapirwhorfhypothesis whichstates moreorless thatpeoplethinkonlyinthecategories imposedbytheirlanguages accordingtoanextremeformulationofthisprinciple someconcepts inonelanguagesimplycannotbeunderstoodbyspeakersofotherlanguages notjustbecauseof technologicaladvanowwouldyoutranslatethesorortnite intoaramaiutbecauseofinherentstructuraldi erencesbetweenlanguagesandcultures foramoreskepticalview seestevenpinker thelanguageinstinct thereisadmittedlysome strengthtothisideawhenappliedtodi erentprogrammingparadigms stheycombinator howdotemplateswork sanabstractfactory fortunately thosedi erencesare toosubtletohaveanyimpactonthematerialin book foracompellingcounterexample chrisokasaki smonograph functionaldatastructures andits morerecentdescendants   introduction wheneverwedescribeanalgorithm ourdescriptionshouldincludeevery detailnecessarytofullyspecifythealgorithm proveitscorrectness andanalyze itsrunningtime atthesametime itshould exclude anydetailsthatare necessarytofullyspecifythealgorithm proveitscorrectness andanalyzeits runningtime slide atamorepracticallevel ourdescriptionshouldallow acompetentbutskepticalprogrammer whohasnotreadthisbook toquickly andcorrectlyimplementthealgorithmin favoriteprogramminglanguage withoutunderstandingwhyitworks idon twanttoboreyouwiththerulesifollowforwritingpseudocode imustcautionagainstoneespeciallypernicioushabit describerepeated operationsinformally asin rst thendo andsoon epeat thisprocess soasanyonewhohastakenoneofthose frustrating comesnextinthissequen testsalreadyknows describing rstfewstepsofanalgorithmsayslittleornothingaboutwhathappens inlatersteps ifyouralgorithmhasaloop writeitasaloop andexplicitly describewhathappensinan arbitrary iteration ifyouralgorithmis recursive writeitrecursively andexplicitlydescribethecaseboundariesand whathappensineachcase  analyzingalgorithms snotenoughjusttowritedownanalgorithmandsaywemustalso convinceouraudience andourselves thatthealgorithmactuallydoeswhat ssupposedtodo andthatitdoessoe ciently correctness insomeapplicationsettings itisacceptableforprogramstobehavecorrectly mostofthetime onallsonablinputs notinthisbook werequire algorithmsthatare correct allpossible inputs wemust prove thatouralgorithmsarecorrect trustingourinstincts ortryingafewtest cases tgoodenough sometimescorrectnessistrulyobvious foralgorithmsyou veseeninearliercourses ontheotherhand isalltoooftenasynonymformostofthealgorithmswediscussin thiscourserequirerealworktoprovecorrect inparticular correctnessproofs usuallyinvolveinduction induction inductionisour friend  ofcourse beforewecanformallyprovethatouralgorithmdoeswhatit supposedtodo wehavetoformallydescribewhatit ssupposedtodo  ifinductionis yourfriend youwillhaveahardtimewiththisbook    analyzingalgorithms runningtime themostcommonwayofrankingdi erentalgorithmsforthesameproblemis byhowquicklytheyrun ideally wewantthefastestpossiblealgorithmforany particularproblem inmanyapplicationsettings itisacceptableforprograms torune cientlymostofthetime onallsonablinputs notinthisbook werequirealgorithmsthat rune ciently evenintheworstcase buthowdowemeasurerunningtime asaspeci cexample howlongdoes ittaketosingthesong bottlesofbeer thisisobviouslyafunctionofthe inputvalue butitalsodependsonhowquicklyyoucansing somesingers mighttaketensecondstosingaverse othersmighttaketwenty technology widensthepossibilitiesevenfurther dictatingthesongoveratelegraphusing morsecodemighttakeafullminuteperverse downloadinganmp3over thewebmighttakeatenthofasecondperverse duplicatingthemp3ina computer smainmemorymighttakeonlyafewmicrosecondsperverse simportanthereishowthesingingtimechangesas grows singing bottlesofbeer  requiresabouttwicemuchtimeassinging bottleso beer nomatterwhattechnologyisbeingused thisisre ectedinthe asymptoticsingingtime wecanmeasuretimebycountinghowmanytimesthealgorithmexecutesa certaininstructionorreachesacertainmilestoneintheforexample wemightnoticethattheword beer issungthreetimesineveryverseof bottlesofbeer sothenumberoftimesyousing beer isagoodindication ofthetotalsingingtime forthisquestion wecangiveanexactanswer bottlesofbeer mentions beer   times incidentally thereare lots ofsongswithquadraticsingingtime thisoneis probablyfamiliartomostenglispeakers ndaysofchristmas gifts   sing onthe thdayofchristmas mytruelovegavetome downto  sing jgifts  sing sing apartridgeinapeartree theinputto ndaysofchristmas isalistof  gifts representedhereas anarray squiteeasytoshowthatthesingingtimeis  inparticular thesingermentionsthenameofagift    times countingthe partridgeinthepeartree salsoeasytoseethatduringthe rst daysof christmas mytruelovegavetomeexactly       gifts   introduction otherquadratisongsincludemacdonaldhadaf wasanoldladywhoswallowedaoleinthebottomofthes growtherushesorattlin courtofkingcaractacu barliwerenotuponthestartrekkin dasnicht einschnitz  pulcinopiíhænsnakofanchad miyand tokokor ki formoreexamples consultyourfavorite preschooler alouette lapart  chantez alouette gentillealouette alouette jeteplumerai pourtout  à chantez jeteplumerai lapart jeteplumerai lapart pourtout à  àrebours chantez lapart lapart chantez alouette alouette aaaaaa chantez alouette gentilleallouette alouette jeteplumerai afewsongshaveevenmorebizarresingingtimes afairlymodernexample istelnetsobyguysteele whichactuallytakes  timetosing rst verses steelerecommended  finally therearesomesongsthat  exceptfortelnetsoallofthesesongsaremostnaturally expressedasasmallsetofnestedloops sotheir running singingtimescanbe computedusingnestedsummations therunningtimeofa recursive algorithmis moreeasilyexpressedasarecurrence forexample thepeasantmultiplication algorithmcanbeexpressedrecursivelyasfollows     iseven  isodd denotethenumberofparity addition andmediationoperations requiredtocompute thisfunctionsatis estherecursiveinequality    withbasecase   techniquesdescribed inthenextchapterimplytheupperbound log sometimestherunningtimeofanalgorithmdependsonaparticular implementationofsomeunderlyingdatastructureofsubroutine forexample thehuntingtoapportionmentalgorithm apportioncongress runsin time denotestherunningtimeof newprior queue denotestherunningtimeof insert denotestherunningtime  ja dasistottovonschnitzelpusskrankengescheitmeyer  theyjustgoonandon myfriend  exercises extractmax underthereasonableassumptionthat  onaverage eachstategetsatleasttworepresentatives wecansimplifythisboundto thepreciserunningtimedependsontheimplementation oftheunderlyingpriorityqueue thecensusbureauimplementsthepriority queueasanunsortedarray whichgivesus  sothe censusbureau simplementationof apportioncongress runsin time ifweimplementthepriorityqueueasabinaryheaporahea array wehave  log sotheoverallalgorithmrunsin log time finally sometimesweareinterestedincomputationalresourcesotherthan time suchasspace numberofcoin ips numberofcacheorpagefaults number ofmessages orthenumberofgiftsmytruelovegavetome resourcescanbeanalyzedusingthesametechniquesusedtoanalyzerunning time forexample latticemultiplicationoftwo numbersrequires  spaceifwewritedownallthepartialproductsbeforeaddingthem butonly spaceifweaddthemonthe exercises  describeandanalyzeane cientalgorithmthatdetermines givenalegal arrangementofstandardpiecesonastandardchessboard whichplayerwill winatchessfromthegivenstartingpositionifbothplayersplayperfectly hint thereisatrivialonesolution ª  identify orwrite asongthatrequires  timetosingthe rst verses identify orwrite asongthatrequires log timetosingthe rst verses identify orwrite asongthatrequiressomeotherweirdamountof timetosingthe rst verses  carefulreadersmightcomplainthatouranalysisofsongslike bottlesof beeronthewaor daysofchristmaisoverlysimplistic largernumberstakelongertosingthanshorternumbers moregenerally becausethereareonlysomanywordsofagivenlength largersetsofwords necessarilycontainlongerwords  wecanmoreaccuratelyestimatesinging timebycountingthenumberof syllables sung ratherthanthenumberof howlongdoesittaketosingtheinteger  ja dasistdassubatomarteilchenbeschleunigungsnaturmäÿigkeitsuntersuchungsmaschine   introduction howlongdoesittaketosing bottlesofbeeronthewa howlongdoesittaketosing daysofchristma asusual expressyouranswersintheform forsomefunction  thecumulativedrinkingsong thebarleymow hasbeensungthroughout thebritishislesforcenturies thesonghasmanyvariants figure   containspseudolyricsfor oneversiontraditionallysungindevonand cornwall vessel isthenameofavesselthatholds  ouncesof beer  barleymow sahealthtothebarley mow mybraveboys sahealthtothebarle lldrinkitoutofthejollybrownbowl sahealthtothebarle sahealthtothebarley mow mybraveboys sahealthtothebarle  lldrinkitoutofthe vessel boys sahealthtothebarle downto  vessel andthejollybrown sahealthtothebarle sahealthtothebarley mow mybraveboys sahealthtothebarle figure0  barley supposeeachname vessel isasingleword andyoucansingfour wordsasecond howlongwouldittakeyoutosing barleymow giveatightasymptoticbound ifyouwanttosingthissongforarbitrarilylargevaluesof llhave tomakeupyourownvesselnames toavoidrepetition thesenames mustbecomeprogressivelylongeras increases suppose vessel  inpractice thesongusessomesubsetofthefollowingvessels nipperkin halfgill quhalfpint quart pottle gallon half anker rkin halfbarrel hogshead pipe butt tun river andocean withafew exceptions especiallyattheend everyvesselinthislisthastwicethevolumeofitspredecessor irishandscottishversionsofthesonghaveslightlydi erentlyrics andtheyusuallyswitchto people barmaid landlord drayer andsoon afterllo anearlyversionofthesongentitledveusonceaappearsintheplay jackdrum entertainment orthecomedieofpasquillandkatherine writtenbyjohnmarstonaround1600 evsonceadrinkeforandtheblackbole singgentlebutler ballymoy thereissome disagreementwhethermarstonwrotethedutchsospeci callyfortheplay llymisa mondegreen foreymoorviceversa orwhetherit sactuallythesame songatall thesediscussionsarebesthadover bottlesofbeer  exercises log syllables andyoucansingsixsyllablespersecond nowhow longwouldittakeyoutosing barleymow giveatightasymptotic bound supposeeachtimeyoumentionthenameofavessel youactuallydrink thecorrespondingamountofbeer oneounceforthejollybrownbowl  ouncesforeach vessel assumingforpurposesofthisproblem thatyouareatleast21yearsold howmanyouncesofbeerwould youdrinkifyousang barleymow givean exact answer notjust anasymptoticbound  recallthattheinputtothehuntingtoalgorithm apportioncongress isanarray pop  pop isthepopulationofthe thstate andan integer thetotalnumberofrepresentativestobeallotted theoutputis anarray rep  rep isthenumberofrepresentativesallotted tothe thstatebythealgorithm thehuntingtoalgorithmissometimesdescribedinawaythat avoidstheuseofpriorityqueuesentirely thetevelalgorithm apositiverealnumber calledthe divisor andthenrunsthefollowing subroutinetocomputeanapportionment thevariable istheideal quota ofrepresentativesallocatedtoastateforthegivendivisor theactual numberofrepresentativesallocatedisalwayseither hhguess pop  reps   pop eb rep rep reps reps rep return reps therearethreepossibilitiesforthe nalreturnvalue reps reps wedidnotallocateenoughrepresentatives atleastintuitively meansourdivisor wastoosmall reps weallocatedtoomany representatives atleastintuitively meansourdivisor wastoo large finally reps wecanreturnthearray rep  asthe nal apportionment inpractice wecancomputeavalidapportionment reps bycalling hhguess withasmallnumberofintegerdivisorsclose tothe standard divisor inthefollowingproblems  pop denotethetotalpopul tionofall states andassumethat   introduction showthatcalling hhguess withthestandarddivisor necessarilyyieldavalidapportionment provethatif hhguess returnsthesamevalueof reps fortwodi erent divisors  italsocomputesthesameallocation rep  bothofthosedivisors provethatif hhguess returnsthecorrectvalue itcomputesthesame allocation rep  asourearlieralgorithm apportioncongress provethatadivisor doesnotnecessarilyexist thatis describeinputs pop  suchthatfor realnumber  thenumberofrepresentativesallocatedby hhguess isnotequalto hint whathappensifwechange inthe fourthlineof hhguess  thecontrolofalargeforceisthesameprincipleasthecontrolofafewmen itismerelyaquestionofdividinguptheirnumbers sunzi theartofwar  translatedbylionelgiles  ourlifeisfritteredawaybydetail simplify simplify henrydavidthoreau walden  taskmewhatvoomis ineverwillknow boy letmetellyou itdoescleanupsnow seuss theodorseussgeisel thecatinthehatcomesback  dothehardjobs rst theeasyjobswilltakecareofthemselves attributedtodalecarnegie  recursion  reductions reduction isthesinglemostcommontechniqueusedindesigningalgorithms reducingoneproblem toanotherproblem meanstowriteanalgorithm thatusesanalgorithmfor asablackboxorsubroutine crucially correctnessoftheresultingalgorithmfor cannotdependinanywayon thealgorithmfor works theonlythingwecanassumeisthattheblackbox solves correctly theinnerworkingsoftheblackboxaresimply noneofour business resomebodyelse sproblem softenbesttoliterallythinkofthe blackboxasfunctioningpurelybymagic forexample thepeasantmultiplicationalgorithmdescribedintheprevious chapterreducestheproblemofmultiplyingtwoarbitrarypositiveintegersto threesimplerproblems addition mediation halving andparitthe algorithmreliesonanabstractsitivedatatypethatsupportsthose threeoperations butthecorrectnessofthemultiplicationalgorithmdoesnot   recursion dependontheprecisedatarepresentation tallymarks claytokens babylonian hexagesimal quipu countingrods romannumerals ngerpositions augrym stones gobarnumerals binary negabinary graycode balancedternary phinary quary oronthepreciseimplementationsofthoseoperations ofcourse runningtime ofthemultiplicationalgorithmdependsonthe runningtime oftheaddition mediation andparityoperations butthat aseparateissuefrom correctness mostimportantly wecancreateamore cientmultiplicationalgorithmjustbyswitchingtoamoree cientnumber representation fromtallymarkstoplaluenotation forexample thehuntingtoalgorithmreducestheproblemofapportioning congresstotheproblemofmaintainingapriorityqueuethatsupportsthe operations insert extractmax theabstractdatatypeorityqueuis ablackbox thecorrectnessoftheapportionmentalgorithmdoesnotdepend onanyspeci cpriorityqueuedatastructure ofcourse runningtime theapportionmentalgorithmdependsonthe runningtime ofthe insert extractmax algorithms butthat saseparateissuefromthe correctness ofthe algorithm thebeautyofthereductionisthatwecancreateamoree cient apportionmentalgorithmbysimplyswappinginanewpriorityqueuedata structure thedesignerofthatdatastructuredoesnotneedtoknow orcarethatitwillbeusedtoapportioncongress whenwedesignalgorithms wemaynotknowexactlyhowthebasicbuilding blocksweuseareimplemented orhowouralgorithmsmightbeusedasbuilding blockstosolveevenbiggerproblems thatignoranceisuncomfortableformany beginners butitisbothunavoidableandextremelyuseful evenwhenyou doknowpreciselyhowyourcomponentswork itisoften extremely helpfulto pretendthatyoudon  simplifyanddelegate recursion isaparticularlypowerfulkindofreduction whichcanbedescribed looselyasfollows ifthegiveninstanceoftheproblemcanbesolveddirectly solveitdirectly reduceittooneormore simplerinstancesofthesameproblem iftheselferenceisconfusing itmaybehelpfultoimaginethatsomeoneelse isgoingtosolvethesimplerproblems justasyouwouldassumeforothertypes ofreductions iliketocallthatsomeoneelsethe recursionfairy taskisto simplify theoriginalproblem ortosolveitdirectlywhensimpli cation iseitherunnecessaryorimpossible therecursionfairywillsolveallthesimpler subproblemsforyou usingmethodsthatarenoneofyourbusinessso butt    simplifyanddelegate  mathematicallysophisticatedreadersmightrecognizetherecursionfairy byitsmoreformalname inductionhypothesis thereisonemildtechnicalconditionthatmustbesatis edinorderfor anyrecursivemethodtoworkcorrectly theremustbenoin nitesequenceof reductionstosimplerandsimplerinstances eventually therecursivereductions mustleadtoanelementary basecase thatcanbesolvedbysomeothermethod therecursivealgorithmwillloopforever themostcommonway tosatisfythisconditionistoreducetooneormore smaller instancesofthe sameproblem forexample iftheoriginalinputisaskreeblewith glurps inputtoeachrecursivecallshouldbeaskreeblewithstrictlylessthan glurps ofcoursethisisimpossibleiftheskreeblehasnoglurpsataoucan thave negativeglurps thatwouldbeinthatcasewemustgrindleblo skreebleusingsomeothermethod vealreadyseenoneinstanceofthispatterninthepeasantmultiplication algorithm whichisbaseddirectlyonthefollowingrecursiveidentity     iseven  isodd thesamerecurrencecanbeexpressedalgorithmicallyasfollows peasantmultiply  return     prod peasantmultiply   recurse isodd prod prod return prod alazyegyptianscribecouldexecutethisalgorithmbycomputing   askingamorejuniorscribetomultiply   andthenpossiblyadding tothejuniorscribe sresponse thejuniorscribe sproblemissimplerbecause  andrepeatedlydecreasingapositiveintegereventuallyleadsto  thejuniorscribeactuallycomputes   isnoneoftheseniorscribe sbusiness andit snoneofyourbusiness  wheniwasanundergraduate iattributedrecursiontoinsteadoftherecursionfairy referringtothebrothersgrimmstoryaboutanoldshoemakerwholeaveshisworkun nished whenhegoestobed onlytodiscoveruponwakingthatelvesichtelmännhave nished everythingovernight someonemoreentheogenicallyexperiencedthanimightrecognizethese rekursionswichtelmännerasterencemckenna sormingmachineelv   recursion  towerofhanoi thetowerofhanoipuzzlewas rstpublissanactualphysicalpuzzl thefrenchteacherandrecreationalmathematicianédouardlucasin1883  underthepseudonym claus desi ananagramofcasd ami thefollowingyear henrideparvilledescribedthepuzzlewiththefollowing remarkablestory  inthegreattempleatbenares  beneaththedomewhichmarksthecentreof theworld restsabrassplateinwhichare xedthreediamondneedles acubithighandasthickasthebodyofabee ononeoftheseneedles atthe creation godplacedsixty fourdiscsofpuregold thelargestdiscrestingonthe brassplate andtheothersgettingsmallerandsmalleruptothetopone thisis thetowerofbramah dayandnightunceasinglytheprieststransferthediscs fromonediamondneedletoanotheraccordingtothe xedandimmutable lawsofbramah whichrequirethatthepriestondutymustnotmovemore thanonediscatatimeandthathemustplacethisdisconaneedlesothat thereisnosmallerdiscbelowit whenthesixty fourdiscsshallhavebeenthus transferredfromtheneedleonwhichatthecreationgodplacedthemtoone oftheotherneedles tower temple andbrahminsalikewillcrumbleintodust andwithathunderclaptheworldwillvanish figure1   disk towerofhanoipuzzle ofcourse asgoodcomputerscientists rstinstinctonreadingthis storyistosubstitutethevariable forthehardwiredconstant  andbecause mostphysicalinstancesofthepuzzlearemadeofwoodinsteadofdiamonds andgold iwillcallthethreepossiblelocationsforthedisksinsteadof  lucaslaterclaimedtohaveinventedthepuzzlein1876  thisenglishtranslationistakenfromw rouseball s1892book mathematicalrecreations andessays  thetempleatbenisalmostcertainlythekashivishvanathtempleinvaranasi uttarpradesh india locatedapproximately2400kmwestofhàn ô vi ê tnam ctionaln claussupposedlyresided coincidentally thefrencharmyinvadedhanoiin1883 thesameyearlucasreleasedhispuzzle ultimatelyleadingtoitsestablishmentasthecapitalof frenchindochina    towerofhanoi eedlhowcanwemoveatowerof disksfromonepegtoanother usinga thirdsparepegasanoccasionalplaceholder withouteverplacingadiskontop ofasmallerdisk asn claus desiam pointedoutinthepamphletincludedwithhispuzzle thesecrettosolvingthispuzzleistothinkrecursively insteadoftryingtosolve theentirepuzzleatonce sconcentrateonmovingjustthelargestdisk tmoveitatthebeginning becausealltheotherdisksareintheway rstwehavetomovethose  smallerdiskstothesparepeg oncethat wecanmovethelargestdiskdirectlytoitsdestination finally nish thepuzzle wehavetomovethe  smallerdisksfromthesparepegtotheir destination figure1  thetowerofhanoialgorithm ignoreeverythingbutthebottomdisk sonowallwehaveto gureoutishowt sit redone vesuccessfullyreducedthe ktowerofhanoi problemtotwoinstancesofthe  ktowerofhanoiproblem wecangleefullyhando totherecursionftocarrylucas smetaphor tothejuniormonksatthetemple jobis nished ifwedidn ttrust thejuniormonks wewouldn thavehiredthem letthemdotheirjobinpeace ourreductiondoesmakeonesubtlebutextremelyimportantassumption thereisalargestdisk ourrecursivealgorithmworksforany positive number ofdisks butitbreaksdownwhen  wemusthandlethatcaseusinga erentmethod fortunately themonksatbenares beinggoodbuddhists quiteadeptatmovingzerodisksfromonepegtoanotherinnotimeatall doingnothing figure1  thevacuousbasecaseforthetowerofhanoialgorithm thereisnospoon   recursion itmaybetemptingtothinkabouthowallthosesmallerdisksmovearo ormoregenerally whathappenswhentherecursionisunrolled utreally tdoit formostrecursivealgorithms unrollingtherecursionisneither necessarynorhelpful taskistoreducetheprobleminstancewe giventooneormoresimplerinstances ortosolvetheproblemdirectlyifsuch areductionisimpossible ourrecursivetowerofhanoialgorithmistrivially correctwhen  forany  therecursionfairycorrectlymovesthetop  disks moreformally theinductivehypothesisimpliesthatourrecursive algorithmcorrectlymovesthetop  disks soouralgorithmiscorrect therecursivehanoialgorithmisexpressedinpseudocodeinfigure   thealgorithmmovesastackof disksfromasourcepeg src toadestination peg dst usingathirdtemporarypeg tmp asaplaceholder noticethatthe algorithmcorrectlydoesnothingatallwhen  hanoi src dst tmp  hanoi  src tmp dst recurse movedisk src dst hanoi  tmp dst src recurse figure1  arecursivealgorithmtosolvethetowerofhanoi denotethenumberofmovesrequiredtotransfer dis runningtimeofouralgorithm ourvacuousbasecaseimpliesthat   andthemoregeneralrecursivealgorithmimpliesthat    forany  bywritingoutthe rstseveralvaluesof wecaneasily guessthat   astraightforwardinductionproofimpliesthatthis guessiscorrect inparticular movingatowerof64disksrequires          individualmoves evenattheimpressiverate ofonemovepersecond themonksatbenareswillbeatworkforapproximately billionyearssde cinqmilliardsdesiècles beforetower temple brahminsalikewillcrumbleintodust andwithathunderclaptheworldwill vanish  mergesort mergesortisoneoftheearliestalgorithmsdesignedforgenerasest programcomputers thealgorithmwasdevelopedbyjohnvonneumannin  anddescribedindetailinapublicationwithhermangoldstinein1947 oneofthe rstnoumericalprogramsfortheedvac   goldstineandvonneumannactuallydescribedannovevariantnowusuallycalled bottomergesort atthetime largedatasetsweresortedbyspeciasemachin almostallbuiltbyimanipulatedpunchedcardsusingvariantsofbinaryradixsort von    mergesort  dividetheinputarrayintotwosubarraysofroughlyequalsize  recursivelymergesorteachofthesubarrays  mergethensubarraysintoasinglesortedarray input sortingexampl divide sortingexampl recurseleft inorstgexampl recurseright inorstaeglmpx merge aegilmnoprstx figure1  amergesortexample rststepiscompletelytriviastdividethearraysizebytw wecandelegatethesecondsteptotherecursionfairy alltherealworkis doneinthe nalmergestep acompletedescriptionofthealgorithmisgivenin figure   tokeeptherecursivestructureclear veextractedthemergestep intoanindependentsubroutine themergealgorithmisalsorecursivy rstelementoftheoutputarray andthenrecursivelymergetherestofthe inputarrays mergesort    mergesort  recurse mergesort  recurse merge  merge      elseif  elseif    figure1  mergesort correctness toprovethatthisalgorithmiscorrect weapplyouroldfriendinductiontwice rsttothe merge subroutinethentothetevel mergesort algorithm lemma1  merge correctlymergesthesubarrays   assumingthosesubarraysaresortedintheinput neumannargued thatbecausetheedvaccouldsortfasterthanibm sdedicated sorters uthumaninterventionorneedforadditionaltheedvacwasanll purpomachine andspeciasesortingmachineswerenolongernecessary   recursion proof  beanyarrayand anyintegersuchthatthesubarrays   aresorted weprovethatforall  thelast  iterationsofthemainloopcorrectlymerge theproofproceedsbyinductionon  thenumberofelements remainingtobemerged thealgorithmcorrectlymergesthetwoemptysubarraysbydoing absolutelynothing thisisthebasecaseoftheinductiveproof therearefourcasestoconsiderforthe thiterationofthemainloop thensubarray isempty min thensubarray isempty min min wemusthave min inallfourcases iscorrectlyassignedthesmallestelementof inthetwocaseswiththeassignment therecursionfairy correctly imeantheinductionhypothesisimpliesthatthelast iterationsofthemainloopcorrectlymerge   intheothertwocases therecursionfairyalsocorrectly mergestherestofthesubarrays theorem1  mergesort correctlysortsanyinputarray  proof weprovethetheorembyinductionon  thealgorithm correctlydoesnothing therecursionfairycorrectly meantheinductionhypothesisimpliesthatouralgorithmcorrectlysortsthe twosmallersubarrays   afterwhichtheyarecorrectly merge dintoasinglesortedarray bylemma   analysis becausethe mergesort algorithmisrecursive itsrunningtimeisnaturally expressedasarecurrence merge clearlytakes time becauseit sasimple foopwithconstantworkperiteration weimmediatelyobtainthefollowing recurrencefor mergesort   asinmostdinquerrecurrences wecansafelystripoutthe oors andceilings usingatechniquecalled domaintransformations describedlater inthischapter givingusthesimplerrecurrence   lllevelsequacaseoftherecursiontreemethod alsodescribedlaterinthis chapter immediatelyimpliesthecloormsolution log ifyouarenot familiarwithrecursiontrees youcanverifythesolution log byinduction    quicksort  quicksort quicksortisanotherrecursivesortingalgorithm discoveredbytonyhoarein and rstpublishedin1961 inthisalgorithm thehardworkissplitting thearrayintosmallersubarrays recursion sothatmergingthesorted subarraysistrivial  choosea pivot elementfromthearray  partitionthearrayintothreesubarrayscontainingtheelementssmaller thanthepivot thepivotelementitself andtheelementslargerthanthe pivot  recursivelyquicksortthe rstandlastsubarrays input sortingexampl chooseapivot sortingexam partition agoeinlm txsr recurseleft aegilmno txsr recurseright aegilmno rstx figure1  aquicksortexample moredetailedpseudocodeisgiveninfigure   inthe partition subroutine theinputparameter istheindexofthepivotelementintheunsortedarray thesubroutinepartitionsthearrayandreturnsthenewindexofthepivot element therearemanydi erente cientpartitioningalgorithms theone mpresentinghereisattributedtonicolomuto  thevariable countsthe numberofitemsinthearraythatare essthanthepivotelement quicksort   chooseapivotelement partition quicksort   recurse quicksort  recurse partition  swap  items pivot    swap swap  return  figure1  quicksort correctness justlikemergesort provingthat quicksort iscorrectrequirestwoseparate inductionproofs onetoprovethat partition correctlypartitionsthearray  hoareproposedamorecomplicatedwapartitioningalgorithmthathassome practicaladvantagesoverlomuto salgorithm ontheotherhand hoare spartitioningalgorithm isoneoftheplaceso neerrorsgotodie   recursion theothertoprovethat quicksort correctlysorts assuming partition iscorrect toprove partition iscorrect weneedtoprovethefollowingloopinvariant theendofeachiterationofthemainloop everythinginthesubarray  essthan andnothinginthesubarray  islessthan llleavetheremainingstraightforwardbuttediousdetailsasexercisesforthe reader analysis theanalysisofquicksortisalsosimilartothatofmergesort partition runsin time becauseit sasimplefoopwithconstantworkperiteration quicksort wegetarecurrencethatdependson rank ofthechosen pivotelement  ifwecouldsomehowalwaysmagicallychoosethepivottobethe median element ofthearray wewouldhave  thetwosubproblemswouldbeasclose tothesamesizeaspossible therecurrencewouldbecome      andwe dhave log usingeithertherecursiontreemethodor theevensimpleryeah wealreadysolvedthatrecurrencefor method infact aswewillseelaterinthischapter actuallylocatethe medianelementinanunsortedarrayinlineartime butthealgorithmisfairly complicated andthehiddenconstantinthe notationislargeenoughto maketheresultingsortingalgorithmimpractical inpractice mostprogrammers settleforsomethingsimple likechoosingthe rstorlastelementofthearray inthiscase cantakeanyvaluebetween  sowehave max   intheworstcase thetwosubproblemsarecompletelyunbalan  therecurrencebecomes  thesolutionis  anothercommonheuristiciscalledanofsethree ements usuallyatthebeginning middle andendofthearray andtake themedianofthosethreeelementsasthepivot althoughthisheuristicis somewhatmoree cientinpracticethanjustchoosingoneelement whenthearrayisalready sorted wecanstillhave   intheworstcase withthemedifheuristic therecurrencebecomes   whosesolutionisstill     thepattern intuitively thepivotelementshouldsuafallsomewhereinthemiddleof thearray saywithrankbetween    thisobservationsuggeststhat thevrunningtimeshouldbe log althoughthisintuition canbeformalized themostcommonformalizationmakesthecompletely unrealisticassumptionthatallpermutationsoftheinputarrayareequallylikely realworlddata berandom butitisnotrandominanywaythatwecan predictinadvance anditis notuniform  occasionallypeoplealsoconsidercarunningtimeforsomereason wewon  thepattern bothmergesortandquicksortfollowageneralpatterncalled divide andconquer  divide thegiveninstanceoftheproblemintoseveral independentsmaller instancesof thesameproblem  delegate eachsmallerinstancetotherecursionfairy  combine thesolutionsforthesmallerinstancesintothe nalsolution forthegiveninstance ifthesizeofanyinstancefallsbelowsomeconstantthreshold weabandon recursionandsolvetheproblemdirectly bybruteforce inconstanttime provingadinqueralgorithmcorrectalmostalwaysrequires induction analyzingtherunningtimerequiressettingupandsolvinga recurrence whichusually butunfortunatelynotalways canbesolvedusing recursiontrees  recursiontrees sowhataretheseonikeeptalkingabout recursiontreesare asimple general pictorialtoolforsolvingdinquerrecurrences recursiontreeisarootedtreewithonenodeforeachrecursivesubproblem ofeachnodeistheamountoftimespentonthecorrespondingsubproblem excluding recursivecalls theoverallrunningtimeofthealgorithmisthe sumofthevaluesofallnodesinthetree tomakethisideamoreconcrete imagineadinqueralgorithm thatspends timeonnovework andthenmakes recursive  ontheotherhand ifwechoosethepivotindex uniformlyatrandom quicksort runs log time withhighprobability possibleinputarray thekeydi erenceisthat therandomnessiscontrolledbyouralgorithm notbytheowerfulmaliciousadversarywho givesusinputdataafterreadingourcode theanalysisofrandomizedquicksortisunfortunately outsidethescopeofthisbook butyoucan ndrelevantlecturenotesat algorithms wtf   recursion calls eachonaproblemofsize uptoconstantfactors whichwecan hideinthe notation therunningtimeofthisalgorithmisgovernedbythe recurrence therootoftherecursiontreefor hasvalue children eachofwhichistherootofa recursivelyde ned recursiontreefor equivalently arecursiontreeisacomplete treewhereeachnodeatdepth containsthevalue feelfreetoassumethat isanintegerpowerof sothat isalwaysaninteger althoughinfactthisdoesn tmatter inpractice irecommenddrawingoutthe rsttwoorthreelevelsofthe tree asinfigure   figure1  arecursiontreefortherecurrence theleavesoftherecursiontreecorrespondtothebasecase ofthe recurrence becausewe reonlylookingforasymptoticbounds theprecisebase casedoesn tactuallymatter wecansafelyassume  forall   isanarbitrarypositiveconstant inparticular wecanchoosewhatever valueof  ismostconvenientforouranalysis forthisexample llchoose   isthesumofallvaluesintherecursiontree wecanevaluatethis sumbyconsideringthetreelevevel foreachinteger thlevelof thetreehasexactly nodes eachwithvalue  isthedepthofthetree ourbasecase   immediatelyimplies log   itfollowsthatthenumberofleavesin    recursiontrees therecursiontreeisexactly log log thelastterminthe levevelsum log  log   therearethreecommoncaseswherethelevevelseries isespecially easytoevaluate decreasing iftheseries decaysexponentially erytermisaconstant factorsmallerthantheprevious inthiscase thesumisdominatedbythevalueattherootoftherecursiontree equal ifalltermsintheseriesareequal weimmediatelyhave log theconstant vanishesintothe notation increasing iftheseries growsexponentially erytermisaconstantfactor largerthantheprevious log inthiscase thesum isdominatedbythenumberofleavesintherecursiontree inthe rstandthirdcases onlythelargestterminthegeometricseriesmatters allothertermsareswallowedupbythe notation inthedecreasingcase wedon tevenhavetocompute theasymptoticupperboundwouldstillhold iftherecursiontreewerein nite asanelementaryexample ifwedrawoutthe rstfewlevelsoftherecursion treeforthe simpli mergesortrecurrence   discoverthatalllevelsareequal whichimmediatelyimplies log figure1  therecursiontreeformergesort therecursiontreetechniquecanalsobeusedforalgorithmswherethe recursivesubproblemshavedi erentsizes forexample ifwecouldsomehow implementquicksortsothatthepivot landsinthemiddlethirdofthe sortedarray thewserunningtimewouldsatisfytherecurrence    thisrecurrencemightlookscary butit sactuallyprettytame ifwedraw outafewlevelsoftheresultingrecursiontree wequicklyrealizethatthe sumofvaluesonanylevelis atmost levelsmightbemissingsome ntheentiretreehasdepth log   log itimmediatelyfollows log thenumberof levelsintherecursion   recursion treeis log  log sothisconservativeanalysiscanbeimprovedbyat mostaconstantfactor whichforourpurposesmeansnotatall thefactthat therecursiontreeisunbalancedsimplydoesn tmatter asamoreextremeexample thewserecurrenceforquicksort   givesusacompletelyunbalancedrecursiontree onechildofeachinternalnodeisaleaf thelevevelsumdoesn tfall intoanyofourthreedefaultcategories butwecanstillderivethesolution  byobservingthateverylevelvalueisatmost andthereareat levels thisconservativeanalysisistight  levelseach havevalueatleast  figure1  recursiontreesforquicksortwithgoodpivots left andwithworst casepivots ª ignoringfloorsandceilingsisokay honest carefulreadersmightobjectthatouranalysisbrushesanimportantdetailunder therug therunningtimeofmergesortdoesn obeytherecurrence   afterall theinputsize mightbeodd andwhatcould itpossiblymeantosortanarrayofsize       theactualmergesort recurrenceissomewhatmessier   wecouldcheckthat log usinginduction butthenecessary calculationswouldbeawful fortunately thereisasimpletechniquefor removing oorsandceilingsfromrecurrences called domaintransformation becausewearederivinganupperbound wecansafelyoverestimate oncebypretendingthatthetwosubproblemsizesareequal againtoeliminatetheceiling        formally wearetreating asafunctionoverthe reals notjustovertheintegers satis esthegivenrecurrencewiththebasecase forall  forsomerealnumbers    whosevaluesdon tmatter happenstobeaninteger coincides withtherunningtimeofanalgorithmonaninputofsize butthatdoesn tmatter  ª   linear timeselection wede neanewfunction choosingtheconstant sothat satis esthesimplerrecurrence   ndthecorrectconstant wederivearecurrencefor fromourgiven recurrencefor nitionof     recurrencefor     nitionof setting  simpli esthisrecurrenceto    whichis exactlywhatwewanted finally therecursiontreemethodimplies log andtherefore   log  log exactlyaspromised similardomaintransformationscanbeusedtoremove oors ceilings andeven lowerordertermsfrom divideandconquerrecurrence butnowthatwe realizethis wedon tneedtobothergrindingthroughthedetailseveragain fromnowon facedwithanydinquerrecurrence iwillsilently brush oorsandceilingsandlowtermsundertherug andiencourage youtodothesame ª  linear timeselection duringourdiscussionofquicksort iclaimedinpassingthatwecan ndthe medianofanunsortedarrayinlineartime rstsuchalgorithmwas discoveredbymanuelblum bobfloyd vaughanpratt ronrivest andbob tarjanintheearly1970s theiralgorithmactuallysolvesthemoregeneral problemofselectingthe thsmallestelementinan ementarray giventhe arrayandtheinteger asinput usingavariantofanalgorithmcalled quickselect onquicksort quickselectwas rstdescribedbytonyhoarein1961 literallyonthesamepagewherehe rstpublishedquicksort quickselect thegenericquickselectalgorithmchoosesapivotelement partitionsthearray usingthesame partition subroutineas quicksort andthenrecursively searches onlyone ofthetwosubarrays speci cally theonethatcontainsthe thsmallestelementoftheoriginalinputarray pseudocodeforquickselectis giveninfigure     recursion quickselect   returna  chooseapivotelement partition  return quickselect   elseif return quickselect  return figure1  quickselect orone armedquicksort thisalgorithmhastwoimportantfeatures justlikequicksort correctnessofquickselectdoesnotdependonhowthepivotischosen evenifwereallyonlycareaboutselecting medians thespecialcase  hoare srecursivestrategyrequiresustoconsiderthemoregeneralselection problem themedianoftheinputarray  isalmostneverthemedianof eitherofthetwosmallersubarrays    thewserunningtimeof quickselect obeysarecurrencesimilarto quicksort wedon tknowthevalueof orwhichofthetwosubarrayswe recursivelysearch sowehavetoassumetheworst max  max  wecansimplifytherecurrenceslightlybyletting denotethelengthofthe recursivesubproblem max   ifthechosenpivotelementisalwayseitherthesmallestorlargestelementin thearray therecurrencesimpli esto  whichimplies  therecursiontreeforthisrecurrenceisjustasimplepath goodpivots wecouldavoidthisquadraticwsebehaviorifwecould magically choosea good pivot meaning forsomeconstant  inthiscase recurrencewouldsimplifyto  ª   linear timeselection thisrecurrenceexpandsintoadecreasinggeometricseries whichisdominated byitslargestterm therecursiontreeisjustasimple path theconstantinthe runningtimedependsontheconstant inotherwords ifwecouldsomehowquickly ndanelementthat close tothemedianinlineartime wecould ndthe exact medianinlinear time sonowallweneedisanapproximatemedianfairy vtarjanalgorithmchoosesagoodquickselectpivotby recursively computingthemedianofacarefsensubsetoftheinputarray approximatemedianfairyisjusttherecursionfairyindisguise speci cally wedividetheinputarrayinto  blocks eachcontaining  elements exceptpossiblythelast ifthelastblockisn tfull justthrow inafew  wecomputethemedianofeachblockbybruteforce collect thosemediansintoanewarray   andthen recursively compute themedianofthisnewarray finally weusethemedianoftheblockmedians called mom inthepseudocodebelow asthequickselectpivot momselect   orwhatever usebruteforce   medianoffive    bruteforce mom momselect   recursion partition  mom return momselect   recursion elseif return momselect  recursion return mom momselect usesrecursionfortwodi erentpurposes rsttimeto chooseapivotelement mom andthesecondtimetosearchthroughthe entriesononesideofthatpivot analysis butwhyisthisfast rstkeyinsightisthat themedianofmediansisa goodpivot momislargerthan    ˇ  blockmedians andeach blockmedianislargerthantwootherelementsinitsblock momisbigger thanatleast   elementsintheinputarray symmetrically momissmaller thanatleast   elements intheworstcase thesecondrecursivecall searchesanarrayofsizeatmost     recursion wecanvisualizethealgorithm sbehaviorbydrawingtheinputarrayasa   grid whicheachcolumnrepresents veconsecutiveelements purposesofillustration imaginethatwesorteverycolumnfromtopdown thenwesortthecolumnsbytheirmiddleelement letmeemphasizethat algorithmdoesnotactuallydothis inthisarrangement themedifans istheelementclosesttothecenterofthegrid thelefthalfofthe rstthreerowsofthegridcontains   elements ofwhichissmallerthanmom iftheelementwe relookingforislargerthan mom ouralgorithmwillthrowaway smallerthanmom including   elements beforerecursing theinputtotherecursive subproblemcontainsatmost   elements asymmetricargumentimplies thatifourtargetelementissmallerthanmom wediscardatleast   elementslargerthanmom sotheinputtoourrecursivesubproblemhasatmost   elements somomisagoodpivot butouralgorithmstillmakes recursive callsinsteadofjustone howdoweprovelineartime thesecondkeyinsightis thatthe total sizeofthetworecursivesubproblemsisaconstantfactorsmaller thanthesizeoftheoriginalinputarray thewserunningtimeofthe algorithmobeystherecurrence    ifwedrawouttherecursiontreeforthisrecurrence weobservethatthetotal workateachleveloftherecursiontreeisatmost   thetotalworkatthe previouslevel thelevelsumsdecayexponentially givingusthesolution thefactthattherecursiontreeisunbalancediscompletely immaterial hooray mom  ª   linear timeselection figure1  therecursiontreesfor momselect andasimilarselectionalgorithmwithblocksofsize3 sanitychecking atthispoint manystudentsaskaboutthatmagicconstant  whydidwe choosethatparticularblocksize theansweristhat  isthesmallestodd blocksizethatgivesusexponentialdecayintherecursioanalysis blocksizesintroduceadditionalcomplications ifwehadusedblocksofsize  therecurrencewouldbe    veseenthisrecurrencebefore everyleveloftherecursiontreehastotal atmost andthedepthoftherecursiontreeis log   log thesolutiontothisrecurrenceis log thisanalysisis tight becausetherecursiontreehas log  completelevels medifans selectionusing  ementblocksisnofasterthansorting fineranalysisrevealsthattheconstanthiddenbythe notationisquite large evenifwecountonlycomparisons selectingthemedianof  elements requires atmost  comparisons soweneedatmost   comparisonstoset uptherecursivesubproblem naïvelypartitioningthearrayaftertherecursive callwouldrequire  comparisons butwealreadyknow   elements largerthanthepivotand   elementssmallerthanthepivot sopartitioning actuallyrequiresonly   additionalcomparisons amoreprecise recurrenceforthewsenumberofcomparisonsis      therecursiontreemethodimpliestheupperbound          inpractice medifansselectionisnotasslowasthiswseanalysis prediawsepivotateverylevelofrecursionisincredibly utitisstillslowerthansortingforevenmoderatelylargearrays   infact therightwaytochoosethepivotelementinpracticeistochooseit uniformlyat random thentheexpectednumberofcomparisonsrequiredto ndthemedianisatmost  seemyrandomizedalgorithmslecturenotesat algorithms wtf formoredetails   recursion  fastmultiplication inthepreviouschapter wesawtwoancientalgorithmsformultiplyingtwo numbersin  time thelatticealgorithmandthe egyptianpeasantalgorithm maybewecangetamoree cientalgorithmbysplittingthedigitarraysin halfandexploitingthefollowingidentity      thisrecurrenceimmediatelysuggeststhefollowingdinquera rithmtomultiplytwo numbers eachofthefouructs iscomputedrecursively butthemultiplicationsinthelast lineare recursive becausewecanmultiplybyapoweroftenbyshiftingthe digitstotheleftand llinginthecorrectnumberofzeros allin time splitmultiply  return   mod10   mod10  splitmultiply splitmultiply splitmultiply splitmultiply return    correctnessofthisalgorithmfollowseasilybyinduction therunningtimefor thisalgorithmfollowstherecurrence   therecursiontreemethodtransformsthisrecurrenceintoan increasing metricseries whichimplies log    infact thisalgorithm multiplieseachdigitof witheachdigitof justlikethelatticealgorithm soiguessthatdidn twork toobad itwasaniceidea intheandreikolmogorov oneofthegiantsof20thcentury mathematics publiclyconjecturedthatthereis algorithmtomultiplytwo numbersinsubquadratictime kolmogorovorganizedaseminarat moscowuniversityin1960 whereherestatedhis  coandposed severalrelatedproblemsthatheplannedtodiscussatfuturemeetings exactlyaweeklater astudentnamedanatoli ˇkaratsubapresented kolmogorovwitharemarkablecounterexample accordingtokaratsubahimself    fastmultiplication figure1  therecursiontreefornaïvedivide conquermultiplication aftertheseminaritoldkolmogorovaboutthenewalgorithmandaboutthe disproofofthe  conjecture kolmogorovwasveryagitatedbecausethis contradictedhisveryplausibleconjecture atthenextmeetingofthesemi nar kolmogorovhimselftoldtheparticipantsaboutmymethod andatthat pointtheseminarwasterminated karatsubaobservedthatthemiddlecoe cient canbecomputedfromthe othertwocoe cients usingonly morerecursivemultiplication viathefollowingalgebraicidentity thistrickletsusreplacethefourrecursivecallsinthepreviousalgorithmwith onlythreerecursivecalls asshownbelow fastmultiply  return   mod10   mod10  fastmultiply fastmultiply fastmultiply return    therunningtimeofkaratsuba fastmultiply algorithmfollowstherecurrence   onceagain therecursiontreemethodtransformsthisrecurrenceintoan increasinggeometricseries butthenewsolutionisonly log     asigni cantimprovementoverourearlierquadratictimebound   mypresentationsimpli estheactualhistoryslightly infact karatsubaproposedan algorithmbasedontheformula thisalgorithmalsoruns lg3 time buttheactualrecurrenceisslightlymessier arestill numbers mighteachhave  digits thesimpli cationpresentedhereis duetodonaldknuth   recursion karatsuba salgorithmarguablylaunchedthedesignandanalysisofalgorithms asaformal eldofstudy figure1  therecursiontreeforkaratsuba sdivide conquermultiplicationalgorithm wecantakekaratsuba sideaevenfurther splittingthenumbersinto morepiecesandcombiningtheminmorecomplicatedways toobtaineven fastermultiplicationalgorithms andreitoomdiscoveredanin nitefamily ofalgorithmsthatsplitanyintegerinto parts eachwith digits thencomputetheproductusingonly   recursivemultiplications toom algorithmswerefurthersimpli edbystephencookinhisphdthesis forany xed thetooookalgorithmrunsin   lg time wherethehidden constantinthe notationdependson ultimately thisdinquerstrategyledgauss tothe discoveryofthe fastfouriertransform  thebasicfftalgorithmitself runsin log time usingfftsforintegermultiplicationincurs somesmalladditionaloverhead rstfftsedintegermultiplication algorithm publishedbyarnoldschönhageandvolkerstrassenin1971 runs log loglog time schössenremainedthetheoretically fastestintegermultiplicationalgorithmforseveraldecades beforemartinfürer discoveredthe rstofalongseriesoftechnicalimprovements finally in2019 davidharveyandjorisvanderhoevenpublishedanalgorithmthatrunsin log time   exponentiation givenanumber andapositiveinteger supposewewanttocompute standardnaïvemethodisasimplefoopthatperforms  multiplications  algorithms wtf forlecturenotesonfastfouriertransforms  schössenisactuallythefastestalgorithm inpractice formultiplyingintegerswith morethanabout75000digits themorerecentalgorithmsoffürer harvey vanderhoeven otherswouldbefasterpractionlyforintegerswithmoredigitsthanthereareparticlesin theuniverse    exponentiation slowpower  return thisiterativealgorithmrequires multiplications theinputparameter couldbeaninteger orarational ora oatingpoint number infact itdoesn tneedtobeanumberatall aslongasit ssomething thatweknowhowtomultiply forexample thesamealgorithmcanbeused tocomputepowersmodulosome nitenumber anoperationcommonlyused incryptographyalgorithms ortocomputepowersofmatrices anoperation usedtoevaluaterecurrencesandtocomputeshortestpathsingraphs wedon tknowwhatkindofobjectwe remultiplying knowhowmuch timeasinglemultiplicationrequires sowe reforcedtoanalyzetherunning timeintermsofthenumberofmultiplications thereisamuchfasterdinquermethod originallyproposedby theindianprosodistpi ngalainthe2ndcentury bce whichusesthefollowing simplerecursiveformula       iseven   ngalapower  return ngalapower  iseven return return thetotalnumberofmultiplicationsperformedbythisalgorithmsatis esthe recurrence   therecursiomethodimmediatelygiveus thesolution log anearlyidenticalexponentiationalgorithmcanalsobederiveddirectly fromtheegyptianpeasantmultiplicationalgorithmfromthepreviouschapter byreplacingadditionwithmultiplication andinparticular replacingduplation withsquaring       iseven     recursion peasantpower  return elseif iseven return peasantpower   return peasantpower   thisachmightreasonablybecalledaringandmediatio alsoperformsonly log multiplications bothofthesealgorithmsareasymptoticallyoptimal anyalgorithmthat computes performatleast log multiplications becauseeach multiplicationatmostdoublesthelargestpowercomputedsofar infact isapoweroftwo bothofthesealgorithmsrequireexactly log  multiplications whichis optimal thereareslightlyfaster methodsforothervaluesof forexample ngalapower peasantpower eachcompute  usingsixmultiplications butinfactonly vemultiplications arenecessary ngala       peasant       optimal      itisaloandingopenquestionwhethertheabsoluteminimumnumberof multiplicationsforagivenexponent canbecomputede ciently exercises towerofhanoi  provethattheoriginalrecursivetowerofhanoialgorithmperforms thesamesequenceofmovsamedisks toandfromthesamepegs inthesameseachofthefollowingnovealgorithms pegsarelabeled    andourproblemistomoveastackof disks frompeg  topeg  asshownonpage  iseven swappegs   atthe thstep maketheonlylegal movethatavoidspeg mod3 ifthereisnolegalmove thenalldisks areonpeg mod3 andthepuzzleissolved forthe rstmove movedisk  topeg  isevenandtopeg  odd thenrepeatedlymaketheonlylegalmovethatinvolvesadi erent diskfromthepreviousmove ifnosuchmoveexists thepuzzleissolved pretendthatdisks    areatthebottomofpegs    repeatedlymaketheonlylegalmovethatsatis thefollowingconstraints untilnosuchmoveispossible  exercises donotplaceanodddiskdirectlyontopofanotherodddisk donotplaceanevendiskdirectlyontopofanotherevendisk donotundothepreviousmove ˆ denotethesmallestinteger suchthat  isnotaninteger forexample ˆ      isanintegerbut    isnot equivalently ˆ isonemorethanthepositionoftheleastsigni  inthebinaryrepresentationof becauseitsbehaviorresemblesthe marksonaruler ˆ issometimescalledthe rulerfunction rulerhanoi  ˆ iseven movedisk ˆ forward     movedisk ˆ backward       thetowerofhanoiisarelativelyrecentdescendantofamucholder mechanicalpuzzleknownasthechineselinkedrings baguenaudier dan srings meleda patience tiringirons prisoner slock sut manyothernames thispuzzlewasalreadywellknowninbothchina andeuropebythe16thcentury theitalianmathematicianlucapacioli describedthepuzzleanditssolutioninhisunpublishedtreatise viribusquantitatis writtenbetween1498and1506  onlyafewyearslater theastypoetyangshendescribedthepuzzleastoyfor womenandthepuzzleisapocryphallyattributedtoa chinesegeneral whogavethepuzzletohiswifetooccupyhertimewhile hewasawayatwar figure1  the7 ringbaguenaudier récréationsmathématiques byédouardlucas  imagecredits attheendofthebook  deviribusquantitatis onthepowersofnumbers isanimportantearlyworkonrecreational mathematicsandperhapstheoldestsurvivingtreatiseonmagic pacioliisbetterknownfor summadearitmetica anmpleteencyclopediaoflatemathematics includedthe rstdescriptionofdoublbookkeeping   recursion thebaguenaudierpuzzlehasmanyphysicalforms butoneofthemost commonconsistsofalongmetalloopandseveralrings whichareconnected toasolidbasebymovablerods theloopisinitiallythreadedthroughthe ringsasshowninfigure   thegoalofthepuzzleistoremovetheloop moreabstractly wecanmodelthepuzzleasasequenceofbits foreachring wherethe thbitis  ifthelooppassesthroughthe thring  hereweindextheringsfromrighttoleft asshownin figure   thepuzzleallowstwolegalmoves youcanalways ipthe  rightmost bit ifthebitstringendswithexactly  youcan ipthe  thbit thegoalofthepuzzleistotransformastringof  sintoastringof  forexample thefollowingsequenceof  movessolvesthepuzzle                                            callasequenceofmoves reduced ifnomoveistheinverseoftheprevious provethatforanynoegativeinteger thereis exactlyone reducedsequenceofmovesthatsolvesthe baguenaudierpuzzle hint thisproblemismucheasierifyou realreadyfamiliarwith graphs describeanalgorithmtosolvethebaguenaudierpuzzle yourinputis thenumberofrings youralgorithmshouldprintareducedsequence ofmovesthatsolvesthepuzzle forexample giventheinteger  input youralgorithmshouldprintthesequence                      howmanymovesdoesyouralgorithmperform asafunction proveyouransweriscorrect  alessfamiliarchapterinthetowerofhanoi shistoryisitsbriefrelocation ofthetemplefrombenarestopisaintheearly13thcentury  therelocation wasorganizedbythewealthycianleonardofibonacci attherequestoftheholyromanemperorfrederickii whohadheard reportsofthetemplefromsoldiersreturningfromthecrusades thetowers ofpisaandtheirattendantmonksbecamefamous helpingtoestablishpisa asadominanttradingcenterontheitalianpeninsula  portionsofthisstoryareactuallytrue  exercises almostassoonasthetemplewasmoved oneofthe diamondneedlesbegantoleantooneside toavoidthepossibilityof theleaningtowerfallingoverfromtoomuchuse fibonacciconvincedthe prieststoadoptamorerelaxedrule anynumberofdisksontheleaning needlecanbemovedtogethertoanotherneedleinasinglemove itwas stillforbiddentoplacealargerdiskontopofasmallerdisk anddiskshadto bemovedoneatatime theleaningneedleorbetweenthetwovertical needles figure1  thetowersofpisa inthe fthmove twodisksaretakenofftheleaningneedle thankstofibonacci snewrule thepriestscouldbringabouttheend oftheuniversesomewhatfasterfrompisathantheycouldfrombenares fortunately thetemplewasmovedfrompisabacktobenaresafterthe newlycrownedpopegregoryixexcommunicatedfrederickii making thelocalpriestslesssympathetictohostingforeignhereticswithstrange mathematicalhabits soonafterward abelltowerwaserectedonthespot wherethetempleoncestood ittoobegantoleanalmostimmediately describeanalgorithmtotransferastackof disksfromone vertical needletotheother vertical needle usingthesmallestpossiblenumberof moves howmanymovesdoesyouralgorithmperform  considerthefollowingrestrictedvariantsofthetowerofhanoipuzzlein eachproblem thepegsarenumbered    andyourtaskistomove astackof disksfrompeg  topeg  exactlyasinproblem  supposeyouareforbiddentomoveanydiskdirectlybetweenpeg  peg  movemustinvolvepeg  describeanalgorithmtosolve thisversionofthepuzzleinasfewmovesaspossible howmany movesdoesyouralgorithmmake ª supposeyouareonlyallowedtomovedisksfrompeg  topeg  peg  topeg  orfrompeg  topeg  equivalently supposethepegs arearrangedinacircleandnumberedinclockwiseorder andyouare onlyallowedtomovediskscounterclockwise describeanalgorithmto solvethisversionofthepuzzleinasfewmovesaspossible howmany movesdoesyouralgorithmmake   recursion figure1  rstseveralmovesinacounterclockwisetowersofhanoisolution ª finally supposeyouronlyrestrictionisthatyoumaynevermoveadisk directlyfrompeg  topeg  describeanalgorithmtosolvethisversion ofthepuzzleinasfewmovesaspossible howmanymovesdoesyour algorithmmake hint matrices thisvariantisconsiderablyharder toanalyzethantheothertwo  considerthefollowingmorecomplexvariantofthetowerofhanoipuzzle thepuzzlehasarowof pegs numberedfrom  inasingleturn areallowedtomovethesmallestdiskonpeg toeitherpeg  orpeg  foranyindex asusual youarenotallowedtoplaceabiggerdiskona smallerdisk yourmissionistomoveastackof disksfrompeg  topeg describearecursivealgorithmforthecase  howmany movesdoesyouralgorithmmake thisisexactlythesameasproblem  describearecursivealgorithmforthecase  thatrequiresat  moves hint usepart ª describearecursivealgorithmforthecase  thatrequiresat  moves hint tusepart ª describearecursivealgorithmforthecase thatrequiresatmost apolynomialnumberofmoves whichpolynomial ª describeandanalyzearecursivealgorithmforarbitrary smallmust asafunctionof sothatthenumberofmovesis boundedbyapolynomialin  exercises recursiontrees  userecursiontreestosolveeachofthefollowingrecurrences   nb          nf      nh       userecursiontreestosolveeachofthefollowingrecurrences              ª  userecursiontreestosolveeachofthefollowingrecurrences   log   log np  nq  sorting  supposeyouaregivenastackof pancakesofdi erentsizes youwantto sortthepancakessothatsmallerpancakesareontopoflargerpancakes theonlyoperationyoucanperformisa aspatulaunderthe pancakes forsomeinteger  ipthemallover figure1  flippingthetopfourpancakes describeanalgorithmtosortanarbitrarystackof pancakesusing ips howmany ipsdoesyouralgorithmperforminthe worstcase  hint thisproblemhasnothingtodowiththetowerof hanoi  exact wseoptimalnumberof ipsrequiredtosort pancakes eitherburnedor unburned isanloandingopenproblem justdothebestyoucan   recursion foreverypositiveinteger describeastackof pancakesthatrequires ipstosort nowsupposeonesideofeachpancakeisburned describeanalgorithm tosortanarbitrarystackof pancakes sothattheburnedsideofevery pancakeisfacingdown ips howmany ipsdoes youralgorithmperformintheworstcase  recallthatthe medif heuristicexaminesthe rst andmiddle elementofthearray andusesthemedianofthosethreeelementsasa quicksortpivot provethatquicksortwiththemedifheuristic requires  timetosortanarrayofsize intheworstcase speci cally foranyinteger describeapermutationoftheintegers  suchthatineveryrecursivecalltomedifcksort thepivotis alwaysthesecondsmallestelementofthearray designingthispermutation requiresintimateknowledgeofthe partition subroutine asawexercise assumethatthe partition subroutineis stable meaningitpreservestheexistingorderofallelementssmallerthanthe pivot anditpreservestheexistingorderofallelementssmallerthan thepivot ª assumethatthe partition subroutineusesthespeci calgorithmlisted onpage  whichis stable  hey moe hey larry provethatthefollowingalgorithmactuallysorts itsinput stoogesort      swap   elseif    stoogesort   stoogesort  stoogesort   stoogesort stillsortcorrectlyifwereplaced     justifyyouranswer statearecurrence includingthebasecase forthenumberof comparisonsexecutedby stoogesort solvetherecurrence andprovethatyoursolutioniscorrect hint ignoretheceiling provethatthenumberof swaps executedby stoogesort isatmost   thefollowingcruelandunusualsortingalgorithmwasproposedbygary miller  exercises cruel   cruel   cruel   unusual  unusual     theonlycomparison swap     swap2ndand3rdquarters swap   unusual   recurseonlefthalf unusual   recurseonrighthalf unusual     recurseonmiddlehalf thecomparisonsperformedbythisalgorithmdonotdependatallon thevaluesintheinputarray suchasortingalgorithmiscalled oblivious assumeforthisproblemthattheinputsize isalwaysapowerof  provebyinductionthat cruel correctlysortsanyinputarray hint consideranarraythatcontains     isthisspecialcaseenough provethat cruel correctlysortifweremovedthefoop unusual provethat cruel correctlysortifweswappedthelasttwo linesof unusual whatistherunningtimeof unusual justifyyouranswer whatistherunningtimeof cruel justifyyouranswer  inversion inanarray  isapairofindices suchthat thenumberofinversionsinan ementarrayisbetween  ifthearrayissorted  ifthearrayissortedbackward andanalyzeanalgorithmtocountthenumberofinversionsinan ement arrayin log time hint modifymergesort  supposeyouaregiventwosetsof points oneset   onthe  andtheotherset   ontheline  createaset linesegmentsbyconnecteachpoint tothecorrespondingpoint describeandanalyzeadinqueralgorithmtodeterminehow manypairsoftheselinesegmentsintersect log time hint seethepreviousproblem nowsupposeyouaregiventwosets     points ontheunitcircle connecteachpoint tothecorresponding   recursion point describeandanalyzeadinqueralgorithmto determinehowmanypairsoftheselinesegmentsintersectin log  time hint useyoursolutiontopart ª describeanalgorithmforpart thatrunsin log time hint useyoursolutionfrompart figure1  elevenintersectingpairsofsegmentswithendpointsonparallellines andtenintersecting pairsofsegmentswithendpointsonacircle  describeanalgorithmthatsortsaninputarray  bycallinga subroutine sqrtsort whichsortsthesubarray  place givenanarbitraryinteger  asinput simplifytheproblem assumethat isaninteger youralgorithmis allowedtoinspectormodifytheinputarraybycalling sqrtsort inparticular youralgorithmmustnotdirectlycompare orcopy arrayelements howmanytimesdoesyouralgorithmcall sqrtsort theworstcase provethatyouralgorithmfrompart isoptimaluptoconstantfactors inotherwords isthenumberoftimesyouralgorithmcalls sqrtsort provethatnoalgorithmcansortusing callsto sqrtsort nowsuppose sqrtsort isimplementedrecursively bycallingyour sortingalgorithmfrompart forexample atthesecondlevelof recursion thealgorithmissortingarraysroughlyofsize   isthewserunningtimeoftheresultingsortingalgorithm simplifytheanalysis assumethatthearraysize hastheform   thatrepeatedsquarerootsarealwaysintegers selection  supposewearegivenaset items eachwitha anda weight anyelement  wede netwosubsets  exercises isthesetofelementsof whosevalueislessthanthevalueof isthesetofelementsof whosevalueismorethanthevalueof foranysubset denotethesumoftheweightsofelementsin weightedmedian isanyelement suchthat   describeandanalyzeanalgorithmtocomputetheweightedmedian ofagivenweightedsetin time yourinputconsistsoftwounsorted arrays   whereforeachindex thelementhas andweight youmayassumethatallvaluesaredistinctand allweightsarepositive  describeanalgorithmtodeterminein timewhetheranarbitrary array  containsmorethan  copiesofanyvalue describeandanalyzeanalgorithmtodetermine givenanarbitrary array  andaninteger containsmorethan copies ofanyvalue expresstherunningtimeofyouralgorithmasafunction ofboth donotusehashing orradixsort oranyothermethodthatdepends onthepreciseinputvalues asopposedtotheirorder  describeanalgorithmtocomputethemedianofanarray   ofdistinct numbersusingatmost  comparisons insteadofwritingpseudocode describeyouralgorithmusinga decisiontree abinarytreewhereeach internalnodecontainsacomparisonoftheform andeach leafcontainsanindexintothearray figure1  findingthemedianofa3 elementarrayusingatmost3comparisons  considerthegeneralizationofthevtarjan select algorithmshowninfigure   whichpartitionstheinputarrayinto blocksofsize insteadof  blocksofsize  butisotherwise identical   recursion mom select   usebruteforce  medianofb   mom mom select   partition  mom return mom select   elseif return mom select  return mom figure1  aparametrizedfamilyofselectionalgorithms seeproblem  statearecurrencefortherunningtimeof mom select assumingthat isaconstant sothesubroutine medianofb runsin  time howdothesizesoftherecursivesubproblemsdependonthe constant considereven andodd separately whatisthewserunningtimeof mom  select hint thisisa trickquestion ª whatisthewserunningtimeof mom  select hint thisisan unfairquestion ª whatisthewserunningtimeof mom  select findinganupper boundontherunningtimeisstraightforward thehardpartisshowing thatthisanalysisisactuallytight hint seeproblem  ª whatisthewserunningtimeof mom  select thehard partisshowingthattheanalysiscannotbeimproved  foranyconstants  thealgorithm mom select runsin time butdi erentvaluesof leadtodi erentconstantfactors denotetheminimumnumberofcomparisonsrequiredto ndthemedian numbers theexactvalueof isknownonlyfor     themedianoffourelementsiseitherthesecondsmallestorthesecondlargest in2014 kechenandadriandumitrescuprovedthatifwemodify mom  select ndsecollest elementswhen  andsecoargestelementswhen  theresultingalgorithmruns time seetheirpaperelectwithgroupsof   takeslineart wads2015 arxiv   fordetails  exercises foreach   ndanupperboundontherunningtime mom select oftheform forsomeexplicitconstant forexample onpage  weshowedthat   whichvalueof yieldsthesmallestconstant hint thisisatrick question  provethatthevariantofthevtarjan select rithmshowninfigure   whichusesanextralayerofsmallmediansto choosethemainpivot runsin time momomselect   usebruteforce   medianof3    mm   mm mom medianof3    momom momomselect mom  mm mm  partition  momom return momomselect   elseif return momomselect  return momom figure1  selectionbymedianofmoms seeproblem   supposewearegiventwosortedarrays   analgorithmto ndthemedianelementintheunionof log time youcanassumethatthearrayscontainnoduplicate elements supposewearegiventwosortedarrays   andan integer describeanalgorithmto ndthe thsmallestelementin log time forexample  youralgorithm shouldreturnthesmallestelementof hint useyoursolution topart ª nowsupposewearegiven sortedarrays    andaninteger describeanalgorithmto ndthe thsmallest elementin log time   recursion finally supposewearegivenatwodimensionalarray   whicheveryrow issorted andaninteger describeanalgorithm ndthe thsmallestelementin asquicklyaspossible howdoes therunningtimeofyouralgorithmdependon hint solveproblem  rst arithmetic  in1854 archaeologistsdiscoveredsumeriansclaytablets carvedaround  bce thatlistthesquaresofintegersupto  thisdiscoveryledsome scholarstoconjecturethatancientsumeriansperformedmultiplicationby reductiontosquaring usinganidentitylike     thosesamescholarsaresilentonhowthesumerians posedlysquaredlargernumbers fourthousandyearslater wecan nally rescuethesesumerianmathematiciansfromtheirlivesofdrudgerythrough thepowerofrecursion describeavariantofkaratsuba salgorithmthatsquaresany numberin lg3 time byreducingtosquaringthree  numbers karatsubaactuallydidthisin1960 describearecursivealgorithmthatsquaresany numberin log   time byreducingtosquaringsix  numbers ª describearecursivealgorithmthatsquaresany numberin log   time byreducingtosquaringonly   numbers hint whatis    describeandanalyzeavariantofkaratsuba salgorithmthatm pliesany numberandany number forany nm lg3  time describeanalgorithmtocomputethedecimalrepresentationof  lg3 time usingthealgorithmfrompart asasubroutine standardalgorithmthatcomputesonedigitatatimerequires  time describeadinqueralgorithmtocomputethedecimal resentationofanarbitrary binarynumberin lg3 time hint watchoutforanextralogfactorintherunningtime ª supposewecanmultiplytwo numbersin time analgorithmtocomputethedecimalrepresentationofanarbitrary binarynumberin log time hint theanalysisisthehard useadomaintransformation  exercises  considerthefollowingclassicalrecursivealgorithmforcomputingthe factorial ofanoegativeinteger factorial  return  return factorial  howmanymultiplicationsdoesthisalgorithmperform howmanybitsarerequiredtowrite inbinary expressyouranswer intheform forsomefamiliarfunction hint   youranswerto shouldconvinceyouthatthenumberofmultiplications agoodestimateoftheactualrunningtimeof factorial canmultiplyany numberandany numberin time usingeitherthelatticealgorithmorduplationandmediation whatis therunningtimeof factorial ifweusethismultiplicationalgorithmas asubroutine thefollowingrecursivealgorithmalsocomputesthefactorialfunction butusingadi erentgroupingofthemultiplications falling compute  return  elseif  return return falling  falling   whatistherunningtimeof falling ifweusem plication hint asusual ignorethe oorsandceilings describeandanalyzeavariantofkaratsuba salgorithmthatmultiplies numberandany number forany lg3    time ª whataretherunningtimesof factorial falling ifwe usethemodi edkaratsubamultiplicationfrompart  greatestcommondivisor oftwopositiveinteger denoted gcd isthelargestinteger suchthatboth areintegers euclid elements writtenaround300 bce describesthefollowingrecursive algorithmtocompute gcd   euclid salgorithmissometimesincorrectlydescribedastheoldestrecursivealgorithm oreventheoldest nontrivial algorithm eventhoughtheegyptianduplationandmediation achisbothnontrivialandrecursiveuclidbyatleast1500years   recursion euclidgcd return elseif return euclidgcd return euclidgcd provethat euclidgcd correctlycomputes gcd  speci cally provethat euclidgcd dividesboth provethateverydivisorof isadivisorof euclidgcd whatisthewserunningtimeof euclidgcd asafunction assumethatcomputing requires log log time provethatthefollowingalgorithmalsocomputes gcd fasteuclidgcd  return elseif return fasteuclidgcd mod return fasteuclidgcd mod whatisthewserunningtimeof fasteuclidgcd asa functionof assumethatcomputing mod takes log log time provethatthefollowingalgorithmalsocomputes gcd binarygcd return elseif arebotheven return  binarygcd   elseif iseven return binarygcd  elseif iseven return binarygcd  elseif return binarygcd  return binarygcd   eucliddidnotdothis proposition1in elements bookviistatesthatif euclidgcd  arerelativelyprime thatis gcd  buttheproofonlyconsidersthespecial case mod mod mod  proposition2statesthatif relativelyprime euclidgcd gcd buttheproofonlyconsidersthespecialcases gcd gcd mod mod finally thesetwopropositionsdonotmakeacompleteproof euclidgcd iscorrect tbelikeeuclid  exercises whatisthewserunningtimeof binarygcd asafunction assumethatcomputing takes log log time andcomputing  requires log time arrays  supposeyouaregivena   checkerboardwithone arbitrarilychosen squareremoved describeandanalyzeanalgorithmtocomputeatilingof theboardbywithoutgapsoroverlapsby hapedtiles eachcomposedof3 squares yourinputistheinteger andtwo integersrepresentingthe rowandcolumnofthemissingsquare theoutputisalistofthepositions andorientationsof    tiles youralgorithmshouldrunin  time hint firstprovethatsuchatilingalwaysexists  youareavisitoratapoliticalconvention orperhapsafacultymeeting delegates eachdelegateisamemberofexactlyonepoliticalparty itisimpossibletotellwhichpoliticalpartyanydelegatebelongsto youwillbesummarilyejectedfromtheconventionifyouask youcandeterminewhetheranypairofdelegatesbelongtothe partybyintroducingthemtoeachother membersofthesamepolitical partyalwaysgreeteachotherwithsmilesandfriendlyhandshakes members ofdi erentpartiesalwaysgreeteachotherwithangrystaresandinsults  supposemorethanhalfofthedelegatesbelongtothesamepolitical party describeane cientalgorithmthatidenti esallmembersofthis majorityparty nowsupposetherearemorethantwoparties butonepartyhasa plurality morepeoplebelongtothatpartythantoanyotherparty presentapracticalproceduretopreciselypickthepeoplefromthe pluralitypoliticalpartyasparsimoniouslyaspossible presumingthe pluralitypartyiscomposedofatleast people prettyplease  smullyanislandhasthreetypesofinhabitants knights alwaysspeakthe truth knaves alwayslie normals sometimesspeakthetruthand sometimesdon everyoneontheislandknowseveryoneelse snameand type knight knave ornormal youwanttolearnthetypeofevery inhabitant youcanaskanyinhabitanttotellyouthetypeofanyotherinhabitant speci cally ifyouaskey whatis stthen willrespondas  reaorldpoliticsismuchmessierthanthissimpli edmodel butthisisatheorybook   recursion isaknight willrespondwith scorrecttype isaknave couldrespondwith ofthetypesthat isanormal couldrespondwith ofthethreetypes theinhabitantswillignoreanyquestionsnotofthispreciseform youmaynotaskaninhabitantabouttheirowntype askingthe sameinhabitantthesamequestionmultipletimesalwaysyieldsthesame answer sothere snopointinaskinganyquestionmorethanonce supposeyouknowthatastrictmajorityofinhabitantsareknights describeane cientalgorithmtoidentifythetypeofeveryinhabitant provethatifatmosthalftheinhabitantsareknights itisimpossibleto determinethetypeofeveryinhabitant  mostgraphicshardwareincludessupportforaloeveloperationcalled blit ock ransfer whichquicklycopiesarectangularchunkofapixelmap atwonalarrayofpixelvalues fromonelocationtoanother isatwonalversionofthestandardclibraryfunction memcpy supposewewanttorotatean pixelmap  clockwise onewayto dothis atleastwhen isapoweroftwo istosplitthepixelmapintofour   blocks moveeachblocktoitsproperpositionusingasequenceof veblits andthenrecursivelyrotateeachblock forthesame reasonthetowerofhanoipuzzleneedsathirdpeg alternately wecould rst recursivelyrotatetheblocksand blitthemintoplace figure1  twoalgorithmsforrotatingapixelmap provethatbothversionsofthealgorithmarecorrectwhen isapower  howmanyblitsdoesthealgorithmperformwhen isapower  describehowtomodifythealgorithmsothatitworksforarbitrary notjustpowersof  howmanyblitsdoesyourmodi edalgorithm perform whatisyouralgorithm srunningtimeifa blittakes  time whatifa blittakesonly time  anarray   distinctnumbersis bitonic ifthereareunique indices suchthat  mod  mod  exercises figure1  rstrotationalgorithm blitthenrecurse inaction imagecredits attheendof thebook  mod  mod inotherwords abitonic sequenceeitherconsistsofanincreasingsequencefollowedbyadecreasing sequence orcanbecircularlyshiftedtobecomeso forexample  isbitonic  bitonic describeandanalyzeanalgorithmto ndthe smallest elementinan elementbitonicarrayin log time youmayassumethatthenumbers intheinputarrayaredistinct  supposewearegivenanarray  distinctintegers whichcouldbe positive negative orzero sortedinincreasingordersothat   describeafastalgorithmthateithercomputesanindex suchthat orcorrectlyreportsthatnosuchindexexists supposeweknowinadvancethat   describeanevenfaster algorithmthateithercomputesanindex suchthat orcorrectly reportsthatnosuchindexexists hint thisis easy  supposewearegivenanarray  withthespecialpropertythat    wesaythatanelement isa local minimum ifitislessthanorequaltobothitsneighbors ormoreformally   forexample therearesixlocal minimainthefollowingarray  î   î   î   î  î   î     recursion wecanobviously ndalocalminimumin timebyscanningthrough thearray describeandanalyzeanalgorithmthat ndsalocalminimumin log time hint withthegivenboundaryconditions thearray haveatleastonelocalminimum  supposeyouaregivenasortedarrayof distinctnumbersthathasbeen rotated steps forsome unknown integer   thatis youaregivenanarray  suchthatsomepre  issortedin increasingorder thecorrespondingsu  issortedinincreasing order  forexample youmightbegiventhefollowingementarray   describeandanalyzeanalgorithmtocomputetheunknowninteger describeandanalyzeanalgorithmtodetermineifthegivenarray containsagivennumber  attheendofthesecondactoftheactionblockbuster fastandimpossible xiii ¾ thelastguardiansofexpendablejusticereloaded thevillainous metaphorhypnotizestheentireheroleague force squad arranges theminalonglineattheedgeofacli andinstructseachherotoshoot theclosesttallerheroestotheirleftandright ataprearrangedsignal supposewearegiventheheightsofall heroes inorderfromleft toright inanarray ht  toavoidsalaryarguments theproducers insistedthatnotwoheroeshavethesameheight thenwecancompute theleftandrighttargetsofeachheroin  timeusingthefollowing orcealgorithm whotargetswhom ht   findthelefttarget forhero   ht ht findtherighttarget forhero downto  ht ht return    exercises describeadinqueralgorithmthatcomputestheoutputof whotargetswhom log time provethatatleast  ofthe heroesaretargets thatis provethat theoutputarrays     containatleast  distinctvalues otherthan alas metaphor sdiabolicalplanissuccessful attheprearranged signal alltheheroessimultaneouslyshoottheirtargets andalltargets falloverthecli apparentlydead metaphorrepeatshisdastardly experimentoverandover aftereachmassacre heforcestheremaining heroestochoosenewtargets followingthesamealgorithm andthen shoottheirtargetsatthenextsignal eventually onlytheshortest memberoftheherocrew alliance posseisleftalive  describeandanalyzeanalgorithmtocomputethenumberofrounds beforedr metaphor sdeadlyprocess nallyends forfullcredit algorithmshouldrunin time  youareacontestantonthehitgameshowyournyouare presentedwithan gridofboxes eachcontainingauniquenumber costs toopenabox yourgoalisto ndaboxwhosenumberislarger thanitsneighborsinthegrid left andright ifyouspend lessmoneythananyofyouropponents youwinawongtripfortwoto lasvegasandayear ssupplyofrioni towhichyouarehopelessly addicted suppose  describeanalgorithmthat ndsanumberthatisbigger thaneitherofitsneighbors howmanyboxesdoesyouralgorithmopen intheworstcase ª suppose describeanalgorithmthat ndsanumberthatisbigger thananyofitsneighbors howmanyboxesdoesyouralgorithmopenin theworstcase ª provethatyoursolutiontopart isoptimaluptoaconstantfactor    forsomepositiveinteger supposesomeoneclaimsto holdanunsortedarray  distinct strings exactlyone stringdoes appearin supposefurtherthatthe waywe canaccess isbycallingthefunction fetchbit whichreturnsthe thbitofthestring  time describeanalgorithmto ndthe missingstringin usingonly callsto fetchbit  inthethrilling nalact retconthesquirrel thelastsurvivingmemberofthehero team group society saveseveryonebytravelingbackintimeandretroactivelyreplacingthe  heroeswithlifelikeballoonsculptures yeah basicallyit avengers endgame   recursion ª nowsuppose  forsomepositiveintegers andagainwe aregivenanarray  distinct strings describeanalgorithm ndthe stringsthataremissingfrom usingonly log calls fetchbit trees  forthisproblem subtree ofabinarytreemeansanyconnectedsubgraph abinarytreeis complete ifeveryinternalnodehastwochildren andevery leafhasexactlythesamedepth describeandanalyzearecursivealgorithm tocomputethe largestcompletesubtree ofagivenbinarytree youralgorithm shouldreturnboththerootandthedepthofthissubtree seefigure   foranexample figure1  thelargestcompletesubtreeofthisbinarytreehasdepth3  beabinarytreewith vertices deletinganyvertex splits intoat mostthreesubtrees containingtheleftchildof ifany therightchild ifany andtheparentof ifany wecall central vertexif eachofthesesmallertreeshasatmost  vertices seefigure   foran describeandanalyzeanalgorithmto ndacentralvertexinanarbitrary givenbinarytree hint firstprovethateverytreehasacentralvertex figure1  deletingacentralvertexina34 nodebinarytree leavingsubtreeswith14  and12nodes  exercises  professorgeorgeo junglehasaodebinarytree inwhichevery nodeislabeledwithauniqueletteroftheromanalphabetorthe character preorderandpostordertraversalsofthetreevisitthenodes inthefollowingorder preorder iqjhlemvotsbrgyzkca fpnudwx postorder hemljvqsgyrzbtcpudnfw xakoi drawgeorge sbinarytree recallthatabinarytreeis ifeverynoeafnodehasexactlytwo children describeandanalyzearecursivealgorithmtoreconstructanarbitrary binarytree givenitspreorderandpostordernodesequencesas input provethatthereisnoalgorithmtoreconstructan arbitrary binary treefromitspreorderandpostordernodesequences describeandanalyzearecursivealgorithmtoreconstructan arbitrary binarytree givenitspreorderand inorder nodesequencesasinput describeandanalyzearecursivealgorithmtoreconstructanarbitrary binary search tree givenonlyitspreordernodesequence ª describeandanalyzearecursivealgorithmtoreconstructanarbitrary binary search tree givenonlyitspreordernodesequence time inpartsassumethatallkeysaredistinctandthattheinputis consistentwithatleastonebinarytree  supposewehave pointsscatteredinsideatwonalbox tree  recursivelysubdividesthepointsasfollows iftheboxcontainsno pointsinitsinterior wearedone wesplittheboxintotwo smallerboxeswitha vertical throughamedianpointinsidethebox onitsboundary partitioningthepointsasevenlyaspossible werecursivelybuildaforthepointsineachofthetwosmaller boxes afterrotatingthem90degrees wealternatebetweensplitting verticallyandsplittinghorizontallyateachlevelofrecursion nal emptyboxesarecalled cells  theterm pronouncedy dee wasoriginallyanabbreviationfor dimensionalbutmodernusageignoresthisetymology inpartbecausenobodyintheir rightmindwould usetheletter todenotedimensioninsteadofthe superior etymologicalconsistencywouldrequirecallingthedatastructureinthisproblema  orperhapsa  butthestandardnomenclatureisnowwonal seealso alphashape betaskeleton epsilonnet potomacriver mississippi river lakemichigan laketahoe manhattanisland labreatarpits saharadesert mount kilimanjaro southvietnam easttimor themilkywaygalaxy thecityoftownsville selfvingautomobiles   recursion figure1  akd treefor15points thedashedlinecrossesthefourshadedcells howmanycellsarethere asafunctionof proveyouransweris correct intheworstcase howmanycellscanahorizontallinecross afunctionof proveyouransweriscorrect assumethat   forsomeinteger hint thereismorethanonefunction suchthat   supposewearegiven pointsstoredinadescribeandanalyze analgorithmthatcountsthenumberofpointsaboveahorizontalline suchasthedashedlineinthe gure asquicklyaspossible hint describeananalyzeane cientalgorithmthatcounts givena points thenumberofpointsthatlieinsidearectangle withhorizontalandverticalsides hint usepart ª  bobratenbur anewstudentincs225 istryingtowritecodetoperform preorder inorder andpostordertraversalsofbinarytrees bobf understandsthebasicideabehindthetraversalalgorithms butwhenever heactuallytriestoimplementthem hekeepsmixinguptherecursivecalls fiveminutesbeforethedeadline bobfranticallysubmitscodewiththe followingstructure preorder null return print label order left order inorder null return order left print label order postorder null return order left order print label inthispseudocodehidesoneofthepre xes pre post eachofthefollowingfunctioncallsappearsexactlyonceinbob submittedcode  exercises preorder left preorder inorder left inorder postorder left postorder thereareprecisely36possibilitiesforbob scode bob accidentallydeletedhissourcecodeaftersubmittingtheexecutable neitheryounorheknowswhichfunctionswerecalledwhere nowsupposeyouaregiventheoutputofbob straversalalgorithms executedonsome unknown binarytree bob soutputhasbeenhelpfully parsedintothreearrays pre   post  youmay assumethatthesetraversalsequencesareconsistentwithexactlyonebinary tree inparticular thevertexlabelsoftheunknowntree aredistinct andeveryinternalnodein hasexactlytwochildren describeanalgorithmtoreconstructtheunknowntree fromthegiven traversalsequences describeanalgorithmthateitherreconstructsbob scodefromthegiven traversalsequences orcorrectlyreportsthatthetraversalsequencesare consistentwithmorethanonesetofalgorithms forexample giventheinput pre  haecbifgd  ahdceifbg post  aeibfcdgh rstalgorithmshouldreturnthefollowingtree andyoursecondalgorithmshouldreconstructthefollowingcode preorder null return print label preorder left postorder inorder null return postorder left print label preorder postorder null return inorder left inorder print label ª  beabinarytreewhosenodesstoredistinctnumericalvalues recall isa binarysearchtree ifandonlyifeither  isempty  satis esthefollowingrecursiveconditions   recursion theleftsubtreeof isabinarysearchtree allvaluesintheleftsubtreearesmallerthanthevalueattheroot therightsubtreeof isabinarysearchtree allvaluesintherightsubtreearelargerthanthevalueattheroot considerthefollowingpairofoperationsonbinarytrees rotate anarbitrarynodeupward  swap theleftandrightsubtreesofanarbitrarynode inbothoftheseoperations ornoneofthesubtrees couldbeempty describeanalgorithmtotransforman arbitrary odebinarytree withdistinctnodevaluesintoabinarysearchtree usingatmost  rotationsandswaps figure   showsasequenceofeightoperations thattransformsa vodebinarytreeintoabinarysearchtree figure1  abinarytree rotate2 rotate2 swap3 rotate3 rotate4 swap3 rotate2 swap4 youralgorithmisnotallowedtodirectlymodifyparentorchild pointers createnewnodes ordeleteoldnodes waytomodify thetreeisthroughrotationsandswaps ontheotherhand youmay compute anythingyoulikeforfree longasthatcomputationdoesnotmodifythetree therunningtimeof youralgorithmis ned tobethenumberofrotationsandswapsthatit performs ª describeanalgorithmtotransformanarbitrary odebinarytreeinto abinarysearchtree usingatmost log rotationsandswaps  rotationspreservetheinordersequenceofnodesinabinarytree partlyforthisreason rotationsareusedtomaintainseveraltypesofbalancedbinarysearchtrees includingavltrees lacktrees splaytrees scapegoattrees andtreaps algorithms wtf forlecture notesonmostofthesedatastructures  exercises provethatany odebinary search treecanbetransformedintoany otherbinary search treewiththesamenodevalues usingonly rotations swaps ª openproblem eitherdescribeanalgorithmtotransformanarbitrary odebinarytreeintoabinarysearchtreeusingonly rotations andswaps orprovethatnosuchalgorithmispossible hint idon thinkit spossible  theambiguitycannotbeclearedup eitherbytheruleoffaithorby thecontext thereisnothingtohinderustopointthesentenceaccordingtoany methodwechooseofthosethatsuggestthemselves augustineofhippo dedoctrinachristiana  translatedbymarcusdods  idroppedmydinner andranbacktothelaboratory inmyexcitement itastedthecontentsofeverybeakerandevaporatingdishonthetable luckilyfor nonecontainedanycorrosiveorpoisonousliquid constantinefahlbergonhisdiscoveryofsaccharin scienti camerican  thegreatestchallengetoanythinkerisstatingtheproblem inawaythatwillallowasolution attributedtobertrandrussell whenyoucometoaforkintheroad takeit yogiberra givingdirectionstohishouse  backtracking thischapterdescribesanotherimportantrecursivestrategycalled backtracking abacktrackingalgorithmtriestoconstructasolutiontoacomputationalproblem incrementally onesmallpieceatatime wheneverthealgorithmneedsto decidebetweenmultiplealternativestothenextcomponentofthesolution recursivelyevaluates alternativeandthenchoosesthebestone  nqueens theprototypicalbacktrackingproblemistheclassical queensproblem rst proposedbygermanchessenthusiastmaxbezzelin1848 underhispseudonym forthestandard   boardandbyfrançoosepheustache lionnetin1869forthemoregeneral board theproblemistoplace queensonan chessboard sothatnotwoqueensareattackingeachother   backtracking forreadersnotfamiliarwiththerulesofchess thismeansthatnotwoqueens areinthesamerow thesamecolumn orthesamediagonal figure2  gauss rstsolutiontothe8queensproblem representedbythearray         inaletterwrittentohisfriendheinrichschumacherin1850 theeminent mathematiciancarlfriedrichgausswrotethatonecouldeasilycon rmfranz nauck sclaimthattheeightqueensproblemhas92solutionsbytrialand errorinafewhours schweristesübrigensnicht durcheinmethodisches tatonnirensichdiesegewissheitzuverscha wennman1odereinpaarstunden daranwendenwill hisdescription tatonniren comesfromthefrench tâtonner meaningtofeel grope orfumblearoundblindly asifinthedark gauss sletterdescribedthefollowingrecursivestrategyforsolvingthe eensproblem thesamestrategywasdescribedin1882bythefrench recreationalmathematicianédouardlucas whoattributedthemethodto emmanuellaquière weplacequeensontheboardonerowatatime starting withthetoprow toplacethe thqueen wemethodicallytryall squaresin row fromlefttorightinasimpleforloop ifaparticularsquareisattackedby anearlierqueen weignorethatsquare wetentativelyplaceaqueen onthatsquareand recursively gropeforconsistentplacementsofthequeensin laterrows figure   showstheresultingalgorithm whichrecursivelyenumerates complete eenssolutionsthatareconsistentwithagivenpartialsolution followinggauss werepresentthepositionsofthequeensusinganarray  indicateswhichsquareinrow containsaqueen placequeens iscalled theinputparameter istheindexofthe rstemptyrow andthepre   containsthepositionsofthe rst  queens tocomputeall eenssolutionswithnorestrictions wewouldcall placequeens   theouterfoopconsidersallpossibleplacements ofaqueenonrow theinnerfoopcheckswhetheracandidateplacement ofrow isconsistentwiththequeensthatarealreadyonthe rst  rows theexecutionof placequeens canbeillustratedusinga recursiontree eachnodeinthistreecorrespondstoarecursivesubproblem andthustoa legalpartialsolution inparticular therootcorrespondstotheemptyboard    nqueens placequeens   print   legal true   legal false legal placequeens   recursion figure2  gaussandlaquière sbacktrackingalgorithmforthe queensproblem  edgesintherecursiontreecorrespondtorecursivecalls leaves correspondtopartialsolutionsthatcannotbefurtherextended eitherbecause thereisalreadyaqueenoneveryrow orbecauseeverypositioninthenext emptyrowisattackedbyanexistingqueen thebacktrackingsearchfor completesolutionsisequivalenttoasearchofthistree figure2  thecompleterecursiontreeofgaussandlaquière salgorithmforthe4queensproblem   backtracking  gametrees considerthefollowingsimpletwayergame  playedonan squaregrid withaborderofsquares scalltheplayershoracefaemsenand verarebaudi  eachplayerhas tokensthattheymoveacrosstheboardfrom onesidetotheother horace stokensstartintheleftborder oneineachrow andmove hor izontallytotheright symmetrically vera stokensstartinthe topborder oneineachcolumn andmove ver ticallydownward theplayers alternateturns ineachofhisturns horaceeither moves oneofhistokensone steptotherightintoanemptysquare jumps oneofhistokensoverexactly oneofvera stokensintoanemptysquaretwostepstotheright ifnolegal movesorjumpsareavailable horacesimplypasses veraeithermoves orjumpsoneofhertokensdownwardineachofherturns unlessnomovesor jumpsarepossible rstplayertomovealltheirtokenso theedgeofthe boardwins snothardtoprovethataslongastherearetokensontheboard atleastoneplayercanlegallymove andthereforesomeoneeventuallywins figure2  verawinsthe3 fake sugar packetgame  idon tknowwhatthisgameiscalled orevenifi mreportingtherulescorrectly ilearned orsomethinglikeit fromlennypitt whorecommendedplayingitwithfapacketsat restaurants  constantinfahlbergandiraremsensynthesizedsaccharinforthe rsttimein1878 fahlbergwasapostdocinremsen slabinvestigatingcoaltarderivatives in1900 ovidiorebaudi publishedthe rstchemicalanalysisof ka ahe ê amedicinalplantcultivatedbytheguaranífor morethan1500years nowmorecommonlyknownas steviarebaudiana    gametrees unlessyou veseenthisgamebefore  youprobablydon thaveanyideahow toplayitwell thereisarelativelysimplebacktrackingalgorithm thatcanplaythisanytwayergamewithoutrandomnessorhidden informationthatendsaftera nitenumberofmov perfectly thatis ifwe dropyouintothemiddleofagame anditis towinagainstanother perfectplayer thealgorithmwilltellyouhowtowin state ofthegameconsistsofthelocationsofallthepiecesandtheidentity ofthecurrentplayer thesestatescanbeconnectedintoa gametree whichhas anedgefromstate tostate ifandonlyifthecurrentplayerinstate legallymovetostate therootofthegametreeistheinitialpositionofthe game andeverypathfromtheroottoaleafisacompletegame figure2  rsttwolevelsofthefake sugar packetgametree tonavigatethroughthisgametree werecursivelyde neagamestateto good bad asfollows agamestateis good ifeitherthecurrentplayerhasalreadywon orifthe currentplayercanmovetoabadstatefortheopposingplayer agamestateis bad ifeitherthecurrentplayerhasalreadylost orifevery availablemoveleadstoagoodstatefortheopposingplayer equivalently anoeafnodeinthegametreeisgoodifithasatleastonebad child andanoeafnodeisbadifallitschildrenaregood byinduction playerthat ndsthegameinagoodstateontheirturncanwinthegame iftheiropponentplaysperfectly ontheotherhand startingfromabadstate playercanwinonlyiftheiropponentmakesamistake thisrecursivede nition wasproposedbyernstzermeloin1913   ifyouhave pleasetellmewhere  infact zermeloconsideredthemoresubtleclassofgamesthathavea nitenumberof states butthatallowin nitesequencesofmoves zermelode nedin niteplaytobeadraw   backtracking thisrecursivede nitionimmediatelysuggeststhefollowingrecursive trackingalgorithmtodeterminewhetheragivengamestateisgoodorbad itscore thisalgorithmisjustasearchofthegametree equivalently thegametreeistherecursiontreeofthealgorithm asimplemodi cationof thisbacktrackingalgorithm ndsagoodmove orevenallpossiblegoodmoves iftheinputisagoodgamestate playanygame player player hasalreadywoninstate return good player hasalreadylostinstate return bad foralllegalmoves playanygame player bad return good isagoodmove return bad therearenogoodmoves allayingprogramsareultimatelybasedonthissimplebacktracking strategy sincemostgameshaveanenormousnumberofstates itis notpossibletotraversetheentiregametreeinpractice gameprograms employotherheuristics  prune thegametree byignoringstatesthatare orousgoodorbad oratleastbetterorworsethanother states orbycuttingo thetreeatacertaindepth ply andusinga moree cientheuristictoevaluatetheleaves  subsetsum sconsideramorecomplicatedproblem called subsetsum givenaset ofpositiveintegersand target integer isthereasubsetofelementsin addupto noticethattherecanbemorethanonesuchsubset forexample         theansweris true becausethesubsets          allsumto  ontheotherhand         theansweris false therearetwotrivialcases ifthetargetvalue iszero thenwecan immediatelyreturn true becausetheemptysetisasubsetof set theelementsoftheemptysetadduptozero  ontheotherhand    buttheset isempty thenwecanimmediatelyreturn false forthegeneralcase consideranarbitraryelement  vealready handledthecasewhere isempty thereisasubsetof thatsumsto andonlyifoneofthefollowingstatementsistrue  aheuristicisanalgorithmthatdoesn twork exceptinpractice  becausewhatelsecouldtheyaddupto    subsetsum thereisasubsetof includes andwhosesumis thereisasubsetof excludes andwhosesumis inthe rstcase theremustbeasubsetof nf thatsumsto inthe secondcase theremustbeasubsetof nf thatsumsto sowecansolve subsetsum byreducingittotwosimplerinstances subsetsum nf subsetsum nf theresultingrecursivealgorithmisshown doesanysubsetof sumto subsetsum  return true elseif  return false anyelementof subsetsum nf recurse wout subsetsum nf recurse return _ wout correctness provingthisalgorithmcorrectisastraightforwardexerciseininduction  thentheelementsoftheemptysubsetsumto true isthecorrect output isnegativeortheset isempty thennosubsetof sumsto false isthecorrectoutput ifthereisasubsetthat sumsto theneitheritcontains oritdoesn andtherecursionfairy correctlychecksforeachofthosepossibilities analysis inordertoanalyzethealgorithm wehavetodescribeafewimplementation detailsmoreprecisely tobegin sassumethattheinputset isgivenasan array  thepreviousrecursivealgorithmallowsustochoose element  themainrecursivecase purelyforthesakeofe ciency itishelpfultochoose anelement suchthattheremainingsubset nf hasaconcisedescription whichcanbecomputedquickly sothatsettinguptherecursivecallsrequires minimaloverhead speci cally wewilllet bethelastelement thesubset nf isstoredinthepre   passingacomplete copy ofthispre xtotherecursivecallswouldtaketooloeneed time justtomaketheinstead wepushonlytwovalues areferencetothe array oritsstartingaddress andthelengthofthepre alternatively   backtracking couldavoidpassingareferenceto recursivecallbymaking aglobal variable doesanysubsetof  sumto subsetsum  return true elseif   return false subsetsum  recurse wout subsetsum  recurse return _ wout withtheseimplementationchoices therunningtime ofouralgorithm satis estherecurrence    thesolution  followseasilyusingeitherrecursiontreesortheevensimpleryeah alreadysolvedthisrecurrenceforthetowerofhanomethod intheworst caorexample islargerthanthesumofallelementsof recursiontreeforthisalgorithmisacompletebinarytreewithdepth andthe algorithmconsidersall  subsetsof variants withonlyminorchanges wecansolveseveralvariantsof subsetsum figure   showsanalgorithmthatactually constructs asubsetof thatsumsto ifoneexists orreturnstheerrorvalue ifnosuchsubset exists thisalgorithmusesexactlythesamerecursivestrategyasourearlier decisionalgorithms thisalgorithmalsorunsin  time theanalysisis simplestifweassumeasetdatastructurethatallowsustoinsertasingle elementin  time forexample alinkedlist butinfacttherunningtime isstill  evenifinsertionrequires time forexample sorted linked list similarvariantsallowustocountsubsetsthatsumtoaparticularvalue orchoosethe subset accordingtosomeothercriterion thatsumstoa particularvalue mostotherproblemsthataresolvedbybacktrackinghavethisproperty thesamerecursivestrategycanbeusedtosolvemanydi erentvariantsofthe sameproblem forexample itiseasytomodifytherecursivestrategydescribed intheprevioussection whichdetermineswhetheragivengamepositionis goodorbad toinsteadreturnagoodmove oralistofallgoodmoves thisreason whenwe design backtrackingalgorithms weshouldaimforthe simplestpossiblevariantoftheproblem computinganumberorevenasingle booleaninsteadofmorecomplexinformationorstructure    thegeneralpattern returnasubsetof  thatsumsto ifnosuchsubsetexists constructsubset  return   return constructsubset   return constructsubset   return return figure2  arecursivebacktrackingalgorithmfortheconstructionversionof subsetsum  thegeneralpattern backtrackingalgorithmsarecommonlyusedtomakea sequenceofdecisions thegoalofbuildingarecursivelyde nedstructuresatisfyingcertainconstraints butnotalways thisgoalstructureisitselfasequence forexample inthe eensproblem thegoalisasequenceofqueenpositions onein eachrow suchthatnotwoqueensattackeachother foreachrow algorithm decides wheretoplacethequeen inthegametreeproblem thegoalisasequenceoflegalmoves suchthat eachmoveisasgoodaspossiblefortheplayermakingit foreachgame state thealgorithm decides thebestpossiblenextmove inthe subsetsum problem thegoalisasequenceofinputelementsthat haveaparticularsum foreachinputelement thealgorithm decides toincludeitintheoutputsequenceornot hangon whyisthegoalof subset sum ndinga sequence thatwasa deliberatedesigndecision weimposedaconvenientorderingontheinput representingitusinganarray asopposedtosomeothermoreamorphous datastruwecanexploitinourrecursivealgorithm ineachrecursivecalltothebacktrackingalgorithm weneedtomake decision andourchoicemustbeconsistentwithallpreviousdecisions eachrecursivecallrequiresnotonlytheportionoftheinputdatawehave notyetprocessed butalsoasuitablesummaryofthedecisionswehavealready forthesakeofe ciency thesummaryofpastdecisionsshouldbeas smallaspossible forexample   backtracking forthe eensproblem wemustpassinnotonlythenumberofempty rows butthepositionsofallpreviouslyplacedqueens wemustrememberourpastdecisionsincompletedetail forthegametreeproblem weonlyneedtopassinthecurrentstateofthe game includingtheidentityofthenextplayer wedon tneedtoremember aboutourpastdecisions becausewhowinsfromagivengame statedoesnotdependonthemovesthatcreatedthatstate  forthe subsetsum problem weneedtopassinboththeremainingavailable integersandtheremainingtargetvalue whichistheoriginaltargetvalue minusthe sum ofthepreviouslychosenelements preciselywhichelements werepreviouslychosenisunimportant whenwedesignnewrecursivebacktrackingalgorithms wemust gureout advance whatinformationwewillneedaboutpastdecisions inthemiddleof thealgorithm ifthisinformationisnontrivial ourrecursivealgorithmmight needtosolveamoregeneralproblemthantheonewewereoriginallyaskedto solve veseenthiskindofgeneralizationbefore ndthe median ofan unsortedarrayinlineartime wederivedanalgorithmtoselectthe thsmallest elementfor arbitrary finally oncewe guredoutwhatrecursiveproblemwe needto solve wesolvethatproblemby recursivebruteforce possibilitiesfor thenextdecisionthatareconsistentwithpastdecisions andlettherecursion fairyworryabouttherest nobeingcleverhere noskippingousstupid choices tryeverything youcanmakethealgorithmfasterlater  textsegmentation interpunctioverborum supposeyouaregivenastringoflettersrepresentingtextinsomeforeign language butwithoutanyspacesorpunctuation andyouwanttobreakthis stringintoitsindividualconstituentwords forexample youmightbegiven thefollowingpassagefromcicero sfamousorationindefenseofluciuslicinius murenain62 bce inthestandard scriptiocontinua ofclassicallatin   manygames toviolatethisindependencecondition forexample thestandardrules ofbothchessandcheckersallowaplayertodeclareadrawifthesamearrangementofpieces occursthreetimes andthechineserulesforgosimplyforbidrepeatinganyearlierarrangement ofstones forthesegames agamestateformallyincludesnotonlythecurrentpositionsof thepiecesbuttheentirehistoryofpreviousmoves  fact classical latin manuscripts separated small dots called interpuncts interpunctuationallbutdisappearedbythe3rdcenturyinfavorof scriptiocontinua spacesbetweenwordswereintroducedbyirishmonksinthe8thcenturyandslowlyspread acrosseuropeoverthenextseveralcenturies scriptiocontinua survivesinearly englishintheformofurlsandhashtags octotherps4lyfe    textsegmentation interpunctioverborum primvsdignitasintamtenviscientianonpotest esseresenimsvntparvaepropeinsingvlislitteris atqveinterpvnctionibusverborvmoccvpatae uentlatinreaderwouldparsethisstring inmodernorthography primus dignitasintamtenuiscientianonpotestesse resenimsuntparvae propeinsingulis litterisatqueinterpunctionibusverborumoccupatae  textsegmentationisnot onlyaprobleminclassicallatinandgreek butinseveralmodernlanguages andscriptsincludingbalinese burmese chinese japanese javanese khmer lao thai tibetan andvietnamese similarproblemsariseinsegmenting unpunctuatedenglishtextintosentences  segmentingtextintolinesfor typesetting speechandhandwritingrecognition curvesimpli cation severaltypesofesanalysis forpurposesofillustration llstickto segmentingsequencesoflettersinthemodernenglishalphabetintomodern englishwords ofcourse somestringscanbesegmentedinseveraldi erentways bothearthandsaturnspin canbedecomposedintoenglishwords aseither earth saturn spin bot heart hands urns pin amongmanyotherpossibilities fornow sconsideranextremelysimple segmentationproblem givenastringofcharacters canitbesegmentedinto englishwords atall tomaketheproblemconcrete andlanguostic sassumewe haveaccesstoasubroutine isword thattakesastring asinput returns true isaor false isnotaforexample wearetryingtodecomposetheinputstringintopalindromes thena isasynonymforlindroandtherefore isword rotator true isword palindrome false justlikethe subsetsum problem input structureisasequence timecontaininglettersinsteadofnumbers soitisnaturaltoconsideradecision processthatconsumestheinputcharactersinorderfromlefttoright output structureisasequenceofwords soitisnaturaltoconsideraprocess thatproducestheoutputwordsinorderfromlefttoright jumpinginto themiddleofthesegmentationprocess wemightimaginethefollowingpicture blue stem unit robot hearthandsaturnspin  looselytranslated ofall dignityinsuchpaltryknowledgeisimpossible thisistrivial stu mostlyconcernedwithindividuallettersandtheplacementofpointsbetweenw cicerowasopenlymockingthelegalexpertiseofhisfriend andnotedjuristserviussulpicius rufus whohadaccusedmurenaofbribery aftermurenadefeatedrufusinelectionforconsul murenawasacquitted thanksinparttocicero sacerbicdefense althoughhewasalmostcertainly guilty librapondo nunquamest delis  augustine dedoctrinachristiana devotesanentirechaptertoremovingambiguityfrom latinscripturebyaddingpunctuation   backtracking heretheblackbarseparatesourpastdecisioplittingthe rst17lettersinto fourwmtheportionoftheinputstringthatwehavenotyetprocessed thenextstageinourimaginedprocessisto decide wherethenextwordin theoutputsequenceends forthisspeci cexample therearefourpossibilities forthenextoutputw hear heart hearth wehave noidea ofthesechoices ifany isconsistentwithacompletesegmentationoftheinput string wecouldbeatthispointandtryto gureout whichchoices aregood butthatwouldrequire thinking stryevery possibilitybybruteforce andlettherecursionfairydoalltherealwork tentatively accept asthenextword andlettherecursionfairymake therestofthedecisions blue stem unit robot arthandsaturnspin tentatively accept hear asthenextword andlettherecursionfairy maketherestofthedecisions blue stem unit robot hear thandsaturnspin tentatively accept heart asthenextword andlettherecursionfairy maketherestofthedecisions blue stem unit robot heart handsaturnspin finally tentatively accept hearth asthenextword andlettherecursion fairymaketherestofthedecisions blue stem unit robot hearth andsaturnspin aslongastherecursionfairyreportssuccessatleastonce wereportsuccess ontheotherhand iftherecursionfairy reportssuparticular thesetofpossiblenextwordsisemptwereportfailure noneofourpastdecisionsa ectwhichchoicesareavailablenow allthat mattersisthesu xofcharactersthatwehavenotyetprocessed inparticular severaldi erentsequencesofpastdecisionscouldleadustothesamesu buttheyallleaveuswithexactlythesamesetofchoicesforthatsu blue stem unit robot hearthandsaturnspin bluest emu nitro bot hearthandsaturnspin wecansimplifyourpictureoftherecursiveprocessbydiscarding leftoftheblackbar hearthandsaturnspin    textsegmentation interpunctioverborum wearenowleftwithasimpleandnaturalbacktrackingstrategy selectthe rst outputword andrecursivelysegmenttherestoftheinputstring togetacompleterecursivealgorithm weneedabasecase ourrecursive strategybreaksdownwhenwereachtheendoftheinputstring becausethere isnonextword fortunately theemptystringhasauniquesegmentationinto zerowords puttingallthepiecestogether wearriveatthefollowingsimplerecursive algorithm splittable   return true  isword  splittable  return true return false indexformulation inpractice passingarraysasinputparametersisratherslow weshouldreally ndamorecompactwaytodescribeourrecursivesubproblems forpurposesof designingthealgorithm sincrediblyusefultotreattheoriginalinputarrayas aglobalvariable andthenreformulatetheproblemandthealgorithminterms ofarrayindicesinsteadofexplicitsubarrays forourstringsegmentationproblem theargumentofanyrecursivecall isalwaysa su oftheoriginalinputarray soifwetreattheinput array  asaglobalvariable wecanreformulateourrecursiveproblemas givenanindex ndasegmentationofthesu todescribeouralgorithm weneedtwobooleanfunctions foranyindices isword true ifandonlyifthesubstring isaword reassumingthisfunctionisgiventous foranyindex splittable true ifandonlyifthesu besplitintowords thisisthefunctionweneedtoimplement forexample isword  true ifandonlyiftheentireinputstringisa singleword splittable  true ifandonlyiftheentireinputstringcan besegmented ourearlierrecursivestrategygivesusthefollowingrecurrence splittable  true isword splittable    backtracking thisis thesamealgorithmaswesawearlier theonlythingwe changedisthenotation thesimilarityisevenmoreapparentifwerewritethe recurrenceinpseudocode isthesuf splittable splittable return true isword splittable  return true return false althoughitmaylooklikeatrivialnotationaldi erence usingindexnotation insteadofarraynotationisanimportanthabit notonlytospeedupbacktracking algorithmsinpractice butfordevelopingdynamicprogrammingalgorithms whichwediscussinthenextchapter ª analysis itshouldcomeasnosurprisethatmostbacktrackingalgorithmshaveexponential wserunningtimes analyzingthepreciserunningtimesofmanyof thesealgorithmsrequirestechniquesthatarebeyondthescopeofthisbook fortunately mostofthebacktrackingalgorithmswewillencounter inthisbook areonlyintermediateresultsonthewaytomoree cientalgorithms meanstheirexactwserunningtimeisnotactuallyimportant makeitwork thenmakeitfast butjustforfun sanalyzetherunningtimeofourrecursivealgorithm splittable becausewedon tknowwhat isword isdoing wecan tknow howlongeachcallto isword takes sowe reforcedtoanalyzetherunning timeintermsofthenumberofcallsto isword  splittable calls isword oneverypre xoftheinputstring callsitselfrecursivelyonevery su xoftheoutputstring theof splittable obeysthe ookingrecurrence   thisreallyisn tasbadasitlooks especiallyonceyou veseenthetrick wereplacethe termwithanexplicitexpression forsome unknown andultimatelyunimportant constant weconservatively  infact aslongas isword runsin polynomial time splittable runsin  time    textsegmentation interpunctioverborum assumethatthealgorithmactuallymakeseverypossiblerecursivecall  wecantransformtheullhistrecurrenceintoahistrecurrence bysubtractingtherecurrencefor  asfollows         nalrecurrencesimpli esto   atthispoint wecan dentlyguess orderiveviarecursiontrees orrememberfromourtower ofhanoianalysis  thisupperboundisnothardto provebyinductionfromtheoriginalforyrecurrence thisanalysisistight thereareexactly   possiblewaysto segmentastringoflength inputcharactereitherendsawordordoesn exceptthelastinputcharacter whichalwaysendsthelastword intheworst case splittable algorithmexploreseachofthese   possibilities variants nowthatwehavethebasicrecursionpatterninhand wecanuseittosolve manydi erentvariantsofthesegmentationproblem justaswedidforthe subsetsum problem herei lldescribejustoneexample morevariationsare consideredintheexercises asusual theoriginalinputtoourproblemisan array  ifastringcanbesegmentedinmorethanonesequenceofwords wemay wantto ndthe segmentationaccordingtosomecriterion conversely theinputstringcannotbesegmentedintowords wemaywanttocomputethe bestsegmentationwecan ratherthanmerelyreportingfailure tomeet bothofthesegoals supposewehaveaccesstoasecondfunction score takesastringasinputandreturnsanumericalvalue forexample wemight assignhigherscorestolongerormorecommonwords lowerscorestoshorter ormoreobscurewords slightlynegativescoresforminorspellingerrors morenegativescorestoobviousnoords ourgoalisto ndasegmentation thatmaximizesthesumofthescoresofthesegments  thisassumptioniswildlyconservativeforenglish word segmentation sincemoststringsof lettersarenotenglishwords forthesimilarproblemofsegmentingsequencesofenglish intogrammaticallycorrectenglish sentences forexample asequenceof copies ofthewordu alor copiesoftheworkor copiesofthewordforany positiveinteger atthemoulinrouge dancesthatarepreservableinmetalcylindersbyother danceshavetheopportunityto redancesthathappeninprisonrestroomtrashreceptacles   backtracking foranyindex maxscore denotethemaximumscoreofany tationofthesu weneedtocompute maxscore  thisfunction satis esthefollowingrecurrence maxscore  max score maxscore  thisisessentiallythesamerecurrenceastheonewedevelopedfor splittable theonlydi erenceisthatthebooleanoperations _ havebeenreplaced bythenumericaloperations max  longestincreasingsubsequence foranysequence subsequence isanothersequenceobtainedfrom deletingzeroormoreelements withoutchangingtheorderoftheremaining elements theelementsofthesubsequenceneednotbecontiguousin whenyoudrivedownamajorstreetinanycity youdrivethrough sequence ofintersectionswithtra clights butyouonlyhavetostopata subsequence ofthoseintersections wherethetra clightsarered ifyou revery lucky youneverstopatall theemptysequenceisasubsequenceof onthe otherhand ifyou reveryunlucky youmayhavetostopateveryintersection isasubsequenceofitself asanotherexample thestrings bent ackack squaring subsequent areallsubsequencesofthestring subsequencebacktracking asaretheempty stringandtheentirestring subsequencebacktracking butthestrings queue equus tallyho arenot asubsequencewhoseelementsarecontiguous intheoriginalsequenceiscalleda substring forexample masher laughter arebothsubsequencesof manslaughter butonly laughter isasubstring nowsupposewearegivenasequenceof integers andweneedto ndthe longestsubsequencewhoseelementsareinincreasingorder moreconcretely theinputisanintegerarray  andweneedtocomputethelongest possiblesequenceofindices    suchthat  forall onenaturalapproachtobuildingthis longestincreasingsubsequence isto decide foreachindex inorderfrom  whetherornottoinclude thesubsequence jumpingintothemiddleofthisdecisionsequence wemight imaginethefollowingpicture             asinourearliertextsegmentationexamples theblackbarseparatesourpast decisionsfromtheportionoftheinputwehavenotyetprocessed numberswe    longestincreasingsubsequence havealreadydecidedtoincludearehighlightedandbold numberswehave alreadydecidedtoexcludearegrayedout noticethatthenumberswe decidedtoincludeareincreasing ouralgorithmmustdecidewhetherornot toincludethenumberimmediatelyaftertheblackbar inthisexample wede nitely include  becausethentheselected numberswouldnolongerbeinincreasingorder solet sskipaheadtothenext decision              nowwe include  butit snotobviouswhetherwe ratherthan tryingtobeourbacktrackingalgorithmwillusesimplebruteforce tentatively includethe  andlettherecursionfairymaketherestof thedecisions tentatively excludethe  andlettherecursionfairymaketherestof thedecisions whicheverchoiceleadstoalongerincreasingsubsequenceistherightone thisispreciselythesamerecursionpatternweusedtosolve subsetsum nowforthekeyquestion whatdoweneedtorememberaboutourpast decisions wecanonlyinclude iftheresultingsubsequenceisinincreasing order ifweassume inductively thatthenumberspreviouslyselectedfrom   areinincreasingorder thenwecaninclude ifandonlyif islargerthanthelastnumberselectedfrom   theonly informationweneedaboutthepastis thelastnumberselectedsofar wecan nowreviseourpicturesbyerasingeverythingwedon tneed       sotheproblemourrecursivestrategyis solvingisthefollowing givenaninteger prev andanarray  ndthelongestincreasing subsequenceof inwhicheveryelementislargerthan prev asusual ourrecursivestrategyrequiresabasecase ourcurrentstrategy breaksdownwhenwegettotheendofthearray becausethereisnoext ntoconsider butanemptyarrayhasexactlyonesubsequence sequence vacuously everyelementintheemptysequenceislarger thanwhatevervalueyouwant andeverypairofelementsintheemptysequence appearsinincreasingorder thelongestincreasingsubsequenceofthe emptyarrayhaslength  stheresultingrecursivealgorithm   backtracking lisbigger prev   return  elseif  prev return lisbigger prev  skip lisbigger prev  lisbigger    return max skip butrememberthatpassingarraysaroundonthecallstackisexpensive strytorephraseeverythingintermsofarrayindices assumingthatthearray  isaglobalvariable theinteger prev istypicallyanarrayelement andtheremainingarrayisalwaysasu oftheoriginalinputarray sowecanreformulateourrecursive problem asfollows giventwoindices ndthelongestincreasing subsequenceof inwhicheveryelementislargerthan lisbigger denotethe length ofthelongestincreasingsubsequenceof inwhicheveryelementislargerthan ourrecursivestrategygives usthefollowingrecurrence lisbigger   lisbigger  max ˆ lisbigger   lisbigger  alternatively ifyoupreferpseudocode lisbigger return  elseif return lisbigger  skip lisbigger  lisbigger   return max skip finally weneedtoconnectourrecursivestrategytotheoriginalproblem findingthelongestincreasingsubsequenceofanarray withnootherconstraints thesimplestapproachistoaddanarti cialsentinelvalue tothebeginning ofthearray    longestincreasingsubsequence take2 lis   return lisbigger   therunningtimeof lisbigger satis esthehanoirecurrence    whichasusualimpliesthat  wereallyshouldn besurprisedbythisrunningtime intheworstcase thealgorithmexamines eachofthe  subsequencesoftheinputarray  longestincreasingsubsequence take2 thisisnottheonlybacktrackingstrategywecanuseto ndlongestincreasing subsequences insteadofconsideringthe input sequenceoneelementatatime wecouldtrytoconstructthe output sequenceoneelementatatime thatis insteadofasking thenextelementoftheoutputsequenwecould askdirectly isthenextelementoftheoutputsequence jumpingintothemiddleofthisstrategy wemightbefacedwiththefollowing picture supposewejustdecidedtoincludethe  justleftoftheblackbarin ouroutputsequence andweneedtodecidewhichelementtotherightofthe bartoincludenext                        ofcourse wecanonlyincludenumbersontherightthataregreaterthan  ouroutputsequencewouldnotbeincreasing                        butwehavenoidea ofthoselargernumbersisthebestchoice andtrying tocleverly gureout thebestchoiceistoomuchwork andit sonlygoingtoget usintotroubleanyway weenumerateallpossibilitiesbybruteforce andlettherecursionfairyevaluateeachone                                                                                 backtracking thesubsetofnumberswecanconsiderasthenextelementdepends onthelastnumberwedecidedtoinclude wecansimplifyourpictureof thedecisionprocessbydiscardingeverythingtotheleftofthebar lastnumberwedecidedtoinclude   theremainingsequenceofnumbersisjustasu xoftheoriginalinputarray ifwethinkoftheinputarray  asaglobalvariable wecanformally expressourrecursiveproblemintermsofindicesasfollows givenanindex ndthelongestincreasingsubsequenceof beginswith lis rst denotethelengthofthelongestincreasingsubsequenceof thatbeginswith wecannowformulateourrecursivebacktrackingstrategy asthefollowingrecursivede nition lis rst  max lis rst becausewearedealingwithsetsofnaturalnumbers wede max  weautomaticallyhave lis rst  forall inparticular lis rst  thesearethebasecasesforourrecurrence wecanalsoexpressthisrecursivede nitioninpseudocodeasfollows lisfirst   max lisfirst return  finally weneedtoreconnectthisrecursivealgorithmtoouroriginal problthelongestincreasingsubsequencewithoutknowingits rstelement onenaturalapproachthatworksistotryallpossible rstel mentsbybruteforce equivalently wecanaddasentinelelement tothe beginningofthearray ndthelongestincreasingsubsequencethatstartswith thesentinel nallyignorethesentinel lis    max lisfirst return lis   return lisfirst      optimalbinarysearchtrees  optimalbinarysearchtrees nalexamplecombinesrecursivebacktrackingwiththedinquer strategy recallthattherunningtimeforasuccessfulsearchinabinarysearch treeisproportionaltothenumberofancestorsofthetargetnode  asaresult thewsesearchtimeisproportionaltothedepthofthetree minimizethewsesearchtime theheightofthetreeshouldbeassmall aspossible bythismetric theidealtreeisperfectlybalanced inmanyapplicationsofbinarysearchtrees itismoreimportantto minimizethetotalcostofseveralsearchesratherthanthewsecostofa singlesearch isamorefrequentsearchtargetthan wecansavetimeby buildingatreewherethedepthof issmallerthanthedepthof evenifthat meansincreasingtheoveralldepthofthetree aperfectlybalancedtreeis thebestchoiceifsomeitemsaresigni cantlymorepopularthanothers infact atotallyunbalancedtreewithdepth mightactuallybethebestchoice thissituationsuggeststhefollowingproblem supposewearegivena sortedarrayof keys  andanarrayofcorresponding accessfrequencies  ourtaskistobuildthebinarysearchtreethatminimizesthe total searchtime assumingthattherewillbeexactly searchesforeachkey beforewethinkabouthowtosolvethisproblem weshould rstcome upwithagoodrecursivede nitionofthefunctionwearetryingtooptimize supposewearealsogivenabinarysearchtree nodes   bethenodesof indexedinsortedorder sothateachnode storesthe correspondingkey thenignoringconstantfactors thetotalcostof performingallthebinarysearchesisgivenbythefollowingexpression cost   ancestorsof nowsuppose istherootof byde nition isanancestorofeverynode thenallancestorsof excepttherootareintheleftsubtreeof thenallancestorsof excepttherootareintherightsubtree wecanpartitionthecostfunctionintothreepartsasfollows cost     ancestorsof left  ancestorsof thesecondandthirdsummationslookexactlylikeouroriginalde nition  ancestor ofanode iseitherthenodeitselforanancestoroftheparentof proper ancestorof iseithertheparentof oraproperancestoroftheparentof   backtracking cost  simplesubstitutionnowgivesusarecurrencefor cost cost   cost left   cost  thebasecaseforthisrecurrenceis asusual  thecostofperformingno searchesintheemptytreeiszero nowourtaskistocomputethetree opt thatminimizesthiscostfunction supposewesomehowmagicallyknewthattherootof opt thenthe recursivede nitionof cost immediatelyimpliesthattheleftsubtree left opt mustbetheoptimalsearchtreeforthekeys   andaccess frequencies   therightsubtree opt mustbethe optimalsearchtreeforthekeys  andaccessfrequencies  oncewechoosethecorrectkeytostoreattheroot therecursionfairy willconstructtherestoftheoptimaltree moregenerally optcost denotethetotalcostoftheoptimalsearch treefortheintervaloffrequencies thisfunctionobeysthefollowing recurrence optcost   min optcost  optcost  thebasecasecorrectlyindicatesthattheminimumpossiblecosttoperform zerosearchesintotheemptysetiszero ouroriginalproblemistocompute optcost  thisrecursivede nitioncanbetranslatedmechanicallyintoarecursive backtrackingalgorithmtocompute optcost  notsurprisingly therunning timeofthisalgorithmisexponential inthenextchapter llseehowto reducetherunningtimetopolynomial sothere snotmuchpointincomputing thepreciserunningtime ª analysis unlessyou reintothatsortofthing justforthefunofit gureout howslowthisbacktrackingalgorithmactuallyis therunningtimesatis esthe recurrence   termcomesfromcomputingthetotalnumberofsearches  yeah soneuglyrecurrence butwecansolveitusingexactlythesame  exercises subtractiontrickweusedbefore wereplacethe notationwithanexplicit constant regroupandcollectidenticalterms subtracttherecurrencefor  togetridofthesummation andthenregroupagain              hey thatdoesn tlooksobadafterall therecursiontreemethodimmediately givesusthesolution  orwecanjustguessandcon rmby induction thisanalysisimpliesthatourrecursivealgorithmdoes examineall possiblebinarysearchtrees thenumberofbinarysearchtreeswith vertices satis estherecurrence    whichhasthecloormsolution  snotobvious ouralgorithmsavesconsiderabletimebysearching independently fortheoptimal leftandrightsubtreesforeachroot afullenumerationofbinarysearchtrees wouldconsiderallpossible pairs ofleftandrightsubtrees hencetheproductin therecurrencefor exercises  describerecursivealgorithmsforthefollowinggeneralizationsofthe setsum problem givenanarray  ofpositiveintegersandaninteger compute number ofsubsetsof whoseelementssumto giventwoarrays   ofpositiveintegersandan integer whereeach denotesthe weight ofthecorresponding element computethe maximumweight subsetof whoseelements sumto ifnosubsetof sumsto youralgorithmshouldreturn  describerecursivealgorithmsforthefollowingvariantsofthetext tationproblem assumethatyouhaveasubroutine isword thattakesan   backtracking arrayofcharactersasinputandreturns true ifandonlyifthatstringisa givenanarray  ofcharacters computethenumberofpartitions intowords forexample giventhestring artistoil youralgorithm shouldreturn  forthepartitions artist oil art toil giventwoarrays   ofcharacters decidewhether canbepartitionedintowordsatthesameindices forexample thestrings bothearthandsaturnspin pinstartrapsandragslap canbepartitionedintowordsatthesameindicesasfollows bot heart hand sat urns pin pin start raps rags lap giventwoarrays   ofcharacters computethenumber ofdi erentwaysthat canbepartitionedintowordsatthesame indices  additionchain foraninteger isanincreasingsequenceofintegers thatstartswith  andendswith suchthateachentryafterthe rst isthesumoftwoearlierentries moreformally theintegersequence    isanadditionchainfor ifandonlyif   foreveryindex  thereareindices suchthat engthofanadditionchainisthenumberofelementsminus  tbothertocountthe rstentry forexample             isanadditionchainfor  oflength  describearecursivebacktrackingalgorithmtocomputeaminim lengthadditionchainforagivenpositiveinteger analyzeor optimizeyouralgorithm srunningtime excepttosatisfyyourown curiosity acorrectalgorithmwhoserunningtimeisexponentialin su cientforfullcredit hint thisproblemisalotmorelike queens thantextsegmentation ª describearecursivebacktrackingalgorithmtocomputeaminim lengthadditionchainforagivenpositiveinteger intimethatis nentialin hint youmay ndtheresultsofcertainegyptian asteners induverprosodists andrussianpeasantshelpful    betwoarbitraryarrays commonsubsequence isbothasubsequenceof andasubsequenceof asimplerecursivede nitionforthefunction lcs whichgivesthe lengthofthe longest commonsubsequenceof  exercises   betwoarbitraryarrays commonsuper sequence isanothersequencethatcontainsboth assubsequences giveasimplerecursivede nitionforthefunction scs whichgivesthelengthofthe shortest commonsupersequence callasequence  ofnumbers bitonic ifthereisanindex  suchthatthepre  isincreasingandthesu isdecreasing giveasimplerecursivede nitionforthefunction lbs whichgivesthelengthofthelongestbitonicsubsequenceofan arbitraryarray ofintegers callasequence  oscillating  foralleven  forallodd giveasimplerecursivede nitionfor thefunction whichgivesthelengthofthelongestoscillating subsequenceofanarbitraryarray ofintegers giveasimplerecursivede nitionforthefunction sos whichgives thelengthoftheshortestoscillatingsupersequenceofanarbitraryarray ofintegers callasequence  convex    forall giveasimplerecursivede nitionforthefunction lxs whichgives thelengthofthelongestconvexsubsequenceofanarbitraryarray integers  foreachofthefollowingproblems theinputconsistsoftwoarrays   describearecursivebacktrackingalgorithmtodeterminewhether asubsequenceof forexample thestring ppap isasubsequenceof thestring ine ppleapple describearecursivebacktrackingalgorithmto ndthesmallestnumber ofsymbolsthatcanberemovedfrom sothat isnolongera subsequence equivalently youralgorithmshould ndthelongest subsequenceof thatis asupersequenceof forexample removingremovingtwosymbolsfromthestring penpine pple pplepen thestring ppap isnolongerasubsequence ª describearecursivebacktrackingalgorithmtodeterminewhether occursastwo disjoint subsequencesof forexample thestring ppap pearsastwodisjointsubsequencesinthestring ine ple analyzetherunningtimesofyouralgorithms excepttosatisfyyour owncuriosity allthreealgorithmsruninexponentialtime llimprove thatlater sothepreciserunningtimeisn tparticularlyimportant   backtracking  thisproblemasksyoutodesignbacktrackingalgorithmsto ndthecostof anoptimalbinarysearchtreethatsatis esadditionalbalanceconstraints yourinputconsistsofasortedarray  ofsearchkeysandanarray  offrequencycounts isthenumberofsearchesfor thisisexactlythesamecostfunctionasdescribedinsection   nowyourtaskistocomputeanoptimaltreethatsatis essomeadditional constraints avltrees weretheearliestselflancingbalancedbinarysearchtrees rstdescribedin1962bygeorgyadelsovelskyandevgeniilandis avltreeisabinarysearchtreewhereforeverynode theheightof theleftsubtreeof andtheheightoftherightsubtreeof erbyat mostone describearecursivebacktrackingalgorithmtoconstructanoptimal avltreeforagivensetofsearchkeysandfrequencies symmetricbinaryb areanotherselflancingbinarytrees rst describedbyrudolfbayerin1972 thesearebetterknownbythename lacktrees afterasomewhatsimplerreformulationbyleoguibas andbobsedgwickin1978 alacktreeisabinarysearchtreewith thefollowingadditionalconstraints everynodeiseitherredorblack everyrednodehasablackparent everyeafpathcontainsthesamenumberofblacknodes describearecursivebacktrackingalgorithmtoconstructanoptimal lacktreeforagivensetofsearchkeysandfrequencies aatrees wereproposedbyproposedbyarneanderssonin1993and slightlysimpli andnamed bymarkallenweissin2000 aatreesare alsoknownas leaninglacktrees afterasymmetricreformulation withdi erentrebalancingalgorithms bybobsedgewickin2006 aatreeisalacktreewithoneadditionalconstraint noleftchildisred  describearecursivebacktrackingalgorithmtoconstructanoptimalaa treeforagivensetofsearchkeysandfrequencies analyzetherunningtimesofyouralgorithms excepttosatisfyyour owncuriosity allthreealgorithmsruninexponentialtime llimprove thatlater sothepreciserunningtimesaren tparticularlyimportant formorebacktrackingexercises seethenextchapter  sedgwick sreformulationrequiresthatno childisred anderssonand sedgwickarestrangelysilentonwhichendoftheeggtoeat rst  potesenimvidereinhacmargine qualiterhocoperatifuimus scilicetquod iunximusprimumnumerumcumsecundo videlicet1cum2 etsecundumcum tercio etterciumcumquarto etquartumcumquinto etsicdeinceps youcanseeinthemarginherehowwehaveworkedthis wecombinedthe rstnumberwiththesecond namely1with2 andthesecondwiththethird thethirdwiththefourth andthefourthwiththe fth andsoforth leonardopisano liberabaci  thosewhocannotrememberthepastarecondemnedtorepeatit jorgeagustínnicolásruizdesantayanayborrás thelifeofreason booki introductionandreasonincommonsense  youknowwhatalearningexperienceis alearningexperienceisoneofthosethingsthatsays ouknowthatthingyoujustdid tdothat douglasadams thesalmonofdoubt   dynamicprogramming  m atr avr tta oneoftheearliestexamplesofrecursionaroseinindiamorethan2000yearsago inthestudyofpoeticmeter orprosody classicalsanskritpoetrydistinguishes betweentwotypesofsyllables ak ara light laghu heavy guru oneclassofmeters variouslycalled atr tta atr achandas eachlineof poetryconsistsofa xednumberof atr whereeachlightsyllable lastsonebeatandeachheavysyllablelaststwobeats theformalstudyof atr tta datesbacktothe chanda astra writtenbythescholarpi ngala between600 bce and200 bce ngalaobservedthatthereareexactly  meters hereeach representsalongsyllableandeach representsashortsyllable   inmorsecode alaststhreetimesaslongasabuteachorisfollowed byapausewiththesamedurationasathus eachuisa laghuak ara   dynamicprogramming althoughpi ngala stext hints atasystematicruleforcountingmeterswitha givennumberofbeats  ittookaboutamillenniumforthatruletobestated explicitly inthe7thcentury anotherindianscholarnamedvirah kawrote acommentaryonpi ngala swork inwhichheobservedthatthenumberof meterswith beatsisthesumofthenumberofmeterswith  beatsand thenumberofmeterswith  beats inmoremodernnotation virah ka observationimpliesarecurrenceforthetotalnumber meters   itisnothardtoseethat   thereisonlyoneemptymeter   theonlyonmeterconsistsofasingleshortsyllable thesamerecurrencereappearedineuropeabout500yearsaftervirah ka inleonardoofpisa s1202treatise liberabaci oneofthemostin uential earlyeuropeanworksoninfullcompliancewithstigler slaw ofeponymy  themodern fibonaccinumbers arede nedusingvirah ka recurrence butwithdi erentbasecases        inparticular wehave  forall backtrackingcanbeslow therecursivede nitionoffibonaccinumbersimmediatelygivesusa sivealgorithmforcomputingthem hereisthesamealgorithmwrittenin pseudocode uisa guruak ara andthereareexactly veletters whosecodeslast atr  chanda astra systematicrulesforlistingallmeterswithagivennumber syllables whichcorrespondroughlytowritingnumbersinbinaryfromlefttoright greeks orfromrighttoleft likeegyptians thesametextincludesarecursivealgorithmto compute  thenumberofmeterswith syllables byrepeatedsquaring arguably recursivealgorithmtocomputebinomialcoe cients thenumberofmeterswith shortsyllables syllablesoverall  oscienti cdiscoveryisnamedafteritsoriginaldiscoverer inhis1980paperthatgivesthe lawitsname thestatisticianstephenstiglerjokinglyclaimedthatthislawwas rstproposedby sociologistrobertk merton similarstatementswerepreviouslymadebyvladimir arnol dinthe1970 sveriesarerarelyattributedtothecorrectpersocarlboyerin o themuseofhistory oftenis ckleinattachingnamestoalfrednorth whiteheadin1917verythingofimportancehasbeensaidbeforebysomeonewhodidnot discoverandevenstephen sfathergeorgestiglerin1966weshouldeverencountera casewhereatheoryisnamedforthecorrectman itwillbenwewillsee examplesofstigler slawinthisbook    atr avr tta recfibo  return  elseif  return  return recfibo  recfibo  thisnaiverecursivealgorithmishorriblyslow exceptforthe recursivecalls theentirealgorithmrequiresonlyaconstantnumberofsteps onecomparisonandpossiblyoneaddition denotethenumberof recursivecallsto recfibo thisfunctionsatis estherecurrence        whichlooksanawfullotliketherecurrenceforfibonaccinumbers writingoutthe rstseveralvaluesof suggeststhecloorm solution    whichwecanverifybyinduction hint hint computing usingthisalgorithmtakesabouttwiceaslongasjustcounting methodsbeyondthescopeofthisbook  implythat    ˇ   isthelled goldenratio inshort therunning timeofthisrecursivealgorithmisexponentialin wecanactuallyseethisexponentialgrowthdirectlyasfollows thinkofthe recursiontreefor recfibo asabinarytreeofadditions withonly  sand  attheleaves sincetheeventualoutputis oftheleavesmust havevalue  theseleavesrepresentthecallsto recribo  aneasyinductive argument hint hint impliesthat recfibo  iscalledexactly  times wejustwantanasymptoticbound senoughtoobservethatthenumber ofcallsto recfibo  isatmostthenumberofcallsto recfibo  therecursiontreehasexactly   leaves andtherefore becauseit safullbinarytree    nodesaltogether memo ization remembereverything theobviousreasonfortherecursivealgorithm slackofspeedisthatitco putesthesamefibonaccinumbersoverandoverandover asinglecallto recfibo resultsinonerecursivecallto recfibo  tworecursivecalls recfibo  threerecursivecallsto recfibo  verecursivecalls recfibo  andingeneral  recursivecallsto recfibo anyinteger  eachcallisrecomputingsomefibonaccinumberfrom scratch wecanspeedupourrecursivealgorithmconsiderablybywritingdownthe resultsofourrecursivecallsandlookingthemupagainifweneedthemlater  algorithms wtf fornotesonsolvingbacktrackingrecurrences   dynamicprogramming figure3  therecursiontreeforcomputing  arrowsrepresentrecursivecalls thisoptimizationtechnique nowknownas memoization withoutanr usuallycreditedtodonaldmichiein1967 butessentiallythesametechnique wasproposedin1959byarthursamuel  memfibo  return  elseif  return  isunde ned memfibo  memfibo  return memoizationclearlydecreasestherunningtimeofthealgorithm butby howmuch ifweactuallytracethroughtherecursivecallsmadeby memfibo ndthatthearray lledfromthebottomup rst   andsoon upto thispatterncanbeveri edbyinduction eachentry lledonlyafteritspredecessor  ifweignorethetimespentin recursivecalls itrequiresonlyconstanttimetoevaluatetherecurrenceforeach fibonaccinumber butbydesign therecurrencefor isevaluatedonlyonce foreachindex weconcludethat memfibo performsonly additions exponential improvementoverthenaïverecursivealgorithm  michieproposedthatprogramminglanguagesshouldsupportanabstractionhecalleda ofunctioconsistingofbothastandardfunctionandadictionaryinstead ofseparatelysupportingarraysandfunctions wheneveramemofunctioncomputesafunction valueforthe rsttime withanr thatvalueintoitsdictionary michiewas inspiredbysamuel suseofltospeeduptherecursiveevaluationofcheckersgame trees michiedescribeshismoregeneralproposalasablingtheprogrammerto samuelize functionsheplea asfarasicantell michieneverusedthetermoisatiohimself memoizationwasusedevenearlierbyclaudeshannon smazrobotwhich hedesignedandconstructedin1950    atr avr tta figure3  therecursiontreefor  trimmedbymemoization downwardgreenarrowsindicatewriting intothememoizationarray upwardredarrowsindicatereadingfromthememoizationarray dynamicprogramming filldeliberately onceweseehowthearray lled wecanreplacethememoizedrecurrence withasimplefoopthat intentionally llsthearrayinthatorder insteadof relyingonamorecomplicatedrecursivealgorithmtodoitforusaccidentally iterfibo        return nowthetimeanalysisisimmediate iterfibo clearlyuses additions stores integers thisisour rstexplicit dynamicprogramming algorithm thedynamic programmingparadigmwasformalizedandpopularizedbyrichardbellman inthewhileworkingattherandcorporation althoughhewas farfromthe rsttousethetechnique inparticular thisiterativealgorithm forfibonaccinumberswasalreadyproposedbyvirah kaandlatersanskrit prosodistsinthe12thcentury andagainbyfibonacciattheturnofthe13th century   moregeneraldynamicprogrammingtechniqueswereindependentlydeployedseveraltimes inthelate1930sandearly1940s forexample pierremasséuseddynamicprogramming algorithmstooptimizetheoperationofhydroelectricdamsinfranceduringthevichyregime johnvonneumannandoskarmorgensterndevelopeddynamicprogrammingalgorithmsto determinethewinnerofanytwayergamewithperfectinformation forexample checkers alanturingandhiscohortsusedsimilarmethodsaspartoftheirkinge ortsat   dynamicprogramming manyyearsafterthefact bellmanclaimedthathedeliberatelychosethe nameamictohidethemathematicalcharacterofhiswork fromhismilitarybosses whowereactivelyhostiletowardanythingresembling mathematicalresearch  theworddoesnotrefertowriting code butrathertotheoldersenseof planning scheduling typicallyby lling inatable forexample sportsprogramsandtheaterprogramsareschedules ofimportantevents withads televisionprogramminginvolves llingeach availabletimeslotwithashow andads degreeprogramsareschedulesof classestobetaken withads theairforcefundedbellmanandothersto developmethodsforconstructingtrainingandlogisticsschedules orasthey calledthem thewordamiwasnotonlyareferenceto themultistage aryingprocessesthatbellmanandhiscolleagueswere attemptingtooptimize butalsoamarketingbuzzwordthatwouldresonate withthefuturisticzeitgeist š ofpowwiiamerica  thanksinpart tobellman sproselytizing dynamicprogrammingisnowastandardtoolfor multistageplanningineconomics robotics controltheory andseveralother disciplines tremembereverythingafterall inmanydynamicprogrammingalgorithms itisnotnecessarytoretain intermediateresultsthroughtheentirecomputation forexample wecan signi cantlyreducethespacerequirementsofouralgorithm iterfibo maintainingonlythetwonewestelementsofthearray bletchleypark bothmassé sworkandvonneumannandmergenstern sworkwere rstpublished in1944 sixyearsbeforebellmancoinedthephraseamicthedetailsof turing surismuwerekeptsecretuntilthe  charleserwinwilsonbecamesecretaryofdefenseinjanuary1953 afteradozenyears asthepresidentofgeneralmotors echarlireorganizedthedepartmentofdefense andsigni cantlydecreaseditsbudgetinhis rstyearino withtheexplicitgoalofrunning thedepartmentmuchmorelikeanindustrialcorporation bellmandescribedwilsoninhis1984 autobiographyasfollows wehadaveryinterestinggentlemaninwashingtonnamedwilson hewassecretaryofdefense andheactuallyhadapathologicalfearandhatredoftheword mnotusingtheterm lightly musingitprecisely hisfacewouldsuffuse hewouldturnred andhewouldgetviolent ifpeopleusedtheterm inhispresence youcanimaginehowhefelt aboutthe term mathematical ifeltihadtodosomethingtoshieldwilsonandtheairforcefromthefact thatiwasreallydoingmathematicsinsidetherandcorporation whattitle whatname couldi choose bellman rstpublisheduseofthetermamicalreadyappearedin  severalmonthsbeforewilsontooko sothisstoryisatleast embellished  andjustpossiblyari ontheiconicbrandnameynamitensioforcharlesatlas famousseriesofexercises whichcharlesromancoinedin1928 heroofthebeach  ª   evenfasterfibonaccinumbers iterfibo2 prev  curr   curr prev prev curr curr return curr thisalgorithmusesthenoandardbutconsistentbasecase   iterfibo2  returnsthecorrectvalue  althoughsavingspacecanbe absolutelycrucialinpractice wewon tfocusonspaceissuesinthisbook ª  aside evenfasterfibonaccinumbers althoughthepreviousalgorithmissimpleandattractive itis thefastest algorithmtocomputefibonaccinumbers wecanderiveafasteralgorithmby exploitingthefollowingmatrixreformulationofthefibonaccirecurrence   inotherwords multiplyingatwonalvectorbythematrix   exactlythesamee ectasoneiterationoftheinnerloopof iterfibo2 itfollows thatmultiplyingbythematrix timesisthesameasiteratingtheloop times      soifwewantthe thfibonaccinumber weonlyneedtocomputethe thpower ofthematrix   ifweuserepeatedsquaring  computingthe thpowerof somethingrequiresonly log multiplications becauseis   matrix thatmeans log   matrixmultiplications eachofwhich reducestoaconstantnumberofintegermultiplicationsandadditions wecancompute inonly log integerarithmeticoperations wecanachievethesamespeedupusingtheidentity   whichholds byinduction forallintegers inparticular thisidentityimpliesthefollowingmutualrecurrenceforpairsofadjacent fibonaccinumbers rstproposedbyédouardlucasin1898            assuggestedbypi ngalaforpowersof  elsewherein chandah astra   dynamicprogramming wecanalsoderivethismutualrecurrencedirectlyfromthearing algorithm theserecurrencestranslatedirectlyintothefollowingalgorithm computethepair  fastrecfibo  return    hprv hcur fastrecfibo  prev hprv  hcur    curr hcur  hprv hcur  prev curr   iseven return prev curr return curr ourstandardrecursiontreetechniqueimpliesthatthisalgorithmperformsonly log integerarithmeticoperations thisisanexponentialspeedupoverthestandarditerativealgorithm wasalreadyanexponentialspeedupoverouroriginalrecursivealgorithm whoa notsofast notexactly fibonaccinumbersgrowexponentiallyfast thfibonacci numberisapproximately log  ˇ  decimaldigitslong log  ˇ   bits sowecan tpossiblycompute inlogarithmic time weneed time justtowritedowntheanswer thewayoutofthisapparentparadoxistoobservethat wecan tperform arbitraryonarithmeticinconstanttime denotethetime requiredtomultiplytwo numbers therunningtimeof fastrecfibo satis estherecurrence  whichsolvesto viarecursiontrees thefastestintegermultiplicationalgorithm asof2019 runsin log time sothatisalsotherunningtimeof thefastestalgorithmknown asof2019 tocomputefibonaccinumbers isthisalgorithmslowerthanouriterativealgorithms nonisn tfree addingtwo numbersrequires time sotheiterativealgorithms iterfibo iterfibo2 actuallyrunin  time doyouseewhy fastrecfibo issigni cantlyfasterthantheiterative algorithms justnot exponentially faster intheoriginalrecursivealgorithm theextracostofon arithmeticisoverwhelmedbythehugenumberofrecursivecalls thecorrect    interpunctioverborumredux recurrenceis   whichstillhasthesolution   interpunctioverborumredux forournextdynamicprogrammingalgorithm sconsiderthetextsegment tionproblemfromthepreviouschapter wearegivenastring  anda subroutine isword thatdetermineswhetheragivenstringisaword thatmeans andwewanttoknowwhether canbepartitionedintoasequence ofwords wesolvedthisproblembyde ningafunction splittable thatreturns true ifandonlyifthesu canbepartitionedintoasequenceofwords needtocompute splittable  thisfunctionsatis estherecurrence splittable  true isword splittable  isword isshorthandfor isword thisrecurrencetranslates directlyintoarecursivebacktrackingalgorithmthatcallsthe isword subroutine  timesintheworstcase butforany xedstring  thereareonly erentwaystocall therecursivefunction splittable neforeachvalueof    erentwaystocall isword neforeachpair suchthat  whyarewespendingexponentialtimecomputing onlyapolynomialamountofstu eachrecursivesubproblemisspeci edbyanintegerbetween   wecanmemoizethefunction splittable intoanarray splittable   subproblem splittable dependsonlyonresultsofsubproblems splittable sothememoizedrecursivealgorithm llsthearrayin decreasing indexorder ifwe llthearrayinthisorderdeliberately weobtainthedynamic programmingalgorithmshowninfigure   thealgorithmmakes  callsto isword anexponentialimprovementoverourearlierbacktracking algorithm  thepattern smartrecursion inanutshell dynamicprogrammingis recursionwithoutrepetition dynamic programmingalgorithmsstorethesolutionsofintermediatesubproblems butnotalways insomekindofarrayortable manyalgorithmsstudents   dynamicprogramming fastsplittable  splittable  true downto  splittable false isword splittable  splittable true return splittable  figure3  interpunctioverborumvelox andinstructors andtextbooks makethemistakeoffocusingonthetabl becausetablesareeasyandfamiliofthe moreimportant anddi cult taskof ndingacorrectrecurrence aslongaswememoizethe correctrecurrence anexplicittableisn treallynecessary butiftherecurrence isincorrect wearewellandtrulyhosed dynamicprogrammingis llingintables saboutsmartrecursion dynamicprogrammingalgorithmsarebestdevelopedintwodistinctstages  formulatetheproblemrecursively writedownarecursiveformula oralgorithmforthewholeproblemintermsoftheanswerstosmaller subproblems thisisthehardpart acompleterecursiveformulationhas twoparts speci cation describetheproblemthatyouwanttosolverecursively incoherentandpreciseenglisot tosolvethatproblem problemyou retryingtosolve withoutthisspeci cation itis impossible eveninprinciple todeterminewhetheryoursolutionis correct solution giveaclearrecursiveformulaoralgorithmforthewhole problemintermsoftheanswerstosmallerinstancesof thesame problem  buildsolutionstoyourrecurrencefromthebottomup writeana rithmthatstartswiththebasecasesofyourrecurrenceandworksitsway uptothe nalsolution byconsideringintermediatesubproblemsinthe correctorder thisstagecanbebrokendownintoseveralsmaller mechanicalsteps identifythesubproblems whatareallthedi erentwaysyour cursivealgorithmcancallitself startingwithsomeinitialinput theargumentto recfibo isalwaysanintegerbetween     warning greedisstupid chooseamemoizationdatastructure findadatastructurethatcan storethesolutionto subproblemyouidenti edinstep thisis butnotalways amultidimensionalarray identifydependencies exceptforthebasecases everysubproblem dependsonothersubproblchones drawapictureofyour datastructure pickagenericelement anddrawarrowsfromeachof theotherelementsitdependson thenformalizeyourpicture findagoodevaluationorder orderthesubproblemssothateachone thesubproblemsitdependson youshouldconsiderthe basecases rst thenthesubproblemsthatdependsonlyonbasecases andsoon eventuallybuildinguptotheoriginaltevelproblem dependenciesyouidenti edinthepreviousstepde neapartialorder overthesubproblems youneedto ndalinearextensionofthatpartial order becareful analyzespaceandrunningtime thenumberofdistinctsubproblems determinesthespacecomplexityofyourmemoizedalgorithm computethetotalrunningtime adduptherunningtimesofallpossible subproblems assumingdeeperrecursivecallsarealreadymemoized canactuallydothisimmediatelyafterstep writedownthealgorithm youknowwhatordertoconsiderthe subproblems andyouknowhowtosolveeachsubproblem sodothat ifyourdatastructureisanarray thisusuallymeanswritingafewnested foopsaroundyouroriginalrecurrence andreplacingtherecursive callswitharrayl ofcourse youhavetoprovethateachofthesestepsiscorrect ifyourrecurrence iswrong orifyoutrytobuildupanswersinthewrongorder youralgorithm twork  warning greedisstupid ifwe reincrediblylucky wecanbypassalltherecurrencesandtablesandsoforth andsolvetheproblemusinga greedy algorithm likeabacktrackingalgorithm greedyalgorithmconstructsasolutionthroughaseriesofdecisions butitmakes thosedecisionsdirectly solvingatanyrecursivesubproblems whilethis approachseemsverynatural italmostneverworks optimizationproblemsthat canbesolvedcorrectlybyagreedyalgorithmarequiterare manyproblemsthatshouldbesolvedbybacktrackingordynamicprogramming manystudents rstintuitionistoapplyagreedystrategy forexample agreedyalgorithmforthetextsegmentationproblemmight ndtheshortest ifyouprefer longest pre xoftheinputstringthatis   dynamicprogramming aword acceptthatpre xasthe rstwordinthesegmentation andthen recursivelysegmenttheremainingsu xoftheinputstring agreedy algorithmforthelongestincreasingsubsequenceproblemmightlookforthe smallestelementoftheinputarray acceptthatelementasthestartofthetarget subsequence andthenrecursivelylookforthelongestincreasingsubsequence totherightofthatelement ifthesesoundlikestupidhackstoyou patyourself ontheback thesearen teven close tocorrectsolutions everyoneshouldtattoothefollowingsentenceonthebackoftheirhands rightunderalltherulesaboutlogarithmsandnotation greedyalgorithmsneverwork usedynamicprogramminginstead hardlyever  becausethegreedyapproachissoincrediblytempting butsorarelycorrect istronglyadvocatethefollowingpolicyinanyalgorithmscourse forcoursesthatdonotnormallyaskforproofsofcorrectness  youwillnotreceive creditfor greedyalgorithm homeworkorexam evenifthealgorithmiscorrect withouta formal proofofcorrectness thevastmajorityofproblemsforwhichstudentsaretemptedto submitagreedyalgorithmareactuallybestsolvedusingdynamicprogramming soialwayso erthefollowingadvicetomyalgorithmsstudents wheneveryoueven wordy yoursubconsciousistellingyoutousedynamicprogramming evenforproblemsthat becorrectlysolvedbygreedyalgorithms susually moreproductivetodevelopabacktrackingordynamicprogrammingalgorithm rst firstmakeitwork thenmakeitfast wewillseetechniquesforproving greedyalgorithmscorrectinthenextchapter  theyhardlyevereverwork thengivethreecheers andonecheermore fortherigorous captainofthe pinafore thengivethreecheers andonecheermore forthecaptainofthe pinafore  introducingthispolicyinmyownalgorithmscoursessigni cantlyimprovedstudents grades becauseitsigni cantlyreducedthefrequencyofincorrectgreedyalgorithms    longestincreasingsubsequence  longestincreasingsubsequence anotherproblemweconsideredinthepreviouschapterwascomputingthe lengthofthelongestincreasingsubsequenceofagivenarray  ofnumbers wedevelopedtwodi erentrecursivebacktrackingalgorithmsforthisproblem bothalgorithmsrunin  timeintheworstcase bothalgorithmscanbe spedupsigni cantlyviadynamicprogramming firstrecurrence isthisnext rstbacktrackingalgorithmevaluatedthefunction lisbigger wede nedasthelengthofthelongestincreasingsubsequenceof whicheveryelementislargerthan wederivedthefollowingrecurrence forthisfunction lisbigger   lisbigger  max ˆ lisbigger   lisbigger  tosolvetheoriginalproblem wecanaddasentinelvalue  tothe arrayandcompute lisbigger   eachrecursivesubproblemisidenti edbytwoindices sothereare  distinctrecursivesubproblemstoconsider wecanmemoizethe sultsofthesesubproblemsintoatwonalarray lisbigger    eachsubproblemcanbesolvedin  time notcountingrecursive calls soweshouldexpectthe naldynamicprogrammingalgorithmtorunin  time theorderinwhichthememoizedrecursivealgorithm llsthisarrayis notimmediatelyclear allwecantellfromtherecurrenceisthateachentry lisbigger lledin theentries lisbigger  lisbigger  inthenextcolumn asindicatedontheleftinfigure   fortunately thispartialinformationisenoughtogiveusa valid evaluation order ifwe llthetableonecolumnatatime fromrighttoleft thenwhenever wereachanentryinthetable theentriesitdependsonarealreadyavailable thismaynotbetheorderthattherecursivealgorithmwoulduse butitworks sowe llgowithit theright gureinfigure   illustratesthisevaluationorder withadoublearrowindicatingtheouterloopandsinglearrowsindicatingthe  infact weonlyneedhalfofthisarray becausewealwayshave butevenifwecared aboutconstantfactorsinthisbook wedon thiswouldbethewrongtimetoworryabout firstmakeitwork thenmakeitbetter   dynamicprogramming figure3  subproblemdependenciesforlongestincreasingsubsequence andavalidevaluationorder innerloop inthiscase thesinglearrowsarebidirectional becausetheorder thatweuseto lleachcolumndoesn tmatter andwe redone pseudocodeforourdynamicprogrammingalgorithmis shownbelow asexpected ouralgorithmclearlyrunsin  time ifnecessary wecanreducethespaceboundfrom  bymaintainingonlythe twomostrecentcolumnsofthetable lisbigger lisbigger   fastlis   addasentinel  basecases lisbigger   downto    orwhatever  lisbigger  skip lisbigger  lisbigger skip lisbigger max skip return lisbigger   secondrecurrence snext oursecondbacktrackingalgorithmevaluatedthefunction lis rst wede nedasthelengthofthelongestincreasingsubsequenceof beginswith wederivedthefollowingrecurrenceforthisfunction lis rst  max lis rst weassumethat max  sothatthebasecaseslike lis rst  fall outoftherecurrenceautomatically tosolvetheoriginalproblem wecanadd asentinelvalue  tothearrayandcompute lis rst   inthiscase recursivesubproblemsareindicatedbyasingleindex sowe canmemoizetherecurrenceintoaononalarray lis rst   itoldyounottoworryaboutconstantfactorsyet    editdistance entry lis rst dependsonlyonentries lis rst sowecan thearrayindecreasingindexorder tocomputeeach lis rst weneedto lis rst indices butwedon tneedtoconsiderthose indices inanyparticularorder theresultingdynamicprogrammingalgorithm runsin  time anduses space fastlis2   addasentinel downto  lis rst   orwhatever  lis rst lis rst lis rst  lis rst return lis rst   tcountthesentinel  editdistance editdistance betweentwostringsistheminimumnumberofletter tions letterdeletions andlettersubstitutionsrequiredtotransformonestring intotheother forexample theeditdistancebetween food money isat mostfour ood moo mon moned money thisdistancefunctionwasindependentlyproposedbyvladimirlevenshteinin  workingoncodingtheory tarasvintsyukin1968 workingonspeech recognition andstanislawulamin1972 workingwithbiologicalsequences forthisreason editdistanceissometimescalled levenshteindistance ulam distance butstrangely neverintsyukdistan wecanvisualizethiseditingprocessbyaligningthestringsoneabovethe withagapinthe rstwordforeachinsertionandagapinthesecond wordforeachdeletion columnswithtwo erent characterscorrespondto substitutions inthisrepresentation thenumberofeditingstepsisjustthe numberofcolumnsthatdo containthesamecharactertwice food money sfairlyobviousthatwecan ttransform food money inthreesteps theeditdistancebetween food money isexactlyfour snot soeasyingeneraltotellwhenasequenceofeditsisasshortaspossible thefollowingalignmentshowsthatthedistancebetweenthestrings algorithm altruistic atmost  isthatthebestwecando   dynamicprogramming algorithm altruistic recursivestructure todevelopadynamicprogrammingalgorithmtocomputeeditdistance rst needtoformulatetheproblemrecursively ouralignmentrepresentationforedit sequenceshasacruciallsubstruproperty supposewehavethe gaprepresentationfortheshortesteditsequencefortwostrings ifweremove thelastcolumn theremainingcolumnsmustrepresenttheshortestedit sequencefortheremainingpre xes wecaneasilyprovethisobservation bycontradiction ifthepre xeshadashortereditsequence gluingthelast columnbackonwouldgivesusashortereditsequencefortheoriginalstrings sooncewe gureoutwhatshouldhappeninthelastcolumn therecursion fairycan gureouttherestoftheoptimalgaprepresentation saiddi erently thealignmentwearelookingforrepresentsasequenceof editingoperations ordered fornoparticularreason fromrighttoleft solving theeditdistanceproblemrequiresmakingasequenceofdecisions oneforeach columnintheoutputalignment inthemiddleofthissequenceofdecisions havealreadyalignedasu xofonestringwithasu xoftheother algor altru becausethecostofanalignmentisjustthenumberofmismatchedcolumns ourremainingdecisionsdon tdependontheeditingoperationswe vealready chosen theyonlydependonthepre xeswehaven talignedyet algor altru foranytwoinputstrings   wecanformulatetheedit distanceproblemrecursivelyasfollows foranyindices edit denotetheeditdistancebetweenthepre xes   weneedto compute edit recurrence arebothpositive thereareexactlythreepossibilitiesforthelast columnintheoptimalalignmentof   insertion thelastentryinthetoprowisempty inthiscase theedit distanceisequalto edit    isthecostofthe nalinsertion    editdistance andtherecursiveexpressiongivestheminimumcostfortheremaining alignment algor altr deletion thelastentryinthebottomrowisempty inthiscase theedit distanceisequalto edit    isthecostofthe naldeletion andtherecursiveexpressiongivestheminimumcostfortheremaining alignment algo altru substitution bothrowshavecharactersinthelastcolumn ifthesetwo charactersaredi erent thentheeditdistanceisequalto edit    ifthesetwocharactersareequal thesubstitutionisfree sotheeditdistance edit   algo altr algo alt thisgenericcaseanalysisbreaksdownifeither   butthose boundarycasesareeasytohandledirectly transformingtheemptystringintoastringoflength requires insertions edit  transformingastringoflength intotheemptystringrequires deletions edit  asasanitycheck bothofthesebasecasescorrectlyindicatethattheedit distancebetweentheemptystringandtheemptystringiszero weconcludethatthe edit functionsatis esthefollowingrecurrence edit    min  edit   edit   edit     dynamicprogramming nowthatwehavearecurrence wecantransformitintoadynamicprogramming algorithmfollowingourusualmechanicalrecipe subproblems eachrecursivesubproblemisidenti edbytwoindices     dynamicprogramming memoizationstructure sowecanmemoizeallpossiblevaluesof edit inatwonalarray edit   dependencies eachentry edit dependsonlyonitsthreeneighboring entries edit  edit  edit   evaluationorder ifwe llthisarrayinstandardrowby rowfromtopdown eachrowfromlefttowheneverwereachan entryinthearray alltheentriesitdependsonarealreadyavailable tthe evaluationorderwecoulduse butitworks solet sgowithit spaceandtime thememoizationstructureuses space wecan computeeachentry edit  timeonceweknowitspredecessors sotheoverallalgorithmrunsin time hereistheresultingdynamicprogrammingalgorithm editdistance    edit   edit   ins edit   del edit   rep edit   rep edit    edit min ins del rep return edit thisalgorithmismostcommonlyattributedtorobertwagnerandmichael fischer whodescribedthealgorithmin1974 infullcompliance withstigler slawofeponymy eitheridenticalormoregeneralalgorithms wereindependentlydiscoveredbytarasvintsyukin1968 velichkoand zagoruykoin1970 davidsanko in1972 petersellersin1974    editdistance almostcertainlyseveralothers  interestingly oftheseauthorsciteeither levenshteinorulam thememoizationtablefortheinputstrings algorithm altruistic shownbelow boldnumbersindicateplaceswherecharactersinthetwostrings areequal theeditdistancebetween algorithm altruistic isindeedsix                                                              thearrowsinthistableindicatewhichpredecessor actuallyde eachentry eachdirectionofarrowcorrespondstoadi erenteditoperation horizontal deletion vertical insertion anddiagonal substitution boldred diagonalarrowsindicatesubstitutionsofaletterforitself anypathof arrowsfromthetopleftcornertothebottomrightcornerofthistablerepresents anoptimaleditsequencebetweenthetwostrings theexamplememoization arraycontainsexactlythreedirectedpathsfromthetopleftcornertothebottom rightcorner eachindicatingadi erentsequenceofsixeditstransforming algorithm altruistic asshownonthenextpage  thisalgorithmissometimesalso incorrectly attributedtosaulneedlemanandchristian wunschin1970 needlwunschamorecommonlyreferstothestandard dynamicprogrammingalgorithmforcomputingthelongestcommonsubsequenceoftwostrings orequivalently theeditdistancewhereonlyinsertionsanddeletionsarepermitted time butthatattributionis incorrect infact needlemanandwunsch salgorithmcomputes weighted longestcommonsubsequences possiblywithgapcosts   time usinga erentrecurrence sanko explicitlydescribeshis algorithmasanimprovement ofneedlemanandwunsch salgorithm   dynamicprogramming algorithm altruistic algorithm altruistic algorithm altruistic editdistance algorithmdoesnotactuallycomputeorstoreanyarrows inthetable butthearrow leadingintoanyentryinthetablecanbe reconstructedonthe yin  timefromthenumericalvalues lledinthetable wecanreconstructtheshortesteditsequencein additionaltime  subsetsum recallthatthe subsetsum problemaskswhetheranysubsetofagivenarray  ofpositiveintegerssumstoagiveninteger inthepreviouschapter wedevelopedarecursivesubsetsumalgorithmthatcanbereformulatedas fixtheoriginalinputarray  andde nethebooleanfunction true ifandonlyifsomesubsetof sumsto weneedtocompute  thisfunctionsatis esthefollowingrecurrence  true  false   _  wecantransformthisrecurrenceintoadynamicprogrammingalgorithm followingtheusualboilerplate subproblems eachsubproblemisdescribedbyaninteger suchthat   andaninteger subproblemswith  trivial soitseemsrathersillytomemoizethem  wecanmodify therecurrencesothatthosesubproblemsneverarise  true  false   _   mbreakingmyownruleagainstprematureoptimization    optimalbinarysearchtrees datastructure wecanmemoizeourrecurrenceintoatwonal array    storesthevalueof evaluationorder eachentry dependsonatmosttwootherentries bothoftheform  sowecan llthearraybyconsideringrows frombottomtotopintheouterloop andconsideringtheelementsineach rowinarbitraryorderintheinnerloop spaceandtime thememoizationstructureuses space   arealreadyknown wecancompute inconstant time sothealgorithmrunsin time hereistheresultingdynamicprogrammingalgorithm fastsubsetsum    true   false downto   true    avoidthecase   _  return  thewserunningtime forthisalgorithmisasigni improvementoverthe  recursivebacktrackingalgorithmwhen small  ifthetargetsum issigni cantlylargerthan  thisiterative algorithmisactuallyslowerthanthenaïverecursivealgorithm becauseit wastingtimesolvingsubproblemsthattherecursivealgorithmneverconsiders dynamicprogrammingisn animprovement   optimalbinarysearchtrees nalproblemweconsideredinthepreviouschapterwastheoptimalbinary searchtreeproblem theinputisasortedarray  ofsearchkeysandan array  offrequencycounts isthenumberoftimeswewill  eventhoughthesubsetsumproblemisthistimebounddoes implythatp np isnotnecessarilyboundedbyapolynomialfunctionoftheinputsize  inthe1967researchmemorandum whereheproposedmemofunctions donaldmichie wrote otabulatevaluesofafunctionwhichwillnotbeneededisawasteofspace andto recomputethesamevaluesmorethanonceisawasteofbutinfact tabulatingvaluesofa functionthatwillnotbeneededisalsoawasteof time   dynamicprogramming searchfor ourtaskistoconstructabinarysearchtreeforthatsetsuch thatthetotalcostofallthesearchesisassmallaspossible fixthefrequencyarray andlet optcost denotethetotalsearchtime intheoptimalsearchtreeforthesubarray wederivedthefollowing recurrenceforthefunction optcost optcost   min optcost  optcost  youcanprobablyguesswhatwe regoingtodowiththisrecurrenceeventually butlet sridofthatuglysummation rst foranypairofindices denotethetotalfrequencycountfor allthekeysintheinterval thisfunctionsatis esthefollowingsimplerecurrence  wecancomputeallpossiblevaluesof  timeuouguessed amicprogramming theusualmechanicalstepsgiveusthefollowing dynamicprogrammingalgorithm initf      wewillusethisshortalgorithmasaninitializationsubroutine thisinitialization allowsustosimplifytheoriginal optcost recurrenceasfollows optcost   min optcost  optcost  nowlet sturnthecrank    optimalbinarysearchtrees subproblems eachrecursivesubproblemisspeci edbytwointegers suchthat    memoization wecanstoreallpossiblevaluesof optcost inatw dimensionalarray optcost    onlytheentries optcost  willactuallybeused butwhatever dependencies eachentry optcost dependsontheentries optcost  optcost  forall suchthat inotherwords eachtableentrydependsonallentrieseitherdirectlytotheleftordirectly thefollowingsubroutine llstheentry optcost assumingallthe entriesitdependsonhavealreadybeencomputed computeoptcost optcost  tmp optcost  optcost  optcost tmp optcost tmp optcost optcost evaluationorder thereareatleastthreedi erentordersthatcanbe usedto llthearray rstonethatoccurstomoststudentsistoscan throughthetableonediagonalatatime startingwiththetrivialbasecases optcost  andworkingtowardthe nalanswer optcost  likeso optimalbst  initf    optcost      orwhatever computeoptcost return optcost  wecouldalsotraversethearrayrowbyrowfromthebottomup traversing eachrowfromlefttoright orcolumnbycolumnfromlefttoright traversing eachcolumnsfromthebottomup   dynamicprogramming optimalbst2  initf   downto  optcost   computeoptcost return optcost  optimalbst3  initf    optcost   downto  computeoptcost return optcost  asbefore wecanillustratetheseevaluationordersusingadoubled arrowtoindicatetheouterloopandsinglinedarrowstoindicatetheinner loop thebidirectionalarrowsinthe rstevaluationorderindicatethatthe orderoftheinnerloopsdoesn tmatter timeandspace thememoizationstructureuses  space nomatter whichevaluationorderwechoose weneed timetocomputeeach entry optcost soouroverallalgorithmrunsin  time asusual wecouldhavepredictedthe nalspaceandtimeboundsdirectlyfrom theoriginalrecurrence optcost   min optcost  optcost  optcost functionhastwoarguments eachofwhichcantakeonroughly erentvalues soweprobablyneedadatastructureofsize  onthe otherhand thereare variablesinthebodyoftherecurrence eachofwhichcantakeroughly erentvalues soitshouldtake  time tocomputeeverything  dynamicprogrammingontrees sofar allofourdynamicprogrammingexamplesusemultidimensionalarrays tostoretheresultsofrecursivesubproblems asthenextexample thisisnotalwaysthemostappropriatedatastructuretouse independentset inagraphisasubsetoftheverticeswithnoedges betweenthem findingthelargestindependentsetinanarbitrarygraphis extremelyhard infact thisisoneofthecanonicalproblemswewill    dynamicprogrammingontrees studyinchapter  butinsomespecialclassesofgraphs wecan ndlargest independentsetsquickly inparticular whentheinputgraphisa tree vertices wecanactuallycomputethelargestindependentsetin time supposewearegivenatree withoutlossofgenerality suppose isa rootedtree thatis thereisaspecialnodein calledthe root andalledgesare implicitlydirectedawayfromthisvertex isanunrootedconnected acyclicundirectedgraecanchooseanarbitraryvertexastheroot callvertex descendant ofvertex iftheuniquepathfrom totheroot includes equivalently thedescendantsof itselfandthedescendants ofthechildrenof subtreerootedat consistsofallthedescendantsof andtheedgesbetweenthem foranynode mis denotethesizeofthelargestindependentset inthesubtreerootedat anyindependentsetinthissubtreethatexcludes itselfistheunionofindependentsetsinthesubtreesrootedatthechildrenof ontheotherhand anyindependentsetthat includes necessarilyexcludesall schildren andthereforeincludesindependentsetsinthesubtreesrooted sgrandchildren thefunction mis obeysthefollowingrecurrence wherethenonstandardnotation isachildof mis max mis  mis weneedtocompute mis istherootof figure3  computingthemaximumindependentsetinatree whatdatastructureshouldweusetomemoizethisrecurrence themost naturalchoiceis thetree speci cally foreachvertex westore theresultof mis inanew eld mis inprinciple useanarray butthenwe dneedpointersbackandforthbetweeneachnodeandits correspondingarrayentry sowhybother sagoodordertoconsiderthesubproblems thesubproblema atedwithanynode dependsonthesubproblemsassociatedwiththechildren andgrandchildrenof sowecanvisitthenodesinanyorderwelike provided thateveryvertexisvisitedbeforeitsparent inparticular wecanuseastandard traversal stherunningtimeofthealgorithm thenovetimeassociated witheachnode isproportionaltothenumberofchildrenandgrandchildren   dynamicprogramming thisnumbercanbeverydi erentfromonevertextothenext butwecan turntheanalysisaround eachvertexcontributesaconstantamountoftimeto itsparentanditsgrandparent becauseeachvertexhasatmostoneparentand atmostonegrandparent thealgorithmrunsin time hereistheresultingdynamicprogrammingalgorithm sstillrecursive becausethat sthemostnaturalwaytoimplementapotreetraversal treemis skipv  foreachchild skipv skipv treemis keepv  foreachgrandchild keepv keepv mis mis max keepv skipv return mis wecanderiveanevensimplerlinalgorithmbyde ningtwoseparate functionsoverthenodesof misyes denotethesizeofthelargestindependentsetofthesubtree rootedat includes misno denotethesizeofthelargestindependentsetofthesubtree rootedat excludes weneedtocompute max misyes misno istherootof rsttwofunctionssatisfythefollowingmutualrecurrence misyes  misno misno max misyes misno wecanmemoizethesefunctionsintothetreeitself byde ningtwo eldsforeachvertex astraightforwardpotreetraversalevaluates bothfunctionsateverynodein time thefollowingalgorithmnotonly memoizesbothfunctionvaluesat italsoreturnsthelargerofthosetwo values treemis2 misno  misyes  foreachchild misno misno treemis2 misyes misyes misno return max misyes misno  exercises inthesecondlineoftheinnerloop weareusingthevalue misno thatwas memoizedbytherecursivecallinthepreviousline exercises forallofthefollowingmoregenerallywhendeveloping newdynamicprogrammingastronglyrecommendfollowingthe stepsoutlinedinsection   inparticular teven start thinkingabout tablesorfoopsuntilyouhaveacompleterecursivesolution includingaclear englishspeci cationoftherecursivesubproblemsyouareactuallysolving  firstmakeitwork thenmakeitfast sequences arrays  inapreviouslife youworkedasacashierinthelostantarcticancolony ofnadiria spendingthebetterpartofyourdaygivingchangetoyour customers becausepaperisaveryrareandvaluableresourceinantarctica cashierswererequiredbylawtousethefewestbillspossiblewhenever theygavechange thankstothenumerologicalpredilectionsofoneofits founders thecurrencyofnadiria calledars wasavailablein thefollowingdenominations          thegreedychangealgorithmrepeatedlytakesthelargestbillthatdoes notexceedthetargetamount forexample tomake usingthe greedyalgorithm rsttakea bill thena bill nally bills giveanexamplewherethisgreedyalgorithmusesmore arbillsthantheminimumpossible hint itmaybeeasier towriteasmallprogramthantoworkthisoutbyhand describeandanalyzearecursivealgorithmthatcomputes givenan integer theminimumnumberofbillsneededtomake dollars tworryaboutmakingyouralgorithmfast justmakesure scorrect describeadynamicprogrammingalgorithmthatcomputes givenan integer theminimumnumberofbillsneededtomake ars thisoneneedstobefast  inmyalgorithmsclasses anydynamicprogrammingsolutionthatdoes includean englishspeci cationoftheunderlyingrecursivesubproblemsautomaticallygetsascoreof evenifthesolutionisotherwiseperfect introducingthispolicysigni cantlyimproved students grades becauseitsigni cantlyreducedthenumberoftimestheysubmittedincorrect orincoherent dynamicprogrammingalgorithms  formoredetailsonthehistoryandcultureofnadiria includingimagesofthevarious denominationsofars moneyart biz   dynamicprogramming  describee cientalgorithmsforthefollowingvariantsofthetext tationproblem assumethatyouhaveasubroutine isword thattakes anarrayofcharactersasinputandreturns true ifandonlyifthatstring isaanalyzeyouralgorithmsbyboundingthenumberofcallsto isword givenanarray  ofcharacters computethenumberofpartitions intowords forexample giventhestring artistoil youralgorithm shouldreturn  forthepartitions artist oil art toil giventwoarrays   ofcharacters decidewhether canbepartitionedintowordsatthesameindices forexample thestrings bothearthandsaturnspin pinstartrapsandragslap canbepartitionedintowordsatthesameindicesasfollows bot heart hand sat urns pin pin start raps rags lap giventwoarrays   ofcharacters computethenumber ofdi erentwaysthat canbepartitionedintowordsatthesame indices  supposeyouaregivenanarray  ofnumbers whichmaybepositive negative orzero andwhichare necessarilyintegers describeandanalyzeanalgorithmthat ndsthelargestsumofelements inacontiguoussubarray describeandanalyzeanalgorithmthat ndsthelargest product elementsinacontiguoussubarray forexample giventhearray        asinput rst algorithmshouldreturn  andyoursecondalgorithmshouldreturn  sum     product  giventheonementarray  asinput rstalgorithmshould return  andyoursecondalgorithmshouldreturn  theemptyintervalis stillaninterval forthesakeofanalysis assumethatcomparing adding ormultiplyinganypairofnumberstakes  time hint hasbeenastandardcomputerscienceinterviewquestion sinceatleastthemiyoucan ndmanycorrectsolutionsonthe web theproblemevenhasitsown wikipediapage butatleastin2016 signi cantfractionofthesolutionsifoundonthewebforpart eitherslowerthannecessaryoractuallyincorrect  exercises  thisexerciseexploresvariantsofthemaximyproblem lem  inallcases yourinputconsistsofanarray  ofrealnumbers whichcouldbepositive negative orzero andpossiblyanadditional integer  wrappingaround suppose isa circular array inthissetting ntiguoussubarracanbeeitheraninterval orasu xfollowed byapre  describeandanalyzeanalgorithmthat ndsacontiguoussubarrayof withthelargestsum longsubarraysonly describeandanalyzeanalgorithmthat ndsa contiguoussubarrayof oflengthatleast thathasthelargestsum assume shortsubarraysonly describeandanalyzeanalgorithmthat ndsa contiguoussubarrayof oflengthatmost thathasthelargestsum thepriceisright describeandanalyzeanalgorithmthat ndsa contiguoussubarrayof withthelargestsum lessthanorequalto describeafasteralgorithmforproblem  wheneverynumberinthe array isnoegative  thisexerciseasksyoutodevelope cientalgorithmsto ndoptimal quences ofvariouskinds asubsequenceisanythingobtainedfromasequence byextractingasubsetofelements butkeepingtheminthesameorder elementsofthesubsequenceneednotbecontiguousintheoriginalsequence forexample thestrings damn yaioai dynamicprogramming areall subsequencesofthestring dynamicprogramming hint exactlyoneoftheseproblemscanbesolvedin timeusinga greedyalgorithm   betwoarbitraryarrays common sequence isanothersequencethatisasubsequenceofboth describeane cientalgorithmtocomputethelengthofthe longest commonsubsequenceof   betwoarbitraryarrays commonsuper sequence isanothersequencethatcontainsboth subsequences describeane cientalgorithmtocomputethelengthof shortest commonsupersequenceof callasequence  ofnumbers bitonic ifthereisanindex  suchthatthepre  isincreasingandthesu isdecreasing describeane cientalgorithmtocomputethe lengthofthelongestbitonicsubsequenceofanarbitraryarray integers   dynamicprogramming callasequence  ofnumbers oscillating  alleven  forallodd describeane cient algorithmtocomputethelengthofthelongestoscillatingsubsequence ofanarbitraryarray ofintegers describeane cientalgorithmtocomputethelengthoftheshortest oscillatingsupersequenceofanarbitraryarray ofintegers callasequence  ofnumbers convex    forall describeane cientalgorithmtocomputethelengthofthe longestconvexsubsequenceofanarbitraryarray ofintegers callasequence  ofnumbers weaklyincreasing ifeachelement islargerthantheaverageofthetwopreviouselements thatis    forall  describeane cientalgorithmto computethelengthofthelongestweaklyincreasingsubsequenceofan arbitraryarray ofintegers callasequence  ofnumbers doublcreasing  forall  inotherwords adoublcreasingsequenceisaperfect shu eoftwoincreasingsequences describeane cientalgorithmto computethelengthofthelongestdoublcreasingsubsequenceofan arbitraryarray ofintegers recallthatasequence  ofnumbersis increasing  forall describeane cientalgorithmtocomputethelengthofthe longestcommonincreasingsubsequence oftwogivenarraysofintegers       isthelongestcommonincreasingsubsequence ofthesequences                                  shu oftwostrings isformedbyinterspersingthecharacters intoanewstring keepingthecharactersof inthesameorder forexample thestring bananaananas isashu eofthestrings banana ananas inseveraldi erentways banana ananas ban ana ana nas thestrings prodgyrnamammiincg dyprongarmammicing bothshu esof dynamic programming pro nam ammi pro amm ing giventhreestrings    describeand analyzeanalgorithmtodeterminewhether isashu eof smooth shu eof isashu eof thatneveruses morethantwoconsecutivesymbolsofeitherstring forexample  exercises mm isasmoothshu eofthestrings dynamic programming ogr mm ing isashu eof dynamic programming itisnotasmoothshu becauseofthesubstrings ogr ing isasmoothshu eofthestrings xxxxxxx xxxxxxxxxxx thereisnosmoothshu eofthestrings xxxx xxxxxxxxxxxx describeandanalyzeanalgorithmtodecide giventhreestrings isasmoothshu eof  foreachofthefollowingproblems theinputconsistsoftwoarrays   describeandanalyzeanalgorithmtodecidewhether isasubsequence forexample thestring ppap isasubsequenceofthestring ine ppleapple describeandanalyzeanalgorithmto ndthesmallestnumberofsymbols thatcanberemovedfrom sothat isnolongerasubsequence equivalently youralgorithmshould ndthelongestsubsequenceof thatis asupersequenceof forexample afterremovingremoving twosymbolsfromthestring penpine pple pplepen thestring ppap nolongerasubsequence ª describeandanalyzeanalgorithmtodeterminewhether occursas disjoint subsequencesof forexample thestring ppap appearsas twodisjointsubsequencesinthestring ine ple supposetheinputalsoincludesathirdarray  ofnumbers maybepositive negative orzero isthe cost andanalyzeanalgorithmtocomputetheminimstoccurrenceof asasubsequenceof thatis wewantto ndanarray   foreveryindex andthetotal cost  isassmallaspossible describeandanalyzeanalgorithmtocomputethetotalnumberof possiblyoverlapping occurrencesof asasubsequenceof purposesofanalysis assumethatwecanaddtwoarbitraryintegersin  time forexample thestring ppap appearsexactly23timesasa subsequenceofthestring penpineappleapplepen ifallcharactersin areequal youralgorithmshouldreturn whatistherunningtimeofyouralgorithmforpart ifaddingtwo integersrequires time   dynamicprogramming  describeandanalyzeane cientalgorithmto ndthelengthofthelongest contiguoussubstringthatappearsbothforwardandbackwardinaninput string  theforwardandbackwardsubstringsmustnotoverlap hereareseveralexamples giventheinputstring algorithm youralgorithmshouldreturn  giventheinputstring ecur sion youralgorithmshouldreturn  thesubstring giventheinputstring redi vide youralgorithmshouldreturn  forthe substring edi theforwardandbackwardsubstringsmustnotoverlap giventheinputstring dynam icprogrammingmany times youralgorithm shouldreturn  forthesubstring ynam inparticular itshould return  forthesubsequence ynamir  apalindromeisanystringthatisexactlythesameasitsreversal deed racecar amanaplanacatacanalpanama describeandanalyzeanalgorithmto ndthelengthofthe longest subsequence ofagivenstringthatisalsoapalindrome forexample thelongestpalindromesubsequenceofthestring icp amzlet eshow mhymrormyhm thatstringasinput youralgorithmshouldreturn  describeandanalyzeanalgorithmto ndthelengthofthe shortest supersequence ofagivenstringthatisalsoapalindrome forexample theshortestpalindromesupersequenceof twentyone twent yo wt sogiventhestring twentyone asinput youralgorithmshouldreturn  anystringcanbedecomposedintoasequenceofpalindromes thestring bubbaseesabanana baseesabanancanbe brokenintopalindromesinthefollowingways and65others bub baseesab anana bb aseesa anana bub sees aba ana bb nan describeandanalyzeane cientalgorithmto ndthesmallestnumber ofpalindromesthatmakeupagiveninputstring forexample theinputstring bubbaseesabanana youralgorithmshouldreturn  describeandanalyzeane cientalgorithmto ndthelargestinteger suchthatagivenstringcanbesplitintopalindromesoflengthatleast forexample  exercises giventhestring palindrome youralgorithmshouldreturn  giventhestring bubbaseesabanana youralgorithmshouldreturn  forthepartition bub baseesab anana givenastringof identicalsymbols youralgorithmshouldreturn describeandanalyzeane cientalgorithmto ndthenumberof erentwaysthatagivenstringcanbedecomposedintopalindromes forexample giventhestring palindrome youralgorithmshouldreturn  giventhestring bubbaseesabanana youralgorithmshouldreturn  givenastringof identicalsymbols youralgorithmshouldreturn   ª metapalindrome isadecompositionofastringintoasequenceof palindromes suchthatthesequenceofpalindromelengthsisitselfa palindrome forexample bob mam aseesa uku ele isametapalindromeforthestring bobsmamaseesaukulele whoselength sequenceisthepalindrome        describeandanalyzean cientalgorithmto ndthelengthoftheshortestmetapalindromefora givenstring forexample giventheinputstring bobsmamaseesaukulele youralgorithmshouldreturn11  supposeyouaregivenanarray  ofpositiveintegers increa ingorthsubsequence isansequenceofindices  withthe followingproperties  forall  forall iseven  isodd  lessformally supposewearegivenanarrayof squares eachcontaininga positiveinteger supposeweplaceatokenononeofthesquares andthen repeatedlymovethetokenleft ifit sonansquare orright ifit sonanevsquare alwaysmovingfromasmallernumber toalargernumber thenthesequenceoftokenpositionsisanincreasing orthsubsequence describeanalgorithmtocomputethelengthofthelongestincreasing orthsubsequenceofagivenarrayof integers forexample giventheinputarray   dynamicprogramming                                         youralgorithmshouldreturntheinteger  whichisthelengthofthe followingincreasingorthsubsequence                    supposewewanttotypesetaparagraphoftextontoapieceofpaper orif youinsist acomputerscreen thetextconsistsofasequenceof wherethe thwordhaslength wewanttobreaktheparagraphinto severallinesoftotallengthexactly forexample accordingtot programusedtotypesetthesenotes theparagraphyouarereadingright isapproximately11 cm ˇ  incheswide dependingonhowtheparagraphisbrokenintolinesoftext wemust insertdi erentamountsofwhitespacebetweenthewords theparagraph shouldbefullyjusti meaningthatthe rstcharacteroneachlinestarts attheleftmargin exceptforthelastline thelastcharacteroneachline endsattherightmargin theremustbeatleastoneunitofwhitespace betweenanytwowordsonthesameline theparagraphyouarereading rightnow justlikethat nethe slop ofaparagraphlayoutasthesumoveralllines thelast ofthecubeoftheamountofextrapaceineachline countingtheoneunitofrequiredspacebetweeneachadjacentpairofwords speci cally ifalinecontainswords thentheslopofthatlineis nedtobe  describeadynamicprogramming algorithmtoprinttheparagraphwithminimumslop  youandyournephewelmodecidetoplayasimplecard game atthebeginningofthegame thecardsaredealtfaceupinalong row eachcardisworthadi erentnumberofpoints afterallthecardsare dealt youandelmotaketurnsremovingeithertheleftmostorrightmost cardfromtherow untilallthecardsaregone ateachturn youcandecide whichofthetwocardstotake thewinnerofthegameistheplayerthat hascollectedthemostpointswhenthegameends havingnevertakenanalgorithmsclass elmofollowstheobviousgreedy shisturn elmo takesthecardwiththehigher pointvalue yourtaskisto ndastrategythatwillbeatelmowhenever itmightseemmeantobeatuponalittlekidlikethis butelmo absolutely hates itwhengrolethimwin provethatyoushouldnotalsousethegreedystrategy thatis thatthereisagamethatyoucanwin butonlyifyoudo followthe samegreedystrategyaselmo  exercises describeandanalyzeanalgorithmtodetermine giventheinitial quenceofcards themaximumnumberofpointsthatyoucancollect playingagainstelmo whenelmowasfour heusedanevensimplernhisturn healwayschosehisnextcarduniformlyatrandom thatis ifthere wasmorethanonecardleftonhisturn hewouldtaketheleftmost cardwithprobability   andtherightmostcardwithprobability   describeanalgorithmtodetermine giventheinitialsequenceofcards themaximum expected numberofpointsyoucancollectplayingagainst foo fiveyearslater elmohasbecomea stronger player describeandanalyzeanalgorithmtodetermine giventheinitial sequenceofcards themaximumnumberofpointsthatyoucancollect playingagainsta perfect opponent  salmosttimetoshowo ippin sweetdancingskills tomorrowis thebigdancecontestyou vebeentrainingforyourentirelife exceptforthat summeryouspentwithyouruncleinalaskahuntingwolverines obtainedanadvancecopyofthelistof songsthatthejudgeswillplay duringthecontest inchronologicalorder yessssssssss youknowallthesongs allthejudges andyourowndancingability extremelywell foreachinteger youknowthatifyoudancetothe songontheschedule youwillbeawardedexactly score points butthen youwillbephysicallyunabletodanceforthenext wait songs thatis youcannotdancetosongs  wait thedancerwiththe highesttotalscoreattheendofthenightwinsthecontest soyouwantyour totalscoretobeashighaspossible describeandanalyzeane cientalgorithmtocomputethemaximum totalscoreyoucanachieve theinputtoyoursweetalgorithmisthepairof arrays score  wait   thenewswaegame candyswapsagaxiii involves cuteanimals numberedfrom  eachanimalholdsoneofthreetypesofcandy circuspeanuts heathbars andcioccolateriagardinichocolatetru alsohaveacandyinyourhand atthestartofthegame youhaveacircus peanut toearnpoints youvisiteachoftheanimalsinorderfrom  eachanimal youcaneitherkeepthecandyinyourhandorexchangeit withthecandytheanimalisholding ifyouswapyourcandyforanothercandyofthe type youearn onepoint   dynamicprogramming ifyouswapyourcandyforacandyofa erent type youloseonepoint yourscorecanbenegative ifyouvisitananimalanddecidenottoswapcandy yourscoredoesnot change visittheanimalsinorder andonceyouvisitananimal youcan nevervisititagain describeandanalyzeane cientalgorithmtocomputeyourmaximum possiblescore yourinputisanarray  isthetypeof candythatthe thanimalisholding  lennyrutenbar thefoundingdeanofthenewmaksymilianr levchin collegeofcomputerscience hascommissionedaseriesofsnowrampson thesouthslopeoftheorcharddownssleddinghill  andchallengedbill kudeki headofthedepartmentofelectricalandcomputerengineering asleddingcontest billandlennywillbothsleddownthehill eachtryingto maximizetheirairtime thewinnergetstoexpandtheirdepartment college intobothsiebelcenterandthenewecebuilding theloserhastomove theirentiredepartment collegeintheboneyardculvertnexttoloomislab wheneverlennyorbillreachesaramp whileontheground theycan eitherusethatramptojumpthroughtheair yingoveroneor moreramps orsledpastthatrampandstayontheground iesoveraramp theycannotusethatramptoextendtheirjump supposeyouaregivenapairofarrays ramp  length  ramp isthedistancefromthetopofthehilltothe thramp length isthedistancethatanysledderwhotakesthe thrampwill travelthroughtheair describeandanalyzeanalgorithmtodetermine themaximumtotaldistancethatlennyorbillcanspendintheair theuniversitylawyersheardaboutlennyandbill slittlebetand immediatelyobjected toprotecttheuniversityfromeitherlawsuits orsinsurancerates theyimposeanupperboundonthe numberofjumpsthateithersleddercantake describeandanalyze analgorithmtodeterminethemaximumtotaldistancethatlennyor billcanspendintheair withatmost jumps giventheoriginalarrays ramp  length  andtheinteger asinput ª whenthelawyersrealizedthatimposingtheirrestrictiondidn atelyshutdownthecontest theyaddedanewrestriction norampcan beusedmorethanonce disgustedbythelegalinterference lennyand billgiveupontheirbetanddecidetocooperatetoputonagoodshow  thenorthslopeisfaster buttooshortforaninterestingcontest  exercises forthespectators describeandanalyzeanalgorithmtodeterminethe maximumtotaldistancethatlennyandbillcanspendintheair takingatmost jumps soatmost  jumpstotal andwitheachramp usedatmostonce  farmersboggis bunce andbeanhavesetupanobstaclecourseformr fox thecourseconsistsofalongrowofbooths eachwithanumberpaintedon thefrontwithbrightredpaint formally foxisgivenanarray  isthenumberpaintedonthefrontofthe thbooth eachnumber couldbepositive negative orzero everyoneagreeswiththefollowing rules ateachbooth fox sayeitheror ifmr foxsaysatthe thbooth heearnsarewardof chickens  foxpaysapenaltyof chickens ifmr foxsaysatthe thbooth hepaysapenaltyof chickens  foxearnsarewardof chickens foxisforbiddentosaythesamewordmorethanthreetimesina row forexample ifhesaysatbooths6  and8 thenhemust sayatbooth9 allaccountswillbesettledattheend aftermr foxvisitseverybooth andtheumpirecallsotmr foxdoesnotactuallyhavetocarry chickensthroughtheobstaclecourse finally ifmr foxviolatesanyoftherules orifheendstheobstacle courseowingthefarmerschickens thefarmerswillshoothim describeandanalyzeanalgorithmtocompute thelargestnumberof chickensthatmr foxcanearnbyrunningtheobstaclecourse giventhe array  ofnumbersasinput hint watchoutfortheburningpine cone  dancedancerevolution isadancevideogame rstintroducedinjapan bykonamiin1998 playersstandonaplatformmarkedwithfourarrows pointingforward left andright arrangedinacrosspattern play thegameplaysasongandscrollsasequenceof arrows ü ü ü ü fromthebottomtothetopofthescreen attheprecisemoment eacharrowreachesthetopofthescreen theplayermuststeponthe correspondingarrowonthedanceplatform thearrowsaretimedsothat llstepwiththebeatofthesong youareplayingavariantofthisgamecalledoguevoguerevolutio wherethegoalistoplayperfectlybutmoveaslittleaspossible whenan arrowreachesthetopofthescreen ifoneofyourfeetisalreadyonthe   dynamicprogramming correctarrow youareawardedonestylepointformaintainingyourcurrent pose ifneitherfootisontherightarrow youmustmoveone footfromitscurrentlocationtothecorrectarrowontheplatform ifyou eversteponthewrongarrow orfailtosteponthecorrectarrow ormove morethanonefootatatime ormoveeitherfootwhenyouarealready standingonthecorrectarrow allyourstylepointsaretakenawayandyou losethegame howshouldyoumoveyourfeettomaximizeyourtotalnumberofstyle points forpurposesofthisproblem assumeyoualwaysstartwithyourleft footon ü andyourrightfooton ü andthatyou vememorizedtheentire sequenceofarrows forexample ifthesequenceis ü ü ü ü ü ü ü ü canearn  stylepointsbymovingyourfeetasshownbelow prove thatfor sequenceof arrows itispossibletoearnatleast   stylepoints describeane cientalgorithmto ndthemaximumnumberofstyle pointsyoucanearnduringagivenvvrroutine theinputtoyour algorithmisanarray arrow  containingthesequenceofarrows  considerthefollowingsolitaireformofscrabble webeginwitha xed nitesequenceoftiles eachtilehasbothaletterandanumericalvalue thestartofthegame wedrawthe rstseventilesfromthesequenceand putthemintoourhand ineachturn weformanenglishwordfromsome orallofthetilesinourhand placethosetilesonthetable andreceivethe totalvalueofthosetilesaspoints ifnoenglishwordcanbeformedfrom thetilesinourhand thegameimmediatelyends thenwerepeatedlydraw thenexttilefromthestartofthesequenceuntileither wehaveseven tilesinourhand thesequenceisempty nodouble triple word letterscores bingos blanks orpassing ourgoalistoobtainas manypointsaspossible forexample considerthefollowingsequenceof20tiles                     giventhissequenceoftilesatthebeginningofthegame wecanearn68 pointsasfollows weinitiallydraw        playtheword      for9points leaving   inhand  exercises drawthenext vetiles      playtheword      for15points leaving   inhand drawthenext vetiles      playtheword     for19points leaving    inhand drawthelastthreetiles    playtheword     for16points leaving   inhand playtheword   for9points emptyingourhandandendingthe game supposethesequenceoftilesisrepresentedbytwoarrays letter  containingasequenceoflettersbetween isthevalueofanytilewithletter designandanalyzean cientalgorithmtocomputethemaximumnumberofpointsthatcan beearnedfromthegivensequenceoftiles nowsupposetwotileswiththesamelettermighthavedi erentvalues nowthetilesequenceisrepresentedbytwoarrays letter   isthevalueofthe thtile designand analyzeane cientalgorithmtocomputethemaximumnumberof pointsthatcanbeearnedfromthegivensequenceoftiles inbothproblems theoutputisasinglenumber themaximumpossible score assume becauseit strue thatyoucan ndallenglishwordsthat canbemadefromanysetofatmostseventiles alongwiththepointvalues ofthosewords  time  supposewearegivenaset linesegmentsintheplane whereeach segmenthasoneendpointontheline  andoneendpointontheline  andall  endpointsaredistinct describeandanalyzeanalgorithmtocomputethelargestsubsetof whichnopairofsegmentsintersects describeandanalyzeanalgorithmtocomputethelargestsubsetof pairofsegmentsintersects nowsupposewearegivenaset linesegmentsintheplane bothendpointsofeachsegmentlieontheunitcircle    andall  endpointsaredistinct describeandanalyzeanalgorithmtocomputethelargestsubsetof whichnopairofsegmentsintersects describeandanalyzeanalgorithmtocomputethelargestsubsetof pairofsegmentsintersects   dynamicprogramming  beasetof pointsevenlydistributedontheunitcircle andlet beasetof linesegmentswithendpointsin theendpointsofthe segmentsare necessarilydistinct couldbesigni cantlysmallerthan  describeanalgorithmto ndthesizeofthelargestsubsetofsegments suchthateverypairisdisjoint twosegmentsaredisjointiftheydo notintersectevenattheirendpoints describeanalgorithmto ndthesizeofthelargestsubsetofsegments suchthateverypairisinteriint twosegmentsareinteri disjointiftheirintersectioniseitheremptyoranendpointofboth segments describeanalgorithmto ndthesizeofthelargestsubsetofsegments suchthateverypairintersects describeanalgorithmto ndthesizeofthelargestsubsetofsegments suchthateverypaircrosses twosegmentscrossiftheyintersect butnotattheirendpoints forfullcredit allfouralgorithmsshouldrunin time  youaredrivingabusalongahighway fullofrowdy hyper thirstystudents andasodafountainmachine eachminutethatastudentisonyourbus thatstudentdrinksoneounceofsoda yourgoalistodropthestudents sothatthetotalamountofsodaconsumedbyallstudentsisas smallaspossible youknowhowmanystudentswillgeto ofthebusateachexit busbeginssomewherealongthehighway probablynotateitherend andmovesataconstantspeedof37 milesperhour youmustdrivethe busalongthehighway youmaydriveforwardtooneexitthen backwardtoanexitintheoppositedirection switchingasoftenasyoulike youcanstopthebus dropo students andturnaroundinstantaneously describeane cientalgorithmtodropthestudentso sothattheydrink aslittlesodaaspossible yourinputconsistsofthebusroute alistofthe exits togetherwiththetraveltimebetweensuccessiveexits thenumberof studentsyouwilldropo ateachexit andthecurrentlocationofyourbus whichyoumayassumeisanexit  sde nea summary oftwostrings tobeaconcatenationof substringsofthefollowingform î sna indicatesasubstring sna ofonlythe rststring foo indicatesacommonsubstring foo ofbothstrings è bar indicatesasubstring bar ofonlythesecondstring  exercises asummaryis valid ifwecanrecovertheoriginalstrings concatenatingtheappropriatesubstringsofthesummaryinorderand discardingthedelimiters î è eachregularcharacterhaslength  andeachdelimiter î è hassome xednoegativelength length ofasummaryisthesumofthelengthsofitssymbols forexample eachofthefollowingstringsisavalidsummaryofthe strings kitten knitting è itt î è è haslength   è itt î è ing haslength   î itten è nitting haslength   î kitten è knitting haslength   describeandanalyzeanalgorithmthatcomputesthelengthofthe shortestsummaryoftwogivenstrings   thedelimiter length isalsopartoftheinputtoyouralgorithm forexample givenstrings kitten knitting  youralgorithmshould return  givenstrings kitten knitting  youralgorithmshould return  givenstrings kitten knitting  youralgorithmshould return   vankin smile isanamericansolitairegameplayedonan squaregrid theplayerstartsbyplacingatokenonanysquareofthegrid thenon eachturn theplayermovesthetokeneitheronesquaretotherightorone squaredown thegameendswhenplayermovesthetokeno theedgeof theboard eachsquareofthegridhasanumericalvalue whichcouldbe positive negative orzero theplayerstartswithascoreofzero thetokenlandsonasquare theplayeraddsitsvaluetohisscore objectofthegameistoscoreasmanypointsaspossible forexample giventhegridbelow theplayercanscore       pointsbyplacingtheinitialtokenonthe8inthesecondrow andthen movingdown thisis thebestpossiblescore forthisgridofnumbers                      dynamicprogramming describeandanalyzeane cientalgorithmtocomputethemaximum possiblescoreforagameofvankin smile giventhe arrayofvalues asinput intheeuropeanversionofthisgame appropriatelycalled vankin kilometer theplayercanmovethetokeneitheronesquaredown squareright oronesquareleft ineachturn topreventin nite scores thetokencannotlandonthesamesquaremorethanonce describeandanalyzeane cientalgorithmtocomputethemaximum possiblescoreforagameofvankin skilometer giventhe arrayof valuesasinput   supposeyouaregivenan bitmapasanarray     solidblock isasubarrayoftheform   inwhich allbitsareequal asolidblockissquareifithasthesamenumberofrows andcolumns describeanalgorithmto ndthemaximumareaofasolid square block  time describeanalgorithmto ndthemaximumareaofasolidblockin  time describeanalgorithmto ndthemaximumareaofasolidblockin  log time hint divideandconquer ª describeanalgorithmto ndthemaximumareaofasolidblockin  time  supposeyouaregivenanarray   ofnumbers whichmaybe positive negative orzero andwhichare necessarilyintegers analgorithmto ndthelargestsumofelementsinanyrectangularsubarray oftheform   forfullcredit youralgorithmshouldrunin  time hint seeproblem   describeandanalyzeanalgorithmthat ndsthemaximrectangular patternthatappearsmorethanonceinagivenbitmap speci cally atwonalarray   ofbitsasinput youralgorithm shouldoutputtheareaofthelargestrepeatedrectangularpatternin forexample giventhebitmapshownontheleftinthe gurebelow algorithmshouldreturntheinteger  whichistheareaofthe   doggo althoughitdoesn thappeninthisexample thetwocopiesofthe repeatedpatternmightoverlap  ifwealsoallowed upward movement theresultinggame vankin sfathom wouldbe np  exercises forfullcredit describeanalgorithmthatrunsin  time ª forextracredit describeanalgorithmthatrunsin  time ª forextraextracredit describeanalgorithmthatrunsin  polylog time  beasetofpointsintheplanein convexposition intuitively ifa rubberbandwerewrappedaroundthepoints theneverypointwouldtouch therubberband moreformally foranypoint thereisalinethat separates fromtheotherpointsin supposethepointsare indexed   incounterclockwiseorderaroundtheber startingwiththeleftmostpoint  thisproblemasksyoutosolveaspecialcaseofthetravelingsalesman problem wherethesalesmanmustvisiteverypointin andthecostof movingfromonepoint  toanotherpoint  istheeuclideandistance describeasimplealgorithmtocomputetheshortest cyclic tourof simple tourisonethatnevercrossesitself provethattheshortesttour mustbesimple describeandanalyzeane cientalgorithmtocomputetheshortesttour thatstartsattheleftmostpoint  andendsattherightmost point describeandanalyzeane cientalgorithmtocomputetheshortesttour withnorestrictionsontheendpoints ª  describeandanalyzeanalgorithmtosolvethetravelingsalesmanproblem  poly time givenanundirected ertexgraph withweighted edges youralgorithmshouldreturntheweightofthelightestcyclein thatvisitseveryvertexexactlyonce  hasnosuchcycles hint theobviousrecursivebacktrackingalgorithmtakes time    bea nitesetofstringsoversome xedalphabet editcenter isastring  suchthatthemaximumeditdistance   dynamicprogramming toanystringin isassmallaspossible editradius isthe maximumeditdistancefromaneditcentertoastringin asetofstrings mayhaveseveraleditcenters butitseditradiusisunique editradius min  max  edit editcenter argmin  max  edit describeandanalyzeane cientalgorithmtocomputetheeditradius ofthreegivenstrings ª describeandanalyzeane cientalgorithmtoapproximatetheedit radiusofanarbitrarysetofstringswithinafactorof  computingthe exact editradiusisunlessthenumberofstringsis xed ª   beanarrayofdigits eachanintegerbetween   digital subsequence isasequenceofpositiveintegerscomposedintheusual wayfromdisjointsubstringsof forexample thesequence             isadigitalsubsequenceofthe rstseveraldigits ˇ                                length ofadigitalsubsequenceisthenumberofintegersitcontains thenumberofdigits theprecedingexamplehaslength  asusual adigital subsequenceis increasing ifeachnumberislargerthanitspredecessor describeandanalyzeane cientalgorithmtocomputethelongest increasingdigitalsubsequenceof hint becarefulaboutyourco putationalassumptions howlongdoesittaketocomparetwo numbers forfullcredit youralgorithmshouldrunin  time fasteralgorithms areworthextracredit thefastestalgorithmiknowforthisproblemrunsin   log time achievingthisboundrequiresseveraltricks bothinthe designofthealgorithmandinitsanalysis butnothingoutsidethescopeof thisclass  ª  considerthefollowingvariantoftheclassicaltowerofhanoiproblem usual thereare diskswithdistinctsizes placedonthreepegsnumbered    initially disksareonpeg  sortedbysizefromsmallest ontoptolargestonbottom ourgoalistomoveallthediskstopeg  asinglestep wecanmovethehighestdiskonanypegtoadi erentpeg  withmoreadvancedtechniques ibelievetherunningtimecanbereducedto   loglog butihaven tworkedthroughthedetails  exercises providedwesatisfytwoconstraints wemustneverplaceasmaller diskontopofalargerdisk secothisisthenoandard mustnevermoveadiskdirectlyfrompeg  topeg  describeandanalyzeanalgorithmtocomputetheexactnumberof movesrequiredtomoveall disksfrompeg  topeg  subjecttothe statedrestrictions forfullcredit youralgorithmshoulduseonly log arithmeticoperationsintheworstcase forthesakeofanalysis assume thataddingormultiplyingtwo numbersrequires time hint matrices splittingsequences arrays  basicarithmeticexpression iscomposedofcharactersfromtheset  andparentheses almosteveryintegercanberepresentedbymore thanonebasicarithmeticexpression forexample allofthefollowingbasic arithmeticexpressionrepresenttheinteger14                                             describeandanalyzeanalgorithmtocompute givenaninteger asinput theminimumnumberof  sinabasicarithmeticexpressionwhosevalueis equalto thenumberofparenthesesdoesn tmatter justthenumberof  forexample  youralgorithmshouldreturn  forthe nal expressionabove therunningtimeofyouralgorithmshouldbebounded byasmallpolynomialfunctionof  supposeyouaregivenasequenceofintegersseparatedby signs forexample        youcanchangethevalueofthisexpressionbyaddingparenthesesin erentplaces forexample                         describeandanalyzeanalgorithmtocompute givenalistofintegers separatedby signs themaximumpossiblevaluetheexpression   dynamicprogramming cantakebyaddingparentheses parenthesesmustbeusedonlytogroup additionsandsubtractions inparticular donotusethemtocreateimplicit multiplicationasin          supposeyouaregivenasequenceofintegersseparatedby signs forexample        youcanchangethevalueofthisexpressionbyaddingparenthesesin erentplaces forexample                         describeandanalyzeanalgorithmtocomputethemaximumpossible valuethegivenexpressioncantakebyaddingparentheses assumingall integersintheinputare positive hint thisiseasy describeandanalyzeanalgorithmtocomputethemaximumpossible valuethegivenexpressioncantakebyaddingparentheses assumingall integersintheinputare noegative describeandanalyzeanalgorithmtocomputethemaximumpossible valuethegivenexpressioncantakebyaddingparentheses withno restrictionsontheinputnumbers assumeanyarithmeticoperationtakes  time  aftergraduatingfromsoobananauniversity youdecidetointerview forapositionatthewallstreetbank longliveboole themanaging directorofthebank eloobegroeg posesa solve problemstoeach newemployee whichtheymustsolvewithin24hours thosewhofailto solvetheproblemare redimmediately enteringthebankforthe rsttime younoticethattheemployeeo ces areorganizedinastraightrow withalarge printedonthedoorof eacho betweeneachadjacentpairofo ces thereisa boardmarkedbyoneofthesymbols _ whenyouaskaboutthese arcanesymbols eloobcon rmsthat representthebooleanvalues true false andthesymbolsontheboardsrepresentthestandard booleanoperators xor healsoexplainsthattheseletters andsymbolsdescribewhethercertaincombinationsofemployeescanwork togethersuccessfully atthestartofanynewproject eloobhierarchically clustershisemployeesbyaddingparenthesestothesequenceofsymbols  exercises obtainanunambiguousbooleanexpression theprojectissuccessfulifthis parenthesizedbooleanexpressionevaluatesto forexample ifthebankhasthreeemployees andthesequenceof symbolsonandbetweentheirdoorsis thereisexactlyone successfulparenthesizationscheme ifthelistof doorsymbolsis thereisnowaytoaddparenthesestomakethe projectsuccessful eloob nallyposesyoursolveinterviewquestion describean algorithmtodecidewhetheragivensequenceofsymbolscanbe sizedsothattheresultingbooleanexpressionevaluatesto yourinputis anarray   f iseven f_ isodd  everyyear aspartofitsannualmeeting theantarcticansnailloversof upperglaciervilleholdaroundtablematingrace severalality breedingsnailsareplacedattheedgeofaroundtable thesnailsare numberedinorderaroundthetablefrom  duringtherace eachsnail wandersaroundthetable leavingatrailofslimebehindit thesnailshave beenspeciallytrainednevertofallo theedgeofthetableortocrossa slimetrail eventheirown iftwosnailsmeet theyaredeclaredabreeding pair removedfromthetable andwhiskedawaytoaromanticholeinthe groundtomakelittlebabysnails notethatsomesnailsmaynever nda mate eveniftheracegoesonforever figure3  theendofatypicalantarcticanslugrace snails6and8never ndmates theorganizers mustpay       foreverypairofsnails theantarcticanslugraceorganizershave postedamonetaryreward tobepaidtotheownersifthatpairofsnails meetsduringthematingrace speci cally thereisatwonal   dynamicprogramming array   postedonthewallbehindtheroundtable istherewardtobepaidifsnails meet describeandanalyzeanalgorithmtocomputethemaximumtotal rewardthattheorganizerscouldbeforcedtopay giventhearray input  youhaveminedalargeslabofmarblefromaquarry forsimplicity suppose themarbleslabisarectanglemeasuring inchesinheightand inches inwidth youwanttocuttheslabintosmallerrectanglesofvarioussiz someforkitchencountertops someforlargesculptureprojects othersfor memorialheadstones youhaveamarblesawthatcanmakeeitherhorizontal orverticalcutsacrossanyrectangularslab atanytime youcanquerythe spotprice ofan chby chmarblerectangle foranypositive integers thesepricesdependoncustomerdemand andpeople whobuymarblecountertopsareweird sodon tmakeanyassumptions aboutthem inparticular largerrectanglesmayhavesigni cantlysmaller spotprices giventhearrayofspotpricesandtheintegers asinput describeanalgorithmtocomputehowtosubdividean marbleslabto maximizeyourpro  thisproblemasksyoutodesigne cientalgorithmstoconstructoptimal binarysearchtreesthatsatisfyadditionalbalanceconstraints yourinput consistsofasortedarray  ofsearchkeysandanarray  frequencycounts isthenumberofsearchesfor thisis exactlythesamecostfunctionasdescribedinsection   butnowyour taskistocomputeanoptimaltreethatsatis essomeadditionalconstraints avltrees weretheearliestselflancingbalancedbinarysearchtrees rstdescribedin1962bygeorgyadelsovelskyandevgeniilandis avltreeisabinarysearchtreewhereforeverynode theheightof theleftsubtreeof andtheheightoftherightsubtreeof erbyat mostone describeandanalyzeanalgorithmtoconstructanoptimalavltree foragivensetofsearchkeysandfrequencies symmetricbinaryb areanotherselflancingbinarytrees rst describedbyrudolfbayerin1972 thesearebetterknownbythename lacktrees afterasomewhatsimplerreformulationbyleoguibas andbobsedgwickin1978 alacktreeisabinarysearchtreewith thefollowingadditionalconstraints everynodeiseitherredorblack everyrednodehasablackparent everyeafpathcontainsthesamenumberofblacknodes  exercises describearecursivebacktrackingalgorithmtoconstructanoptimal lacktreeforagivensetofsearchkeysandfrequencies aatrees wereproposedbyproposedbyarneanderssonin1993and slightlysimpli andnamed bymarkallenweissin2000 aatreesare alsoknownas leaninglacktrees afterasymmetricreformulation withdi erentrebalancingalgorithms bybobsedgewickin2006 aatreeisalacktreewithoneadditionalconstraint noleftchildisred  describeandanalyzeanalgorithmtoconstructanoptimalaatreefora givensetofsearchkeysandfrequencies  supposeyouaregivenan bitmapasanarray     solidblock isasubarrayoftheform   inwhich allbitsareequal supposeyouwanttodecompose intoasfewdisjoint blocksaspossible onenaturalrecursivepartitioningstrategyiscalleda guillotine division iftheentirebitmap isasolidblock thereisnothingtodo wecut intotwosmallerbitmapsalongahorizontalorvertical andthenrecursivelydecomposethetwosmallerbitmapsintosolid blocks anyguillotinesubdivisioncanberepresentedasabinarytree eachinternalnodestoresthepositionandorientationofacut andeach leafstoresasinglebut   indictingthecontentsofthecorresponding block size ofaguillotinesubdivisionisthenumberofleavesinthe correspondingbinarytree thatis nalnumberofsolidblocks andthe depth ofaguillotinesubdivisionisthedepthofthecorrespondingbinary tree describeandanalyzeanalgorithmtocomputeaguillotinesubdivision ofminimumpossiblesize showthataguillotinesubdivisiondoes alwaysyieldapartitioninto thesmallestnumberofsolidblocks describeandanalyzeanalgorithmtocomputeaguillotinesubdivision withthesmallestpossibledepth describeandanalyzeanalgorithmtodetermine giventhetree representingaguillotinedecompositionfor andtwoindices  sedgwick sreformulationrequiresthatno childisred anderssonand sedgewickarestrangelysilentaboutwhethertomeasureanglesclockwiseorcounterclockwise whetherplutoisaplanet whetherowermeansorandwhetherit betterto ghtahundredduzedhorsesorasinglezedduck   dynamicprogramming figure3  aguillotinesubdivisionwithsize8anddepth5 nethe depth ofapixel inaguillotinesubdivisiontobethe depthoftheleafthatcontainsthatpixel describeandanalyzean algorithmtocomputeaguillotinesubdivisionfor suchthatthesum ofthedepthsofthepixelsassmallaspossible describeandanalyzeanalgorithmtocomputeaguillotinesubdivision suchthatthesumofthedepthsofthe black pixelsassmallas  congratulations vebeenhiredbythegiantonlinebookstoredenile otjustariverintooptimizetheirwarehouserobots eachbook thatdenilesellshasauniqueisbn internationalstandardbooknumber whichisjustanumericalvalue eachofdenile swarehousescontainsa longrowofbins eachcontainingmultiplecopiesofasinglebook binsarearrangedinsortedorderbyisbn eachbin sisbnisprintedonthe frontofthebininmachinbleform booksareretrievedfromthese binsbyrobots whichrunalongrailsparalleltotherowofbins deniledoesnotmaintainalistofwhichbinscontainwhichisbn numbers thatwouldbetoosimple toretrieveadesiredbook therobotmust rst ndthatbook sbinusingabinarysearch becausethe searchrequiresphysicalmotionbytherobot wecannolongerassumethat eachstepofthebinarysearchrequires  time speci cally therobotalwaysstartsatthe  wherethebooksareloaded intoboxestoshiptocustomers  exercises movingtherobotfromthe thbintothe thbinrequires seconds forsomeconstant therobotmustbedirectlyinfrontofabininordertoreadthatbin isbn readinganisbnrequires seconds forsomeconstant reversingtherobot sdirectionofmotion fromincreasingtodecreasing orviceversa requires additionalseconds forsomeconstant whentherobot ndsthetargetbin itextractsonebookfromthatbin andreturnsto  designandanalyzeanalgorithmtocomputeabinarysearchtreeoverthe binsthatminimizesthetotaltimetherobotspendssearchingforbooks yourinputisanarray  ofintegers isthenumberoftimes thattherobotwillbeaskedtoretrieveabookfromthe thbin alongwith thetimeparameters  astandardmethodtoimprovethecacheperformanceofsearchtreesisto packmoresearchkeysandsubtreesintoeachnode isarooted treeinwhicheachinternalnodestoresupto keysandpointerstoupto  children eachtherootofasmaller speci cally eachnode storesthree elds apositiveinteger sorted array key  anarray child  ofchildpointers inparticular thenumberofchildpointersisalwaysexactlyonemorethan thenumberofkeys  eachpointer child iseither null orapointertotherootofa treewhosekeysarealllargerthan key andsmallerthan key  inparticular allkeysintheleftmostsubtree child  aresmallerthan key  andallkeysintherightmostsubtree child arelargerthan key intuitively youshouldhavethefollowingpictureinmind key  key  key      arerequiredtosatisfytwoadditionalconstraints whichguaranteea wsesearchcostof log everyleafmusthaveexactlythesamedepth andeverynode exceptpossiblytherootmustcontainatleast  keys inthisproblem wearenot interestedinoptimizingthe wse searchcost butratherthe total costofasequenceof searches sowewillnotimposetheseadditionalconstraints   dynamicprogramming isthesubtreepointedtoby child cost ofsearchingforakey ina isthenumberofnodesin thepathfromtheroottothenodecontaining asoneofitskeys  isjustastandardbinarysearchtree fixanarbitrarypositiveinteger  isuggest  suppose youraregivenasortedarray  ofsearchkeysandacorresponding array  offrequencycounts isthenumberoftimes thatwewillsearchfor yourtaskistodescribeandanalyzeane cient algorithmto nda thatminimizesthetotalcostofsearchingforthe givenkeyswiththegivenfrequencies describeapolynomiaalgorithmforthespecialcase  describeanalgorithmforarbitrary thatrunsin timeforsome xedinteger ª describeanalgorithmforarbitrary thatrunsin timeforsome xedinteger thatdoes dependon  astring ofparentheses andbrackets balanced ifit satis esoneofthefollowingconditions istheemptystring forsomebalancedstring forsomebalancedstring xy forsomebalancedstrings forexample thestring isbalanced xy describeandanalyzeanalgorithmtodeterminewhetheragivenstring ofparenthesesandbracketsisbalanced describeandanalyzeanalgorithmtocomputethelengthofalongest balancedsubsequenceofagivenstringofparenthesesandbrackets describeandanalyzeanalgorithmtocomputethelengthofashortest balancedsupersequenceofagivenstringofparenthesesandbrackets describeandanalyzeanalgorithmtocomputetheminimumeditdistance fromagivenstringofparenthesesandbracketstoabalancedstringof parenthesesandbrackets  exercises ª describeandanalyzeanalgorithmtocomputethelongestcommon balancedsubsequenceoftwogivenstringsofparenthesesandbrackets ª describeandanalyzeanalgorithmtocomputethelongestpalindromic balancedsubsequenceofagivenstringofparenthesesandbrackets ª describeandanalyzeanalgorithmtocomputethelongestcommon palindromicbalancedsubsequence whew oftwogivenstringsof parenthesesandbrackets foreachproblem yourinputisanarray  f foreveryindex youmayprefertousedi erentsymbolsinsteadof parenthesesandorexample ã â ê é utplease tellyourgraderwhatsymbolsyou reusing ª  congratulations yourresearchteamhasjustbeenawardeda mm yearproject jointlyfundedbydarpa google andmcdonald toproduce dwim rstcompilertoreadprogrammers minds yourproposaland yournumerouspressreleasesallpromisethatdwimwillautomatically correcterrorsinanygivenpieceofcode whilemodifyingthatcodeaslittle aspossible nowit stimetostartactuallymakingthedamn thingwork asawarmupexercise youdecidetotacklethefollowingnecessary subproblem recallthatthe editdistance betweentwostringsistheminimum numberofsinglinsertions deletions andreplacementsrequired totransformonestringintotheother arithmeticexpression isastring suchthat isastringofoneormoredecimaldigits forsomearithmeticexpression forsomearithmeticexpressions andsomebinary operator supposeyouaregivenastringoftokensfromthealphabet representsadecimaldigitand representsabinaryoperator describeandanalyzeanalgorithmtocomputetheminimumeditdistance fromthegivenstringtoanarithmeticexpression  ribonucleicacid rna moleculesarelongchainsofmillionsofnucleotides bases offourdi erenttypes adenine cytosine guanine uracil sequence ofanrnamoleculeisastring  eachcharacter f correspondstoabase inadditiontothe chemicalbondsbetweenadjacentbasesinthesequence hydrogenbonds canformbetweencertainpairsofbases thesetofbondedbasepairsis calledthe secondarystructure ofthernamolecule   dynamicprogramming wesaythattwobasepairs     overlap     inpractice mostbasepairsare noverlapping overlappingbasepairscreatelled pseudoknots inthe secondarystructure whichareessentialforsomernafunctions butare moredi culttopredict supposewewanttopredictthebestpossiblesecondarystructurefor agivenrnasequence wewilladoptadrasticallysimpli edmodelof secondarystructure eachbasecanbondwithatmostoneotherbase pairsand pairscanbond pairsoftheform   cannotbond bondedbasepairscannotoverlap thelast andleastrealistic restrictionallowsustovisualizernasecondary structureasasortoffattree asshownbelow figure3  examplernasecondarystructurewith21bondedbasepairs indicatedbyheavyredlines gapsareindicatedbydottedcurves thisstructurehasscore                describeandanalyzeanalgorithmthatcomputesthemaximumpossible number ofbondedbasepairsinasecondarystructureforagivenrna sequence gap inasecondarystructureisamaximalsubstringofunpairedbases largegapsleadtochemicalinstabilities sosecondarystructureswith smallergapsaremorelikely toaccountforthispreference sde score ofasecondarystructuretobethesumofthe squares ofthegap lengths seefigure   thisscorefunctionisutterly ctional realrna structurepredictionrequires morecomplicatedscoringfunctions describeandanalyzeanalgorithmthatcomputestheminimum possiblescoreofasecondarystructureforagivenrnasequence  exercises  describeandanalyzeane cientalgorithmtodetermine givenastring andaregularexpression  generalized regularexpressionsallowthebinaryoperator intersection andtheunaryoperator complement inadditiontotheusual concatenation kleeneclosure operators nfa constructionsandkleene stheoremimplythatanygeneralizedregular expression representsaregularlanguage describeandanalyzeane cientalgorithmtodetermine givena string andageneralizedregularexpression  inbothproblems assumethatyouareactuallygivenaparsetreeforthe generalized regularexpression notjustastring treesandsubtrees  vejustbeenappointedastheneworganizerofthe rstannualmandatory holidaypartyatgiggle asubsidiaryofabugida giggleemployeesare organizedintoastricthitreewiththecompanypresidentatthe root theaowingoraclesinhumanresourceshaveassignedareal numbertoeachemployeemeasuringhowtheemployeeis tokeep thingssocial thereisonerestrictionontheguestlist anemployeecannot attendthepartyiftheirimmediatesupervisorisalsopresent ontheother hand thepresidentofthecompany attendtheparty eventhoughshe hasanegativefunrating shercompany afterall giveanalgorithmthat makesaguestlistforthepartythatmaximizesthesumoftheratings oftheguests  sincesofewpeoplecametolastyear sholidayparty thepresidentofgiggle decidestogiveeachemployeeapresentinsteadthisyear speci cally eachemployeemustreceiveonthethreegifts  ana weekvacationanywhereintheworld  anacao breakfastfortwoatjumpingjackflash sflapjackstackshack  burningpaperbagfullofdogpoop corporateregulationsprohibitany employeefromreceivingexactlythesamegiftashis herdirectsupervisor anyemployeewhoreceivesabettergiftthanhis herdirectsupervisorwill almostcertainlybe redina tofjealousy asgiggle cialpartyczar jobtodecidewhichgifteach employeereceives describeanalgorithmtodistributegiftssothatthe minimumnumberofpeopleare red youmaysendthepresidenta amingbagofdogpoop moreformally youaregivenarootedtree representingthecompany hierarchy andyouwanttolabelthenodesof withintegers      dynamicprogramming thateverynodehasadi erentlabelfromitsparent cost ofanlabeling isthenumberofnodeswithsmallerlabelsthantheirparents seefigure   foranexample describeandanalyzeanalgorithmtocomputethe minimstlabelingof figure3  atreelabelingwithcost9 thenineboldnodeshavesmallerlabelsthantheirparents theoptimallabelingforthistree  aftertheflamingdogpoopholidaydebacle youwerestronglyencouraged toseekotheremployment andsoyouleftgiggleforrivalcompanytwitbook thenewpresidentoftwitbookjustdecidedtoimitategiggle bythrowingherownholidayparty andinlightofyourpastexperience appointedyouastheo cialpartyorganizer thepresidentdemandsthat youinviteexactly employees includingthepresidentherself andeveryone whoisinvitedisrequiredtoattend yeah llbefun justlikeatgiggle employeesattwitbookareorganizedintoastrict hierarchy atreewiththecompanypresidentattheroot theaowing oraclesinhumanresourceshaveassignedarealnumbertoeachemployee indicatingthe awkwardness ofinvitingboththatemployeeandtheir diatesupervisor anegativevalueindicatesthattheemployeeandtheir supervisoractuallylikeeachother yourgoalistochooseasubsetof employeestoinvite sothatthetotalawkwardnessoftheresulting partyisassmallaspossible forexample iftheguestlistdoesnotinclude bothanemployeeandtheirimmediatesupervisor thetotalawkwardness iszero theinputtoyouralgorithmisthetree theinteger andthe awkwardnessofeachnodein describeanalgorithmthatcomputesthetotalawkwardnessoftheleast awkwardsubsetof employees assumingthecompanyhierarchyis describedbya binary tree thatis assumethateachemployeedirectly supervisesatmosttwoothers ª describeanalgorithmthatcomputesthetotalawkwardnessoftheleast awkwardsubsetof employees withnorestrictionsonthecompany hierarchy  exercises  supposeweneedtobroadcastamessagetoallthenodesinarootedtree initially onlytherootnodeknowsthemessage inasingleround anynode thatknowsthemessagecanforwardittoatmostoneofitschildren figure   foranexample designanalgorithmtocomputetheminimumnumberofroundsrequired tobroadcastthemessagetoallnodesina binary tree designanalgorithmtocomputetheminimumnumberofroundsrequired tobroadcastthemessagetoallnodesinan arbitrary rootedtree hint youmay ndtechniquesinthenextchapterusefultoproveyour algorithmiscorrect eventhoughit snotagreedyalgorithm figure3  amessagebeingdistributedthroughatreein verounds  oneday alexgottiredofclimbinginagymanddecidedtotakeaverylarge groupofclimberfriendsoutsidetoclimb theclimbingareawherethey hadahugewideboulder notverytall withvariousmarkedhand andfootholds alexquicklydeterminedanllowsetofmovesthather groupoffriendscanperformtogetfromoneholdtoanother theoverallsystemofholdscanbedescribedbyarootedtree vertices whereeachvertexcorrespondstoaholdandeachedgecorresponds toanallowedmovebetweenholds theclimbingpathsconvergeastheygo uptheboulder leadingtoauniqueholdatthesummit representedbythe rootof  alexandherfriends whoareallexcellentclimbers decidedtoplaya game whereasmanyclimbersaspossiblearesimultaneouslyontheboulder andeachclimberneedstoperformasequenceof moves climbercanchooseanarbitraryholdtostartfrom andallmovesmustmove awayfromtheground eachclimbertracesoutapathof edges inthetree alldirectedtowardtheroot notwoclimbersare allowedtotouchthesamehold thepathsfollowedbydi erentclimbers cannotintersectatall describeandanalyzeane cientalgorithmtocomputethemaximum numberofclimbersthatcanplaythisgame moreformally youaregivena rootedtree andaninteger andyouwantto ndthelargestpossible  whydocomputerscienceprofessorsthinktreeshavetheirrootsatthetop becausethey veneverbeenoutside   dynamicprogramming numberofdisjointpathsin whereeachpathhaslength assume isabinarytree forexample giventhetree belowand  input youralgorithmshouldreturntheinteger  figure3  sevendisjointpathsoflength  thisis thelargestsuchsetofpathsinthistree  bearootedbinarytreewith vertices andlet beapositive integer wewouldliketomark verticesin sothateveryvertexhasa nearbymarkedancestor moreformally wede nethe clusteringcost ofany subset ofverticesas cost max cost wherethemaximumistakenoverallvertices inthetree cost thedistancefrom toitsnearestancestorin cost     istherootof   cost parent inparticular cost  excludestherootof figure3  asubsetof veverticesinabinarytree withclusteringcost3  exercises ª describeadynamicprogrammingalgorithmtocompute giventhetree andaninteger theminimumclusteringcostofanysubsetof verticesin forfullcredit youralgorithmshouldrunin   time describeadynamicprogrammingalgorithmtocompute giventhetree andaninteger thesizeofthesmallestsubsetofverticeswhose clusteringcostisatmost forfullcredit youralgorithmshouldrunin time showthatyoursolutionforpart impliesanalgorithmforpart thatrunsin  log time  thisquestionasksyouto nde cientalgorithmstocomputethe largest commonrootedsubtree oftwogivenrootedtrees recallthata rooted tree isaconnectedacyclicgraphwithadesignatednodecalledtheroot arootedsubtreeofarootedtreeconsistsofanarbitrarynodeandallits descendants theprecisede nitionofmmodependsonwhichpairsof rootedtreesweconsiderisomorphic recallthata binary treeisarootedtreeinwhicheverynodehasa possiblyempty left subtreeanda possiblyempty subtree binarytreesareisomorphicifandonlyiftheyarebothempty ortheir leftsubtreesareisomorphicandtheirrightsubtreesareisomorphic describeanalgorithmto ndthelargestcommon binary subtreeoftwo binary trees figure3  twobinarytrees withtheirlargestcommon rooted subtreeemphasized inan ordered rootedtree eachnodehasa sequence ofchildren aretherootsoforderedrootedsubtrees twoorderedrootedtreesare isomorphiciftheyarebothempty oriftheir thsubtreesareisomorphic foreveryindex describeanalgorithmto ndthelargestcommon orderedsubtreeoftwoorderedtrees   ª inan unordered rootedtree eachnodehasanunordered set ofchildren whicharetherootsofunorderedrootedsubtrees twounorderedrooted treesareisomorphiciftheyarebothempty orthesubtreesofeachroot canbeorderedsothat thsubtreesareisomorphicforeveryindex describeanalgorithmto ndthelargestcommonunorderedsubtreeof twounorderedtrees     dynamicprogramming  thisquestionasksyouto nde cientalgorithmstocomputeoptimal subtreesin unrooted nnectedacyclicundirectedgraphs subtree ofanunrootedtreeisanyconnectedsubgraph supposeyouaregivenanunrootedtree withweightsonits edges whichmaybepositive negative orzero describeanalgorithmto path withmaximumtotalweight supposeyouaregivenanunrootedtree withweightsonits vertices whichmaybepositive negative orzero describeanalgorithmto subtree withmaximumtotalweight thiswasa2016google interviewquestion   bearbitrary ordered unrootedtrees meaningthatthe neighborsofeverynodehaveawedcyclicorder describean algorithmto ndthelargestcommon ordered subtreeof   ª   bearbitrary unordered unrootedtrees describean algorithmto ndthelargestcommon unordered subtreeof    rootedminors ofrootedtreesareanaturalgeneralizationofsubsequences arootedminorofarootedtree isanytreeobtainedby contracting oneor moreedges whenwecontractanedge istheparentof childrenof becomenewchildrenof andthen isdeleted inparticular therootof isalsotherootofeveryrootedminorof figure3  arootedtreeandoneofitsrootedminors bearootedtreewithlabelednodes wesaythat boring foreachnode allchildrenof havethesamelabel childrenof erentnodesmayhavedi erentlabels describeanalgorithmto thelargestboringrootedminorofagivenlabeledrootedtree supposewearegivenarootedtree whosenodesarelabeledwith numbers describeanalgorithmto ndthelargest hearooted minor thatis youralgorithmshouldreturnthelargestrooted minor suchthateverynodein hasasmallerlabelthanitschildren  exercises supposewearegivena binary tree whosenodesarelabeledwith numbers describeanalgorithmto ndthelargest binary rootedminor thatis youralgorithmshouldreturnarooted minor suchthateverynodein hasatmosttwochildren aninordertraversalof isanincreasingsubsequenceofaninorder traversalof recallthatarootedtreeis ordered ifthechildrenofeachnodehavea wedlorder describeanalgorithmto ndthelargest binminorofan arbitrary orderedtree whosenodes arelabeledwithnumbers thelorderofnodesin shouldbeconsistentwiththeirorderin ª describeanalgorithmto ndthelargestcommon ordered rootedminor oftwo ordered labeledrootedtrees ª describeanalgorithmto ndthelargestcommon unordered rooted minoroftwo unordered labeledrootedtrees hint combinedynamic programmingwithmaximum ows  thepointis ladiesandgentleman greedisgood greedworks greedisright greedclari cutsthrough andcapturestheessenceoftheevolutionaryspirit greedinallitsforms greedforlife money love knowledgehasmarkedthe upwardsurgeinmankind andgrmyworsavenotonlyteldar paperbuttheothermalfunctioningcorporationcalledtheusa gordongekko michaeldouglas wallstreet  thereisalwaysaneasysolutiontoeveryhumanpr neat plausible andwrong mencken divine newyorkeveningmail november16   greedyalgorithms  storingfilesontape supposewehaveasetof lesthatwewanttostoreonmagnetictape  inthe future userswillwanttoreadthose lesfromthetape readinga lefrom tapeisn tlikereadinga lefromdisk rstwehavetofaorwardpastallthe andthattakesasigni cantamountoftime  beanarray listingthelengthsofeach speci cally haslength ifthe lesare storedinorderfrom  thenthecostofaccessingthe leis cost   readerswhoaretemptedtoobjectthatmagnetictapehasbeenobsoletefordecades arecordiallyinvitedtotouryournearestsupercomputerfacility asktoseethetaperobots alternatively lingasequenceofbooksonalibrarybookshelf youknow thosestrange briobjectsmadeofdeadtreesandink   greedyalgorithms thecostre ectsthefactthatbeforeweread wemust rstscanpastallthe earlier lesonthetape ifweassumeforthemomentthateach leisequally likelytobeaccessed thenthe expected costofsearchingforarandom leis cost  cost    ifwechangetheorderofthe lesonthetape wechangethecostofaccessing lesbecomemoreexpensivetoread butothersbecomecheaper erent leordersarelikelytoresultindi erentexpectedcosts speci cally ˇ denotetheindexofthe lestoredatposition onthetape thenthe expectedcostofthepermutation ˇ cost ˇ    ˇ whichordershouldweuseifwewantthisexpectedcosttobeassmallas theanswer intuitivelyclear sortthe lesbyincreasinglength butintuitionisatrickybeast theonlywaytobe thatthisorderworksis takeo andnuketheentiresitefromorbitactually prove thatitworks lemma4  cost ˇ isminimizedwhen ˇ ˇ  forall proof suppose ˇ ˇ  forsomeindex tosimplifynotation ˇ ˇ  ifweswap thenthecostof accessing increasesby andthecostofaccessing decreasesby theswapchangestheexpectedcostby butthischange isanimprovement ifthe lesareoutoforder candecreasetheexpectedcostbyswappingsomepairof thisisour rstexampleofacorrect greedyalgorithm tominimizethe total expectedcostofaccessingthe weputthe lethatischeapesttoaccess rst andthenrecursivelywriteeverythingelse nobacktracking nodynamic programming justmakethebestlocalchoiceandblindlyplowahead ifwe useane cientsortingalgorithm therunningtimeisclearly log thetimerequiredtoactuallywritethe toshowthatthegreedyalgorithm isactuallycorrect weprovedthattheoutputofanyotheralgorithmcanbe improvedbysomesortofexchange sgeneralizethisideafurther supposewearealsogivenanarray  accessfrequencies foreach willbeaccessedexactly timesover thelifetimeofthetape nowthe total costofaccessingallthe lesonthetapeis cost ˇ  ˇ  ˇ   ˇ ˇ    schedulingclasses asbefore reorderingthe lescanchangethistotalcost sowhatordershould weuseifwewantthetotalcosttobeassmallaspossible thisquestionis similarinspirittotheoptimalbinarysearchtreeproblem butthetargetdata structureandthecostfunctionarebothdi erent sothealgorithmmustbe erent wealreadyprovedthatifallthefrequenciesareequal weshouldsortthe lesbyincreasingsize ifthefrequenciesarealldi erentbutthe lelengths areallequal thenintuitively weshouldsortthe lesby decreasing access frequency withthemo rst infact thisisnothardtoprove hint hint bymodifyingtheproofoflemma   butwhatifthesizesandthe frequenciesbothvary inthiscase weshouldsortthe lesbythe ratio lemma4  cost ˇ isminimizedwhen ˇ ˇ ˇ  ˇ  forall proof suppose ˇ ˇ ˇ  ˇ forsomeindex tosimplifynotation ˇ ˇ  ifweswap thecostofaccessing increasesby andthecostofaccessing decreases theswapchangesthetotalcostby thischangeisanimprovement  ifanytwoadjacent lesareoutoforder wecanimprovethetotalcostby swappingthem  schedulingclasses thenextexampleisslightlymorecomplex supposeyoudecidetodropout ofcomputerscienceandchangeyourmajortoappliedchaos theapplied chaosdepartmento ersallofitsclassesonthesamedayeveryweek called oberdabythestudents butinterestingly bythefaculty everyclass hasadi erentstarttimeandadi erentendingtime ac101oiletpaper landscapeastartsat10 pmandendsat11 pm ac666 entizingtheeschatostartsat4 pmandendsat4 pm andsoon intheinterestofgraduatingasquicklyaspossible youwanttoregisterforas manyclassesaspossible appliedchaosclassesdon trequireanyactual work theuniversity sregistrationcomputerwon tletyouregisterforoverlapping classes andnooneinthedepartmentknowshowtooverridethis whichclassesshouldyoutake moreformally supposeyouaregiventwoarrays   listing thestartand nishtimesofeachclass tobeconcrete wecanassumethat   greedyalgorithms  foreach forsomevalue forexample thenumber ofpicosecondsinsoberday yourtaskistochoosethelargestpossiblesubset f   sothatforanypair  wecanillustratetheproblembydrawingeachclassasarectanglewhoseleft andright atesshowthestartand nishtimes thegoalisto nda largestsubsetofrectanglesthatdonotoverlapvertically figure4  amaximumcon ict freescheduleforasetofclasses thisproblemhasafairlysimplerecursivesolution basedontheobservation thateitheryoutakeclass  oryoudon denotethesetofclassesthat class  starts andlet denotethesetofclassesthat startafter class  ends     ifclass  isintheoptimalschedule thensoaretheoptimalschedulesfor whichwecan ndrecursively ifnot wecan ndtheoptimalschedule   recursively soweshouldtrybothchoicesandtakewhichever onegivesthebetterschedule evaluatingthisrecursivealgorithmfromthe bottomupgivesusadynamicprogrammingalgorithmthatrunsin  time iwon tbothertogothroughthedetails becausewecandobetter  intuitively dlikethe rstclassto nishasearlyaspossible becausethat leavesuswiththelargestnumberofremainingclasses thisintuitionsuggests thefollowingsimplegreedyalgorithm scanthroughtheclassesinorderof nishtime wheneveryouencounteraclassthatdoesn tcon ictwithyourlatest classsofar takeit seefigure   foravisualizationoftheresultinggreedy schedule wecanwritethegreedyalgorithmsomewhatmoreformallyasshowninin figure   hopefullythe rstlineisunderstandable aftertheinitialsort algorithmisasimplelinloop sotheentirealgorithmrunsin log time  butyoushouldstillworkoutthedetailsyourself thedynamicprogrammingalgorithm canbeusedto ndthescheduleforseveraldi erentde nitionsofbutthegreedy algorithmi mdescribinghereonlyworkswhenmeansalso youcanimprove therunningtimeto  usingadi erentrecurrence    schedulingclasses figure4  thesameclassessortedby nishtimesandthegreedyschedule greedyschedule   sort andpermute tomatch count  count   count count count  count return  count figure4  agreedyalgorithmfor ndingamaximumsetofnon overlappingclasses toprovethat greedyschedule actuallycomputesthelargestcon schedule weuseanexchangeargument similartotheoneweusedfortape sorting wearenotclaimingthatthegreedyscheduleisthe maximal schedule therecouldbeothers comparefigures     allwecan claimisthatatleastoneoftheoptimalschedulesistheoneproducedbythe greedyalgorithm lemma4  atleastonemaximalcon ischeduleincludestheclassthat nishes rst proof betheclassthat nishes rst supposewehaveamaximal ischedule thatdoesnotinclude bethe rstclassin nish nishesbefore cannotcon ictwithanyclassintheset nf theschedule  gnf isalsocon isince  thesamesizeas itisalsomaximal nishtheproof wecallonouroldfriendinduction   greedyalgorithms theorem4  thegreedyscheduleisanoptimalschedule proof betheclassthat nishes rst andlet bethesubsetofclassesthat startafter nishes thepreviouslemmaimpliesthatsomeoptimalschedule sothebestschedulethatcontains isanoptimalschedule thebest schedulethatincludes mustcontainanoptimalschedulefortheclassesthat donotcon ictwith thatis anoptimalschedulefor thegreedyalgorithm chooses andthen bytheinductivehypothesis computesanoptimalschedule ofclassesfrom theproofmightbeeasiertounderstandifweunrolltheinductionslightly proof   bethesequenceofclasseschosenbythegreedy algorithm sortedbystartingtime supposewehaveamaximalcon schedule     againsortedbystartingtime isdi erentfromtheclass chosenby thegreedyalgorithm wecouldhave  inwhichcasethisschedulestarts withanochoice  byconstruction thgreedychoice notcon ictwithanyearlierclass    andbecauseourschedule ineitherdoes hasthe earliest nishtimeamong allclassesthatdon tcon ictwiththeearlierclasses inparticular nishes itfollowsthat doesnotcon ictwithanyofthelaterclasses  themodi edschedule      isalsocon thisargumentisadirectgeneralizationoflemma   whichconsidersthecase  byinduction itnowfollowsthatthereisanoptimalschedule    thatincludes classchosenbythegreedyalgorithm butthis isimpossibleunless ifsomeclass  doesnotcon ictwithanyofthe rst greedyclasses thenthegreedyalgorithmwouldchoosemorethan classes  generalpattern thebasicstructureofthiscorrectnessproofisexactlythesameasforthe taproblem aninductiveexchangeargument assumethatthereisanoptimalsolutionthatisdi erentfromthegreedy solution findthedi erencebetweenthetwosolutions    huffmancodes arguethatwecanexchangetheoptimalchoiceforthegreedychoicewithout makingthesolutionworse althoughtheexchangemightnotmakeitbetter thisargumentimpliesbyinductionthatsomeoptimalsolution entiregreedysolution andtherefore equals thegreedysolution intheschedulingproblem anadditionalstepisrequiredtoshownooptimal solution strictly improvesthegreedysolution  huffmancodes binarycode assignsastringof0sand1stoeachcharacterinthealphabet binarycodeis ifnocodeisapre xofanyother confusingly freecodesarealsocommonlycalled pre xcodes asciiandunicode utfarebothbinarycodes morsecodeisabinarycodewith symbols andbutitis becausethecodefor isapre ofthecodesfor  anybinarycodecanbevisualizedasabinarytreewiththe encodedcharactersstoredattheleaves thecodewordforanysymbolisgiven bythepathfromtheroottothecorrespondingleaf  forleft  forright thelengthofanysymbol scodewordisthedepthofthecorrespondingleafin thecodetree althoughtheyaresuper ciallysimilar binarycodetreesare binarysearchtrees wedon tcareatallabouttheorderofsymbolsattheleaves supposewewanttoencodeamessagewritteninan alphabet sothattheencodedmessageisasshortaspossible speci cally givenanarray offrequencycounts  wewanttocomputeabinarycodethat minimizesthetotalencodedlengthofthemessage  depth thisisexactlythesamecostfunctionweconsideredforoptimizingbinary searchtrees buttheoptimizationproblemisdi erent becausecodetreesare notrequiredtokeepthekeysinanyparticularorder  forthisreason morsecodeisarguablybetterdescribedasa ternary code threesymbols andpause alternatively morsecodecanbeconsidereda binarycode withonebeatofsound light current highvoltage smoke gas andonebeat ofsilence darkness ground lowvoltage air liquid asthetwosymbols theneachis encodedas eachas andeachpauseas instandardmorsecode letterisfollowedbyonepause andeachwordisfollowedbytwoadditionalpauses sattheendoftheentirecodedmessageareomitted forexample thestring morsecode unambiguouslyencodedasthefollowingbitstring   greedyalgorithms in1951 asaphdstudentatmit davidhu mandevelopedthefollowing greedyalgorithmtoproducesuchanoptimalcode  huffman mergethetwoleastfrequentlettersandrecurse man salgorithmisbestillustratedthroughanexample supposewewant toencodethefollowinghelpfullyselfvesentence discoveredbylee sallows  thissentencecontainsthreea threec twod sixe vef eighth thirteeni twol sixteenn nineo sixr sevens twot twou vev eightw fourx vey andonlyonez tokeepthingssimple signorethefortourspaces nineteenapostrophes nineteencommas threehyphens andonlyoneperiod andencodeonlythe letters asthoughthemessagewerewrittenin scriptiocontinua thissentencecontainsthreeasthreecstwodstwentysixesfivefst hreegseighthsthirteenistwolssixteennsnineossixrstwentysev ensstwentytwotstwousfivevseightwsfourxsfiveysandonlyonez  hereisthefrequencytableforsallows sentence  man salgorithmpicksoutthetwoleastfrequentletters breakingties thiscase mergesthemtogetherintoasingle  manwasastudentinaninformationtheoryclasstaughtbyrobertfano whowas aclosecolleagueofclaudeshannon thefatherofinformationtheory fanoandshannon hadpreviouslydevelopedadi erentgreedyalgorithmforproducingpre xplitthe frequencyarrayintotwosubarraysasevenlyaspossible andthenrecursivelybuildacodefor eachsubarrautthesefanhannoncodeswereknownnottobeoptimal fanoposedthe problemof ndinganoptimalpre xcodetohisclass mandecidedtosolvetheproblemas aclassproject insteadoftakinga nalexam notrealizingthattheproblemwasopen orthat fanoandshannonhadalreadytriedandfailedtosolveit afterseveralmonthsoffruitlesse ort maneventuallygaveupanddecidedtotakethe nalexamafterall ashewasthrowinghis notesinthetrash thesolutiondawnedonhim manwouldlaterdescribetheepiphanyas absolutelightningofsuddenrealizatio  thissentencewas rstreportedbyalexanderdewdneyinhisoctober1984omputer recreatiocolumnin scienti camerican sallowshimselfpublishedtheremarkablestoryof itsdiscoveryin1985 alongwithseveralotherselfvesentences youcan ndsallows paperon hiswebsite frustratedwiththeslowprogressofhiscoderunningonavax11  sallowsdesignedandbuiltdedicatedhardwaretoperformaorcesearchforselfve sentenceswithvarious avortextpangramhas sentencecontainsexactly andsoon carefultheoreticalanalysislimitedthesearchspacetojustoversixbillionpossibilities whichhispangrammachineenumeratedinjustundertwohours  andhetalkedforfortveminutes andnobodyunderstoodawordthathesaid butwe hadfun llin outtheformsandplayin withthepencilsonthebenchthere    huffmancodes newcharacter dz withfrequency  thisnewcharacterbecomesaninternal nodeinthecodetreeweareconstructing asitschildren tmatterwhichchildiswhich thealgorithmthenrecursivelyconstructs ahu mancodeforthenewfrequencytable dz  after19merges all20lettershavebeenmergedtogether therecordofmerges givesusourcodetree thealgorithmmakesanumberofarbitrarychoices asa result thereareactuallyseveraldi erenthu mancodes onesuchhu man codeisshownbelow numbersinnoeafnodesarefrequenciesformerged characters forexample thecodefor  andthecodefor  encodingsallows sentencewiththisparticularhu mancodewouldyielda bitstringthatstartslikeso                 hereisthelistofcostsforencodingeachcharacterinsallows sentence withthatcharacter scontributiontothetotallengthoftheencodedsentence char freq  depth  total  altogether theencodedmessageis649bitslong erenthu mancodes encodethesamecharactersdi erently possiblywithcodewordsofdi erent length buttheoveralllengthoftheencodedmessageisthesamefor mancode bits   greedyalgorithms giventhesimplestructureofhu man salgorithm srathersurprisingthat itproducesan optimal binarycode  encodingsallows sentence coderequiresatleast649bits fortunately therecursive structuremakesthisclaimeasytoproveusinganexchangeargument toourearlieroptimalityproofs westartbyprovingthatthealgorithm svery rstchoiceiscorrect lemma4  bethetwoleastfrequentcharacters breakingties betweenequallyfrequentcharactersarbitrarily thereisanoptimalcodetree inwhich aresiblings proof llactuallyproveastrongerstatement thereisanoptimalcodein aresiblings havethelargestdepthofanyleaf beanoptimalcodetree andsupposethistreehasdepth isafullbinarytree ithasatleasttwoleavesatdepth thataresiblings verify thisclaimbyinduction supposethosetwoleavesare butsome othercharacters  bethecodetreeobtainedbyswapping andlet depth thisswapincreasesthedepthof anddecreasesthedepth cost  cost ourassumptionthat isoneofthetwoleastfrequentcharactersbut isnot implies andourassumptionthat hasmaximumdepthimplies  itfollowsthat cost  cost ontheotherhand isanoptimal codetree sowemustalsohave cost  cost weconcludethat  anoptimalcodetree swapping mustgiveyetanotheroptimalcodetree inthis naloptimalcodetree aremaximsiblings asrequired nowoptimalityisguaranteedbyourdearfriendtherecursionfairy recursiveargumentreliesonthefollowingnoandardrecursivede nition afullbinarytreeiseitherasinglenode orafullbinarytreewheresomeleafhas beenreplacedbyaninternalnodewithtwoleafchildren theorem4  everyhu mancodeisanoptimalbinarycode proof ifthemessagehasonlyoneortwodistinctcharacters thetheoremis trivial soassumeotherwise  betheoriginalinputfrequencies andassumewithoutlossof generalitythat   arethetwosmallestfrequencies tosetupthe  itwascertainlysurprisingtobothhu manandfano    huffmancodes recursivesubproblem    ourearlierexchange argumentimpliesthat   deepest siblingsinsomeoptimalcodefor   bethehu mantreefor   theinductivehypothesisimplies  isanoptimalcodetreeforthesmallersetoffrequencies toobtain nalcodetree wereplacetheleaflabeled  withaninternalnode withtwochildren labelled   iclaimthat isoptimalfortheoriginal frequencyarray  toprovethisclaim wecanexpressthecostof intermsofthecostof  asfollows intheseequations depth denotesthedepthoftheleaflabelled ineither  eachleafthatappearsinboth  hasthesamedepthin bothtrees cost  depth   depth  depth   depth   depth  cost    depth  depth  cost       depth  cost    thisequationimpliesthatminimizingthecostof isequivalenttominimizing thecostof  inparticular attachingleaveslabeled   totheleafin  labeled  givesanoptimalcodetreefortheoriginalfrequencies toe cientlyconstructahu mancode wekeepthecharactersinapriority queue usingthecharacterfrequenciesaspriorities wecanrepresentthecode treeasthreearraysofindices listingthe eftand ightchildrenandthe ofeachnode theleavesofthe nalcodetreearenodesatindices  andtherootisthenodewithindex   pseudocodeforthealgorithmis showninfigure   buildhuffman performs prioriteueoperations   insert sand   extractmin ifweimplementthepriority queueasastandardbinaryheap eachoftheseoperationsrequires log time andthustheentirealgorithmrunsin log time finally simplealgorithmstoencodeanddecodemessagesusinga xed mancodeareshowninfigure   bothalgorithmsrunin time isthelengthoftheencodedmessage   greedyalgorithms buildhuffman     insert   extractmin ndtworarestsymbols extractmin mergeintoanewsymbol insert updatetreepointers    figure4  buildingahuffmancode huffmanencode    huffmanencodeone huffmanencodeone   huffmanencodeone    huffmandecode           figure4  encodinganddecodingalgorithmsforhuffmancodes  stablematching everyyear thousandsofnewdoctorsmustobtaininternshipsathospitalsaround theunitedstates duringthe rsthalfofthe20thcentury competitionamong hospitalsforthebestdoctorsledtoearlierandearliero ersofinternships sometimesasearlyasthesecondyearofmedicalschool alongwithtighter deadlinesforacceptance inthe1940s medicalschoolsagreednottorelease informationuntilacommondateduringtheirstudents fourthyear inresponse hospitalsbegandemandingfasterdecisions by1950 hospitalswouldregularly calldoctors ertheminternships anddemand responses interns wereforcedtogambleiftheiricehospitalcalledandrisk losingabetteropportunitylater orrejectandriskhavingnopositionatall   theamericanacademicjobmarketinvolvessimilargambles atleastincomputerscience somedepartmentsstartmakingo ersinfebruarywithtweekdecisiondeadlines departmentsdon tevenstartinterviewinguntilmarch mitnotoriouslywaitsuntilmay whenall    stablematching finally acentralclearinghouseforinternshipassignments nowcalledthe nationalresidentmatchingprogram nrmp wasestablishedintheearly1950s eachyear doctorssubmitarankedlistofallhospitalswheretheywouldaccept aninternship andeachhospitalsubmitsarankedlistofdoctorstheywould acceptasinterns thenrmpthencomputesanmatchingbetweendoctors andhospitalsthatsatis esthefollowing stability requirement amatchingis unstable ifthereisadoctor andhospital thatwouldbebothhappierwith eachotherthanwiththeircurrentmatch thatis ismatchedwithsomeotherhospital eventhoughsheprefers ismatchedwithsomeotherdoctor eventhoughtheyprefer inthiscase wecall unstablepair forthematching thegoalofthe residentmatchisa stablematching whichisamatchingwithnounstable pairs forsimplicity llassumefromnowonthatthereareexactlythesame numberofdoctorsandhospitals eachhospitalo ersexactlyoneinternship eachdoctorranksallhospitalsandviceversa nally therearenotiesin thedoctors orhospitals rankings  somebadideas rstglance itisnotevenclearthatastablematchingalwaysexists matchingofdoctorsandhospitalsisstable supposetherearethree doctors quincy rotwang shephard representedbylowse letters andthreehospitals arkhamasylum bethlemroyalhospital countygeneralhospital representedbyseletters whorankeach otherasfollows qrs aca cab bbc abc rsq qqr srs thematching aq isunstable becausearkhamwouldratherhire rotwangthandr quincy anddr rotwangwouldratherworkatarkham thanatbedlam isanunstablepairforthismatching itsinterviewsareover beforemaking facultyo ers needlesstosay themishmashofo datesanddecisiondeadlinescausestremendousstress forcandidatesanddepartmentsalike forsimilarreasons since1965 mostamericanuniversitieshaveagreedtoacommonapril15 deadlineforprospectivegraduatestudentstoaccepto ersof nancialsupport andbyextension ersofadmission  inreality mosthospitalso ermultipleinternships eachdoctorranksonlyasubsetofthe hospitalsandviceversa andtherearetypicallymoreinternshipsthaninteresteddoctors thenitstartsgettingcomplicated   greedyalgorithms onemightimagineusinganincrementalalgorithmthatstartswithan arbitrarymatching andthengreedilyperformsexchangestoresolveinstabilities resolvingoneinstabilitycancreatenewones infact incrementalvcanleadtoanin niteloop forexample ifwestart withourearlierunstablematching aq eachofthefollowingexchanges resolvesoneunstablepair indicatedoverthearrow butthesequenceof exchangesleadsbacktotheoriginalmatching  aq bq bq aq aq alternatively wemighttrythefollowingmundgreedyprotocol eachround everyunmatchedhospitalmakesano ertotheirfavoriteunmatched doctor theneveryunmatcheddoctorwithano eracceptstheirfavoriteo snothardtoprovethatatleastonenewdoctspitalpairismatchedin eachround sothealgorithmalwaysendswithamatching fortheprevious exampleinput wealreadyhaveastablematching attheendofthe rstround butconsiderthefollowinginputinstead qrs caa bcb abc abc qqs srr rsq inthe rstround shephardacceptsano erfromcounty anddr quincy acceptsano erfrombedlam rejectingarkham leavingonlydr rotwangandarkhamunmatched theprotocolendswiththematching bq aftertworounds thismatchingisunstable arkham anddr shephardprefereachothertotheirmatches thebostonpoolandgale shapleyalgorithms in1952 thenrmpadoptedthestonpalgorithmtoassigninterns namedbecauseithadbeenpreviouslyusedbyaregionalclearinghouseinthe bostonarea tenyearslater davidgaleandlloydshapleydescribedand formallyanalyzedageneralizationofthebostonpoolalgorithmandprovedthat itcomputesastablematching galeandshapleyusedthemetaphorofcollege admissions essentiallythesamealgorithmwasindependentlydevelopedby elliottperansonin1972foruseinmedicalschooladmissions similaralgorithms havesincebeenadoptedformanyothermatchingmarkets includingfaculty hiringinfrance hiringofneweconomicsphdsintheunitedstates university admissioningermany publicschooladmissioninnewyorkandboston billet assignmentsforusnavysailors andkidnprograms  thisexamplewasdiscoveredbydonaldknuth    stablematching shapleywasawardedthe2012nobelprizeineconomicsforhisresearchon stablematchings togetherwithalvinroth whosigni cantlyextendedshapley workandusedittodevelopseveralreaorldexchanges galedidnotshare theprize becausehediedin2008 likeourlastfailedgreedyalgorithm thegalhapleyalgorithmproceeds inroundsuntileverypositionhasbeenaccepted eachroundhastwostages  anarbitraryunmatchedhospital ersitspositiontothebestdoctor accordingtoa spreferencelist whohasnotalreadyrejectedit  isunmatched tentatively accepts alreadyhas amatchbutprefers sherejectshercurrentmatchand tentatively acceptsthenewo erfrom rejectsthenewo eachdoctorultimatelyacceptsthebesto erthatshereceives accordingtoher preferencelist  inshort hospitalsmakeo ersgreedily anddoctorsaccept ersgreedily thedoctors abilitytorejecttheircurrentmatchesinfavorof bettero ersisthekeytomakingthismutualgreedystrategywork forexample supposethattherearefourdoctors quincy rotwang shephard anddr tam andfourhospitals arkhamasylum bethlemroyal hospital countygeneralhospital andthedharmainitiative whorankeach otherasfollows qrst aabd bdab cccc dbda abcd trts strr rqsq qsqt giventhesepreferencelistsasinput thegalhapleyalgorithmmightproceed asfollows  arkhammakesano ertodr tam  bedlammakesano ertodr rotwang  countymakesano ertodr tam whorejectsherearliero erfrom arkham  dharmamakesano ertodr shephard fromthispointon thereis onlyoneunmatchedhospital sothealgorithmhasnomorechoices  arkhammakesano ertodr shephard whorejectsherearliero fromdharma  the1952bostonpoolalgorithmisaspecialcaseofthegalhapleyalgorithmthatexecutes ersinaparticularorder roughlyspeaking eacho erismadebyahospital whosefavorite doctor amongthosewhohaven trejected ranks highest becausetheorderof ersdependsontheentiresetofpreferencelists thisalgorithm beexecutedbyacentral authority incontrast thegalhapleyalgorithmdoesnotevenrequireeachparticipanttoknow theirownpreferencesinadvance aslongastheybehaveconsistentlywithsome xedrankings   greedyalgorithms  dharmamakesano ertodr rotwang whorejectsherearliero erfrom bedlam  bedlammakesano ertodr tam whorejectsherearliero erfrom county  countymakesano ertodr rotwang whorejectsit  countymakesano ertodr shephard whorejectsit  countymakesano ertodr quincy afterthetenthround allpendingo ersareaccepted andthealgorithmreturns thematching youcan andshould verifybybruteforcethat thismatchingisstable eventhoughnodoctorwashiredbyherfavoritehospital andnohospitalhiredtheirfavoritedoctor infact countyendeduphiringtheir favoritedoctor thisisnot theonlystablematching forthesepreference lists thematching isalsostable runningtime analyzingthenumberofo ersperformedbythealgorithmisrelatively forward whichiswhywe redoingit rst eachhospitalmakesano erto eachdoctoratmostonce sothealgorithmmakesatmost  ers toanalyzetheactual runningtime weneedtospecifythealgorithm inmoredetail howarethepreferencelistsgiventothealgorithm howdoes thealgorithmdecidewhetheranyhospitalisunmatched andifso howdoes ndanunmatchedhospital howdoesthealgorithmstorethetentative matchings howdoesthealgorithmdecidewhetheradoctorprefershernew ertohercurrentmatch mostfundamentally howdoesthealgorithm actuallyrepresentdoctorsandhospitals onepossibilityistorepresenteachdoctorandhospitalbyauniqueinteger  andtorepresentpreferencesastwoarrays dpref   hpref   dpref representsthe thhospitalindoctor spreferencelist hpref representsthe thdoctorinhospital preferencelist withtheinputinthisform thebostonpoolalgorithmcan executeeacho erinconstanttime aftersomeinitialpreprocessing theoverall implementationrunsin  time weleavetheremainingdetailsas straightforwardexercise asomewhatharderexercise istoprovethatthereareinputs andchoicesof whomakeso erswhen thatforce  erstobemadebeforethealgorithm halts  upperboundonthewserunningtimeis tight correctness butwhyisthealgorithm correct atall howdoweknowthatitalwayscomputes astablematching completematchingforthatmatter    stablematching onceadoctorreceivesano shehasatleastatentativematchforthe restoftime equivalently ifanydoctorisunmatched thennohospitalhas eredthatdoctorajob whichimpliesthatthehospitalshavenotexhausted theirpreferencelists itfollowsthatwhenthealgorithmterminates afterat  rounds everydoctorismatched andthereforeeverypositionis lled inotherwords thealgorithmalwayscomputesaperfectmatchingbetween doctorsandhospitals whew itremainsonlytoprovethattheresulting matchingisstable supposethealgorithmmatchessomedoctor tosomehospital thoughsheprefersanotherhospital becauseeverydoctoracceptsthebest ershereceives receivednoo ershelikedmorethan inparticular nevermadeano erto ontheotherhand madeo erstoeverydoctor theypreferovertheir nalmatch itfollowsthat prefers anunstablepair weconcludethattherearenounstable pairs thematchingisstable optimality surprisingly thecorrectnessofthegalhapleyalgorithmdoesnotdepend onwhichhospitalmakesitso erineachround infact nomatterwhich unassignedhospitalmakesano erineachround thealgorithmalwayscomputes thesamematching ssaythat isa feasible doctorfor ifthereisastable matchingthatassignsdoctor tohospital lemma4  duringthegalhapleyalgorithm eachhospital isrejected onlybydoctorsthatareinfeasiblefor proof weprovethelemmabyinductiononthenumberofrounds anarbitraryroundofthealgorithm inwhichdoctor rejectsonehospital foranotherhospital therejectionimpliesthat prefers eachdoctor thatappearshigherthan spreferencelistalreadyrejected inanearlier roundandtherefore bytheinductivehypothesis isinfeasiblefor nowconsideranarbitrarymatching ofthesamedoctorsandhospitals thatassigns wealreadyestablishedthat prefers prefers toitspartner thematchingisunstable ontheotherhand prefersits partnerto byourearlierargument itspartnerisinfeasible andagain thematchingisunstable weconcludethatthereisnostablematchingthat assigns nowlet denotethe feasible doctoron spreference list lemma   impliesthateverydoctorthat preferstoits nalmatchis infeasiblefor ontheotherhand nalmatchingisstable sothedoctor assignedto mustbefeasiblefor thefollowingresultisnowimmediate   greedyalgorithms corollary4  thegalhapleyalgorithmmatches forevery hospital inotherwords thegalhapleyalgorithmcomputesthe bestpossible stable matchingfromthehospitals pointofview itturnsoutthatthismatchingis alsothe worst possiblefromthedoctors pointofview worst denotethe lowfeasiblehospitalondoctor spreferencelist corollary4  thegalhapleyalgorithmmatches worst forevery doctor proof supposegaleandshapleyassigndoctor tohospital weneedto showthat worst consideranarbitrarystablematchingwhere matchedwith butwithanotherdoctor thepreviouscorollaryimpliesthat prefers becausethematchingisstable musttherefore preferherassignedhospitalto thisargumentworksfor stablematching prefers otherfeasiblematchto inotherwords worst asubtleconsequenceofthesetwocorollaries discoveredbylesterdubins anddavidfreedmanin1981 isthatadoctorcanpotentiallyimprovehermatch bylyingaboutherpreferences butahospitalcannot asetofhospitals cancolludesothat oftheirmatchesimprove partlyforthisreason nationalresidencymatchingprogramreverseditsmatchingalgorithmin  sothatpotentialresidentso ertoworkforhospitals accordingtotheir preferenceorders andeachhospitalacceptsitsbesto thenew algorithmcomputesthebestpossiblestablematchingforthedoctors andthe worstpossiblestablematchingforthehospitals inpractice reversalalteredlessthan1 oftheresidents matches asfarasiknow precisee ectofthischangeonthe patients isanopenproblem exercises caveatlector someoftheseexercises besolvedusinggreedy algorithms wheneveryoudescribeandanalyzeagreedyalgorithm alsoincludeaproofthatyouralgorithmiscorrect thisproofwilltypicallytake theformofanexchangeargument theseproofsareespeciallyimportantin classes likemine thatdo normallyrequireproofsofcorrectness  greedyschedule algorithmwedescribedfortheclassscheduling problemisnottheonlygreedystrategywecouldhavetried foreachof thefollowingalternativegreedystrategies eitherprovethattheresulting algorithmalwaysconstructsanoptimalschedule ordescribeasmallinput  exercises exampleforwhichthealgorithmdoes produceanoptimalschedule assumethatallalgorithmsbreaktiesarbitrarily thatis inamannerthat iscompletelyoutofyourcontrol hint ofthesealgorithmsare actuallycorrect choosethecourse endslast discardclassesthatcon ictwith andrecurse choosethecourse starts rst discardallclassesthatcon ict andrecurse choosethecourse startslast discardallclassesthatcon ict andrecurse choosethecourse shortestduration discardallclassesthat ictwith andrecurse chooseacourse ictswiththefewestothercourses discardall classesthatcon ictwith andrecurse ifnoclassescon ict choosethemall discardthecourse longestduration andrecurse ifnoclassescon ict choosethemall discardacoursethat ictswiththemostothercourses andrecurse betheclasswiththe earlieststarttime andlet betheclasswith secondearlieststarttime aredisjoint choose andrecurseoneverythingbut completelycontains discard andrecurse discard andrecurse ifanycourse completelycontainsanothercourse discard recurse choosethecourse endslast discardallclasses thatcon ictwith andrecurse  nowconsideraweightedversionoftheclassschedulingproblem erentclasseso erdi erentnumberofcredithours totallyunrelated tothedurationoftheclasslectures yourgoalisnowtochooseasetof ictingclassesthatgiveyouthelargestpossiblenumberofcredit hours givenarraysofstarttimes endtimes andcredithoursasinput provethatthegreedyalgorithmdescribedatthebeginningofthis chasetheclassthatends rstand returnanoptimalschedule provethat ofthegreedyalgorithmsdescribedinexercise  returnanoptimalschedule hint solveexercise  rst thealgorithms thatdon tworktheredon tworkhere   greedyalgorithms describeandanalyzeanalgorithmthatalwayscomputesanoptimal schedule hint youralgorithmwillnotbegreedy  beasetof intervalsontherealline wesaythatasubsetofintervals covers iftheunionofallintervalsin isequaltotheunionofall intervalsin size ofacoverisjustthenumberofintervals describeandanalyzeane cientalgorithmtocomputethesmallest coverof assumethatyourinputconsistsoftwoarrays   representingtheleftandrightendpointsoftheintervalsin youuseagreedyalgorithm youmustprovethatitiscorrect asetofintervals withacover shaded ofsize   beasetof intervalsontherealline wesaythataset ofpoints stabs ifeveryintervalin containsatleastonepointin describeand analyzeane cientalgorithmtocomputethesmallestsetofpointsthat stabs assumethatyourinputconsistsoftwoarrays   representingtheleftandrightendpointsoftheintervalsin asusual youuseagreedyalgorithm youmustprovethatitiscorrect asetofintervalsstabbedbyfourpoints shownhereasverticalsegments  beasetof intervalsontherealline propercoloring assignsa colortoeachinterval sothatanytwooverlappingintervalsareassigned erentcolors describeandanalyzeane cientalgorithmtocomputethe minimumnumberofcolorsneededtoproperlycolor assumethatyour inputconsistsoftwoarrays   representingtheleftand rightendpointsoftheintervalsin asusual ifyouuseagreedyalgorithm youmustprovethatitiscorrect apropercoloringofasetofintervalsusing vecolors  exercises  foreveryinteger ndafrequencyarray  whosehu man codetreehasdepth  suchthatthelargestfrequencyisassmallas supposethetotallength ofthe unencoded messageisboundedbya polynomialinthealphabetsize provethattheanyhu mantreefor thefrequencies  hasdepth log ª  callafrequencyarray  vy ifitsatis estwoconditions  forall  thatis  isthe unique mostfrequentsymbol   thatis atleastan fractionofthesymbolsare  findthelargestrealnumber suchthatineveryhu mancodeforevery vyfrequencyarray symbol  isrepresentedbyasinglebit hint firstprovethat      describeandanalyzeanalgorithmtocomputeanoptimal ternary codeforagivenarrayoffrequencies  tforgettoprovethat youralgorithmiscorrectfor  describeindetailhowtoimplementthegalhapleystablematching algorithm sothatthewserunningtimeis  asclaimedearlier inthischapter  provethatitispossibleforthegalhapleyalgorithmtoperform  ersbeforetermination youneedtodescribebothasuitableinput andasequenceof  valido ers describeforanyinteger asetofpreferencesfor doctorsand hospitalsthatforcesthegalhapleyalgorithmtoexecute  rounds nomatterwhichvalidproposalismadeineachround hint impliespart  describeandanalyzeane cientalgorithmtodeterminewhetheragiven setofhospitalanddoctorpreferenceshastoa unique stablematching  considerageneralizationofthestablematchingproblem wheresome doctorsdonotrankallhospitalsandsomehospitalsdonotrankalldoctors andadoctorcanbeassignedtoahospitalonlyifeachappearsintheother preferencelist inthiscase therearethreeadditionalunstablesituations amatchedhospitalprefersanunmatcheddoctortoitsassignedmatch amatcheddoctorprefersanunmatchedhospitaltoherassignedmatch anunmatcheddoctorandanunmatchedhospitalappearineachother preferencelists   greedyalgorithms astablematchinginthissettingmayleavesomedoctorsand orhospitals unmatched eventhoughtheirpreferencelistsarenoy forexample ifeverydoctorlistsharvardastheironlyacceptablehospital andevery hospitallistsdr houseastheironlyacceptableintern thenonlyhouseand harvardwillbematched describeandanalyzeane cientalgorithmthatcomputesastable matchinginthismoregeneralsetting hint reducetoaninstance whereeverydoctorrankseveryhospitalandviceversa andtheninvoke galhapley  thescandinavianfurniturecompanyfürnihashired driverstodeliver identicalordersto erentaddressesinwilmington delaware driverhastheirownwablisheddeliveryroutethroughwilmington thatvisitsall addresses assumingtheyfollowtheirroutesastheyalways twodriversnevervisitthesameaddressesatthesametime inprinciple eachofthe driverscandelivertheirfurnituretoanyof addresses butthere sacomplication oneofthedrivershassecretly wiredproximitysensorsandexplosivestothejohannshamnsofas withthe strinnegreenstripepattern iftwosofasareeveratthesameaddressat thesametime bothwillexplode destroyingboththedeliverytruckand thebuildingatthataddress thiscanonlyhappenifonedriverdeliversan ordertothataddress andthenlateranotherdrivervisitsthatsameaddress whilethefurnitureisstillontheirtruck yourjobasthefürnidispatcheristoassigneachdrivertoadelivery address describeanalgorithmtoassignaddressestodriverssothateachof addressesreceivestheirfurnitureorderandtherearenoexplosions forexample supposejack sroutevisits537paperstreetat6pmand franklinstreetat8pm andmarla sroutevisits537paperat7pmand franklinat9pm thenjackshoulddeliverto1888franklin andmarla shoulddeliverto537paper therewouldbeanexplosionat1888 franklinat8pm cuethepixies hint jackandmarlaareabitunstable  supposeyouareasimpleshopkeeperlivinginacountrywith erent typesofcoins withvalues    intheu forexample  andthevaluesare       cents yourbelovedandbenevolentdictator elgeneralissimo hasdecreedthat wheneveryougiveacustomerchange youmustusethesmallestpossible numberofcoins soasnottowearouttheimageofelgeneralissimolovingly engravedoneachcoinbyservantsoftheroyaltreasury intheunitedstates thereisasimplegreedyalgorithmthatalways resultsinthesmallestnumberofcoins subtractthelargestcoinand  exercises recursivelygivechangefortheremainder elgeneralissimodoesnot approveofamericancapitalistgreed showthatthereisasetofcoin valuesforwhichthegreedyalgorithmdoes alwaysgivethesmallest possibleofcoins nowsupposeelgeneralissimodecidestoimposeacurrencysystem wherethecoindenominationsareconsecutivepowers    ofsomeinteger  provethatdespiteelgeneralissimo sdisapproval thegreedyalgorithmdescribedinpart doesmakeoptimalchangein thiscurrencysystem describeandanalyzeane cientalgorithmtodetermine givenatarget andasortedarray  ofcoindenominations thesmallest numberofcoinsneededtomake centsinchange assumethat   sothatitispossibletomakechangeforanyamount  supposeyouaregivenanarray  ofintegers eachofwhichmaybe positive negative orzero acontiguoussubarray iscalleda positive interval ifthesumofitsentriesisgreaterthanzero describeandanalyze analgorithmtocomputetheminimumnumberofpositiveintervalsthat covereverypositiveentryin forexample giventhefollowingarrayas input youralgorithmshouldoutput  ifeveryentryintheinputarrayis negative youralgorithmshouldoutput  sum  sum  sum                considerthefollowingprocess atalltimesyouhaveasinglepositive integer whichisinitiallyequalto  ineachstep youcaneither increment double yourgoalistoproduceatargetvalue youcanproducetheinteger  infourstepsasfollows          obviouslyyoucanproduceanyinteger usingexactly  increments foralmostallvaluesof thisishorriblyine cient describeandanalyze analgorithmtocomputethe minimum numberofstepsrequiredtoproduce anygiveninteger  supposewehave skierswithheightsgiveninanarray  skis withheightsgiveninanarray  describeane cientalgorithmto assignaskitoeachskier sothattheaveragedi erencebetweentheheight ofaskierandherassignedskiisassmallaspossible thealgorithmshould   greedyalgorithms computeapermutation suchthattheexpression   isassmallaspossible  alicewantstothrowapartyandsheistryingtodecidewhotoinvite peopletochoosefrom andsheknowswhichpairsofthesepeople knoweachother shewantstoinviteasmanypeopleaspossible subjectto twoconstraints foreachguest thereshouldbeatleast veothergueststhattheyalready foreachguest thereshouldbeatleast veothergueststhatthey alreadyknow describeandanalyzeanalgorithmthatcomputesthelargestpossiblenumber ofguestsalicecaninvite givenalistof peopleandthelistofpairswho knoweachother  supposewearegiventwoarrays   ofpositiveintegers matrixof  sand  agreeswith foreveryindex throwcontains  andthe thcolumncontains  andanalyzeanalgorithmthateitherconstructsamatrixthatagreeswith orcorrectlyreportsthatnosuchmatrixexists  vejustacceptedajobfromelonmusk deliveringburritosfromsan franciscotonewyorkcity yougettodriveaburritveryvehicle throughelon snewtranscontinentalundergroundburritverytube whichrunsinadirectlinebetweenthesetwocities  yourburritveryvehiclerunsonsinglsebatteries whichmust bereplacedafteratmost100miles theactualfuelisvirtuallyfree thebatteriesareexpensiveandfragile andthereforemustbeinstalledonly byo cialmembersofthetranscontinentalundergroundburritvery vehicleeplacementtechnicians union  evenifyoureplace yourbatteryearly youmuststillpayfullpriceforeachnewbatterytobe installed yourvehicleistoosmalltocarrymorethanonebattery atatime  andwhichwasclearlymodeledaftermaciejcegªowski ctional alweehauken burritotunn  orastheycallthemselvesingerman dietranskontinentaluntergrundburritolieferfahrz batteriewechseltechnikervereinigung  exercises thereareseveralfuelingstationsalongthetube eachstationchargesa erentpriceforinstallinganewbattery beforeyoustartyourtrip carefullyprintthewikipediapagelistingthelocationsandpricesofevery fuelingstationalongthetube giventhisinformation howdoyoudecide thebestplacestostopforfuel moreformally supposeyouaregiventwoarrays   isthedistancefromthestartofthetubetothe thstation isthecosttoreplaceyourbatteryatthe thstation assumethatyour tripstartsandendsatfuelingstations   isthetotal lengthofyourtrip andthatyourcarstartswithanemptybattery soyou mustinstallanewbatteryatstation  describeandanalyzeagreedyalgorithmto ndtheminimumnumber ofrefuelingstopsneededtocompleteyourtrip tforgettoprove thatyouralgorithmiscorrect butwhatyoureallywanttominimizeisthetotal cost oftravel thatyourgreedyalgorithminpart produceanoptimal solutionwhenextendedtothissetting describeane cientalgorithmtocomputethelocationsofthefuel stationsyoushouldstopattominimizethetotalcostoftravel  vebeenhiredtostoreasequenceof booksonshelvesinalibrary orderofthebooksis xedbythecatalogingsystemandcannotbechanged eachshelfmuststoreacontiguousintervalofthegivensequenceofbooks youaregiventwoarrays   respectivelytheheightandthicknessofthe thbookinthesequence shelvesinthislibraryhavethesamelength thetotalthicknessofallbooks onanysingleshelfcannotexceed supposeallthebookshavethesameheight andtheshelveshaveheight largerthan soeverybook tsoneveryshelf describeandanalyzea greedyalgorithmtostorethebooksinasfewshelvesaspossible hint thealgorithmisobvious butwhyisitcorrect thatwasanicewarmup butnowhere stherealproblem infactthe bookshavedi erentheights butyoucanadjusttheheightofeachshelf tomatchthetallestbookonthatshelf inparticular youcanchange theheightofanyemptyshelftozero nowyourtaskistostorethe bookssothatthesumoftheheightsoftheshelvesisassmallaspossible showthatyourgreedyalgorithmfrompart alwaysgivethe bestsolutiontothisproblem describeandanalyzeanalgorithmto ndthebestmatchingbetween booksandshelvesasdescribedinpart   greedyalgorithms  astring ofparentheses balanced ifitsatis esoneofthe followingconditions istheemptystring forsomebalancedstring xy forsomebalancedstrings forexample thestring isbalanced xy describeandanalyzeanalgorithmtodeterminewhetheragivenstring ofparenthesesisbalanced describeandanalyzeagreedyalgorithmtocomputethelengthofa longestbalancedsubsequenceofagivenstringofparentheses asusual tforgettoproveyouralgorithmiscorrect forbothproblems yourinputisanarray  whereforeach bothofyouralgorithmsshouldrunin time  onedayalexgottiredofclimbinginagymanddecidedtotakealarge groupofclimberfriendsoutsidetoclimb theywenttoaclimbingarea withahugewideboulder notverytall withseveralmarkedhandandfoot holds alexquicklydeterminedanllowsetofmovesthathergroupof friendscanperformtogetfromoneholdtoanother theoverallsystemofholdscanbedescribedbyarootedtree vertices whereeachvertexcorrespondstoaholdandeachedgecorresponds toanallowedmovebetweenholds theclimbingpathsconvergeastheygo uptheboulder leadingtoauniqueholdatthesummit representedbythe rootof alexandherfriends whoareallexcellentclimbers decidedtoplaya game whereasmanyclimbersaspossiblearesimultaneouslyontheboulder andeachclimberneedstoperformasequenceof moves climbercanchooseanarbitraryholdtostartfrom andallmovesmustmove awayfromtheground eachclimbertracesoutapathof edges inthetree alldirectedtowardtheroot notwoclimbersare allowedtotouchthesamehold thepathsfollowedbydi erentclimbers cannotintersectatall describeandanalyzeagreedyalgorithmtocomputethemaximum numberofclimbersthatcanplaythisgame youralgorithmisgiven  exercises arootedtree andaninteger asinput anditshouldcomputethe largestpossiblenumberofdisjointpathsin whereeachpathhas length assumethat isabinarytree forexample giventhe treebelowasinput youralgorithmshouldreturntheinteger  figure4  sevendisjointpathsoflength  thisis thelargestsuchsetofpathsinthistree nowsupposeeachvertexin hasanassociated reward andyourgoal istomaximizethetotalrewardoftheverticesinyourpaths insteadof thetotalnumberofpaths showthatyourgreedyalgorithmdoes alwaysreturntheoptimalreward describeane cientalgorithmtocomputethemaximumpossiblereward asdescribedinpart  congratulations youhavesuccessfullyconqueredcamelot transforming theformerbattlhereditarymonarchyintoanancalist commune wherecitizenstaketurnstoactasasortofexecutiv feek butwithallthedecisionsofthato cerrati edataspecial eeklymeeting byasimplemajorityinthecaseofpurelyinternala airs butbyatwmajorityinthecaseofmoremajor asa nalsymbolicact youordertheroundtable surprisingly actualcirculartable tobesplitintopizzwedgesanddistributedtothe citizensofcamelotastrophies eachcitizenhassubmittedarequestforan angularwedgeofthetable speci edbytwoanglorexample sirrobin thebravemightrequestthewedgefrom    andsirlancelot thepuremightrequestthe  wedgefrom   eachcitizenwillbe happyifandonlyiftheyreceive precisely thewedgethattheyrequested someoftheserangesoverlap sosatisfying thecitizens requestsissimplyimpossible welcometopolitics describeandanalyzeanalgorithmto ndthemaximumnumberof requeststhatcanbesatis hint theoutputofyouralgorithmshould notchangeifyourotatethetable donotassumethatanglesareintegers   greedyalgorithms  supposeyouarestandingina eldsurroundedbyseverallargeballoons youwanttouseyourbrandnewacmebrandzac topopallthe balloons withoutmovingfromyourcurrentlocation thezac shootsaweredlaserbeam whichpopsalltheballoonsithits eachshotrequiresenoughenergytopowerasmallcountryforayear wantto reasfewshotsaspossible figure4  nineballoonspoppedbyfourshotsofthezap matic minimumzap problemcanbestatedmoreformallyasfollows aset circlesintheplane eachspeci edbyitsradiusandthe coordinatesofitscenter computetheminimumnumberofraysfromthe originthatintersecteverycirclein yourgoalisto ndane cient algorithmforthisproblem supposeitispossibletoshootaraythatdoesnotintersectanyballoons describeandanalyzeagreedyalgorithmthatsolvestheminimumzap probleminthisspecialcase hint seeexercise  describeandanalyzeagreedyalgorithmwhoseoutputiswithin  optimal thatis istheminimumnumberofraysrequiredtohit everyballoon thenyourgreedyalgorithmmustoutputeither  ofcourse youmustprovethisfact describeanalgorithmthatsolvestheminimumzapproblemin  time ª describeanalgorithmthatsolvestheminimumzapproblemin log time assumeyouhaveasubroutinethattellsyoutherangeofanglesofraysthat intersectsanarbitrarycircle  time thissubroutineisnotdi cult towrite butit snottheinterestingpartoftheproblem  hedistributionsandpartitionsofknowledgearenotlikeseverallinesthatmeet inoneangle andsotouchbutinapoint butarelikebranchesofatreethatmeetin astem whichhathadimensionandquantityofentirenessandcontinuancebefore itcometodiscontinueandbreakitselfintoarmsandboughs francisbacon theadvancementoflearning  thusyousee mostnoblesir howthistypeofsolutionbearslittlerelationshipto mathematics andidonotunderstandwhyyouexpectamathematicianto produceit ratherthananyoneelse leonhardeuler describingthekönigsburgbridgeproblem inalettertocarlleonhardgottliebehler april3  yaturnleftbythe restationinthevillageandtaketheoldpostroadbythe reservoirand thatwon tdo besttocontinuestraightonbythetarroaduntilyoureachtheschoolhouseand thenturnleftontheroadtobennett slakeuntil thatwon tworkeither eastmillinocket yasay cometothinkofit youcan tgettherefromhere robertbryanandmarshalldodge bertandiandotherstoriesfromdowneast   basicgraphalgorithms  introductionandhistory agraphisacollectionofofintegers pairsofpeople pairsof cities pairsofstars pairsofcountries pairsofscienti cpapers pairsofweb pairsofgamepositions pairsofrecursivesubproblems evenpairs ofgraphs mirroringthemostcommonmethodforvisualizinggraphs underlyingobjectsbeingpairedareusuallycalled vertices nodes andthe pairsthemselvesarecalled edges arcs butinfacttheobjectsandpairscan beanythingatall oneoftheearliestexamplesofgraphsare roadnetworks andmapsthereof romanengineersconstructedanetworkofmorethan400000kmofpublicroads acrosseurope westernandcentralasia andnorthernafricaduringtheheight oftheromanempire travelersontheroadnetworkwouldcarry itineraria whichwereeithersimplelistsormorepictorialrepresentationsofthelandmarks anddistancesalongvariousroads tabulapeutingeriana   basicgraphalgorithms scrolldepictingtheentireroman cursuspublicus iswidelybelievedtobea medievalcopyofarevisionofa itinerariumpictum commissionedduringthereignofaugustuscaesar thepeutingertableis notageographicallyaccuratemaoriansdebatewhetheritquali esasa atautanabstractrepresentationoftheroadnetwork similarto amodernsubwaymap citiesalongeachroadareindicatedbykinksinthe curverepresentingthatroad thenamesofthesecitesandthelengthsofroad segmentsbetweenthemarealsoindicatedonthemap themapcontains enoughinformationto ndtheshortestroutebetweenanytwocitiesinthe romanempire seefigure   figure5  asmallexcerptofkonradmiller s1872restorationofthe tabulapeutingeriana showingthe romanroadfrommodern daybirten veteribus topleft throughköln agripina andbonn bonnae mainz mogontiaco topright withbranchestotrier avgtresvirorvm center andmetz matricorvm bottomcenter imagecredits attheendofthebook oneoftheoldestclassicalapplicationsofgraspeci callyt inrepresentinggenealogies complexfamilyhavebeenusedforcenturies tosettlelegalquestionsaboutmarriage inheritance androyalsuccession civil lawintheromanempire lateradoptedascanonlawbytheearlycatholic church forbademarriagebetween rstcousinsorcloserrelatives intheearly ninthcentury thechurchchangedboththerequireddistanceandthemethod ofcomputation wheretheroman computatiolegalis requiredthesumof thedistancestothenearestcommonancestortobeatleastfour thenewer computatiocanonica requiredthemaximumofthetwodistancestobeatleast in1215 bowingtopracticalconsiderations andactualpractice churchrelaxedtheminimumrequireddistanceformarriagetofour  leftdiagraminfigure   illustratesaparticularlyconvolutedcase tiriusand theburgamarryandhaveasongaius afterwhichtiriusdies theburgathen  duringthe11thand12thcenturies thisrestrictiongraduallyexpandedtoincludeuptofour linksbya nity initiallythroughmarriage andlaterthroughalsex betrothal evengodparenting forexample marriagebetweenamanandhissister shusband ssister husband ssisterwasformallyforbidden aswasamarriagebetweenawidowerandhisson wife swidowedmother thesea nityrequirementsweresigni cantlyreducedbutnoteliminated in1215 thechurchonlyabandonedtheconceptofa nity excopulaillicita in1917    introductionandhistory marrieslothar bearshimason anddies nally lotharandberthamarryand haveadaughtergemma cangaius ssonlegallymarrygemma sdaughter figure5  twodiagramsdescribingacomplexmarriagecase fromananonymous15th centurytrea tiseonjohannesandreae superarboribusconsanguinitatisetaf nitatis anearly14th centurytreatise oncanonlaw imagecredits attheendofthebook inthelate1600s frenchmathematicianpierrevarignondevelopeda graphicalmethodfor ndingtheequilibriumpositionofanetwork ofropesundertension buildingonearlierworkbysimonstevinpublished acenturyearlier varignonobservedthatwhentheropesareatequilibrium onecandrawagraphwhoseedgesaresegmentsparalleltotheropes lengthsequaltotheforcesalongthoseropes suchthattheropesmeetingat anypointinthenetworkde neaclosedcycleinthegraph varignon smethod ofphicalstatiwasnotpublishedincompletedetailuntil1725 twoyears afterhisdeath thesegraphsarenowknownas reciprocalforcediagrams maxwonadiagrams afterjamesclerkmaxwellandluigicremona alongwithcarlculmannandothers developedarichtheoryofreciprocal diagramsinthelate1800s figure5  reciprocalforcediagrams dotted fromvarignon sposthumous nouvellemécanique statique dontleprojetfutdonnéenmdclxxxvii newmechanics orstatics whoseprojectwasgiven in1687 imagecredits attheendofthebook   basicgraphalgorithms ofcourse therearemanyotherfamiliarexamplesofgraphs likeboard games datingtoantiquity verticesandedgesofconvexpolyhedra formally studiedbyancientgreekphilosophers butmucholder visualizationsofstar patterns alreadydevelopedineastasiabythe7thcentury knight stours describedbyali rudra aandothersinthe9thand10thcenturies mazes introducedintheirmodernformbygiovannifontanacirca1420 geodetictriangulations introducedbygemmafrisiusin1533 andusedto calculatethecircumferenceoftheearthbywillebrodsnellin1615andtode themeterin1799 leonhardeuler swownpartial  solutiontothebridges ofkönigsburgpuzzle  telegraphandothercommunicationnetworks rstproposedin1753 developedbyronalds schilling gauss weber othersintheearly1800s anddeployedworldwidebythelate1800s electrical circuits formalizedintheearly1800sbyohm maxwell kirchho andothers molecularstructuralformulas introducedindependentlybyaugustkekulé in1857andarchibaldcouperin1858 socialnetworks rststudiedinthe bysociologistjacobmoreno digitalelectroniccircuits proposed bycharlessanderspeircein1886 andcastintotheirmodernformbyclaude shannonin1937 andyeah ifyouinsist themoderninternet thewordfortheabstractmathematicalwascoinedbyjames sylvesterin1878 whoadaptedkekulé scogratodescribecertain algebraicinvariants atthesuggestionofhiscolleaguewilliamcli wordwas rstusedforconnectedacyclicgraphsbyarthurcayleyin  althoughtheabstractconceptoftreeshadalreadybeenusedbygustav kirchho andkarlvonstaudttenyearsearlier thezerothbookongraph theorywaspublishedbyandréaguëin1926 dénesk nigpublished rstgraphtheorybooktenyearslater  basicde nitions formally simple graph isapairofsets isanarbitrary noy niteset whoseelementsarecalled vertices  nodes isa setofpairsofelementsof whichwecall edges inan undirected graph edgesareunorderedpairs orjustsetsofsizetwo iusuallywrite uv todenotetheundirectededgebetween ina directed graph theedgesareorderedpairsofvertices iusuallywrite insteadof denotethedirectededgefrom  eulerdismissedthe nalstepofhisally ndinganeulertourofagraph wheneveryvertexhasevensobvious euleralsofailedtonoticethatagraphwithan eulertourmustbeconnected rstcompleteproofthatagraphhasaneulertourifandonly ifitisconnectedandeveryvertexhasevendegreewaspublishedbycarlhierholzerin1873  thesingularoftheenglishwordertiis vertex thesingularofis matrix andthesingularofis unlessyou respeakingitalian thereisnosuch    basicde nitions followingstandard butadmittedlyconfusing practice iwillalsouse denotethe number ofverticesinagraph todenotethe number ofedges inanyundirectedgraphwehave   andinanydirectedgraph wehave   endpoints ofanedge uv areitsvertices wedistinguish theendpointsofadirectededge bycalling tail head thede nitionofagraphasapairof sets forbidsmultipleundirectededges withthesameendpoints ormultipledirectededgeswiththesameheadand thesametail thesamedirectedgraphcancontainbothadirectededge anditsreversal thede nitionofanundirectededgeasa set ofverticesforbidsanundirectededgefromavertextoitself graphs loopsandparalleledgesareoftencalled simple graphs noegraphs aresometimescalled multigraphs despitetheformalde nitionalgap algorithmsforsimplegraphsextendtomultigraphswithlittleornomodi cation andforthatreason iseenoneedforaformalde nitionhere foranyedge uv inanundirectedgraph wecall neighbor andvice versa andwesaythat adjacent degree ofanodeisitsnumber ofneighbors indirectedgraphs wedistinguishtwokindsofneighbors anydirectededge wecall predecessor andwecall successor ofavertexisitsnumberofpredecessors itsnumberofsuccessors agraph    isa subgraph   propersubgraph isanysubgraphotherthan walk inanundirectedgraph isasequenceofvertices whereeach adjacentpairofverticesareadjacentin informally wecanalsothinkofa walkasasequenceofedges awalkiscalleda path ifitvisitseachvertex atmostonce foranytwovertices inagraph wesaythat reachable containsawalk andthereforeapath anundirectedgraphis connected ifeveryvertexisreachablefromeveryother vertex everyundirectedgraphconsistsofoneormore components whichare itsmaximalconnectedsubgraphs twoverticesareinthesamecomponentif andonlyifthereisapathbetweenthem  awalkis closed ifitstartsandendsatthesamevertex cycle isaclosed walkthatentersandleaveseachvertexatmostonce anundirectedgraphis acyclic ifnosubgraphisacycle acyclicgraphsarealsocalled forests tree isa connectedacyclicgraph orequivalently onecomponentofaforest spanning thingasavertice matrice indice appendice helice apice vortice radice simplice codice directrice dominatrice unice kleenice asterice obelice dogmatice geta cacofonice vitalstatistice geriatrice orjimihendrice ifyouhavetroublerememberingthisrule stickto  componentsareoftencallednnectedcomponbutthisusageisredundant nentsareconnectedbyde nition   basicgraphalgorithms tree ofanundirectedgraph isasubgraphthatisatreeandcontainsevery vertexof agraphhasaspanningtreeifandonlyifitisconnected spanningforest isacollectionofspanningtrees oneforeachcomponent directedgraphsrequireslightlydi erentde nitions directedwalk isa sequenceofvertices    suchthat  isadirectededgefor everyindex directedpathsanddirectedcyclesarede nedsimilarly vertex reachable fromvertex inadirectedgraph ifandonlyif containsa directedwalk andthereforeadirectedpath adirectedgraph stronglyconnected ifeveryvertexisreachablefromeveryothervertex directedgraphis acyclic ifitdoesnotcontainadirectedcycle directedacyclic graphsareoftencalled dags  representationsandexamples themostcommonwaytovisuallyrepresentgraphsisby drawing drawingofagraphmapseachvertextoapointintheplane typicallydrawnas asmallcircleorsomeothershape andeachedgetoacurveorstraightline segmentbetweenthetwovertices agraphis planar ifithasadrawingwhere notwoedgescross suchadrawingisalsocalledan embedding  thesame graphcanhavemanydi erentdrawings soitisimportantnottoconfusea particulardrawingwiththegraphitself inparticular planargraphscanhave noanardrawings figure5  twodrawingsofthesamedisconnectedplanargraphwith13vertices edges andtwo components onlythedrawingontheleftisanembedding drawingsarefarfromtheonlyusefulrepresentationofgraphs forexample intersectiongraph ofacollectionofgeometricobjectshasa nodeforeveryobjectandanedgeforeveryintersectingpairofobjects aparticulargraphcanberepresentedasanintersectiongraphdependsonwhat kindofobjectyouwanttouseforthevertices erenttypesofe segments rectangles circles edi erentclassesofgraphs particularlyusefultypeofintersectiongraphisan intervalgraph whosevertices  confusingly thewordisoftenusedasasynonymforevenwhen theedgesintersect pleasedon tdothat    representationsandexamples areintervalsontherealline withanedgebetweenanytwointervalsthat overlap figure5  thegraphinfigure   isalsotheintersectiongraphof asetoflinesegmentsand setofcircles anothergoodexampleisthe dependencygraph ofarecursivealgorithm dependencygraphsaredirectedacyclicgraphs theverticesareallthedistinct recursivesubproblemsthatarisewhenexecutingthealgorithmonaparticular input thereisanedgefromonesubproblemtoanotherifevaluatingthesecond subproblemrequiresarecursiveevaluationofthe rst forexample forthe fibonaccirecurrence        theverticesofthedependencygrapharetheintegers    andthe edgesarethepairs   foreveryinteger  figure5  thedependencygraphofthepi ngala fibonaccirecurrence asamorecomplexexample recalltherecurrenceforthe editdistance problemfromchapter  edit    min  edit   edit   edit     thedependencygraphofthisrecurrenceisan gridofvertices connectedbyverticaledges  horizontaledges  anddiagonaledges   dynamicprogrammingworkse ciently foranyrecurrencethathasareasonablysmalldependencygraph aproper evaluationorderensuresthateachsubproblemisvisited itspredecessors   basicgraphalgorithms figure5  thedependencygraphoftheeditdistancerecurrence anotherinterestingexampleisthe gurationgraph ofagame puzzle ormechanismliketioe checkers therubik scube thetowerofhanoi oraturingmachine theverticesofthecon gurationgraphareallthevalid gurationsofthepuzzle thereisanedgefromonecon gurationtoanother ifitispossibletotransformonecon gurationintotheotherwithasingle simpleov theprecisede nitiondependsonwhatmovesare allowed evenforreasonablysimplemechanisms thecon gurationgraphcan beextremelycomplex andwetypicallyonlyhaveaccesstolocalinformation aboutthecon gurationgraph figure5  thecon gurationgraphofthe4 disktowerofhanoi gurationgraphsarecloserelativesofthe gametrees weconsideredin chapter  butwithonecrucialdi erence eachstateofagameappears onceinitscon gurationgraph butcanappearmanytimesinitsgametree short gurationgraphsare memoized gametrees ateautomata usedinformallanguagetheorycanbemodeledas labeleddirectedgraphs recallthatadeterministicateautomatonis formallyde nedasae isa nitesetcalled alphabet isa nitesetof states  isthe startstate isthesetof    datastructures acceptingstates isa transitionfunction butitisoftenmore usefultothinkof asadirectedgraph whoseverticesarethestates andwhoseedgeshavetheform foreverystate  andsymbol  basicquestionsaboutthelanguage acceptedby canthenbe phrasedasquestionsaboutthegraph forexample ifandonly ifnoacceptingstate vertexisreachablefromthestartstate vertex finally sometimesonegraphcanbeusedtoimplicitlyrepresentotherlarger graphs agoodexampleofthisimplicitrepresentationisthe subsetconstruction whichisnormallyusedtoconvertnfasintodfas butcanbeappliedto arbitrary directedgraphsasfollows directedgraph wecande anewdirectedgraph    whoseverticesareall subsets ofverticesin andwhoseedges  arede nedasfollows   forsome   wecanmechanicallytranslatethisde nitionintoanalgorithmtoconstruct  butstrictlyspeaking thisconstructionisunnecessary implicit representationof  simportantnottoconfuseanyoftheseexamples representationswiththe actualformal nition agraphisapairofsets isan arbitrary noy niteset isasetofpairs eitherorderedorunordered elementsof inshort agraphisasetofpairsofthings  datastructures inpractice graphsareusuallyrepresentedbyoneoftwostandarddatastru tures adjacencylists adjacencymatrices atahighlevel bothdatastructures arearraysindexedbyvertices thisrequiresthateachvertexhasauniqueinteger identi erbetween  inaformalsense theseintegers thevertices adjacencylists byfarthemostcommondatastructureforstoringgraphsisthe adjacencylist anadjacencylistisanarrayoflists eachcontainingtheneighborsofoneofthe vertices ortheoeighborsifthegraphisdirected  forundirectedgraphs eachedge uv isstoredtwice oncein sneighborlistandoncein sneighbor list fordirectedgraphs eachedge isstoredonlyonce intheneighbor listofthetail forbothtypesofgraphs theoverallspacerequiredforan adjacencylistis  attentivestudentsmightnoticethatdespiteisname anadjacencylistisnotalist nomenclatureisanexampleoftheredherringprinciple incomputerscience asinmathematics aredherringisneithernecessarilyrednornecessarilya sh   basicgraphalgorithms thereareseveraldi erentwaystorepresenttheseneighborlists butthe standardimplementationusesasimplelist theresultingdata structureallowsustolistthe oeighborsofanode  deg time justscan sneighborlist wecandeterminewhether isanedge  deg timebyscanningtheneighborlistof forundirectedgraphs wecanimprovethetimeto  min deg deg bysimultaneously scanningtheneighborlistsofboth stoppingeitherwhenwelocatethe edgeorwhenwefalloftheendofalist figure5  anadjacencylistforourexamplegraph ofcourse linkedlistsarenottheonlydatastructurewecoulduse otherstructurethatsupportssearching listing insertion anddeletionwilldo forexample wecanreducethetimetodeterminewhether uv isanedgeto  log deg byusingabalancedbinarysearchtreetostoretheneighbors orevento  timebyusinganappropriatelyconstructedhashtable  onecommonimplementationofadjacencylistsisthe adjacencyarray whichusesasinglearraytostorealledgerecords withtherecordsofedges incidenttoeachvertexinacontiguousinterval andwithaseparatearray storingtheindexofthe rstedgeincidenttoeachvertex itisuseful tokeeptheintervalsforeachvertexinsortedorder asshowninfigure   sothatwecancheckin logdeg timewhethertwovertices adjacent adjacencymatrices theotherstandarddatastructureforgraphsisthe adjacencymatrix  rst proposedbygeorgesbrunelin1894 theadjacencymatrixofagraph isa matrixof  sand  normallyrepresentedbyatwonalarray   whereeachentryindicateswhetheraparticularedgeispresent speci cally forallvertices ifthegraphisundirected  ifandonlyif uv   thisisa lot moresubtlethanitsounds mostpopularhashingtechniquesdo guarantee fastquerytimes andevenmost good hashingmethodscanguaranteeonly  expected time algorithms wtf foramorethoroughdiscussionofhashing  seefootnote     datastructures figure5  anabstractadjacencyarrayforourexamplegraph anditsactualimplementationasa pairofintegerarrays ifthegraphisdirected  ifandonlyif  forundirectedgraphs theadjacencymatrixisalways symmetric meaning forallvertices uv arejustdi erent namesforthesameedge andthediagonalentries areallzeros directedgraphs theadjacencymatrixmayormaynotbesymmetric andthe diagonalentriesmayormaynotbezero abcdefghijklm              figure5  anadjacencymatrixforourexamplegraph givenanadjacencymatrix wecandecidein  timewhethertwovertices areconnectedbyanedgejustbylookingintheappropriateslotinthematrix wecanalsolistalltheneighborsofavertexin timebyscanningthe correspondingrow orcolumn thisrunningtimeisoptimalintheworstcase butevenifavertexhasfewneighbors westillhavetoscantheentirerowto ndthemall adjacencymatricesrequire  space regardlessof howmanyedgesthegraphactuallyhas sotheyareonlyscientforvery dense graphs   basicgraphalgorithms comparison table   summarizestheperformanceofthevariousstandardgraphdata structures stars indicateexpectedamortizedtimeboundsformaintaining dynamichashtables  standardadjacencylistfastadjacencylistadjacency linkedlists hashtables matrix space  testif uv   min deg deg   testif   deg   list neighbors  deg  deg listalledges  insertedge uvo    deleteedge uvo deg deg   table5  timesforbasicoperationsonstandardgraphdatastructures inlightofthiscomparison onemightreasonablywonderwhyanyonewould useanadjacencymatrix afterall adjacencylistswithhashtablessupport thesameoperationsinthesametime usinglessspace themainreasonisthat forsu cientlydensegraphs adjacencymatricesaresimplerandmoree cient inpractice becausetheyavoidtheoverheadofchasingpointersandcomputing hashfunctions rejustcontiguousblocksofmemory whywouldanyoneuse linkedlists inanadjacencyliststructureto storeneighbors insteadofbalancedbinarysearchtreesorhashtables theprimaryreasoninpracticeisalmostsurely tradition theyweregood enoughfordonaldknuth scode theyshouldbegoodenoughforyo aremoreprincipledarguments oneisthatstandardadjacencylistsareinfact goodenough formostapplications moststandardgraphalgorithmsnever rarely actuallyaskwhetheranarbitraryedgeispresentorabsent orattempt toinsertordeleteedges andsooptimizingthedatastructurestosupportthose operationsisunnecessary butinmyopinion themostcompellingreasonfor standarddata structuresisthatmanygraphsare implicitly representedbyadjacencymatrices andstandardadjacencylists forexample intersectiongraphsareusuallyrepresentedasalistoftheunderlying geometricobjects aslongaswecantestwhethertwoobjectsintersectin constanttime wecanapplyanygraphalgorithmtoanintersectiongraphby pretending thattheinputgraphisstoredexplicitlyasanadjacencymatrix anydatastructurecomposedfromrecordswithpointersbetweenthemcan beseenasadirectedgraph graphalgorithmscanbeappliedtothesedata structuresby pretending thatthegraphisstoredinastandardadjacencylist  tworryifyoudon tunderstandthephraseamortiz    firstsearch wecanapplyanygraphalgorithmtoacon gurationgraph itwererepresentedasastandardadjacencylist providedwecan enumerateallpossiblemovesfromagivencon gurationinconstanttime forthelasttwoexamples wecanenumeratetheedgesleavinganyvertexin timeproportionaltoitsdegree butwe necessarilydetermineinconstant timeiftwoverticesareadjacent isthereapointerfromthisrecordtothat record canwegetfromthiscon gurationtothatcon gurationinonemove weusuallydon thavetheluxuryofreorganizingthepointersineach recordorthemovesoutofagivencon gurationintoamoree cientdata structure astandardadjacencylist withneighborsstoredinlinkedlists istheappropriatemodeldatastructure intherestofthisbook unlessexplicitlystatedotherwise alltimebounds forgraphalgorithmsassumethattheinputgraphisrepresentedbyast dardadjacencylist unlessexplicitlystatedotherwise whenan exerciseasksyoutodesignandanalyzeagraphalgorithm youshouldassume thattheinputgraphisrepresentedinastandardadjacencylist  whatever firstsearch sofarwehaveonlydiscussed local operationsongraphs arguablythemost fundamental global questionwecanaskaboutgraphsis reachability givena graph andavertex thereachabilityquestionaskswhichverticesare reachablefrom thatis forwhichvertices isthereapathfrom sconsideronlyundirectedgraphs llconsiderdirectedgraphsbrie attheendofthissection forundirectedgraphs theverticesreachablefrom arepreciselytheverticesinthesamecomponentas perhapsthemostnaturalreachabilityaleastforpeoplelikeus whoareusedtothinkingrecursiv search thisalgorithmcan bewritteneitherrecursivelyoriteratively sexactlythesamealgorithmeither theonlydi erenceisthatwecanactuallyseetheostackinthe noveversion recursivedfs isunmarked mark foreachedge vw recursivedfs iterativedfs push whilethestackisnotempty pop isunmarked mark foreachedge vw push   basicgraphalgorithms searchisjustone perhapsthemostcommon speciesofa generalfamilyofgraphtraversalalgorithmsthaticall whateversearch thegenerictraversalalgorithmstoresasetofcandidateedgesinsomedata structurethati llcallatheonlyimportantpropertiesofaarethat wecanputstu intoitandthenlatertakestu backout astackisaparticular typeofbag butcertainlynottheonlyone hereisthegenericalgorithm whateverfirstsearch intothebag whilethebagisnotempty fromthebag isunmarked mark foreachedge vw intothebag iclaimthat whateverfirstsearch markseverynodereachablefrom andnothingelse thealgorithmclearlymarkseachvertexin atmost showthatitvisitseverynodeinaconnectedgraph atleast wemodifythe algorithmslightly themodi cationsareinboldred insteadofkeepingvertices inthebag themodi edalgorithmstorespairsofvertices thismodi cation allowsustoremember wheneverwevisitavertex forthe rsttime previousneighborvertexput intothebag wecallthisearliervertex parent whateverfirstsearch inbag whilethebagisnotempty fromthebag isunmarked mark parent foreachedge vw ƒ intothebag lemma5  whateverfirstsearch markseveryvertexreachablefrom andonlythosevertices thesetofallpairs parent parent  nesaspanningtreeofthecomponentcontaining proof firstwearguethatthealgorithmmarkseveryvertex thatisreachable byinductiononthesdistancefrom thealgorithm marks beanyothervertexreachablefrom andlet anypathfrom withtheminimumnumberofedges theremustbesuch apath isreachablefrom thepre xpath isshorter thantheshortestpathfrom sotheinductivehypothesisimpliesthatthe    importantvariants algorithmmarks whenthealgorithmmarks itmustimmediatelyputthe pair intothebag soitmustlatertake outofthebag atwhichpoint thealgorithmimmediatelymarks unlessitwasalreadymarked everypair parent parent  isactuallyanedgeinthe underlyinggraph weclaimthatforanymarkedvertex thepathofparent edges parent parent parent eventuallyleadsbackto weprove thisclaimbyinductionontheorderinwhichverticesaremarked trivially reachablefrom solet beanyothermarkedvertex theparentof mustbe markedbefore ismarked sotheinductivehypothesisimpliesthattheparent path parent parent parent leadsto addingonemoreparentedge parent establishestheclaim thepreviousclaimimpliesthateveryvertexmarkedbythealgorithmis reachablefrom andthatthesetofallparentedgesformsaconnectedgraph becauseeverymarkednodeexcept hasauniqueparent thenumberofparent edgesisexactlyonelessthanthenumberofmarkedvertices weconcludethat theparentedgesformatree analysis therunningtimeofthetraversalalgorithmdependsonwhatdatastructurewe useforthebutwecanmakeafewgeneralobservations isthetime requiredtoinsertasingleitemintothebagordeleteasingleitemfromthebag theforloop ƒ isexecutedexactlyonceforeachmarkedvertex andtherefore atmost times eachedge uv inthecomponentof isputintothebagexactly onceasthepair andonceasthepair soline isexecuted atmost  times finally wecan ttakemorethingsoutofthebagthanweput soline isexecutedatmost   times assumingtheunderlying graph isstoredinastandardadjacencylist whateverfirstsearch runsin time isstoredinanadjacencymatrix therunningtimeof whateverfirstsearch increasesto   importantvariants stack depth ifweimplementtheusinga stack werecoverouroriginal searchalgorithm stackssupportinsertions push anddeletions pop  timeeach sothealgorithmrunsin time thespanningtreeformed bytheparentedgesiscalleda spanningtree theexactshape ofthetreedependsonthestartvertexandontheorderthatneighborsare visitedinsidetheforloop ƒ butingeneral spanningtreesarelong   basicgraphalgorithms andskinny wewillconsiderseveralimportantpropertiesandapplicationsof searchinchapter  queue breadth ifweimplementtheusinga queue wegetadi erentgraversal algorithmcalled search queuessupportinsertions push deletions pull  timeeach sothealgorithmrunsin time thiscase spanningtree formedbytheparentedgescontains shortestpaths fromthestartvertex toeveryothervertexinitscomponent wewillconsidershortestpathsindetailinchapter  theexactshapeof aspanningtreedependsonthestartvertexandontheorderthat neighborsarevisitedintheforloop ƒ butingeneral spanning treesareshortandbushy figure5  adepth rstspanningtreeandabreadth rstspanningtreeofthesamegraph startingatthecentervertex priorityqueue finally ifweimplementtheusinga priorityqueue wegetyetanother familyofalgorithmscalled search becausethepriorityqueuestores atmostonecopyofeachedge insertinganedgeorextractingtheminim priorityedgerequires log time whichimpliesthatsearchrunsin log time idescribesearchasaamilyofaratherthanasingle algorithm becausetherearedi erentmethodstoassignprioritiestotheedges andthesechoicesleadtodi erentalgorithmicbehavior lldescribethree wownvariantsbelow buttherearemanyothers inallthreeexamples weassumethateveryedge uv intheinputgraphhasanoegative weight uv iftheinputgraphisundirectedandweusetheweightofeachedge asitspriority searchconstructsthe minimumspanningtree ofthe componentof surprisingly aslongasalltheedgeweightsaredistinct resultingtreedoes dependonthestartvertexortheorderthatneighbors    importantvariants arevisited inthiscase theminimumspanningtreeisactuallyunique instantiationofsearchiscommonly asusual incorrectly prim salgorithm lldiscussthisandotherminimin moredetailinchapter  nethe length ofapathtobethesumoftheweightsofitsedges canalsocompute shortestpaths inweightedgraphsusingsearch asfollows everymarkedvertex storesadistance dist initiallyweset dist  foreveryothervertex whenweset parent wealsoset dist dist andwhenweinserttheedge intothepriority queue weusethepriority dist assumingalledgeweightsare positive dist isthelengthoftheshortestpathfrom thisinstantiation ofsearchiscommonly asusual strictlyspeaking incorrectly knownas dijkstra salgorithm llseethisalgorithmagaininchapter  finally nethe width ofapathtobethe minimum weightofanyedge inthepath asimplemodi cationofsearchalgorithm computes widestpaths toeveryotherreachablevertex widestpaths arealsocalled bottleneckshortestpaths everymarkedvertex storesa width initiallyweset width  foreveryothervertex weset parent wealsoset width min width whenweinserttheedge intothepriorityqueue weusethepriority min width widestpathsareusefulinalgorithmsforcomputing maximum ows youguessedit llconsiderinchapter  disconnectedgraphs whateverfirstsearch onlyvisitstheverticesreachablefromasinglestart vertex tovisit vertexin wecanusethefollowingsimple function wfsall forallvertices unmark forallvertices isunmarked whateverfirstsearch wait ihearyouask whyareyoumakingthissocomplicated whynotjust  scanthevertexarray markeveryvertexduh forallvertices mark  thiswordisalmostalwaysasignalthatyouaremissingsomethingimportant   basicgraphalgorithms youhaveancompletelistofvertices thenyoucandothat rememberthatnotallgraphsarerepresentedsoexplicitly  moreimportantly evenifwedohaveanexplicitvertexlist theorderinwhichthisnaivealgorithm visitsverticesisdeterminedbytheirorderinthe datastructure notbythe abstractstructureofthegraph inparticular unlikeanaivescanthroughthevertices wfsall visitsall theverticesinonecomponent andthenalltheverticesinthenextcomponent andsoonthrougheachcomponentoftheinputgraph thiscompon componenttraversalallowsus forexample tocountthecomponentsofa disconnectedgraphusingasinglecounter countcomponents count  forallvertices unmark forallvertices isunmarked count count  whateverfirstsearch returncount withjustabitmorework wecanrecordwhichcomponentcontainseachvertex insteadofmerelymarkingit countandlabel count  forallvertices unmark forallvertices isunmarked count count  labelone count return count labelonecomponent labelone count whilethebagisnotempty fromthebag isunmarked mark comp count foreachedge vw intothebag wfsall markseveryvertexonce putseveryedgeintothebagonce takeseveryedgeoutofthebagonce sotheoverallrunningtimeis isthetimeforabagoperation inparticular ifwerunsearch orsearchateveryvertex theresultingalgorithmstillrequiresonly time whateverfirstsearch computesaspanningtreeof onecomponent wecanuse wfsall tocomputeaspanning forest oftheentire  ontheotherhand ifwestoreaampateveryvertexindicatingthelasttimeitwas thenwecaneveryvin  timebyrecordingthestarttimeofour traversal andconsideringavertexifitstimestampislaterthantherecordedstart time    graphreductions floodfill graph inparticular searchwithedgeweightsasprioritiescomputes theminimeightspanningforestin log shockingly atleastone extremely popularalgorithmstextbookclaimsthat thiswrappercanonlybeusedwithsearch  thisclaimis atly incorrect infact rst implementationofsearch written around1945bykonradzuseinhisprotanguage plankalkül wasdevelopedfor thespeci cpurposeofcountingandlabelingthecomponentsofanundirected graph directedgraphs whatevsearchiseasytoadapttodirectedgraphs theonlydi erenceis thatwhenwemarkavertex weputallofits eighborsintothebag infact ifweareusingstandardadjacencylistsoradjacencymatrices wedonothave tochangethecodeatall whateverfirstsearch intothebag whilethebagisnotempty fromthebag isunmarked mark foreachedge intothebag ourearlierproofimpliesthatthealgorithmmarkseveryvertexreachable andthedirectededges parent nearootedtree withalledges directedawayfromtheroot evenifthegraphisconnected weno longernecessarilyobtaina spanning treeofthegraph becausereachabilityis nolongersymmetric onthegrippinghand whateverfirstsearch doesde neaspanningtree oftheverticesreachablefrom byvaryingtheinstantiationofthe wecanobtainaspanningtree aspanningtree minimeightdirectedspanningtree astree ora treeofthosereachablevertices  graphreductions floodfill oneoftheearliestmodernexamplesofwhatevsearchwasproposed byedwardmooreinthea pixelmap isatwonalarray  toquotedirectly nlikesearch whosepredecessorsubgraphformsatree thepredecessorsubgraphproducedbyasearchmaybecomposedofseveraltrees becausethesearchmayrepeatfrommultipleso   basicgraphalgorithms whosevaluerepresentcolors theindividualentriesinthearrayarecalled pixels anabbreviationof pictureelements  connectedregion inapixelmapisa connectedsubsetofpixelsthatallhavethesamecolor wheretwopixelsare consideredadjacentiftheyareimmediatehorizontalorverticalneighbors ood operation commonlyrepresentedbyapaintcaninraphics editingsoftware changeseverypixelinaconnectedregiontoanewcolor inputtotheoperationconsistsoftheindices ofonepixelinthetarget regionandthenewcolor figure5  anexampleof ood problemcanbereducedtothereachabilityproblembychasing thede nitions wede neanundirectedgraph whoseverticesare theindividualpixels andwhoseedgesconnectneighboringpixelswiththe samecolor eachconnectedregioninthepixelmapisacomponentof problem reduces toareachabilityproblemin wecansolvethis reachabilityproblemusingwhatevsearchin startingatthegivenpixel withoneminormodi cation wheneverwemarkavertex weimmediately changeitscolor foran pixelmap thegraph  verticesandat   edges sowhatevsearchrunsin  time thissimpleexampledemonstratestheessentialingredientsofa reduction ratherthansolvingthe problemfromscratch weuseanexisting algorithmasablsubroutine whatevsearchworksisutterly irrelevanthere allthatmattersisits speci cation givenagraph anda startingvertex markeveryvertexin thatisreachablefrom likeanyother subroutine westillhavetodescribehowtoconstructtheinputandhowto useitsoutput wealsohavetoanalyze resultingalgorithmintermsof inputparameters nottheverticesandedgesofwhateverintermediategraph ouralgorithmconstructs nowthatwehaveanalgorithmthatwut noecanapply twoeasyoptimizationstomakeitfaster onepracticalandtheothertheoretical  beforetheadventofmodernrasterdisplaydevicesinthe1960s pixelsweremorecommonly knownas stitches tesserae dependingonwhethertheyweremadeofthreadorverysmall rocks theword pix becameastandardabbreviationfor picture intheearly20thot longafter sox becameacommonpluralof sock antingtheearliercolloquialism piccy alsovoxel volumeelement texel textureelement andtaxel tactileelementand orbadger  exercises inanactualimplementation wewouldnotactuallybuildaseparategraph datastructurefor wecanusethepixelmapdirectly asthough wereastandardadjacencylist becausewecanlisttheorneighbors ofanypixelin  timeeach inparticular thereisnoneedtoseparately vertices wecanusethecolorofthepixelsinstead morecarefulanalysisimpliesthattherunningtimeisproportionalto thenumberofpixelsintheregionbeing llvalently thenumber ofverticesincomponentof containingvertex chcouldbe considerablysmallerthan  exercises graphs  provethatthefollowingde nitionsareallequivalent atreeisaconnectedacyclicgraph atreeisonecomponentofaforest aforestisanacyclicgraph atreeisaconnectedgraphwith atmost  edges atreeisaminimallyconnectedgraph removinganyedgedisconnects thegraph atreeisanacyclicgraphwith atleast  edges atreeisamaximallyacyclicgraph addinganedgebetweenanytwo verticescreatesacycle atreeisagraphthatcontainsauniquepathbetweeneachpairof vertices  provethatanyconnectedacyclicgraphwith  verticeshasatleast twoverticeswithdegree  donotusethewordsoreaforany wownpropertiesoftrees yourproofshouldfollowentirelyfromthe nitionsofnnand  agraph bipartite ifthevertices canbepartitionedintotwo subsets suchthateveryedgehasonevertexin andtheotherin provethateverytreeisabipartitegraph provethatagraph isbipartiteifandonlyifeverycyclein hasan evennumberofedges describeandanalyzeane cientalgorithmthatdetermineswhethera givenundirectedgraphisbipartite   basicgraphalgorithms  whenevergroupsofpigeonsgather theyinstinctivelyestablisha pecking order foranypairofpigeons onepigeonalwayspeckstheother driving itawayfromfoodorpotentialmates thesamepairofpigeonsalways choosesthesamepeckingorder evenafteryearsofseparation nomatter whatotherpigeonsarearound surprisingly theoverallpeckingordercan containcyclorexample pigeon peckspigeon whichpeckspigeon whichpeckspigeon whichpeckspigeon provethatany nitepopulationofpigeonscanbeplacedinaprocession perhapsaparade sothateachpigeonpeckstheprecedingpigeon posterior prettyplease supposeyouaregivenadirectedgraphrepresentingthepecking lationshipsamongasetof pigeons thegraphcontainsonevertex perpigeon anditcontainsanedge ifandonlyifpigeon pecks pigeon describeandanalyzeanalgorithmtocomputeapeckingorder forthepigeons asguaranteedbypart provethatforanysetofatleastthreepigeons eitherthepeckingorder describedinpart isunique ortherearethreepigeons suchthatpigeon peckspigeon whichpeckspigeon whichpecks pigeon  eulertour ofagraph isaclosedwalkthrough thattraversesevery edgeof exactlyonce provethatifaconnectedgraph hasaneulertour theneveryvertex hasevendegree eulerprovedthis provethatifeveryvertexinaconnectedgraph hasevendegree hasaneulertour eulerdid provethis describeandanalyzeanalgorithmtocomputeaneulertourinagiven graph orcorrectlyreportthatnosuchtourexists eulervaguelywaved hishandsatthis  onalhypercubeisthegraphde nedasfollows thereare  vertices eachlabeledwithadi erentstringof bits twoverticesare joinedbyanedgeiftheirlabelsdi erinexactlyonebit ahamiltoniancycleinagraph isacycleofedgesin thatenterseach vertexof exactlyonce provethatforall  onal hypercubehasahamiltoniancycle whichhypercubeshaveaneulertour aclosedwalkthattraversesevery edgeexactlyonce hint thisisveryeasy  exercises traversalalgorithms  recallthatadirectedgraph stronglyconnected foranytwovertices thereisapathin andapathin describeanalgorithmtodetermine givenan undirected graph input whetheritispossibletodirecteachedgeof sothattheresulting directedgraphisstronglyconnected  beaconnectedgraph andlet beaspanningtreeof rootedatsomenode provethatif isalsoaspanningtree rootedat  professorsepprichandgoodsteinproposethefollowingoptimizationofthe genericwhatevsearchalgorithm insteadofcheckingwhetherthe verticeswetakeoutofthebagaremarked theiralgorithmchecksbeforeit evenputsthevertexintothebag therebyensuringthateachvertexisput intothebagatmostonce theiralgorithmalsoassignstheparentofeach vertexwhenthatvertexismarked eagerwfs mark intothebag whilethebagisnotempty fromthebag foreachedge vw isunmarked mark parent intothebag provethat eagerwfs markseverynodereachablefrom andnothing equivalently provethattheparentedges parent computed eagerwfs neaspanningtreeofthecomponentcontaining provethatifthebagisimplementedasaqueue eagerwfs isequivalent tosearch meaningthetwoalgorithmsmarkthesame verticesinthesameorderandconstructthesamespanningtree hint whatisthede nitionofaqueue provethat eagerwfs equivalenttosearch nomatter whatdatastructureisusedasthebag andthus inparticular whenthe bagisastack eagerwfs recursivedfs specifytheorderthatedges vw ateachvertex areconsidered anddi erentedgeordersmaylead todi erentspanningtrees youneedtoargue forsomeexplicit graph thatnospanningtreeof producedby recursivedfs canbe constructedby eagerwfs bagdatastructure orviceversa   basicgraphalgorithms  oneoftheearliestpublisheddescriptionsofwhatevsearchasa genericclassofalgorithmswasbyedsgerdijkstra leslielamport alain martin carelscholten andelisabethste ensin1975 aspartofthedesign ofanautomaticgarbagecollector insteadofmaintainingmarkedand unmarkedvertices theiralgorithmmaintainsacolorforeachvertex iseitherwhite gray orblack asusual inthefollowingalgorithm imaginea xedunderlyinggraph threecolorsearch colorallnodeswhite color gray whileatleastonevertexisgray threecolorstep threecolorstep anygrayvertex hasnowhiteneighbors color black anywhiteneighborof parent color gray provethat threecolorsearch maintainsthefollowinginvariantat alltimes noblackvertexisaneighborofawhitevertex hint shouldbeeasy provethatafter threecolorsearch terminates allvertices ablefrom areblack allverticesnotreachablefrom arewhite thattheparentedges parent nearootedspanningtreeofthe componentcontaining hint intuitively blacknodesareandgraynodesare theunlikeourformulationof whateverfirstsearch theoralgorithmisnotrequiredtoprocessalledgesoutofa nodeatthesametime provethatthefollowingvariantof threecolorsearch tainsthesetofgrayverticesinastandardstack isequivalentto search hint theorderofthelasttwolinesof colorstackstep matters threecolorstacksearch colorallnodeswhite color gray push ontothestack whileatleastonevertexisgray threecolorstackstep threecolorstackstep pop fromthestack hasnowhiteneighbors color black anywhiteneighborof parent color gray push ontothestack push ontothestack provethatthefollowingvariantof threecolorsearch tainsthesetofgrayverticesinastandardqueue equivalent  exercises tosearch hint theorderofthelasttwolinesof threecolorqueuestep tmatter threecolorqueuesearch colorallnodeswhite color gray push intothequeue whileatleastonevertexisgray threecolorqueuestep threecolorqueuestep pull fromthequeue hasnowhiteneighbors color black anywhiteneighborof parent color gray push intothequeue push intothequeue ª nowsupposethatanotherprocessisaddingedgesto colorsearch isrunning thesenewedgescouldviolatethecolor invariantdescribedinpart andthereforedestroythecorrectness oftheaparticular threecolorsearch terminates someverticesreachablefrom couldbewhite thiswouldbedisastrous ifwearerelyingontomeanbleandthereforesafeto del iftheotherprocessexplicitlypreservesthecolorinvariant wecanstillusetheoralgorithmtosafelyidentifyunreachable vertices wemodelthetwoconcurrentalgorithmsasfollows orchoicein garbagecollect andthechoiceofwhichvertices mutate areentirelyoutofthemainalgorithm scontrol  garbagecollect colorallverticeswhite color gray whileatleastonevertexisgray collectstep mutate collectstep anygrayvertex hasnowhiteneighbors color black anywhiteneighborof color gray  thisisa dramatic oversimpli cationoftheandswectionalgorithms actuallyusedinmlanguageslikeluaandgo amorethoroughdiscussionof mdynamicmemorymanagementisunfortunatelybeyondthescopeofthisbook exceptforthefirstcommandment thoushaltnotrollthineowngarbagecollector   basicgraphalgorithms mutate anyvertex anyvertex uw isnotanedge addedge uw isblackand iswhite color gray iswhiteand isblack color gray provethat garbagecollect eventuallyterminateswitheveryvertex reachablefrom coloredblackandeveryvertexnotreachablefrom coloredwhite ª supposeinsteadofrecoloringblackverticesgray mutate maintainsthe colorinvariantbycoloringsome white verticesgray mutate anyvertex anyvertex uw isnotanedge addedge uw isblackand iswhite color gray iswhiteand isblack color gray provethat garbagecollect eventuallyterminateswith coloredblack everyvertexreachablefromablackvertexcoloredblack andevery vertexnotreachablefromablackvertexcoloredwhite reductions  numbermaze isan gridofpositiveintegers atokenstartsinthe upperleftcorner yourgoalistomovethetokentothelowcorner oneachturn youareallowedtomovethetokenup left orright thedistanceyoumaymovethetokenisdeterminedbythenumberonits currentsquare forexample ifthetokenisonasquarelabeled  thenyou maymovethetokenthreestepsup threestepsdown threestepsleft threestepsright youareneverallowedtomovethetokeno edgeoftheboard describeandanalyzeane cientalgorithmthateitherreturnsthe minimumnumberofmovesrequiredtosolveagivennumbermaze correctlyreportsthatthemazehasnosolution forexample giventhe numbermazeinfigure   youralgorithmshouldreturntheinteger   snakesandladders isaclassicboardgame originatinginindianolater thanthe16thcentury theboardconsistsofan gridofsquares  exercises figure5    numbermazethatcanbesolvedineightmoves numberedconsecutivelyfrom   startinginthebottomleftcornerand proceedingrowbyrowfrombottomtotop withrowsalternatingtothe leftandright certainpairsofsquaresinthisgrid alwaysindi erentrows areconnectedbyeithera leadingdown leadingup eachsquarecanbeanendpointofatmostonesnakeorladder youstartwithatokenincell  inthebottomleftcorner ineachmove youadvanceyourtokenupto positions forsome xedconstant ifthe tokenendsthemoveatthe endofasnake itslidesdowntothebottom ofthatsnake ifthetokenendsthemoveatthe endofa ladder itclimbsuptothetopofthatladder describeandanalyzeanalgorithmtocomputethesmallestnumberof movesrequiredforthetokentoreachthelastsquareofthegrid figure5  asnakesandladdersboard upwardstraightarrowsareladders downwardwavyarrows aresnakes  theinfamousmongolianpuzzlarriorvidrachitkyledainventedthe followingpuzzleintheyear1473 thepuzzleconsistsofan grid ofsquares whereeachsquareislabeledwithapositiveinteger andtwo tokens oneredandtheotherblue thetokensalwayslieondistinctsquares ofthegrid thetokensstartinthetopleftandbottomrightcornersofthe grid thegoalofthepuzzleistoswapthetokens   basicgraphalgorithms inasingleturn youmaymoveeithertokenup orleft bya distancedeterminedbythe token forexample iftheredtokenisona squarelabeled  thenyoumaymovethebluetoken  stepsup  stepsleft  stepsright  stepsdown youmaynotmoveeithertokeno thegrid andattheendofamovethetwotokenscannotlieonthesame square describeandanalyzeane cientalgorithmthateitherreturnsthe minimumnumberofmovesrequiredtosolveagivenvidrachitkyleda puzzle orcorrectlyreportsthatthepuzzlehasnosolution forexample giventhepuzzleinfigure   youralgorithmwouldreturnthenumber  figure5  movesolutionfora   vidrachitkyledapuzzle  supposeyouaregivenadirectedgraph andtwovertices describeandanalyzeanalgorithmtodetermineifthereisawalkin possiblyrepeatingverticesand oredges whoselengthisdivisible  forexample giventhegraphshownbelow withtheindicatedv tices youralgorithmshouldreturn true becausethewalk haslength6  supposeyouaregivenadirectedgraph wheresomeedgesareredandthe remainingedgesareblue describeanalgorithmto ndtheshortestwalk fromonevertex toanothervertex inwhichnothreeconsecutive edgeshavethesamecolor thatis ifthewalkcontainstworededgesina row thenextedgemustbeblue andifthewalkcontainstwoblueedgesin arow thenextedgemustbered forexample giventhefollowinggraphasinput youralgorithmshould returntheinteger  istheshortestlegal walkfrom  exercises  consideradirectedgraph whereeachedgeiscoloredeitherred white orblue awalkin iscalleda french agwalk ifitssequenceofedge colorsisred white blue red white blue andsoon moreformally awalk   isafrench agwalkif foreveryinteger theedge  isredif mod3  whiteif mod3  andblueif mod3  describeanalgorithmto ndallverticesin thatcanbereachedfrom agivenvertex throughafrench agwalk  thereare galaxiesconnectedby intergalactictelays telayjoinstwogalaxiesandcanbetraversedinbothdirections eachtelay hasanassociatedcostof dollars isa positiveinteger atelaycanbeusedmultipletimes butthetollmust bepaideverytimeitisused judywantstotravelfromgalaxy togalaxy butteleportationisnot verypleasantandshewouldliketominimizethenumberoftimessheneeds toteleport shewantsthetotalcosttobeamultipleof vedollars becausecarryingsmallchangeisnotpleasanteither describeandanalyzeanalgorithmtocomputethesmallestnumberof timesjudyneedstoteleporttotravelfromgalaxy togalaxy sothat thetotalcostisamultipleof vedollars solvepart butnowassumethatjudyhasacouponthatallowsher touseexactlyonetelayforfree  threeseashellsisasolitairegame playedonaconnectedundirected graph initially threetokensareplacedondistinctstartvertices ineachturn allthree tokens bymovingeachtokenalong anedgefromitscurrentvertextoanadjacentvertex attheendofeach turn thethreetokens lieonthreedi erentvertices yourgoalisto movethetokensontothreegoalvertices itdoesnotmatterwhich tokenendsuponwhichgoalvertex figure5  theinitialcon gurationofthethreeseashellspuzzleandthe rsttwoturnsofasolution describeandanalyzeanalgorithmtodeterminewhetheragiventhree seashellspuzzleissolvable yourinputconsistsofthegraph thestart vertices andthegoalvertices youroutputisasinglebit true false   basicgraphalgorithms  beaconnectedundirectedgraph supposewestartwithtwocoinson twoarbitrarilychosenverticesof andwewanttomovethecoinssothat theylieonthesamevertexusingasfewmovesaspossible ateverystep eachcoin movetoanadjacentvertex describeandanalyzeanalgorithmtocomputetheminimumnumberof stepstoreachacon gurationwherebothcoinsareonthesamevertex ortoreportcorrectlythatnosuchcon gurationisreachable theinput toyouralgorithmconsistsofagraph andtwovertices  whichmayormaynotbedistinct nowsupposetherearethreecoins describeandanalyzeanalgorithm tocomputetheminimumnumberofstepstoreachacon gurationwhere bothcoinsareonthesamevertex ortoreportcorrectlythatnosuch gurationisreachable finally supposethereare fortywo coins describeandanalyzean algorithmtodeterminewhetheritispossibletomoveall  coinstothe samevertex coinmustmoveat step forfullcredit youralgorithmshouldrunin time  oneofmydaughter selementmathworkbooks  containsseveral puzzlesofthefollowingtype completeeachanglemazebelowbytracingapathfromstartto nishthat hasonlyacuteangles describeandanalyzeanalgorithmtosolvearbitraryemazes youaregivenaconnectedundirectedgraph whoseverticesarepoints intheplaneandwhoseedgesarelinesegments edgesdonotintersect exceptattheirendpoints forexample adrawingoftheletter wouldhave veverticesandfouredges andthe rstmazeabovehas18verticesand21 edges youarealsogiventwovertices start finish youralgorithmshouldreturn true containsawalkfrom start finish thathasonlyacuteangles false formally awalk isvalidif foranytwoconsecutiveedges inthewalk ü uvw ˇ  ü uvw ˇ  assumeyouhaveasubroutinethat candeterminein  timewhethertheanglebetweentwogivensegments isstraight obtuse oracute  jasonbattersonandshannonrogers beastacademymath practice3a  https beastacademy resources printables forseveralmoreexamples  exercises  supposeyouaregivenasetof horizontalandverticallinesegmentsand twopoints intheplane describeane cientalgorithmtodetermine ifthereisapathfrom thatdoesnotintersectanyofthegivenline segments eachhorizontallinesegmentisspeci edbyitsleftandright ates anditsunique ate eachverticallinesegmentisspeci byitsunique ateanditstopandbottom ates finally thepoints areeachspeci edbytheir ates figure5  apathbetweentwopointsinamazeofhorizontalandverticallinesegments  everycheesyromancemoviehasascenewheretheromanticcouple alongandfrustratingseparation suddenlyseeeachotheracrossalong distance andthenslowlyapproachoneanotherwithunwaveringeyecontact asthemusicrollsinandtherainliftsandthesunshinesthroughtheclouds andthemusicswellsandeveryonestartsdancingwithrainbowsandkittens andchocolateunicornsand  supposearomanticcouplgrandcomputersciencetradition named aliceandtheirfavoriteparkattheeastandwestentrancesand immediatelyestablishntact theycan tjustrundirectlytoeachother theymuststayonthepaththatagsthroughtheparkbetween theeastandwestentrances tomaintaintheproperdramatictension alice andbobmusttraversethepathsothattheyalwayslieonadirecteaest wecandescribethezigzagpathastwoarrays   containingthe atesofthecornersofthepath inorderfrom thesouthwestendpointtothesoutheastendpoint arrayissortedin increasingorder  thepathisasequenceofstraightline segmentsconnectingthesecorners suppose    foreveryotherindex thatis theendpointsofthepatharestrictlybeloweveryotherpointonthepath  funfact damienchazelle thedirectorof whiplash lalaland isthesonofprinceton computerscienceprofessorandelectricguitaristbernardchazelle   basicgraphalgorithms figure5  aliceandbobmeet alicewalksbackwardinstep2 andbobwalksbackwardinsteps5 and6 provethatforanypath meetingtheseconditions aliceandbobcan meet hint describeagraphthatmodelsallpossiblelocations ofthecouplealongthepath whataretheverticesofthisgraph aretheedges usethe handshakelemma everygraphhasaneven numberofverticeswithodddegree iftheendpointsofthepathare beloweveryothervertex aliceand bobmightstillbeabletomeet ortheymightnot describeanalgorithm todecidewhetheraliceandbobcanmeet withouteitherbreaking eaesteyecontactorsteppingo thepath giventhearrays   asinput ª describeanalgorithmforpart thatrunsin time  thefamouspuzzlkerkanielthedaneinventedasolitairegameplayed withtwotokensonan squaregrid somesquaresofthegridare markedas obstacles andonegridsquareismarkedasthe target ineach turn theplayermustmoveoneofthetokensfromiscurrentposition asfar aspossible upward downward orleft stoppingjustbeforethetoken hits  theedgeoftheboard  anobstaclesquare  theothertoken thegoalistomoveeitherofthetokensontothetargetsquare forexample wecansolvethepuzzleshowninfigure   bymoving theredtokendownuntilithitstheobstacle thenmovingthegreentoken leftuntilithitstheredtoken andthenmovingtheredtokenleft andup theredtokenstopsatthetargetonthe6thmove greentokenisjustabovethetargetsquare describeandanalyzeanalgorithmtodeterminewhetheraninstanceof thispuzzleissolvable yourinputconsistoftheinteger alistofobstacle locations thetargetlocation andtheinitiallocationsofthetokens  exercises figure5  aninstanceofkanielthedane spuzzlethatcanbesolvedinsixmoves circlesindicate initialtokenpositions blacksquaresareobstacles thecentersquareisthetarget outputofyouralgorithmisasingleboolean true ifthegivenpuzzleis solvableand false hint tforgetaboutthetimerequired toconstructthegraph ª  rectanglewalk isanewabstractpuzzlegame availableforonly99 steam ios android xboxone playstation5 nintendowiiu atari2600 palmpilot commodore64 sinclairzxdecpdpplato zusez3 duramesc odhnerarithmometer analyticalengine jacquard loom horologiummirabilelundense leibnizsteppedreckoner azari robotband yanshi sautomaton antikytheramechanism knottedrope ishangobone andpileofrocks thegameisplayedonan gridofblackandwhitesquares theplayer movesarectanglethroughthisgrid subjecttothefollowingconditions therectanglemustbealignedwiththegrid thatis thetop left andrightcoordinatesmustbeintegers therectanglemust twithinthe grid anditmustcontainatleast onegridcell therectanglemustnotcontainablacksquare inasinglemove theplayercanreplacethecurrentrectangle withany rectangle  thateithercontains oriscontainedin initially theplayer srectangleisa   squareintheupperrightcorner theplayer sgoalistoreacha   squareinthebottomleftcornerusing asfewmovesaspossible figure5  rst vestepsofarectanglewalk   basicgraphalgorithms describeandanalyzeanalgorithmtocomputethelengthoftheshortest rectanglewalkinagivenbitmap yourinputisanarray    indicatesablacksquareand  indicatesa whitesquare assumethatavalidrectanglewalkexists inparticular    forexample giventhebitmapshownabove algorithmshouldreturntheinteger18 hint tforgetaboutthetime requiredtoconstructthegraph  racetrack alsoknownas graphracers vectorrally isatwayer pacilracinggamethatje playedonthebusin5thgrade  gameisplayedwithatrackdrawnonasheetofgraphpaper theplayers alternatelychooseasequenceofgridpointsthatrepresentthemotionofa cararoundthetrack subjecttocertainconstraintsexplainedbelow velocityposition                                                                     figure5  a16 stepracetrackrun ona25 track thisis theshortestrunonthistrack eachcarhasa position anda velocity bothwithinteger coordinates asubsetofgridsquaresismarkedasthe startingarea anothersubsetismarkedasthe nishingarea theinitialpositionofeachcar ischosenbytheplayersomewhereinthestartingarea theinitialvelocityof eachcarisalways   ateachstep theplayeroptionallyincrementsor decrementseitherorbothcoordinatesofthecar svelocity inotherwords eachcomponentofthevelocitycanchangebyatmost  inasinglestep car snewpositionisthendeterminedbyaddingthenewvelocitytothecar previousposition thenewpositionmustbeinsidethetrack carcrashesandthatplayerlosestherace theraceendswhenthe rstcar reachesapositioninsidethe nishingarea  theactualgameisabitmorecomplicatedthantheversiondescribedhere harmmade vectorracer foranexcellentonlineversion  exercises supposetheracetrackisrepresentedbyan arrayofbits  bitrepresentsagridpointinsidethetrack  bitrepresentsa gridpointoutsidethetrack theartingisthe rstcolumn andthe hingisthelastcolumn describeandanalyzeanalgorithmto ndtheminimumnumberofsteps requiredtomoveacarfromthestartinglinetothe nishlineofagiven racetrack  rollingdiemaze isapuzzleinvolvingastandarddie acubewith numbersoneachside andagridofsquares youshouldimaginethegrid lyingonatable thediealwaysrestsonandexactlycoversonesquareof thegrid inasinglestep youcan roll thedie90degreesaroundoneofits bottomedges movingittoanadjacentsquareonestepnorth south east orwest somesquaresinthegridmaybe blocked thediecanneverrestona blockedsquare othersquaresmaybe labeled withanumber wheneverthe dierestsonalabeledsquare thenumberonthe faceofthediemust equalthelabel squaresthatareneitherlabelednormarkedare free maynotrollthedieo theedgesofthegrid arollingdiemazeis solvable ifitispossibletoplaceadieonthelowerleftsquareandrollittotheupper rightsquareundertheseconstraints figure5  rollingadie figure   showsfourrollingdiemazes assumingweuseastandard diewith   onoppositesides onlythe rsttwomazesaresolvable forexample rstmazeissolvablebybyplacingthedieonthelower leftsquarewith  onthetopface andthenrollingthedieeast thennorth thennorth theneast figure5  fourrollingdiemazes onlythe rsttwoaresolvable supposetheinputisatwonalarray   whereeach entry storesthelabelofthesquareinthe throwand thcolumn  meansthesquareisfreeand  meansthesquareisblocked   basicgraphalgorithms describeandanalyzeapolynomiaalgorithmtodeterminewhether thegivenrollingdiemazeissolvable ª nowsupposethemazeisspeci implicitly byalistoflabeledand blockedsquares speci cally supposetheinputconsistsofaninteger specifyingtheheightandwidthofthemaze andanarray  whereeachentry isatriple indicatingthatsquare haslabel asintheexplicitencoding label  indicatesthatthe squareisblocked freesquaresarenotlistedin atall describeand analyzeane cientalgorithmtodeterminewhetherthegivenrolling diemazeissolvable forfullcredit therunningtimeofyouralgorithm shouldbepolynomialintheinputsize hint youhavesomefreedominhowtoplacetheinitialdie thereare rollingdiemazesthatcanbesolvedonlyiftheinitialpositionischosen correctly ª  supposeyouaregivenanarbitrarydirectedgraph inwhicheachedgeis coloredeitherredorblue alongwithtwospecialvertices describeanalgorithmthateithercomputesawalkfrom suchthat thepatternofredandblueedgesalongthewalkisapalindrome correctlyreportsthatnosuchwalkexists describeanalgorithmthateithercomputesthe shortest walkfrom suchthatthepatternofredandblueedgesalongthewalkisa palindrome orcorrectlyreportsthatnosuchwalkexists hint wheredidwelastseepalindromes ª  draughts alsoknownintheunitedstatesasisagameplayed onan gridofsquares alternatelycoloredlightanddark  thegame isusuallyplayedonan     board buttheruleseasilygeneralize toanyboardsize eachdarksquareisoccupiedbyatmostonegamepiece usuallycalleda checker intheu whichiseitherblackorwhite light squaresarealwaysempty oneplayermovesthewhitepieces theothermovestheblackpieces aplayerloseswhenherlast pieceistakeno theboard  thecountingtablesusedbymedievalenglishgovernmentaccountantswerecoveredbya greenclothwithblacksquaresinacheckerpattern dishapedcounterswereplacedinthese squarestorepresentvalues forthisreason thebritishgovernment saccountantshavebeen collectivelyknownsincethe10thcenturyasthe exchequer theactualcountingtableswereused bytheexchequertotallytaxpaymentswellintothe19thcentury  exercises considerthefollowingsimpleversionofthegame essentiallyamerican checkersorbritishdraughts butwhereeverypieceisaking  piecescan bemovedinanyofthefourdiagonaldirections oneachturn aplayer moves oneofherpiecesonestepdiagonallyintoanemptysquare ormakesaseriesof jumps withoneofherpieces ineachjump thepiece movestoanemptysquaretwostepsawayinanydiagonaldirection onlyiftheintermediatesquareisoccupiedbyapieceoftheoppositecolor thisenemypieceis captured andimmediatelyremovedfromtheboard jumpsinthesameturnmustbemadewiththesamepiece describeanalgorithmtodecidewhetherwhitecancaptureeveryblack piece therebywinningthegame inasingleturn theinputconsistsof thewidthoftheboard alistofpositionsofwhitepieces andalist ofpositionsofblackpieces forfullcredit youralgorithmshouldrun time isthetotalnumberofpieces hint thegreedy kearbitraryjumpsuntilyougetstu awinningsequenceofjumpsevenwhenoneexists seeproblem  parity parity parity figure5  whitewinsinoneturn figure5  whitecannotwininoneturnfromeitherofthesepositions  mostothervariantsofdraughtshavewhichbehave erentlythankings inthebritish americangame andwhichmakethisproblem moredi cult aswewillsee inchapter   forthehousiscrinkledtoandfro andhathsoqueinteweyesforto forhitisshapenasthemaseiswr thertohaveiaremedieinmythoght byacleweoftwyne ashehathgoon thesameweyhemayreturneanoon folwingalweythethreed ashehathcome geoffreychaucer thelegendofgoodwomen  èbelloilmondoecomesonobruttiidissisollevato sarebbebelloilmondosecifosseunaregolapergirareneilabirinti risposeilmiomaestro beautifultheworldis andhowuglylabyrinthsare isaid relieved beautifultheworldwouldbeiftherewereaprocedureformovingthrough labyrinths mymasterreplied umbertoeco ilnomedellarosa  englishtranslation thenameoftherose bywilliamweaver   depth firstsearch inthepreviouschapter weconsideredagenerica ortraversingarbitrarygraphs bothundirectedanddirected inthis chapter wefocusonaparticularinstantiationofthisalgorithmcalled search andprimarilyonthebehaviorofthisalgorithmindirectedgraphs althoughsearchcanbeaccuratelydescribedas searchwithastthealgorithmisnormallyimplementedrecursively thanusinganexplicitstack dfs isunmarked mark foreachedge dfs   depth firstsearch wecanmakethisalgorithmslightlyfaster inpractice bycheckingwhether anodeismarked werecursivelyexploreit thismodi cationensures thatwecall dfs onlyonceforeachvertex wecanfurthermodifythe algorithmtocomputeotherusefulinformationabouttheverticesandedges byintroducingtwoblsubroutines previsit postvisit whichwe leaveunspeci edfornow dfs mark previsit foreachedge vw isunmarked parent dfs postvisit recallthatanode reachable fromanothernode inadirectedgraph ormoresimply canreach andonlyif containsadirectedpathfrom reach denotethesetofverticesreachablefrom including ifweunmarkallverticesin andthencall dfs thesetofmarked verticesisprecisely reach reachabilityinundirectedgraphsissymmetric canreach ifandonly canreach asaresult afterunmarkingallverticesofanundirected graph calling dfs traversestheentirecomponentof andtheparent pointersde neaspanningtreeofthatcomponent thesituationismoresubtlewithdirectedgraphs asshowninthe gure eventhoughthegraphisnndi erentverticescanreach erent andpotentiallyoverlapping portionsofthegraph theparent pointersassignedby dfs neatreerootedat whoseverticesare precisely reach butthisisnotnecessarilyaspanningtreeofthegraph figure6  depth rsttreesrootedatdifferentverticesinthesamedirectedgraph asusual wecanextendourreachabilityalgorithmtotraversethe entire inputgraph evenifitisdisconnected usingthestandardwrapperfunction shownontheleftinfigure   hereweaddagenericblsubroutine    preorderandpostorder preprocess toperformanynecessarypreprocessingforthe previsit postvisit functions dfsall preprocess forallvertices unmark forallvertices isunmarked dfs dfsall preprocess addvertex forallvertices addedge unmark dfs figure6  twoformulationsofthestandardwrapperalgorithmfordepth rstsearch alternatively ifweareallowedtomodifythegraph wecanaddanew source vertex withedgestoeveryothervertexin andthenmakeasingle callto dfs asshownontherightoffigure   nowtheresultingparent pointersalwaysde neaspanningtreeofthe augmented inputgraph butnotof original inputgraph thetwowrapperfunctionshaveessentially identicalbehavior choosingoneortheotherisentirelyamatterofconvenience  thisalgorithmbehavesslightlydi erentlyforundirectedanddirected graphs inundirectedgraphs aswesawinthepreviouschapter itiseasyto adapt dfsall tocountthecomponentsofagraph inparticular theparent pointerscomputedby dfsall neaspanningforestoftheinputgraph containingaspanningtreeforeachcomponent whenthegraphisdirected dfsall maydiscoveranynumberofmponbetween  evenwhenthegraphisnndependingontheprecisestructureofthe graphandtheorderinwhichthewrapperalgorithmvisitsthevertices  preorderandpostorder hopefullyyouarealreadyfamiliarwithpreorderandpostordertraversalsof rooted trees bothofwhichcanbecomputedusingsearch traversalorderscanbede nedforarbitrarydirectedgraeniftheyare disconnectpassingaroundacounter asshowninfigure   equiv lently wecanuseourgenericalgorithmwiththefollowing subroutines preprocess previsit postvisit preprocess clock  previsit clock clock  pre clock postvisit clock clock  post clock  theequivalenceofthesetwowrapperfunctionsisaspeci cfeatureof depth search inparticular wrapping breadth searchinafooptovisiteveryvertexdoes yieldthe sametraversalorderasaddingasourcevertexandinvokingsearchat   depth firstsearch dfsall clock  forallvertices unmark forallvertices isunmarked clock dfs clock dfs clock mark clock clock  pre clock foreachedge isunmarked parent clock dfs clock clock clock  post clock return clock figure6  ningpreorderandpostorderviadepth rstsearch ineitherformulation thisalgorithmassignsassigns pre andadvancesthe clock justafterpushing ontotherecursionstack anditassigns post advancestheclock justbeforepopping therecursionstack itfollowsthat foranytwovertices theintervals pre post pre post eitherdisjointornested pre post pre post ifand onlyif dfs iscalledduringtheexecutionof dfs orequivalently ifand onlyif isanancestorof inthe nalforestofparentpointers dfsall labelseverynodeinthegraph thelabels pre nea preordering ofthevertices andthelabels post nea postordering ofthe vertices  withafewtrivialexceptions everygraphhasseveraldi erent andpostorderings dependingontheorderthat dfs considersedgesleaving eachvertex andtheorderthat dfsall considersvertices fortherestofthischapter wereferto pre asthe startingtime lessformally post asthe nishingtime orlessformally nisandtheintervalbetweenthestartingand nishingtimesas activeinterval orlessformally isactiv classifyingverticesandedges duringtheexecutionof dfsall eachvertex oftheinputgraphhasoneof threestates dfs hasnotbeencalled thatis clock pre active dfs hasbeencalledbuthasnotreturned thatis pre clock post nished dfs hasreturned thatis post clock becausestartingand nishingtimescorrespondtopushesandpopsonthe recursionstack avertexisactiveifandonlyifitisontherecursionstack followsthattheactivenodesalwayscompriseadirectedpathin  confusingly oftheseordersaresometimescalledpleasedon dothat    preorderandpostorder figure6  adepth rstforestofadirectedgraph andthecorrespondingactiveintervalsofitsvertices ningthepreordering abfgchdlokpeinjm andthepostordering dkoplhcgfbamjnie forestedgesare solid dashededgesareexplainedinfigure   theedgesoftheinputgraphfallintofourdi erentclasses dependingon howtheiractiveintervalsintersect fixyourfavoriteedge isnewwhen dfs dfs mustbecalledduringthe executionof dfs eitherdirectlyorthroughsomeintermediaterecursive calls ineithercase isaproperancestorof intheforest pre pre post post dfs calls dfs directly parent iscalleda treeedge iscalleda forwardedge isactivewhen dfs isalreadyontherecursionstack whichimpliestheoppositenestingorder pre pre post post mustcontainadirectedpathfrom edgessatisfyingthis conditionarecalled backedges nishedwhen dfs weimmediatelyhave post pre edgessatisfyingthisconditionarecalled crossedges finally thefourthordering post pre isimpossible theseedgeclassesareillustratedinfigure   theactualclassi cation ofedgesdependsontheorderinwhich dfsall considersverticesandtheorder inwhich dfs considerstheedgesleavingeachvertex   depth firstsearch figure6  classi cationofedgesbydepth rstsearch finally thefollowingkeylemmacharacterizesancestorsanddescendantsin anyforestaccordingtovertexstatesduringthetraversal lemma6  fixanarbitrarytraversalofanydirectedgraph followingstatementsareequivalentforallvertices isanancestorof intheforest pre pre post post justafter dfs iscalled isactive justbefore dfs iscalled thereisapathfrom inwhichevery vertex including isnew proof suppose isanancestorof intheforest thenby nitionthereisapath oftreeedges byinductiononthepath length wehave pre pre post post foreveryvertex thuseveryvertexin isnewbefore dfs iscalled inparticular wehave pre pre post post whichimpliesthat isactivewhile dfs executing becauseparentpointerscorrespondtorecursivecalls pre pre post post impliesthat isanancestorof suppose isactivejustafter dfs iscalled pre pre post post whichimpliesthatthereisapathof zeroormore treeedgesfrom throughtheintermediatenodesontherecursionstack ifany finally suppose isnotanancestorof fixanarbitrarypath bethe rstvertexin thatisnotadescendantof andlet thepredecessorof theedge guaranteesthat pre post post post isadescendantof pre post itfollowsthat pre pre becauseotherwise wouldbeadescendantof becauseactive intervalsareproperlynested thereareonlytwopossibilities post post isactivewhen dfs iscalled post pre isalready nishedwhen dfs iscalled    detectingcycles weconcludethat pathfrom containsavertexthatisnotnewwhen dfs iscalled  detectingcycles directedacyclicgraph dag isadirectedgraphwithnodirectedcycles anyvertexinadagthathasnoincomingverticesiscalleda source anyvertex withnooutgoingedgesiscalleda sink anisolatedvertexwithnoincident edgesatallisbothasourceandasink everydaghasatleastonesourceand onesink butmayhavemorethanoneofeach forexample inthegraphwith verticesbutnoedges everyvertexisasourceandeveryvertexisasink figure6  adirectedacyclicgraph vertices aresources vertices aresinks recallfromourearliercaseanalysisthatif post post foranyedge thegraphcontainsadirectedpathfrom andthereforecontainsadirected cycle throughtheedge wecandeterminewhetheragivendirected graph isadagin timebycomputingapostorderingofthevertices andthencheckingeachedgebybruteforce alternatively insteadofnumberingthevertices wecanexplicitlymaintain thestatusofeachvertexandimmediatelyreturn false ifweeverdiscover anedgetoanactivevertex thisalgorithmalsorunsin time figure   isacyclic forallvertices status forallvertices status isacyclicdfs false return false return true isacyclicdfs status active foreachedge status active return false elseif status isacyclicdfs false return false status finished return true figure6  alinear timealgorithmtodetermineifagraphisacyclic   depth firstsearch  topologicalsort topologicalordering ofadirectedgraph isatotalorder onthevertices suchthat foreveryedge lessformally atopologicalordering arrangestheverticesalongahorizontallinesothatalledgespointfromleftto atopologicalorderingisclearlyimpossibleifthegraph hasadirected cyclrightmostvertexofthecyclewouldhaveanedgepointingtotheleft ontheotherhand consideranarbitrarypostorderingofanarbitrary directedgraph ourearlieranalysisimpliesthat post post foranyedge containsadirectedpathfrom andthereforecontainsa directedcyclethrough equivalently isacyclic post post everyedge itfollowsthateverydirectedacyclicgraph hasatopological ordering inparticular thereversalofanypostorderingof isatopological orderingof figure6  reversedpostorderingofthedagfromfigure   ifwerequirethetopologicalorderinginaseparatedatastructure wecan simplywritetheverticesintoanarrayinreversepostorder time showninfigure   implicittopologicalsort butrecordingthetopologicalorderintoaseparatedatastructureisusually overkill inmostapplicationsoftopologicalsort theorderedlistofthevertices isnotouractualgoal wewanttoperformsome xedcomputationat eachvertexofthegraph eitherintopologicalorderorinreversetopological order fortheseapplications itisnotnecessaryto record thetopologicalorder atall    topologicalsort topologicalsort forallvertices status clock forallvertices status clock topsortdfs clock return  topsortdfs clock status active foreachedge status clock topsortdfs clock elseif status active failgracefully status finished clock clock clock  return clock figure6  explicittopologicalsort ifwewanttoprocessadirectedacyclicgraphin reverse topologicalorder itsu cestoprocesseachvertexattheendofitsrecursivesearch afterall topologicalorderisthesameasreversedpostorder postprocess forallvertices status forallvertices isunmarked postprocessdfs postprocessdfs status active foreachedge status postprocessdfs elseif status active failgracefully status finished process ifwealready thattheinputgraphisacyclic wecanfurthersimplifythe algorithmbysimplymarkingverticesinsteadofrecordingtheirsearchstatus postprocessdag forallvertices unmark forallvertices isunmarked postprocessdagdfs postprocessdagdfs mark foreachedge isunmarked postprocessdagdfs process thisisjustthestandardsearchalgorithm postvisit renamed process becauseitissuchacommonoperationondirectedacyclicgraphs isometimes expresspostorderprocessingofadagidiomaticallyasfollows postprocessdag forallvertices inpostorder process   depth firstsearch forexample ourearlierexplicittopologicalsortalgorithmcanbewrittenas topologicalsort clock forallvertices inpostorder clock clock clock  return  toprocessadagin forward topologicalorder wecanrecordatopological orderingoftheverticesintoanarrayandthenrunasimplefoop alternatively wecanapplysearchtothe reversal denoted rev byreplacingeacheach withitsreversal reversingadirectedcycle givesusanotherdirectedcyclewiththeoppositeorientation sothereversal ofadagisanotherdag everysourcein isasinkin rev andviceversa followsinductivelythateverytopologicalorderingof rev isthereversalofa topologicalorderingof  thereversalofanydirectedgraph representedina standardadjacencylist canbecomputedin time thedetailsofthis constructionareleftasaneasyexercise  memoizationanddynamicprogramming ourtopologicalsortalgorithmisarguablythemodelforawideclassofdynamic programmingalgorithms recallthatthe dependencygraph ofarecurrence hasavertexforeveryrecursivesubproblemandanedgefromonesubproblem toanotherifevaluatingthe rstsubproblemrequiresarecursiveevaluation ofthesecond thedependencygraphmustbeacyclic orthenaïverecursive algorithmwouldneverhalt evaluatinganyrecurrencewithmemoizationis thesameasperf ingasearchofthedependencygraph inparticular avertexofthe dependencygraphisifthevalueofthecorrespondingsubproblemhas alreadybeencomputed theblsubroutines previsit postvisit areproxiesfortheactualvaluecomputation seefigure   carryingthisanalogyfurther evaluatingarecurrence usingdynamic gramming isthesameasevaluatingallsubproblemsinthedependencygraphof therecurrenceinreversetopologicalerysubproblemisconsidered thesubproblemsitdependson dynamicprogramminga gorithmisequivalenttoapostordertraversalofthedependencygraphofits underlyingrecurrence  apostorderingofthereversalof isnotnecessarilythereversalofapostorderingof eventhoughbotharetopologicalorderingsof    memoizationanddynamicprogramming memoize isunde ned initialize forallsubproblems memoize update basedon nalize dfs isunmarked mark previsit foralledges dfs postvisit figure6  memoizedrecursionisdepth rstsearch depth rstsearchismemoizedrecursion dynamicprogramming forallsubproblems inpostorder initialize forallsubproblems update basedon nalize figure6  dynamicprogrammingispostordertraversal therearesomeminordi erencesbetweenmostdynamic mingalgorithmsandtopologicalsort inmostdynamicprogramming algorithms thedependencygraphis implicit nodesandedgesarenot explicitlystoredinmemory butratherareencodedbytheunderlying rence butthisdi erencereallyisminor aslongaswecanenumeraterecursive subproblemsinconstanttimeeach wecantraversethedependencygraph asif itwereexplicitlystoredinanadjacencylist moresigni cantly mostdynamicprogrammingrecurrenceshavehighly structureddependencygraphs forexample aswediscussedinchapter  thedependencygraphfortheeditdistancerecurrenceisaregulargridwith diagonals andthedependencygraphforoptimalbinarysearchtreesisan uppertriangulargridwithallpossiblerightwardandupwardedges regularstructureallowsustoasuitableevaluationorderdirectlyinto thealgorithm typicallyasacollectionofnestedloops sothereisnoneedto topologicallysortthedependencygraphatruntime wepreviouslycalledthe reversetopologicalorderan evaluationorder dynamicprogrammingindags conversely wecanusesearchtobuilddynamicprogramming algorithmsforproblemswithlessstructureddependencygraphs forexample considerthe longestpath problem whichasksforthepathof maximum total weightfromonenode toanothernode inadirectedgraph withweighted edges ingeneraldirectedgraphs thelongestpathproblemis byan easyreductionfromthetravelingsalesmanproblem seechapter  butitis   depth firstsearch figure6  thedependency dag oftheeditdistancerecurrence easytoiftheinputgraph isacyclic wecancomputethelongestpathin lineartime asfollows fixthetargetvertex andforanynode llp denotethelength ofthelongestpathin isadag thisfunctionsatis esthe recurrence llp  max llp  denotesthegivenweightofedge max inparticular isa sink butnotequalto llp thedependencygraphforthisrecurrenceistheinputgraph subproblem llp dependsonsubproblem llp ifandonlyif isan edgein wecanevaluatethisrecursivefunctionin timeby performingasearchof startingat thealgorithmmemoizes eachlength llp intoanextra eldinthecorrespondingnode longestpath return  llp isunde ned llp foreachedge llp max llp longestpath return llp inprinciple wecantransformthismemoizedrecursivealgorithmintoa dynamicprogrammingalgorithmviatopologicalsort    strongconnectivity longestpath foreachnode inpostorder llp  llp foreachedge llp max llp llp return llp thesetwoalgorithmsarearguablyidenticarecursioninthe rstalgorithm andthefoopinthesecondalgorithmrepresentthe search choosingoneoftheseformulationsovertheotherisentirelyamatter ofconvenience almostanydynamicprogrammingproblemthatasksforanoptimal sequence ofdecisionscanberecastas ndinganoptimal path insomeassociateddag thetextsegmentation subsetsum longestincreasingsubsequence andeditdistanceproblemsweconsideredinchapters   canallbe reformulatedas ndingeitheralongestpathorashortestpathinadag withweightedverticesoredges ineachcase thedaginquestionisthe dependencygraphoftheunderlyingrecurrence ontheotherhand shadynamicprogrammingproblems ndingoptimalbinarysearch treesormaximumindependentsetsintrees cannotberecastas ndingan optimal path inadag  strongconnectivity sgobacktotheproperde nitionofconnectivityindirectedgraphs recall thatonevertex reach anothervertex inadirectedgraph adirectedpathfrom andthat reach denotesthesetofallvertices canreach twovertices stronglyconnected canreach canreach adirectedgraphisstronglyconnectedifandonlyifevery pairofverticesisstronglyconnected tediousde nitiosingimpliesthatstrongconnectivityisanequivalence relationoverthesetofverticesofanydirectedgraph justlikeconnectivityin undirectedgraphs theequivalenceclassesofthisrelationarecalledthe connectedcomponents moresimply strongcomponents equi alently astrongcomponentof isamaximalstronglyconnectedsubgraph adirectedgraph isstronglyconnectedifandonlyif hasexactlyone strongcomponent attheotherextreme isadagifandonlyifeverystrong componentof consistsofasinglevertex strongcomponentgraphscc isanotherdirectedgraphobtained bycontractingeachstrongcomponenttoasinglevertexandcollapsing   depth firstsearch paralleledges thestrongcomponentgraphissometimesalsocalledthe metph condensation snothardtoprove hint hint scc isalwaysadag atleastinprinciple itispossibletotopologicallyorder thestrongcomponentsof thatis theverticescanbeorderedsothatevery edgejoinstwoedgesinthesamestrongcomponent figure6  thestrongcomponentsofagraph andthestrongcomponentgraph scc itisstraightforwardtocomputethestrongcomponentofasinglevertex time firstwecompute reach viawhatevsearch wecompute reach   reach bysearchingthereversalof finally thestrongcomponentof istheintersection reach reach  wecandeterminewhethertheentiregraphisstronglyconnectedin time wecancompute thestrongcomponentsinadirectedgraph bycombiningthepreviousalgorithmwithourstandardwrapperfunction theresultingalgorithmrunsin time thereareatmost strong components andeachrequires timetodiscover evenwhenthegraphisa dag surelywecandobetter afterall weonlyneed timetodecide whethereverystrongcomponentisasinglevertex  strongcomponentsinlineartime infact thereareseveralalgorithmstocomputestrongcomponentsin time allofwhichrelyonthefollowingobservation lemma6  fixatraversalofanydirectedgraph eachstrong component containsexactlyonenodethatdoesnothaveaparentin eitherthisnodehasaparentinanotherstrongcomponent orithasnoparent proof beanarbitrarystrongcomponentof consideranypathfrom onevertex  toanothervertex  everyvertexonthispathcanreach andthuscanreacheveryvertexin symmetrically everynodeonthispathcan bereachedby andthuscanbereachedbyeveryvertexin weconclude thateveryvertexonthispathisalsoin    strongcomponentsinlineartime bethevertexin withtheearlieststartingtime hasaparent parent startsbefore andthuscannotbein nowlet beanothervertexin justbefore dfs iscalled everyvertex isnew sothereisapathofnewverticesfrom lemma   impliesthat isadescendantof intheforest everyvertexonthe pathoftreeedges liesin inparticular parent  thepreviouslemmaimpliesthateachstrongcomponentofadirected graph nesaconnectedsubtreeofanyforestof inparticular foranystrongcomponent thevertexin withtheearlieststartingtimeisthe lowestcommonancestorofallverticesin wecallthisvertexthe root figure6  strongcomponentsarecontiguousinthedepth rstforest llpresenttwoalgorithms bothofwhichfollowthesameintuitiveoutline beanystrongcomponentof thatisasinkin scc wecall sink component equivalently isasinkcomponentifthereachofanyvertex isprecisely wecan ndallthestrongcomponentsin byrepeatedly ndingavertex insomesinkcomponent ndingthevertices reachablefrom andremovingthatsinkcomponentfromtheinputgraph untilnoverticesremain thisisn tquiteanalgorithmyet becauseit snotclear howto ndavertexinasinkcomponent strongcomponents count  isnoy count count  anyvertexinasinkcomponentof magic forallvertices reach label count add remove anditsincomingedgesfrom figure6  almostanalgorithmtocomputestrongcomponents   depth firstsearch kosarajuandsharir salgorithm rstglance ndingavertexinasinkcomponent seemsquitedi cult sactuallyquiteeasyto ndavertexina source componstrong componentof thatcorrespondstoa source scc singsearch lemma6  thelastvertexinanypostorderingof liesinasourcecomponent proof fixatraversalof andlet bethelastvertexintheresulting postordering dfs mustbethelastdirectcallto dfs madebythe wrapperalgorithm dfsall istherootofoneofthetreesin theforest soanynode post pre isadescendantof finally istherootofitsstrongcomponent forthesakeofargument supposethereisanedge suchthat   canreach canreach canreach istherootof vertex isadescendantof andthus pre pre theedge guaranteesthat pre post andtherefore pre post itfollows isadescendantof butthen canreach throughtreeedges contradictingourassumptionthat  itiseasytocheck hint hint rev scc scc rev foranydirected graph vertexinapostorderingof rev liesina sink component oftheoriginalgraph ifwetraversethegraphasecondtime wherethe wrapperfunctionfollowsareversepostorderingof rev theneachcallto dfs visitsexactlyonestrongcomponentof  puttingeverythingtogether weobtainthealgorithmshowninfigure   whichcountsandlabelsthestrongcomponentsofanydirectedgraphin time thisalgorithmwasdiscovered butneverpublished byraokosaraju in1978 andlaterindependentlyrediscoveredbymichasharirin1981  kohariralgorithmhastwophases rstphaseperformsa searchof rev pushingeachvertexontoastackwhenitis nished inthe secondphase weperforma traversaloftheoriginalgraph consideringverticesintheordertheyappearonthestack thealgorithmlabels eachvertexwiththerootofitsstrongcomponent withrespecttothesecond traversal figure   showsthekohariralgorithmrunningonourexample graph withonlyminormodi cationstothealgorithm wecanalsocompute thestrongcomponentgraph scc time  areversepostorderingof rev isnotthesameasapostorderingof  therearerumorsthatthesamealgorithmappearsintherussianliteratureevenbefore kosaraju butihaven tfoundareliablesourceforthatrumoryet    strongcomponentsinlineartime kosarajusharir newemptystack forallvertices unmark root phase1 pushinpostorderinrev forallvertices isunmarked pushpostrevdfs phase2 dfsagaininstackorder isnoy pop root labelonedfs pushpostrevdfs mark foreachedge reversed isunmarked pushpostrevdfs push labelonedfs root foreachedge root labelonedfs figure6  thekosaraju sharirstrongcomponentsalgorithm figure6  thekosaraju shariralgorithminaction depth rsttraversalofthereversedgraph depth rsttraversaloftheoriginalgraph visitingrootverticesinreversedpostorderfromthe rsttraversal   depth firstsearch ª tarjan salgorithm anearlierbutconsiderablymoresubtlelinalgorithmtocomputestrong componentswaspublishedbybobtarjanin1972  intuitively tarjan salgorithm identi esa source componentof andthenv ndsthe remainingstrongcomponents theentirecomputationhappensduring asinglesearch fixanarbitrarytraversalofsomedirectedgraph foreach vertex low denotethesmallest startingtime amongallverticesreachable byapathoftreeedgesfollowedby atmostone noedge trivially low pre canreachitselfthroughzerotreeedgesfollowedby zeronoedges tarjanobservedthatsinkcomponentscanbecharacterized intermsofthis low function lemma6  avertex istherootofasinkcomponentof ifandonlyif low pre low pre foreveryproperdescendant proof beavertexsuchthat low pre thenthereisnoedge isadescendantof pre pre ontheotherhand cannotreachanyvertex suchthat pre post itfollowsthat reachonlyitsdescendants andthereforeanydescendantof canreachonly descendantsof inparticular cannotreachitsparent ifithasone therootofitsstrongcomponent nowsupposeinadditionthat low pre foreverydescendant theneachdescendant canreachanothervertex whichmustbeanother descendantof suchthat pre pre byinduction everydescendant canreach itfollowsthatthedescendantsof comprisethestrong component whoserootis mustbeasinkcomponent cannotreachanyvertexoutsideof ontheotherhand suppose istherootofasinkcomponent canreachanothervertex ifandonlyif  canreachallofits descendants andeveryvertexin isadescendantof sdescendants comprise low pre foranyothernode  wouldbe anotherrootof whichisimpossible computing low foreveryvertex viasearchisstraightforward seefigure   lemma   impliesthatafterrunning findlow wecanidentifytheroot sinkcomponentin time byaglobalwhatevsearch  accordingtolegend kosarajuapparentlydiscoveredhisalgorithm analgorithms lecture hewassupposedtopresenttarjan salgorithm butheforgothisnotes sohehadto makeupsomethingelseonthe theonlyaspectofthisstorythati ndsurprisingisthat nobodytellsitaboutsharirortarjan    strongcomponentsinlineartime findlow clock  forallvertices unmark forallvertices isunmarked findlowdfs findlowdfs mark clock clock  pre clock low pre foreachedge isunmarked findlowdfs low min low low low min low pre figure6  computing low foreveryvertex andthenmarkanddeletethosesinkcomponentsin additionaltime bycallingwhatevsearchateachroot andthenrecurse theresultingalgorithmmightrequire iterations eachremovingonlyasingle vertex naivelygivingusatotalrunningtimeof tospeedupthisstrategy tarjan salgorithmmaintainsanauxiliarystackof vertices separatefromtherecursionstack wheneverwestartanewvertex wepushitontothestack wheneverwe nishavertex wecompare low pre thenthe rst timewediscoverthat low pre weknowthree things vertex istherootofasinkcomponent allverticesin appearconsecutivelyatthetopoftheauxiliarystack deepest vertexin ontheauxiliarystackis atthispoint wecanidentifytheverticesin bypoppingthemo theauxiliary stackonebyone stoppingwhenwepop wecoulddeletetheverticesin andrecursivelycomputethestrong componentsoftheremaininggraph butthatwouldbewasteful becausewe wouldrepeat verbatim allcomputationdonebeforevisiting label eachvertexin identifying astherootofitsstrongcomponent thenignorelabeledverticesfortherestofthesearch formally modi cationchangesthede nitionof low tothesmalleststartingtimeamong allvertices inthesamestrongcomponentas canreachbyapathof treeedgesfollowedbyatmostonenoedge buttoprovecorrectness easiertoobservethatignoringlabeledverticesleadsthealgorithmtoexactly thesamebehaviorasactuallydeletingthem finally tarjan salgorithmisshowninfigure   withthenecessary modi cationsfrom findlow figure   indicatedinboldred therunning timeofthealgorithmcanbesplitintotwoparts eachvertexispushedonto onceandpoppedo sothetotaltimespentmaintainingtheauxiliary stack theredstu ifweignoretheauxiliarystackmaintenance   depth firstsearch restofthealgorithmisjustastandardsearch weconcludethatthe algorithmrunsin time tarjan clock  newemptystack forallvertices unmark root forallvertices isunmarked tarjandfs tarjandfs mark clock clock  pre clock low pre push foreachedge isunmarked tarjandfs low min low low root low min low pre low pre repeat pop root figure6  tarjan sstrongcomponentsalgorithm exercises depth rstsearch topologicalsort andstrongcomponents  describeanalgorithmtocomputethereversal rev ofadirectedgraph time provethatforeverydirectedgraph thestrongcomponentgraph scc isacyclic provethat scc rev rev scc foreverydirectedgraph fixanarbitrarydirectedgraph foranyvertex denote thestrongcomponentof thatcontains forallvertices provethat canreach ifandonlyif canreach scc  adirectedgraph nnected foreverypairofvertices isreachablefrom isreachablefrom orboth giveanexampleofadirectedacyclicgraphwithauniquesourcethatis nnected describeandanalyzeanalgorithmtodeterminewhetheragivendirected acyclic graphisnnected  exercises describeandanalyzeanalgorithmtodeterminewhetheranarbitrary directedgraphisnnected  thepolicedepartmentinthecityofsoobananahasmadeeverystreet inthecityonay despitewidespreadcomplaintsfromconfusedmotorists themayorclaimsthatitispossibletolegallydrivefromanyintersectionin soobananatoanyotherintersection thecityneedstoeitherverifyorrefutethemayor sclaim formalizethis problemintermsofgraphs andthendescribeandanalyzeanalgorithm tosolveit afterrunningyouralgorithmfrompart themayorreluctantlyadmits thatshewas lying misinformed callanintersection good forany intersection thatonecanlegallyreachfrom itispossibletolegally drivefrom backto nowthemayorclaimsthatover95 ofthe intersectionsinsoobananaaregood describeandanalyzean cientalgorithmtoverifyorrefuteherclaim forfullcredit bothalgorithmsshouldruninlineartime  supposewearegivenadirectedacyclicgraph withauniquesource andauniquesink avertex f iscalledan vertex everypathfrom passesthrough orequivalently ifdeleting unreachablefrom describeandanalyzeanalgorithmto vertexin figure6  adirectedacyclicgraphwiththree cutvertices  avertex inaconnectedundirectedgraph iscalleda cutvertex ifthe subgraph obtainedbyremoving isdisconnected figure6  anundirectedgraphwithfourcutvertices   depth firstsearch describealinalgorithmthatdetermines givenanundirected graph andavertex isacutvertexin whatisthe runningtimeto ndallcutverticesbytryingyouralgorithmforeach vertex beaspanningtreeofanundirectedgraph provethattherootof isacutvertexof ifandonlyifithasmore thanonechildin provethatanovertex isacutvertexof ifandonlyifat leastonedescendant ofeachchildof isaneighbor ofsomeproperancestorof hint theseclaimsnolongerholdif notaspanningtree isadirectedgraph describeanalgorithmthatidenti eseverycutvertexinagiven rectedgraphin time  anedge inaconnectedundirectedgraph iscalleda bridge ora cutedge ifthesubgraph obtainedbyremoving isdisconnected andedge describealinalgorithmthatdetermines isabridgeornot whatistherunningtimeto ndallbridges bytryingyouralgorithmforeachedge beanarbitraryspanningtreeof provethat bridgesof alsoanedgein thisclaimimpliesthat hasatmost  bridges howdoesthisinformationimproveyouralgorithmfrompart allbridges nowsupposeweroot atanarbitraryvertex foranyvertex denotethesubtreeof rootedat forexample uv bean arbitraryedgeof istheparentof provethat uv isabridge ifandonlyif uv istheonlyedgein withexactlyoneendpoint describealinalgorithmtoidentifyeverybridgein hint beaspanningtreeof  transitiveclosure ofadirectedgraph isadirectedgraphwith thesameverticesas thatcontainsanyedge ifandonlyifthereisa directedpathfrom transitivereduction isagraphwith thesmallestpossiblenumberofedgeswhosetransitiveclosureis samegraphmayhaveseveraltransitivereductions describeane cientalgorithmtocomputethetransitiveclosureofa givendirectedgraph  exercises provethatadirectedgraph hasa unique transitivereductionifand onlyif isacyclic describeane cientalgorithmtocomputeatransitivereductionofa givendirectedgraph  oneoftheoldestalgorithmsforexploringarbitraryconnectedgraphswas proposedbygastontarryin1895 asasystematicprocedureforsolving mazes  theinputtotarry salgorithmisanundirectedgraph foreaseofpresentation weformallyspliteachundirectededge uv intotwo directededges inanactualimplementation thissplitis trivial thealgorithmsimplyusesthegivenadjacencylistfor asthough weredirected tarry unmarkallverticesof coloralledgesof white anyvertexin rectarry rectarry mark ifthereisawhitearc isunmarked color green color red averse rectarry elseifthereisa green arc color red averse rectarry weinformallysaythattarry salgorithmvertex everytime itmarks anditvedge whenitcolorsthatedge red recursivelycalls rectarry unlikeourearliergraphtraversalalgorithm tarry salgorithmcanmarksamevertexmultipletimes describehowtoimplementtarry salgorithmsothatitrunsin time provethatnodirectededgein istraversedmorethanonce whenthealgorithmvisitsavertex forthe thtime exactlyhowmany edgesinto red andexactlyhowmanyedgesoutof red hint considerthestartingvertex separatelyfromtheothervertices proveeachvertex isvisitedatmost deg times exceptthestarting vertex whichisvisitedatmost deg  times thisclaimimmediately impliesthat tarry terminates provethatthelastvertexvisitedby tarry isthestartingvertex  evenoldergraversalalgorithmsweredescribedbycharlestrémauxin1882 christianwienerin1873 bycarlhierholzerin1873 implicitly byleonhardeulerin1736 inparticular wiener salgorithmisequivalenttosearchinconnectedundirected graphs   depth firstsearch foreveryvertex tarry visits provethatalledgesinto outof red tarry halts hint considertheverticesin theorderthattheyaremarkedforthe rsttime startingwith provetheclaimbyinduction provethat tarry visitseveryvertexof thisclaimandtheprevious claimimplythat tarry traverseseveryedgeof exactlyonce  considerthefollowingvariantoftarry sgraversalalgorithm varianttraversesgreenedgeswithoutrecoloringthemredandassignstwo numericallabelstoeveryvertex tarry2 unmarkallverticesof coloralledgesof white anyvertexin rectarry   rectarry2 clock isunmarked pre clock clock clock  mark ifthereisawhitearc isunmarked color green color red rectarry  clock elseifthereisagreenarc post clock clock clock  rectarry  clock proveordisprovethefollowingclaim tarry  halts thegreen edgesde neaspanningtreeandthelabels pre post neapreorder andpostorderlabelingthatareallconsistentwithasinglesearch inotherwords proveordisprovethat tarry producesthesame output assearch eventhoughitvisitstheedgesinacompletely erentorder  youhaveacollectionof land goldkeys eachkeyunlocks onebox eachboxmightbeunlockedbyonekey bymultiple keys orbynokeysatall thereareonlytwowaystoopeneachboxonceit islocked unlockitproperly whichrequireshavingonematchingkeyin yourhand orsmashittobitswithahammer yourbabybrother wholovesplayingwithshinyobjects hassomehow managedtolockallyourkeysinsidetheboxes luckily yourhomesecurity systemrecordedeverything soyouknowexactlywhichkeys ifany insideeachbox youneedtogetallthekeysbackoutoftheboxes theyaremadeofgold clearlyyouhavetosmashatleastonebox yourbabybrotherhasfoundthehammerandiseagerlyeyeingone oftheboxes describeandanalyzeanalgorithmtodetermineifitis  exercises possibletoretrieveallthekeyswithoutsmashinganyboxexceptthe oneyourbrotherhaschosen describeandanalyzeanalgorithmtocomputetheminimumnumberof boxesthatmustbesmashedtoretrieveallthekeys  supposeyouareteachinganalgorithmscourse inyoursecondmidterm yougiveyourstudentsadrawingofagraphandaskthentoindicatea searchtreeandasearchtreerootedataparticular vertex onceyoustartgradingtheexam yourealizethatthe graphyougavethestudentshasseveralsuchspanningartoomany tolist youneedawaytotellwhethereachstudent ssubmissionis correct ineachofthefollowingproblems supposeyouaregivenaconnected graph astartvertex andaspanningtree suppose undirected describeandanalyzeanalgorithmtodecide isa depth spanningtreerootedat suppose undirected describeandanalyzeanalgorithmtodecide isa breadth spanningtreerootedat hint snot enoughfor tobeanunweightedstree thisisthe rightchapterforthisproblem suppose directed describeandanalyzeanalgorithmtodecide isa breadth spanningtreerootedat hint solve rst suppose directed describeandanalyzeanalgorithmtodecide isa depth spanningtreerootedat  severalmodernprogramminglanguages includingjavascript python perl andruby includeafeaturecalled parallelassignment whichallows multipleassignmentoperationstobeencodedinasinglelineofcode thepythoncode   simultaneouslysets   thevaluesofthesideoftheassignmentarealldeterminedby valuesofthevariables thepythoncode swapsthe valuesof andthefollowingpythoncodecomputesthe thfibonacci number deffib prev curr   whilen  prev curr curr prev curr  returncurr supposetheinterpreteryouarewritingneedstoconverteveryparallel assignmentintoanequivalentsequenceofindividualassignments   depth firstsearch theparallelassignment   canbeserializedineither     uttheparallelassignment  canonlybeserializedas  serializationmayrequireoneor moreadditionaltemporaryvariables forexample serializing requiresonetemporaryvariable andserializing requirestwo temporaryvariables describeanalgorithmtodeterminewhetheragivenparallelassignment canbeserializedwithoutadditionaltemporaryvariables describeanalgorithmtodeterminewhetheragivenparallelassignment canbeserializedwith exactlyone additionaltemporaryvariable assumethatthegivenparallelassignmentinvolvesonlysimpleinteger variables noindirectionviapointersorarrays novariableappearsonthe leftsidemorethanonce andexpressionsontherightsidehavenoside ects tworryaboutthedetailsofparsingtheassignmentstatement justassume butdescribe anappropriategraphrepresentation dynamicprogramming  supposewearegivenadirectedacyclicgraph whosenodesrepresentjobs andwhoseedgesrepresentprecedenceconstraints thatis eachedge indicatesthejob mustbecompletedbeforejob eachnode hasaweight indicatingthetimerequiredtoexecutejob describeanalgorithmtodeterminetheshortestintervaloftimeinwhich alljobsin canbeexecuted supposethe rstjobstartsattime  describeanalgorithmtodetermine foreachvertex theearliesttimewhenjob canbegin nowdescribeanalgorithmtodetermine foreachvertex latest time whenjob canbeginwithoutviolatingtheprecedenceconstraintsor increasingtheoverallcompletiontime computedinpart assuming thateveryjobexcept startsatitsearlieststarttime computedin  beadirectedacyclicgraphwithauniquesource andauniquesink hamiltonianpath isadirectedpathin thatcontainseveryvertex describeanalgorithmtodeterminewhether hasahamiltonian path supposethe vertices haveweights describeane cientalgorithm ndthepathfrom withmaximumtotalweight  exercises supposewearealsogivenaninteger describeane cientalgorithm ndthemaximeightpathfrom thatcontainsatmost edges assumethereisatleastonesuchpath supposesomeoftheverticesof aremarkedas andwe arealsogivenaninteger describeane cientalgorithmto ndthe maximeightpathfrom thatvisitsatleast importantvertices assumethereisatleastonesuchpath describeanalgorithmtocomputethenumberofpathsfrom assumethatyoucanaddarbitrarilylargeintegersin  time  beadirectedacyclicgraphwhoseverticeshavelabelsfromsome xed alphabet andlet  beastringoverthesamealphabet anydirected pathin hasalabel whichisastringobtainedbyconcatenatingthelabels ofitsvertices describeanalgorithmthateither ndsapathin whoselabelis correctlyreportsthatthereisnosuchpath describeanalgorithmto ndthe number ofpathsin whoselabelis assumethatyoucanaddarbitrarilylargeintegersin  time describeanalgorithmto ndthelongestpathin whoselabelisa subsequenceof describeanalgorithmto ndthe shortest pathin whoselabelisa supersequence describeanalgorithmto ndapathin whoselabelhasminimumedit distancefrom  polygonalpath isasequenceoflinesegmentsjoinedthe endpointsoftheselinesegmentsarecalledthe vertices ofthepath length ofapolygonalpathisthesumofthelengthsofitssegments polygonalpathwithvertices     monotonically increasing   foreveryindex ormally vertexofthepathisaboveandtotherightofitspredecessor figure6  amonotonicallyincreasingpolygonalpathwithsevenverticesthroughasetofpoints   depth firstsearch supposeyouaregivenaset pointsintheplane representedastwo arrays   describeandanalyzeanalgorithmtocompute thelengthofthelongestmonotonicallyincreasingpathwithverticesin assumeyouhaveasubroutine length   thatreturnsthelength ofthesegmentfrom    foranytwonodes inadirectedacyclicgraph interval istheunionofalldirectedpathsin equivalently consistsofallvertices suchthat  reach  reach togetherwithalltheedgesin connectingthosevertices supposewearegivenadirectedacyclicgraph inwhicheveryvertex hasanumericalweight whichmaybepositive negative orzero describeane cientalgorithmto ndthemaximeightinterval wheretheweightofeachintervalisthesumoftheweightsofits vertices describeane cientalgorithmto ndthelargestvertexweightinevery intervalin youralgorithmshouldcomputeatwonalarray maxwt   whereeachentry maxwt isthemaximum weightamongallverticesintheinterval inparticular isempty maxwt shouldbe  beadirectedacyclicgraphwhoseverticeshavelabelsfromsome xed alphabet anydirectedpathin hasalabel whichisastringobtainedby concatenatingthelabelsofitsvertices recallthata palindrome isastring thatisequaltoitsreversal describeandanalyzeanalgorithmto ndthelengthofthelongest palindromethatisthelabelofapathin forexample giventhegraph infigure   youralgorithmshouldreturntheinteger  whichisthe lengthofthepalindrome hannah figure6  adagwhoselongestpalindromepathlabelhaslength   exercises describeanalgorithmto ndthelongestpalindromethatisa sequenceofthelabelofapathin suppose hasasinglesource andasinglesink describeanalgorithm ndtheshortestpalindromethatisasupersequenceofthelabelofa pathin  supposeyouaregiventwodirectedacyclicgraphs inwhichevery nodehasa label fromsome nitealphabet erentnodesmayhavethe samelabel thelabelofa path ineitherdagisthestringobtainedby concatenatingthelabelsofitsvertices describeandanalyzeanalgorithmtocomputethelengthofthelongest stringthatisboththelabelofapathin andthelabelofapathin describeandanalyzeanalgorithmtocomputethelengthofthelongest stringthatisbothasubsequenceofthelabelofapathin anda subsequenceofthelabelofapathin describeandanalyzeanalgorithmtocomputethelengthoftheshortest stringthatisbothasupersequenceofthelabelofapathin anda supersequenceofthelabelofapathin hint thisiseasierthanit  beanarbitrary necessarilyacyclic directedgraphinwhichevery vertex hasanintegerweight describeanalgorithmto ndthelongestdirectedpathin whosevertex weightsde neanincreasingsequence describeandanalyzeanalgorithmtodeterminethemaximeight vertexreachablefromeachvertexin thatis foreachvertex algorithmneedstocompute maxreach max  reach  supposeyouaregivenadirectedacyclicgraph verticesandan integer describeane cientalgorithmto ndasetofatmost vintpathsthatvisiteveryvertexin nowsupposetheedgesoftheinputdag haveweights whichmaybe positive negative orzero describeane cientalgorithmto ndaset ofatmost vintpaths withminimumtotalweight thatvisit everyvertexin youralgorithmsshouldrunin timeforsomesmallconstant asinglevertexisapathwithweightzero wewillseeamoree cient algorithmforpart inchapter    depth firstsearch  krisisaprofessionalrockclimberwhoiscompetingintheu climbing nationals thecompetitionrequireskristouseasmanyholdsonthe climbingwallaspossible usingonlytransitionsthathavebeenexplicitly allowedbythero theclimbingwallhas holds krisisgivenalistof pairs holds eachindicatingthatmovingdirectlyfromhold tohold isallowed movingdirectlyfrom isnotallowedunlessthelistalso includesthepair krisneedsto gureoutasequenceofallowed transitionsthatusesasmanyholdsaspossible sinceeachnewholdincreases hisscorebyonepoint therulesallowkristochoosethe rstandlasthold inhisclimbingroute therulesalsoallowhimtouseeachholdasmany timesashelikes onlythe rstuseofeachholdincreaseskris score nethenaturalgraphrepresentingtheinput describeandanalyze analgorithmtosolvekris sclimbingproblemifyouareguaranteedthat theinputgraphisadag describeandanalyzeanalgorithmtosolvekris sclimbingproblemwith norestrictionsontheinputgraph bothofyouralgorithmsshouldoutputthemaximumpossiblescorethatkris canearn  thereare galaxiesconnectedby intergalactictelays telayjoinstwogalaxiesandcanbetraversedinbothdirections thecompanythatrunsthetelayshasestablishedan extremelylucrativecoststructure anyonecanteleport fromtheir homegalaxyatnocostwhatsoever butteleporting theirhomegalaxy isprohibitivelyexpensive judyhasdecidedtotakeasabbaticaltouroftheuniversebyvisitingas manygalaxiesaspossible startingatherhomegalaxy tosaveontravel expenses shewantstoteleportawayfromherhomegalaxyateverystep exceptfortheverylastteleporthome describeandanalyzeanalgorithmtocomputethemaximumnumberof galaxiesthatjudycanvisit yourinputconsistsofanundirectedgraph verticesand edgesdescribingthetelaynetwork integer  identifyingjudy shomegalaxy andanarray  containingthedistancesofeachgalaxyfrom ª justbeforeembarkingonheruniversaltour judywinsthespacelottery givingherjustenoughmoneytoa teleportstowardherhome galaxy describeanewalgorithmtocomputethemaximumnumberof distinctgalaxiesjudycanvisit shecanvisitthesamegalaxymorethan butcrucially onlythe rstvisitcountstowardhertotal  exercises  thedoctorandriversongdecidetoplayagameonadirectedacyclic graph whichhasonesource andonesink  eachplayerhasatokenononeoftheverticesof atthestartofthe game thedoctor stokenisonthesourcevertex andriver stokenison thesinkvertex theplayersalternateturns withthedoctormoving rst oneachofhisturns thedoctormoveshistokenforwardalongadirected edge oneachofherturns rivermoveshertoken backward alongadirected edge ifthetwotokensevermeetonthesamevertex riverwinsthegame ello sweetiifthedoctor stokenreaches orriver stokenreaches beforethetwotokensmeet thenthedoctorwinsthegame describeandanalyzeanalgorithmtodeterminewhowinsthisgame assumingbothplayersplayperfectly thatis ifthedoctorcanwin matterhowrivermoves thenyouralgorithmshouldoutputand ifrivercanwin nomatterhowthedoctormoves youralgorithmshould outputv whyarethesetheonlytwopossibilities theinputto youralgorithmisthegraph ª    beagiven stringoversome nitealphabet andlet beadeterministicatemachinewith statesoverthesame alphabet describeandanalyzeanalgorithmtocomputethelengthofthelongest subsequenceof thatisacceptedby forexample acceptsthe language dab youralgorithmshouldoutputthe number4 whichisthelengthofthesubsequence arar describeandanalyzeanalgorithmtocomputethelengthofthes estsupersequenceof thatisacceptedby forexample ceptsthelanguage abcdr abracadabra youralgorithm shouldoutputthenumber25 whichisthelengthofthesupersequence bcdr analyzeyouralgorithmsintermsofthelength oftheinputstring number ofstatesintheatemachine andthesizeofthealphabet  dynamicprogrammingalgorithmcanbemodeledas nding anoptimalpaththroughadirectedacyclicgraph buteverydynamic programmingalgorithmdoesprocesssomeunderlyingdependencygraph inpostorder  thelabels areabbreviationsfortheuntempered chismandthe imevortex theshiningworldofthesevensystems alsoknownasgallifrey andtrenzalore orskaroand telos orsomethingelset sallverycomplicated nevermind   depth firstsearch supposewearegivenadirectedacyclicgraph whereeverynodestores anumericalsearchkey describeandanalyzeanalgorithmto ndthe largestbinarysearchtreethatisasubgraphof supposewearegivenadirectedacyclicgraph andtwovertices describeanalgorithmtocomputethenumberofdirectedpathsin assumethatanyarithmeticoperationrequires  time beadirectedacyclicgraphwiththefollowingfeatures hasasinglesource andseveralsinks   eachedge hasanassociatedweight   foreachnovertex thetotalweightofalledgesleaving  thatis  theweights nearandomwalkin fromthesource tosome sink afterreachinganynovertex thewalkfollowsedge withprobability allprobabilitiesaremutuallyindependent describeandanalyzeanalgorithmtocomputetheprobabilitythatthis randomwalkreachessink foreveryindex assumethateach arithmeticoperationtakesonly  time  wemustallhangtogether gentlemen orelseweshallmostassuredlyhangseparately benjaminfranklin atthesigningofthe declarationofindependence july4  irememberseekingadvicefromcouldithave whetherthisworkwasworthsubmittingforpublication thereasoningitusesisso verysimple fortunatelyheadvisedmetogoahead andmanyyearspassed beforeanotherofmypublicationsbecameaswell knownasthisverysimpleone josephkruskal describinghisshortest spanning subtreealgorithm  cleanallthethings alliebrosh thisiswhyi llneverbeanadult hyperboleandahalf june17   minimumspanningtrees supposewearegivenaconnected undirected weighted graph thisisa graph togetherwithafunction thatassignsareal weight toeachedge whichmaybepositive negative orzero thischapter describesseveralalgorithmsto ndthe minimumspanningtree thatis thespanningtree thatminimizesthefunction  seefigure   foranexample  distinctedgeweights anannoyingsubtletyintheproblemstatementisthatweightedgraphscan havemorethanonespanningtreewiththesameminimumweight inparticular ifeveryedgein hasweight  spanningtreeof isaminimum   minimumspanningtrees figure7  aweightedgraphanditsminimumspanningtree spanningtree withweight  thisambiguitycomplicatesthedevelopment ofouralgorithms everythingwouldbemuchsimplerifwecouldsimply assume thatminimumspanningtreesareunique fortunately thereisaneasyconditionthatimpliestheuniquenesswewant lemma7  ifalledgeweightsinaconnectedgraph aredistinct auniqueminimumspanningtree  proof beanarbitraryconnectedgraphwithtwominimumspanning trees  weneedtoprovethatsomepairofedgesin havethesame weight theproofisessentiallyagreedyexchangeargument eachofourspanningtreesmustcontainanedgethattheothertreeomits beaminimeightedgein  andlet  beaminimeight edgein  breakingtiesarbitrarily withoutlossofgenerality suppose  thesubgraph  containsexactlyonecycle whichpassesthrough theedge  edgeofthiscyclethatis atleastonesuch edgemustexist isatree wemayormaynothave    weimmediatelyhave   andtherefore    itfollowsthat   nowconsiderthespanningtree    thisnewtree  beequalto weimmediatelyhave      isa minimum spanningtree sowemusthave   inother  isalsoaminimumspanningtree weconcludethat  whichcompletestheproof ifwealreadyhaveanalgorithmthatassumesdistinctedgeweights wecan stillrunitongraphswheresomeedgeshaveequalweights aslongaswehave aconsistentmethodforbreakingties onesuchmethodusesthefollowing  theconverseofthislemmaisfalse aconnectedgraphwithrepeatededgeweightscanstill haveauniqueminimumspanningtree asatrivialexample suppose isatree    theonlyminimumspanningtreealgorithm algorithminplaceofsimpleweightcomparisons shorteredge takesasinput fourintegers representingfour notnecessarilydistinct vertices decideswhichofthetwoedges hasllweight theinputgraphundirected thepairs representthesameedge shorteredge thenreturn thenreturn min min thenreturn min min thenreturn max max thenreturn ifmax max return inlightoflemma   andthistikingrule wewillsafelyassumefor therestofthischapterthatedgeweightsare distinct andtherefore minimumspanningtreesare unique inparticular wecanfreelydiscuss minimumspanningtreewithnoconfusion  theonlyminimumspanningtreealgorithm therearemanyalgorithmstocomputeminimumspanningtrees butalmostall ofthemareinstancesofthefollowinggenericstrategy thesituationissimilar tographtraversal whereseveraldi erentalgorithmsareallvariantsofthe generictraversalalgorithmwhatevsearch thegenericminimumspanningtreealgorithmmaintainsanacyclic graph oftheinputgraph whichwewillcallthe intermediatespanningforest atalltimes satis esthefollowinginvariant isasubgraphoftheminimumspanningtreeof initially consistsof onertextrees thegenericalgorithmconnectstrees byaddingcertainedgesbetweenthem whenthealgorithmhalts consistsofasinglespanningtree ourinvariantimpliesthatthismustbethe minimumspanningtreeof wehavetobecarefulabout edgesweaddtotheevolvingforest becausenoteveryedgeisintheminimum spanningtree atanystageofitsevolution theintermediatespanningforest induces twospecialtypesofedgesintherestofthegraph anedgeis useless ifitisnotanedgeof butbothitsendpointsareinthe samecomponentof anedgeis safe ifitistheminimeightedgewithexactlyoneendpoint insomecomponentof   minimumspanningtrees thesameedgecouldbesafefortwodi erentcomponentsof someedgesof areneithersafenoruseless wecalltheseedges undecided allminimumspanningtreealgorithmsarebasedontwosimpleobservations rstobservationwasprovedbyrobertprimin1957 althoughitisimplicit inseveralearlieralgorithms andthesecondisimmediate lemma7  prim theminimumspanningtreeof containseverysafeedge proof infactweprovethefollowingstrongerstatement subset theverticesof theminimumspanningtreeof containstheminimeight edgewithexactlyoneendpointin likethepreviouslemma weprovethis claimusingagreedyexchangeargument beanarbitrarysubsetofverticesof andlet bethelightestedge withexactlyoneendpointin ourassumptionthatalledgeweightsare distinctimpliesthat isunique beanarbitraryspanningtreethatdoes weneedtoprovethat theminimumspanningtreeof isconnected itcontainsapathfromoneendpointof tothe becausethispathstartsatavertexof andendsatavertexnotin mustcontainatleastoneedgewithexactlyoneendpointin  edge isacyclic removing  yieldsaspanning forest exactlytwocomponents onecontainingeachendpointof adding tothisforestgivesusanewspanningtree   thede nitionof implies  whichimpliesthat  hassmallertotalweightthan isnottheminimumspanningtreeof whichcompletestheproof figure7  everysafeedgeisintheminimumspanningtree blackverticesareinthesubset lemma7  theminimumspanningtreecontainsnouselessedge proof addinganyuselessedgeto wouldintroduceacycle ourgenericminimumspanningtreealgorithmrepeatedlyadds safe edges totheevolvingforest isnotyetconnected theremustbeatleastone safeedge becausetheinputgraph isconnected nomatterwhichsafe edgesweaddineachiteration ourgenericalgorithmeventuallyconnects byinduction lemma   impliesthattheresultingtreeisinfacttheminimum    bor vka salgorithm spanningtree wheneverweaddnewedgesto someundecidededgesmay becomesafe andotherundecidededgesmaybecomeuseless onceanedge becomesuseless itstaysuselessforever tofullyspecifyaparticularalgorithm wemustdescribe safeedge toaddineachiteration andhowto thoseedges  bor vka salgorithm theoldestandarguablysimplestminimumspanningtreealgorithmwasdisco eredbytheczechmathematicianotakarbor vkain1926 aboutayearafter jind ichsaxelaskedhimhowtoconstructanelectricalnetworkconnecting severalcitiesusingtheleastamountofwire  thealgorithmwasrediscoveredby gustavchoquetin1938 rediscoveredagainbyateamofpolishmathematicians ledbyjózef ukaszewiczin1951 andrediscoveredagainbygeorgesollinin  althoughsollinneverpublishedhisrediscovery itwascarefullydescribed andcreditedinoneofthe rsttextbooksongraphalgorithms asaresult algorithmissometimescalledollin thebor vka choquet flewierkauubrzycki prim sollin brosh  algorithmcanbesummarizedinoneline bor vka add thesafeedges andrecurse figure7  bor vka salgorithmrunontheexamplegraph thickrededgesarein dashededgesare useless arrowspointalongeachcomponent ssafeedge thealgorithmendsafterjusttwoiterations hereisbor vka salgorithminmoredetail thealgorithmcallsthe cou andlabel algorithm fromchapter  onpage  tocountthecomponents andlabeleachvertex withaninteger comp indicatingitscomponent  saxelwasanemployeeofthewestmoravianpowercompany describedbybor vkaas erytalentedandwhowaslaterexecutedbythenazisasapersonofjewish descent  goreadeverythingin hyperboleandahalf andthengobuythebook andanextracopy foryourcat sthat youdon thaveacat whatkindofamonsterareyou gogetacat andthenbuyitanextracopyof hyperboleandahalf   minimumspanningtrees bor vka count countandlabel count  addallsafeedges count count countandlabel return itremainsonlytodescribehowtoidentifyandaddallthesafeedgesto suppose hasmorethanonecomponent sinceotherwisewe realreadydone thefollowingsubroutinecomputesanarray safe  ofsafeedges safe istheminimeightedgewithoneendpointinthe thcomponent byabruteforceexaminationofeveryedgein foreachedge uv areinthesamecomponent uv iseitheruselessoralreadyanedge wecomparetheweightof uv totheweightsof safe comp safe comp andupdatethearrayentriesifnecessary oncewehave identi edallthesafeedges weaddeachedge safe addallsafeedges count  count safe null foreachedge uv  comp  comp safe comp null uv safe comp safe comp uv safe comp null uv safe comp safe comp uv  count add safe eachcallto countandlabel runsin time becausetheforest atmost  edges addallsafeedges runsin time becausewespend constanttimeoneachvertex eachedgeof andeachcomponentof theinputgraphisconnected wehave  itfollowsthateachiteration ofthewhileloopof bor vka takes time eachiterationreducesthenumberofcomponentsof byatleastafactor oftwtheworstcase thecomponentsof coalesceinpairs initiallyhas components thewhileloopiteratesatmost log times concludethattheoverallrunningtimeofbor vka salgorithmis log thisisthemstalgorithmyouwant despiteitsrelativelyobscureorigin earlywesternalgorithmsresearcherswere awareofbor vka salgorithm butdismisseditasbeingoocompli    jarník algorithm asaresult despiteitssimplicityande ciency mostalgorithmsanddata structurestextbooksunfortunatelydonotevenmentionbor vka salgorithm thisomissionisaseriousmistake bor vka salgorithmhasseveraldistinct advantagesoverotherclassicalmstalgorithms bor vka salgorithmoftenrunsfasterthanits log wserunning time thenumberofcomponentsin candropbysigni cantlymorethana factorof  inasingleiteration reducingthenumberofiterationsbelowthe wse log  aslightreformulationofbor vka salgorithm actuallyclosertobor vka originalpresentation actuallyrunsin timeforabroadclassof interestinggraphs includinggraphsthatcanbedrawnintheplanewithout edgecrossings incontrast thetimeanalysisfortheothertwoalgorithms appliesto graphs bor vka salgorithmallowsforsigni cantparallelism ineachiteration eachcomponentof canbehandledinaseparateindependentthread thisimplicitparallelismallowsforevenfasterperformanceonmulticoreor distributedsystems incontrast theothertwoclassicalmstalgorithmsare intrinsicallyserial severalmorerecentminimalgorithmsarefasterevenin theworstcasethantheclassicalalgorithmsdescribedhere ofthese fasteralgorithmsaregeneralizationsofbor vka salgorithm inshort ifyoueverneedtoimplementaminimalgorithm usebor vka ontheotherhand ifyouwantto provethingsabout minimum spanningtreese ectively youreallyneedtoknowthenexttwoalgorithmsas  jarník algorithm thenextoldestminimumspanningtreealgorithmwas rstdescribedbythe czechmathematicianvojt chjarníkina1929lettertobor vka jarníkpublished hisdiscoverythefollowingyear thealgorithmwasindependentlyrediscovered byjosephkruskalin1956 arguably byrobertprimin1957 byharryloberman andarnoldweinbergerin1957 nallybyedsgerdijkstrain1958 prim lobermandandweinberger anddijkstraall eventually knewofandeven citedkruskal spaper butsincekruskalalsodescribedtwootherminim salgorithmsinthesamepaper algorithmisusuallycalled aorsometimesprim dijkstraaeventhoughby dijkstraalreadyhadanotheralgorithm inappropriately namedafterhim injarník salgorithm theintermediateforest hasonlyonenontrivial component alltheothercomponentsareisolatedvertices initially consists   minimumspanningtrees ofasinglearbitraryvertexofthegraph thealgorithmrepeatsthefollowing stepuntil spansthewholegraph jarník repeatedlyadd ssafeedgeto figure7  jarník salgorithmrunontheexamplegraph startingwiththebottomvertex ateachstage thickrededgesarein anarrowpointsalong ssafeedge anddashededgesareuseless toimplementjarník salgorithm wekeepalltheedgesadjacentto apriorityqueue whenwepulltheminimeightedgeoutofthepriority queue rstcheckwhetherbothofitsendpointsarein ifnot weaddthe edgeto andthenaddthenewneighboringedgestothepriorityqueue otherwords jarník salgorithmisavariantofasdescribedat theendofchapter  ifweimplementtheunderlyingpriorityqueueusinga standardbinaryheap jarník salgorithmrunsin log log time ª improvingjarník salgorithm wecanimprovejarník salgorithmusingamorecomplexpriorityqueuedata structurecalleda fibonacciheap rstdescribedbymichaelfredmanand roberttarjanin1984 justlikebinaryheaps fibonacciheapssupportthe standardpriorityqueueoperations insert extractmin decreasekey unlikestandardbinaryheaps whichrequire log timeforevery operation fibonacciheapssupport insert decreasekey inconstant amortized time theamortizedcostof extractmin isstill log   amortizedtimeisanaccountingtrickthatallowsustoignoreinfrequent uctuationsin thetimeforasingledatastructureoperation afibonacciheapcanexecuteanyintermixed sequenceof insert decreasekey extractmin sin log time inthe worstcase sothe average insert andthe average decreasekey eachtakeconstanttime average extractmin takes log time someindividualoperationsmaytake    kruskal salgorithm toapplythisfasterdatastructure wekeepthe vertices inthepriority queueinsteadofedges wherethepriorityofeachvertex iseithertheminim weightedgebetween andtheevolvingtree  ifthereisnosuchedge wecan insert alltheverticesintothepriorityqueueatthebeginningofthe algorithm wheneverweaddanewedgeto wemayneedtodecrease theprioritiesofsomeneighboringvertices tomakethedescriptioneasier webreakthealgorithmintotwoparts jarníkinit initializesthepriorityqueue jarníkloop isthemainalgorithm theinputconsistsoftheverticesandedgesofthegraph alongwiththestart vertex foreachvertex wemaintainbothitspriority priority andthe incidentedge edge suchthat edge priority jarník jarníkinit jarníkloop jarníkinit foreachvertex  nf  edge priority edge null priority  insert jarníkloop   extractmin add edge foreachneighbor  priority uv edge uv decreasekey uv figure7  jarník sminimumspanningtreealgorithm readytobeusedwithafibonacciheap theoperations insert extractmin areeachcalled timesonce foreachvertexexcept decreasekey iscalled times atmosttwice foreachedge ifweuseafibonacciheap theimprovedalgorithmrunsin log time whichisfasterthanbor vka salgorithmunless inpractice thisimprovementisrarelyfasterthanthenaive implementationusingabinaryheap unlessthegraphisextremelylargeand dense thefibonacciheapalgorithmsarequitecomplex andthehidden constantsinboththerunningtimeandspacearesigni otoutrageous butcertainlybiggerthanthehiddenconstant  inthe log timeboundfor binaryheapoperations  kruskal salgorithm thelastminimumspanningtreealgorithmwe llconsiderwas rstdescribedby josephkruskalin1956 inthesamepaperwhereherediscoveredjarnik longerintheworstcase amortizationuses statistical averagingoverthesequenceofoperations thereisnoassumptionofrandomnesshere eitherintheinputdataorinthealgorithm   minimumspanningtrees rithm kruskalwasmotivatedbytypewrittentranslation ofobscure ofbor vka soriginalpaperthathadbeenoatingarotheprincetonmath department kruskalfoundbor vka salgorithmecessarilyela  thesamealgorithmwasrediscoveredin1957byharrylobermanandarnold weinberger butsomehowavoidedbeingrenamedafterthem likeourearlierminimpanningtreealgorithms kruskal salgorithmhas amemorableonedescription kruskal scanalledgesbyincreasingweight ifanedgeissafe additto figure7  kruskal salgorithmrunontheexamplegraph thickrededgesarein thindashededges areuseless thesimplestmethodtoscantheedgesinincreasingweightorderisto sort theedgesbyweight log time andthenuseasimplefoopoverthe sortededgelist aswewillseeshortly thispreliminarysortingdominatesthe runningtimeofthealgorithm becauseweexaminetheedgesinorderfromlightesttoheaviest anyedge weexamineissafeifandonlyifitsendpointsareindi erentcomponentsofthe forest supposeweencounteranedge thatjoinstwocomponents butisnotsafe thentheremustbealighteredge  withexactlyoneendpoint butthisisimpossible inductively everypreviouslyexamined edgehasbothendpointsinthesamecomponentof justasinbor vka salgorithm eachvertexof needsto componentof containsit unlikebor vka salgorithm wedo  tobefair bor vka rstpaper unnecessarilyelaborate inpartbecauseitwaswritten formathematiciansintheformallanguageof linear algebra ratherthaninthelanguageof graphs bor vka sfollowuppaper alsopublishedin1927butinanelectrotechnicaljournal writteninplainlanguageforamuchbroaderaudience essentiallyinitscurrentmodernform kruskalwasapparentlyunawareofbor vka ssecondpaper stupidironcurtain    kruskal salgorithm notrecomputeallcomponentlabelsfromscratcheverytimeweaddanedge whentwocomponentsarejoinedbyanedge thesmallercomponent inheritsthelabelofthelargercomponent thatis wetraversethesmaller component viawhatevsearch thistraversalrequires  timefor eachvertexinthesmallercomponent eachtimethecomponentlabelofa vertexchanges thecomponentof containingthatvertexgrowsbyatleasta factorof  eachvertexlabelchangesatmost log times itfollows thatthe total timespentupdatingvertexlabelsisonly log moregenerally kruskal salgorithmmaintainsapartitionoftheverticesof intodisjointsubsets inourcase thecomponentsof usingadatastructure thatsupportsthefollowingoperations makeset createasetcontainingonlythevertex returnanidenti eruniquetothesetcontaining union replacethesetscontaining withtheirunion operationdecreasesthenumberofsets sacompletedescriptionofkruskal salgorithmintermsoftheseoperations kruskal sort byincreasingweight foreachvertex  makeset  uv thlightestedgein  union add uv return aftertheinitialsort thealgorithmperformsexactly makeset operations oneforeachvertex  operations twoforeachedge  union operations oneforeachedgeintheminimumspanningtree wejustdescribed adisjodatastructureforwhich makeset require  time union runsin log amortized time usingthisimplementation totaltimespentmaintainingthesetpartitionis log  butrecallthatwealreadyneed log log timejusttosortthe edges becausethisislargerthanthetimespentmaintainingthe unio datastructure theoverallrunningtimeofkruskal salgorithmis log  adi erentdisjodatastructure whichusesastrategycalled uniowithpath compression performseach union amortizedtime isthealmo bnstant inverseackermanfunction ifyoudon tfeellikeconsultingwikipedia thinkof  usingthisimplementation thetotaltimespentmaintainingthesetpartition whichisslightlyfasterwhen islargeand isverycloseto   minimumspanningtrees exactlythesameasbor vka salgorithm orjarník salgorithmwithanormal nonacci heap exercises  beanarbitraryconnectedgraphwithweightededges provethatforanycyclein theminimumspanningtreeof excludes themaximeightedgeinthatcycle proveordisprove theminimumspanningtreeof includesthe minimeightedgein cyclein  throughoutthischapter weassumedthatnotwoedgesintheinputgraph haveequalweights whichimpliesthattheminimumspanningtreeisunique infact aweakerconditionontheedgeweightsimpliesmstuniqueness describeaneightedgraphthathasauniqueminimumspanning tree eventhoughtwoedgeshaveequalweights provethataneightedgraph hasa unique minimumspanning treeifandonlyifthefollowingconditionshold foranypartitionoftheverticesof intotwosubsets theminim weightedgewithoneendpointineachsubsetisunique themaximeightedgeinanycycleof isunique describeandanalyzeanalgorithmtodeterminewhetherornotagraph hasauniqueminimumspanningtree  mostclassicalminimalgorithmsusethenotionsof andseledgesdescribedinthetext butthereisanalternateformulation beaweightedundirectedgraph wheretheedgeweightsaredistinct wesaythatanedge dangerous ifitisthelongestedgeinsomecycle ifitdoesnotlieinanycyclein provethattheminimumspanningtreeof containseveryusefuledge provethattheminimumspanningtreeof doesnotcontainany dangerousedge describeandanalyzeane cientimplementationofthefollowing algorithm rstdescribedbyjosephkruskalinthesame1956paper whereheproposedskal saexaminetheedgesof decreasing order ifanedgeisdangerous removeitfrom hint tbeasfastaskruskal susualalgorithm  describeandanalyzeanalgorithmtocomputethe maximum spanningtreeofagiveneightedgraph  exercises feedbackedgeset ofanundirectedgraph isasubset oftheedges suchthateverycyclein containsatleastoneedgein inother removingeveryedgein makesthegraph acyclic andanalyzeafastalgorithmtocomputetheminimeightfeedback edgesetofagiveneightedgraph  supposewearegivenbothanundirectedgraph withweightededgesand aminimumspanningtree describeanalgorithmtoupdatetheminimumspanningtreewhenthe weightofasingleedge isdecreased describeanalgorithmtoupdatetheminimumspanningtreewhenthe weightofasingleedge isincreased inbothcases theinputtoyouralgorithmistheedge anditsnewweight youralgorithmsshouldmodify sothatitisstillaminimumspanningtree hint considerthecases   separately  describeandanalyzeanalgorithmto ndthe secondsmallestspanning tree ofagivengraph thatis thespanningtreeof withsmallest totalweightexceptfortheminimumspanningtree ª describeandanalyzeane cientalgorithmtocompute givenaweighted undirectedgraph andaninteger spanningtreesof smallestweight  agraph dense  describeamodi cationof jarník sminimpanningtreealgorithmthatrunsin  time pendentof whentheinputgraphisdense usingonlyelementarydata struparticular usingfibonacciheaps thisvariantof jarník salgorithmwas rstdescribedbyedsgerdijkstrain1958  minimpanningtreealgorithmsareoftenformulatedusinganoperation called edgecontraction tocontracttheedge uv weinsertanewnode redirectanyedgeincidentto uv tothisnewnode andthen delete aftercontraction theremaybemultipleparalleledges betweenthenewnodeandothernodesinthegraph weremoveallbutthe lightestedgebetweenanytwonodes thethreeclassicalminimpanningtreealgorithmsdescribedinthis chaptercanallbeexpressedcleanlyintermsofcontractionasfollows threealgorithmsstartbymakingacleancopy  oftheinputgraph andthenrepeatedlycontractsafeedgesin  theminimumspanningtree consistsofthecontractededges   minimumspanningtrees figure7  contractinganedgeandremovingredundantparalleledges bor vka markthelightestedgeleavingeachvertex contractall markededges andrecurse jarník repeatedlycontractthelightestedgeincidenttosome xed rootvertex kruskal repeatedlycontractthelightestedgeinthegraph describeanalgorithmtoexecuteasinglepassofbor vka scontraction algorithmin time theinputgraphisrepresentedinan adjacencylist consideranalgorithmthat rstperforms passesofbor vka sco tionalgorithm andthenrunsjarník salgorithm afibonacciheap ontheresultingcontractedgraph whatistherunningtimeofthishybridalgorithm asafunctionof forwhichvalueof isthisrunningtimeminimized whatisthe resultingrunningtime callafamilyofgraphs nice ifithasthefollowingproperties contractinganedgeofanicegraphyieldsanothernicegraph everynicegraphwith verticeshasonly edges forexample planargraphsthatcanbedrawnintheplanewith nocrossingnice contractinganyedgeofaplanargraph leavesasmallerplanargraph andeuler sformulaimpliesthatevery planargraphwith verticeshasatmost   edges provethatbor vka scontractionalgorithmcomputestheminimum spanningtreeofanynicegraphin time  considerapathbetweentwovertices inaundirectedweighted graph width ofthispathistheminimumweightofanyedgeinthe path bottleneckdistance isthewidthofthewidest pathfrom iftherearenopathsfrom thebottleneckdistance ontheotherhand thebottleneckdistancefrom toitselfis  provethatthe maximum spanningtreeof containswidestpaths pairofvertices  exercises thebottleneckdistancebetween  describeanalgorithmtosolvethefollowingproblemin time givenaundirectedweightedgraph twovertices anda weight isthebottleneckdistancebetween atmost suppose isthebottleneckdistancebetween provethatdeletinganyedgewithweightlessthan doesnotchange thebottleneckdistancebetween provethat contracting anyedgewithweight greater notchangethebottleneckdistancebetween ifcontraction createsparalleledges deleteallbutthe heaviest edgebetweeneach pairofnodes ª describeanalgorithmtocomputeaminimeneckpathbetween time hint startby ndingthemedieightedge  bor vka salgorithmcanbereformulatedtouseastandarddisjo datastructuretoidentifysafeedges justlikekruskal salgorithm ofexplicitlycountingandlabelingcomponentsoftheevolvingspanning forest ineachiteration inthisvariant eachcomponentof isrepresentedbyan vertex storesapointer parent toitsparent orto itselfif istheroot ofitsthesubroutine returnstherootof sbut alsoapplies pathcompression reassigningallparentpointersfrom tothe roottopointdirectlytotheroot tospeedupfuture operations  subroutine union combinestwointoonebymakingoneofthetwo rootnodestheparentoftheother   pathcompressionisaformofmemoization  union isimplementedmorecarefullytoensurethattherootofthelargeror olderdoesnotchange thosedetailsdon tmatterhere   minimumspanningtrees parent return parent parent return union parent parent inthemodi edversionofbor vka salgorithm inadditiontotheparent pointers therootvertex ofeachcomponentof maintainsanedge safe attheendof findsafeedges isthelightestedgewithoneendpoint inthatcomponent findsafeedges foreachvertex  safe null false foreachedge uv   safe null uv safe safe uv safe null uv safe safe uv true return addsafeedges foreachvertex  safe  null xy safe  union add xy bor vka foreachvertex  parent findsafeedges addsafeedges return provethateachcallto findsafeedges addsafeedges requiresonly time hint whatisthedepthofthewhen findsafeedges ends itfollowsthatthisvariantof bor vka alsorunsin log time  istudymybibleasigatherapples firstishakethewholetree thattheripestmight fall theniclimbthetreeandshakeeachlimb andtheneachbranchandtheneach twig andthenilookundereachleaf attributedtomartinluther  lifeisanunfoldment andthefurtherwetravelthemoretruthwecancomprehend tounderstandthethingsthatareatourdooristhebestpreparationfor understandingthosethatliebeyond attributedtohypatiaofalexandria  byelberthubbard littlejourneystothehomesofgreatteachers  yourmindwillanswermostquestionsifyoulearntorelaxandwaitfortheanswer likeoneofthosethinkingmachines youfeedinyourquestion sitback andwait williams burroughs nakedlunch  themethodsgiveninthispaperrequirenoforesightoringenuity andhencedeservetobecalledalgorithms edwardr moore shortestpaththroughamaze   shortestpaths supposewearegivenaweighted directed graph withtwospecial vertices andwewantto ndtheshortestpathfroma source vertex toa target vertex thatis wewantto ndthedirectedpath startingat andending thatminimizesthefunction  forexample ifiwanttoanswerthequestionthefastestwaytodrive frommyoldapartmentinchampaign illinoistomywife soldapartmentin columbus ohiimightuseagraphwhoseverticesarecities edgesare roads weightsaredrivingtimes ischampaign iscolumbus  graphisdirected becausedrivingtimesalongthesameroadmightbedi erent  westonchurch northonprospect eastonsouthoneastonairportexpressway northoneastonnorthongrandview easton5th northonolentangyriver easton dodridge northonhigh westonkelso southonneil dependingontra weliveinurbana   shortestpaths indi erentdirections atonetime therewasaspeedtraponjusteastof theindiana ohioborder butonlyforeastboundtra  shortestpathtrees almosteveryalgorithmknownforcomputingshortestpathsfromonevertex toanotheractuallysolves largeportionsof thefollowingmoregeneral single sourceshortestpath sssp problem findshortestpathsfromthesource vertex othervertexinthegraph thisproblemisusuallysolvedby ndinga shortestpathtree rootedat thatcontainsallthedesiredshortest paths snothardtoseethatifshortestpathsareunique thentheyformatree becauseanysubpathofashortestpathisitselfashortestpath ifthereare multipleshortestpathstosomevertices wecanalwayschooseoneshortest pathtoeachvertexsothattheunionofthepathsisatree ifthereareshortest pathsfrom totwovertices thatdiverge thenmeet thendivergeagain wecanmodifyoneofthepathswithoutchangingitslength sothatthetwo pathsonlydivergeonce figure8  solid dashed areshortestpaths alongthetop isalsoashortestpath althoughtheyarebothoptimalspanningtrees streesand minimumspanningtreesareverydi erentcreatures streesare rootedanddirected minimumspanningtreesareunrootedandundirected streesaremostnaturallyde nedfordirectedgraphs minimum spanningtreesaremorenaturallyde nedforundirectedgraphs ifedgeweights aredistinct thereisonlyoneminimumspanningtree buteverysourcevertex inducesadi erentstree itispossiblefor shortest pathtreetouseadi erentsetofedgesfromtheminimumspanningtree ª  negativeedges formostsproblems wheretheedgeweightscorrespondtodistance orlengthortime itisnaturaltoassumethatalledgeweightsarenoegative orevenpositive formanyapplicationsofsalgorithms itisnaturaltoconsideredgeswithnegativeweight forexample theweight  ª   negativeedges figure8  aminimumspanningtreeandashortestpathtreeofthesameundirectedgraph ofanedgemightrepresentthe cost ofmovingfromonevertextoanother negativeightedgesrepresenttransitionswithnegativecost orequivalently transitionsthatearnapro negativeedgesareathorninthesideofmostsproblems becausethepresenceofanegative cycle mightimplythatshortestpathsmaynot bewend tobeprecise ashortestpathfrom existsifandonlyif thereisatleastonepathfrom butthereisnopathfrom thattouches anegativecycle pathfrom thattouchesanegativecycle thereis ashorterpathfrom thatgoesaroundthecycleonemoretime  atleastonepathfrom touchesanegativecycle thereisnoshortestpath figure8  thereisnoshortestwalkfrom inpartbecauseweneedtoconsidernegativeedgeweights thischapter explicitlyconsiders directedgraphs allofthealgorithmsdescribedhere alsoworkforundirectedgraphswithessentiallytrivialmodi cations ifand onlyif negativeedgesareprohibited correctlyhandlingnegativeedgesin undirectedgraphsisconsiderablymoresubtle wecannotsimplyreplaceevery undirectededgewithapairofdirectededges becausethiswouldtransformany negativeedgeintoashortnegativecycle subpathsofan undirected shortestpath thatcontainsanegativeedgeare necessarilyshortestpaths thesetofallundirectedshortestpathsfromasinglesourcevertexmaynot neatree evenifshortestpathsareunique  technically weshouldbediscussingshortest walks ratherthanshortest paths butthe abuseofterminologyisstandard canreach theremustbeashortestsimplepathfrom sjustnptocompute whentherearenegativecycles byaneasyreductionfromthe hamiltonianpathproblem ontheotherhand ifthereisashortest walk thatwalk mustbeasimplepath andthereforemustbetheshortestsimplepathfrom blerg   shortestpaths figure8  anundirectedgraphwhereshortestpathsfrom areuniquebutdonotde neatree acompletetreatmentofundirectedgraphswithnegativeedgesisbeyond thescopeofthisbook iwillonlymention forpeoplewhowanttofollowup viagoogle thata single shortestpathinanundirectedgraphwithnegative edgescanbecomputedin  log time byareductiontomaximum weightedmatching  theonlyssspalgorithm justlikegraphtraversalandminimumspanningtrees manydi erentsssp algorithmscanbedescribedasspecialcasesofasinglegenericalgorithm rst proposedbylesterfordin1956andindependentlydescribedbygeorgedantzig in1957  andagainbygeorgemintyin1958 eachvertex inthegraphstores twovalues inductively describea tentative shortestpathfrom dist isthelengthofthetentativeshortest path  ifthereisno suchpath pred isthepredecessorof inthetentativeshortest path null ifthereisnosuchvertex thepredecessorpointersautomaticallyde neatentatives tree rootedat thesepointersareexactlythesameastheparentpointersin ourgenericgraphtraversalalgorithm atthebeginningofthealgorithm initializethedistancesandpredecessorsasfollows initsssp dist  pred null forallvertices  dist  pred null duringtheexecutionofthealgorithm anedge tense dist dist istense thetentativeshortestpath isclearlyincorrect becausethepath isshorter wecancorrect oratleastimprove obviousoverestimateby relaxing theedgeasfollows  speci cally dantzigshowedthattheshortestpathproblemcanbephrasedasalinear programmingproblem andthendescribedaninterpretationofhissimplexmethodintermsof theoriginalgraph hisdescriptionis morally equivalenttoford srelaxationstrategy    theonlyssspalgorithm relax dist dist pred nowthateverythingissetup ford sgenericalgorithmhasasimpleone description repeatedlyrelaxtenseedges untiltherearenomoretenseedges fordsssp initsssp whilethereisatleastonetenseedge relax anytenseedge fordsssp eventuallyterminates becausetherearenomoretenseedges thenthepredecessorpointerscorrectlyde neastree andeach dist istheactualsdistancefrom inparticular cannotreach dist  andifanynegativecycleisreachablefrom thenthealgorithmneverterminates thecorrectnessofford sgenericalgorithmfollowsfromthefollowingseries ofsimplerclaims  atanymomentduringtheexecutionofthealgorithm foreveryvertex thedistance dist iseither  orthelengthofawalkfrom claimcanbeprovedbyinductiononthenumberofrelaxations  ifthegraphhasnonegativecycles dist iseither  orthelength ofsome simplepath speci cally dist isthelengthof awalkfrom thatcontainsadirectedcycle thatcyclemusthave negativelength thisclaimimpliesthatif hasnonegativecycles relaxationalgorithmeventuallyhalts becausethereareonlya nite numberofsimplepathsin  ifnoedgein istense thenforeveryvertex thedistance dist isthelengthofthepredecessorpath pred pred pred speci cally violatesthisconditionbutitspredecessor pred theedge pred istense  ifnoedgein istense thenforeveryvertex thepathofpredecessor edges pred pred pred isinfactashortestpathfrom speci cally violatesthisconditionbutitspredecessor insome shortestpath doesnot theedge istense thisclaimalsoimplies thatif hasanegativecycle thensomeedgeis tense sothe genericalgorithmneverhalts sofarihaven tsaidanythingabouthowto ndtenseedges orwhichtense edge torelaxifthereismorethanone justlikewhatevsearch   shortestpaths areseveraldi erentinstantiationsofford sgenericrelaxationalgorithm whatevsearch thee ciencyandcorrectnessofeachsearch strategydependsonthestructureoftheinputgraph therestofthischapterconsidersthefourmostcommoninstantiations offord salgorithm eachofwhichisthebestchoiceforadi erentclassof inputgraphs llleavetheremainingdetailsofthegenericcorrectnessproof asexercises andinsteadgive moreinformative selfntained correctness proofsforeachofthesefourspeci calgorithms  unweightedgraphs breadth firstsearch inthesimplestspecialcaseoftheshortestpathproblem alledgeshaveweight  andthelengthofapathisjustthenumberofedges thisspecialcasecanbe solvedbyaspeciesofourgenericgraversalalgorithmcalled search searchisoftenattributedtoedwardmoore whodescribed itin1957 asalgorithmasthe rstpublishedmethodto ndtheshortest paththroughamaze  especiallyinthecontextofvlsiwiringandrobotpath planning searchissometimesattributedtochinyanglee describedseveralapplicationsofmoore salgorithm withpropercreditto moore in1961 in1945 morethanadecadebeforemooreconsidered mazes konradzusedescribedanimplementationofsearch asa methodtocountandlabelthecomponentsofadisconnectedgraph   moorewasmotivatedbyaweaknessinclaudeshannon smazrobot whichshannondesignedandconstructedin1950 theseususedamemoizedversionof rstsearch implementedusingelectromechanicalrelays thiswasalmostcertainlythe rst implementation ofsearchingraphs accordingtomoore thismachinewas usedwithamazewhichhadmorethanonesolution avisitoraskedwhyithadnotbeenbuilt toalways ndtheshortestpath shannonandieachattemptedto ndeconomicalmethods ofdoingthisbymachine hefoundseveralmethodssuitableforanalogcomputation  andi obtainedthesea  analogmethodsforcomputingshortestpathsthroughmazeshavebeenproposedusing ballbearings uid plasma chemicalreactionwaves chemotaxis resistornetworks electric circuitswithleds memristornetworks glowdischargeinmicro uidicchips growingplants slimemold amoebas ants bees nematodes andtourists  konradzusewasoneoftheearlypioneersofcomputing hedesignedandbuilthis rst programmablecomputer laterdubbedthez1 inthelate1930sfrommetalstripsandrodsinhis parents livingroom thez1anditsoriginalblueprintsweredestroyedbyabritishairraidin1944 zuse s1945phdthesisdescribesthevery rstevelprogramminglanguage called plankalkül rstcompleteexampleofaplankalkülprograminzuse sthesisisanimplementationof searchtocountcomponents alongwithapseudocodeexplanationandanillustrated traceofthealgorithm sexecutiononadisconnectedgraphwitheightvertices tothecollapseofthenazigovernment zusewasunabletosubmithisphdthesis andplankalkül remainedunpublisheduntil1972 rstplankalkülcompilerwas nallyimplementedin1975 byjoachimhohmann    unweightedgraphs breadth firstsearch searchmaintainsautqueueofvertices initiallycontainsonlythesourcevertex ateachiteration thealgorithm pull avertex fromthefrontofthequeueandexamineseachofitsoutgoingedges wheneverthealgorithmdiscoversanoutgoingtenseedge itrelaxes thatedgeand push esvertex ontothequeue thealgorithmendswhenthe queuebecomesempty bfs initsssp push whilethequeueisnotempty pull foralledges dist dist  istense dist dist  relax pred push searchissomewhateasiertoanalyzeifwebreakitsexecution phases byintroducinganimaginary token beforewe pull anyvertices push thetokenintothequeue thecurrentphaseendswhenwe pull tokenoutofthequeue webeginthenextphasewhenwe push thetokeninto thequeueagain rstphaseconsistsentirelyofscanningthesource vertex thealgorithmendswhenthequeuecontains thetoken modi edalgorithmisshowninfigure   andfigure   showsanexampleof thisalgorithminaction letmeemphasizethatthesemodi cationsaremerely aconvenienceforanalysis withorwithoutthetoken thealgorithm push esand pull sverticesinthesameorder scansedgesinthesameorder andoutputs exactlythesamedistancesandpredecessors bfswithtoken initsssp push push ú startthe rstphase whilethequeuecontainsatleastonevertex pull ú push ú startthenextphase foralledges dist dist  istense dist dist  relax pred push figure8  breadth rstsearchwithanend phasetoken ú boldredlinesareonlyforanalysis   shortestpaths figure8  acompleterunofbreadth rstsearchinadirectedgraph verticesarepulledfromthe queueintheorder ú ú cag ú fe ú ú ú ú istheend phasetoken boldverticesare inthequeueattheendofeachphase boldedgesdescribetheevolvingshortestpathtree letmeemphasizethatinthefollowinglemma dist isjustavariable maintainedbythealgorithm dist intuitively representsatentative sdistance wecannotassume dist iseveractuallyequal tothetruesdistancefrom tworry llgetthere lemma8  foreveryinteger  andeveryvertex attheendofthe phase dist  dist isinthequeueifandonlyif dist proof theproofproceedsbyinductionon thebasecase  forward atthestartofthe rstphasetheendofthezerothphathe queuecontainsonlythestartvertex andthetoken ú initsssp justset dist  dist  forall  xaninteger  theinductivehypothesisimpliesthatatthe start thphase thequeuecontainseveryvertex dist  bythetoken ú inotherwords thequeuelookslikethis ô ú    ô beforewe pull thetoken ú fromthequeue endingthe thphase pull vertex dist  foreachsuchvertex weconsidereveryoutgoingedge tense weset dist dist  sothat dist andthenimmediately    unweightedgraphs breadth firstsearch push intothequeue thesearetheonlyassignmentstodistancelabels duringthe thphase byinduction duringtheentire thphase thequeue containssomeverticeswithdistancelabel  followedbythetoken bysomeverticeswithdistancelabel ô ú   ô inparticular justbeforethe thphaseends thequeuecontainsthetoken followedbysomeverticeswithdistancelabel ô ú ô vertex appearsinthis nalqueueifandonlyif dist waschanged duringthe thphase attheendofthe thphase thequeuecontains vertex dist lemma   impliesthatthemainbodyof bfs assignsdistancelabelsinno decreasingorder ontheotherhand thedistancelabel dist ofeachvertex neverincreases itfollowsthatforeachvertex theline dist dist  isexecuted atmostonce duringphase dist eachpredecessorpointer pred ischangedatmostonce duringphase dist eachvertex push edintothequeueatmostonce duringphase dist eachvertex pull edfromthequeueatmostonce duringphase dist  foreachedge thecomparison dist dist  isperformed atmostonce duringphase dist  altogether theseobservationsimplythatsearchrunsin time intuitively wecanthinkoftheverticesinthequeueasaavefro expandingmonotonicallyoutwardfromthesourcevertex passingovereach vertexandedgeofthegraphatmostonce thisexpandingwavefrontanalogy wasalreadyproposedbychinyangleein1961 inspiredbyvisualizations producedbyhisimplementationofmoore salgorithma theseobservationsalsoimplythatwecanreplacethecondition dist dist  bythe arguably simplertest dist  thendistances playthesameroleasthemarksmaintainedbyothergraversalalgorithms whichensurethateachvertexisvisitedonlyonce speci cally avertexis ifandonlyifitsdistancelabelis nite butwestillneedtoprovethatthe naldistancelabelsarecorrect theorem8  bfs ends dist isthelengthoftheshortestpathin foreveryvertex   shortestpaths proof fixanarbitraryvertex andconsideranarbitrarypath    iclaimthat dist foreachindex dist wecanprovethisclaimbyinductionon asfollows trivially dist  dist  foranyindex  theinductionhypothesisimplies dist   immediatelyafterwe pull vertex  fromthequeue dist dist   orweset dist dist   ineithercase dist dist   wejustprovedthat dist isatmostthelengthofan arbitrary pathfrom itfollowsthat dist isatmostthelengthofthe shortest pathfrom asimilarinductionproofimpliesthat dist isthelengthofthepredecessor path pred pred pred sothismustbetheshortestpath  directedacyclicgraphs depth firstsearch shortestpathsarealsoeasytocomputeindirectedacyclicgraphs evenwhen theedgesareweighted andinparticular evenwhensomeedgeshavenegative weight wedon thavetoworryaboutnegativecycles becausebyde nition dagsdon thave cycles thisisacompletelystandarddynamic programmingalgorithm beadirectedgraphwithweightededges andlet bethe xedstart vertex foranyvertex dist denotethelengthoftheshortestpathin thisfunctionsatis esthefollowingsimplerecurrence dist  min dist infact thisidentityholdsfor directedgraphs butitisonlya recurrence fordirectedacyclicgraphs iftheinputgraph containedacycle arecursive evaluationofthisfunctionwouldfallintoanin niteloop isadag eachrecursivecallvisitsanearliervertexintopologicalorder thedependencygraphforthisrecurrenceisthereversaloftheinputgraph subproblem dist dependson dist ifandonlyif isanedgein wecomputethedistanceofeveryin time byperforminga searchinthereversalof andconsideringverticesinpostorder equivalently wecanconsidertheverticesintheoriginalgraph intopologicalorder showninfigure   theresultingdynamialgorithmisanotherexampleofford genericrelaxationalgorithm tomakethisconnectionclearer wecanmovethe initialization dist outsidethemainloopandaddcomputationofpredecessor pointers asshowninfigure   figure   showsthisalgorithminaction    directedacyclicgraphs depth firstsearch dagsssp forallvertices intopologicalorder dist  dist  foralledges dist dist istense dist dist relax figure8  computingshortestpathsinadagusingdynamicprogramming dagsssp initsssp forallvertices intopologicalorder foralledges istense relax figure8  computingshortestpathsinadagusingford salgorithm thesearethesamealgorithm figure8  computingshortestpathsinadag byrelaxing incoming edgesintopologicalorder eachiteration boldedgesindicatepredecessors andtheboldvertexisabouttobescanned compare withfigure     shortestpaths dagsssp ersfromsearchandotherinstancesofford relaxationstrategyinoneminorrespect whenevertheseothers algorithmsconsideravertex theyattempttorelaxeachofits outgoing edges intuitively pushing thewavefrontforwardfromthesource dagsssp attemptstorelaxeachofthe incoming edgesofeachvertex intuitively pulling thewavefrontforward ifwemodify dagsssp torelaxoutgoingedgesinsteadofincoming edges weobtainanotheralgorithmthatcomputesshortestpathsindags time andthatmorecloselyresemblesourothers algorithms pushdagsssp initsssp forallvertices intopologicalorder forall outgoing edges istense relax figure   showsanexecutionofthismodi edalgorithmonthesame graphasfigure   thecorrectnessof pushdagsssp followsimmediately fromthecorrectnessofford sgeneralrelaxationstrategy butit snothardto provecorrectnessdirectly byinductionovertheverticesintopologicalorder  best dijkstra salgorithm ifwereplacethefifoqueueinsearchwithapriorityqueue thekeyofavertex isitstentativedistance dist weobtainanalgorithm rstlisin1957byateamofresearchersatthecaseinstituteof technologyledbymichaelleyzorek inanannualprojectreportforthecombat developmentdepartmentoftheusarmyelectronicprovingground thesame algorithmwasindependentlydiscoveredbyedsgerdijkstrain1956 butnot publisheduntil1959 againbygeorgemintysometimebefore1960 andagain bypeterwhitingandjohnhillierin1960 anearlyidenticalalgorithmwas alsodescribedbygeorgedantzigin1958 althoughseveralearlysourcescalled ity sathisapproachisnowuniversallyknownas ainfullaccordancewithstigler slaw  pseudocodeforthisalgorithm isshowninfigure   aneasyinductionproofimpliesthat atalltimesduringtheexecutionofthis algorithm anedge istenseifandonlyifvertex iseitherinthepriority  iwillfollowthiscommonconvention despitethehistoricalinaccuracy partlybecausei tthinkanybodywantstoreadabouttheeyzohnso deraandpartlybecausepapersthataren published tcount    dijkstra salgorithm figure8  computingshortestpathsinadag byrelaxing outgoing edgesintopologicalorder eachiteration boldedgesindicatepredecessors andtheboldvertexisabouttobescanned compare withfigure   dijkstra initsssp insert  whilethepriorityqueueisnotempty extractmin foralledges istense relax isinthepriorityqueue decreasekey dist insert dist figure8  dijkstra salgorithm   shortestpaths queueoristhevertexmostrecently extract edfromthepriorityqueue dijkstra salgorithmisaninstanceofford sgeneralstrategy whichimpliesthat itcorrectlycomputesshortestpaths providedtherearenonegativecyclesin nonegativeedges dijkstra salgorithmisparticularlywvedwhentheinputgraphhasno negativeightedges inthissetting thealgorithmintuitivelyexpandsa wavefrontoutwardfromthesourcevertex passingoververticesinincreasing orderoftheirdistancefrom similarlytosearch figure   showsthealgorithminaction figure8  rstfouriterationsofdijkstra salgorithmonagraphwithnonegativeedges ineach iteration boldedgesindicatepredecessors shadedverticesareinthepriorityqueue andtheboldvertex isabouttobescanned theremainingiterationsdonotchangethedistancesortheshortest pathtree wecanderiveaselfntainedproofofcorrectnessfordijkstra salgorithm inthissettingbyformalizingthiswavefrontintuition foreachinteger denotethevertexreturnedbythe thcallto extractmin andlet bethe valueof dist justafterthis extract ion inparticular wehave    wecannotassumeatthispointthatthevertices aredistinct principle thesamevertexmightbe extract edmorethanonce lemma8  hasnonegativeightedges thenforall wehave proof assume hasnonegativeweightedges fixanarbitraryindex provethelemma itsu cestoprovethat  therearetwocasesto    dijkstra salgorithm containstheedge  andthisedgeisrelaxedduringthe iterationofthemainloop thenattheendofthe thiteration wehave dist  dist  dist becausealledgeweightsare noegative atthestartofthe thiteration  mustalreadybeinthe priorityqueue anditmusthavepriority dist  dist thevertexreturnedby extractmin dist  doesnotchange duringthe thiteration inbothcases weconcludethat  thelemmanowfollowsimmediately byinductionon lemma8  hasnonegativeightedges eachvertexof extract fromthepriorityqueueatmostonce proof suppose extract edmorethanonce speci cally suppose extract edinthe thiterationofthemainloop insert edduringthe iteration andre extract edduringthe thiteration forsomeindices theninthenotationofthepreviousproof wehave thedistancelabel dist neverincreases dist strictlydecreases duringthe thiteration justbefore isre insert itfollowsthat bythepreviouslemma hasatleastonenegativeightedge lemma   immediatelyimpliesthateachvertexisscannedatmostonce andthusthateachedgeisrelaxedatmostonce unlikein search eachdistancelabel dist canchangemultipletimes rsttime dist changesfrom  insert intothepriorityqueue afterthat changeto dist isfollowedbyacallto decreasekey extract fromthepriorityqueue itsdistancelabelneverchanges therestofthecorrectnessproofisalmostidenticaltosearch theorem8  hasnonegativeightedges thenwhen dijkstra ends dist isthelengthoftheshortestpathin foreveryvertex proof fixanarbitraryvertex andconsideranarbitrarypath    foranyindex denotethelengthofthe subpath   weprovebyinductionthat dist forall trivially dist  dist   foranyindex  theinductionhypothesisimplies dist   immediatelyafterwe pull vertex  fromthequeue dist dist   orweset dist dist   ineithercase wehave dist dist       shortestpaths wejustprovedthat dist isatmostthelengthof pathfrom followsthat dist isatmostthelengthofthe shortest pathfrom ontheotherhand asimilarinductionproofimpliesthat dist isthelength ofthepredecessorpath pred pred pred itremainsonlytoboundthealgorithm srunningtime altogether dijkstra performsatmost decreasekey operations andatmost insert extractmin operations ifweimplementtheunderlyingpriorityqueue usingastandardbinaryheap whichsupportseachoperationin log time dijkstra runsin log time  ifweknowinadvancethatourinputgraphswill havenegativeedges wecansimplifydijkstra salgorithmslightly insert ingeveryvertexintothe priorityqueueintheinitializationphase andthenonlycalling decreasekey themainloop asshowninfigure   thisistheversionofdijkstra salgorithm presentedbymostalgorithmstextbooks wikipedia andevendijkstra soriginal paper salsotheversionofdijkstra salgorithmthatidescribedas inchapter  nonnegativedijkstra initsssp forallvertices insert dist whilethepriorityqueueisnotempty extractmin foralledges istense relax decreasekey dist figure8  dijkstra salgorithmveryslightlysimpli edforgraphswithoutnegativeedges differences dijkstra areboldred ª negativeedges nonnegativedijkstra correctlycomputeshortestpaths ingraphswithnegativeedges evenwhenalledgeweightsare  spapersfromthe1950snevermentionedpriorityqueues dijkstraproposeda orcescanofallverticesonthewavefrontateveryiteration hisoriginalalgorithmruns  time whichisactuallyfasterthanthebinpimplementationwhen  mintyproposedaorcescanofall edges suchthat dist nitebut dist isnot hisoriginalalgorithmrunsin time theuseofapriorityqueue implementedas abinaryheap toobtainnearrunningtimewasproposedbydonaldjohnsonin1977 therunningtimecanbeimprovedto log usingamorecomplexpriorityqueuedata structurecalleda fibonacciheaps thereareevenfasteralgorithms usingevenmoresophisticated priorityqueues forthespecialcaseofintegeredgeweights    relaxalltheedges bellman ford positive nonnegativedijkstra isnofasterthan dijkstra eitherintheory orinpractice forbothofthesereasons ithink dijkstra ismoredeserving ofthenameathan nonnegativedijkstra evenedsger dijkstrawouldhaveagreedthatacorrectalgorithmthatissometimes andin practice rarely slowisbetterthanafastalgorithmthatdoesn talwayswork whentheinputgraphhasnegativeedges thefamiliar wavefrointuitionisnolongeraccurate thesamevertexcanbe extract edmultipletimes thesameedgecanberelaxedmultipletimes distancesmightnotbediscoveredinincreasingorder figure   showsan exampleexecutionwherethetopleftvertexis extracted sixtimes andthe topthreeedgesareeachrelaxedtwice forgraphswithoutnegativecycles butnootherrestrictionsonedgeweights thewserunningtimeof dijkstra isactuallyexponential figure   showsparticularlysimplefamilyofgraphs duetodouglasshierandchristoph witzgall thatforces dijkstra toperform   relaxations  amorecomplex familyofgraphs whichi llleaveasanexercise forces  relaxations istheworstpossible inpractice dijkstra salgorithmisusuallyfast evenforgraphswithnegativeedges figure8  adirectedgraphwithnegativeedgesthatforces dijkstra toruninexponentialtime  relaxalltheedges bellman ford thesimplestimplementationofford sgenericsalgorithmwas rstsketchedbyalfonsoshimbelin1954 describedinmoredetailbyedward moorein1957 andindependentlyrediscoveredbymaxwoodburyandgeorge dantzigin1957 byrichardbellmanin1958 andbygeorgemintyin1958 neitherwoodburyanddantzignormintypublishedtheiralgorithms infull compliancewithstigler slaw thealgorithmisalmostuniversallyknownas  becausebellmanexplicitlyusedford s1956formulationof  amusingly shierandwitzgall sexampleisadagwithonly edges whichimpliesthat shortestpathscanbecomputedinonly time evenifwe alreadynoticethatthe agpathalongthetop theshortestpathtree  iwillfollowthiscommonconvention despitethehistoricalinaccuracy partlybecausei tthinkanyonereallywantsreadaboutthehimbel moore woodbantzig ford kalaba mintyaandpartlybecausei mtiredofpeoplelookingatmefunny whenitalkabouthimbel   shortestpaths figure8  acompleterunofdijkstra salgorithmonagraphwithnegativeedges ateachiteration boldedgesindicatepredecessors shadedverticesareinthepriorityqueue andtheboldvertexisthe nexttobescanned comparewithfigure      relaxalltheedges bellman ford relaxingedges althoughsomeauthorsrefertola  andafew earlysourcesreferto theshimbel moore woodbantzig kalaba minty brosh  algorithmcanbesummarizedinoneline bellmaord relax thetenseedges thenrecurse bellmanford initsssp whilethereisatleastonetenseedge foreveryedge istense relax thefollowinglemmaisthekeytoprovingbothcorrectnessande ciency oford foreveryvertex andnoegativeinteger dist denotethelengthoftheshortest walk consistingof atmost edges inparticular dist   dist   forall  lemma8  foreveryvertex andnoegativeinteger iterationsof themainloopof bellmanford wehave dist dist proof theproofproceedsbyinductionon thebasecase  istrivial soassume  fixavertex andlet betheshortestwalkfrom consistingofatmost edges breakingtiesarbitrarily byde nition length dist therearetwocasestoconsider suppose hasnoedges mustbethetrivialwalkfrom dist  weset dist  initsssp dist neverincrease sowealwayshave dist  bethelastedgeof theinductionhypothesisimplies thatafter  iterations dist dist  duringthe thiterationof theouterloop whenweconsidertheedge intheinnerloop dist dist orweset dist dist inbothcases wehave dist dist  dist asusual dist cannotincrease dist mightdecreasefurtherbeforethe thiterationoftheouterloopends  thisnameismostlikelyareferencetorichardbellmanandrobertkalaba s1965monograph ondynamicprogrammingandcontroltheory whichdescribesbellman salgorithm bellmanand kalabaalsopublishedanextensionofbellman salgorithmin1960thatcomputes thshortest paths foranyconstant  goreadeverythingin hyperboleandahalf andthenadoptanothercat soyoucan buyitanothercopyofthebook   shortestpaths inbothcases weconcludethat dist dist attheendofthe iteration iftheinputgraphhasnonegativecycles theshortestwalkfrom toany othervertexisasimplepathwithatmost  edges itfollowsthat bellma ford haltswiththecorrectsdistancesafteratmost  iterations saiddi erently ifanyedgeisstilltenseafter  iterations thentheinput graphmustcontainanegativecycle wecanrewritethealgorithmmore concretelyasfollows bellmanford initsssp repeat  times foreveryedge istense relax foreveryedge istense returnegativecycl eachiterationoftheinnerlooptriviallyrequires time sotheoverall algorithmrunsin time ordis cient evenif thegraphhasnegativeedges andinfactevenifthegraphhasnegative cycles ifalledgeweightsarenoegative dijkstra salgorithmisfaster atleastintheworstcase inpractice dijkstra salgorithmisoftenfasterthan ordevenforgraphswithnegativeedges moore simprovement neithermoorenorbellmandescribedtheordalgorithmintheformi presentedhere moorepresentedhisversionofthealgorithm algorithmd thesamepaperthatproposedsearch algorithma forunweighted graphs thetwoalgorithmsarenearlyidentical althoughmoore algorithmhasthesame wserunningtimeas bellmanford itis oftensigni cantlyfasterinpractice intuitivelybecauseitavoidscheckingedges thatareousnottense moorederivedhisweightedsalgorithmbymakingtwom cationsto search replaceeach  inthe innermostloop totaketheedgeweightsintoaccount checkwhether avertexisalreadyinthefifoqueuebefore insert ingit sothatthequeue alwayscontainsatmostonecopyofeachvertex   moore salgorithmisstill correct withoutthischeck butthe timeboundisnot    relaxalltheedges bellman ford followingourearlieranalysisofsearch llintroducea ú tobreaktheexecutionofthealgorithmintophases justlike search eachphasebeginswhenthetokenis push edintothequeue andends whenthetokenis pull edoutofthequeueagain justlikebfs thealgorithm endswhenthequeuecontains thetoken theresultingalgorithmisshown infigure   moore initsssp push push ú startthe rstphase whilethequeuecontainsatleastonevertex pull ú push ú startthenextphase foralledges istense relax isnotalreadyinthequeue push figure8  moore sshortest pathalgorithm boldredlinesinvolvingthetoken ú areonlyforanalysis becausethequeuecontainsatmostonecopyofeachvertexatanytime eachvertexis pull edfromthequeueatmostonceineachphase andtherefore eachedge ischeckedfortensenessatmostonceineachphase everyedgethatistensewhenaphasebeginsisrelaxedduringthatphase someedgesthatbecometenseduringthephasemightalsoberelaxedduring thatphase andsomerelaxededgesmightbecometenseagaininthesame phase moore canbeviewedasare nementof bellmanford usesaqueuetomaintaintenseedges ratherthantestingeveryedgebybrute force inparticular asimilarinductiveproofestablishesthefollowinganalogue oflemma   lemma8  foreveryvertex andnoegativeinteger phasesof moore wehave dist dist iftheinputgraphhasnonegativecycles moore haltsafteratmost  phases ineachphase wescaneachvertexatmostonce sowerelax eachedgeatmostonce sothewserunningtimeofasinglephaseis theoverallrunningtimeof moore inpractice moore oftencomputesshortestpathsconsiderablyfasterthan bellmanford becauseitonlyscansanedge dist waschangedinthepreviousphase iftheinputgraphcontainsanegativecycle moore neverhalts fortunately bellmanford itiseasytomodifymoore salgorithmtoreportnegative   shortestpaths figure8  acompleterunofmoore salgorithmonadirectedgraphwithnegativeedges nodesare pulledfromthequeueintheorder ú abc ú ú ú ú ú ú istheend phasetoken thestartofeachphase boldedgesindicatepredecessors andshadedverticesareinthevertexqueue comparewithfigures     cyclesiftheyexist perhapstheeasiestmodi cationisto maintaina token andcountthenumberoftimesthetokenis pull edfromthequeue theinputgraphcontainsanegativecycleifandonlyifthequeueisnoy immediatelyafterthetokenis pull edforthe  thtime dynamicprogrammingformulation likealmosteverythingelsewithhisnameonit richardbellmanderivedthe salgorithmviadynamicprogramming asusual needtostartwitharecursivede nitionofshortestpathdistances stempting tousethesameidentitythatweexploitedfordirectedacyclicgraphs dist  min dist iftheinputgraphisnotadag thisrecurrencedoesn twork supposetheinputgraphcontainsthedirectedcycle tocompute dist rstneed dist andtocompute dist rstneed dist tocompute dist rstneed dist iftheinputgraphhasanydirected cycles wegetstuckinanin niteloop    relaxalltheedges bellman ford tosupportaproperrecurrence weneedtoaddanadditionalstructural parametertothedistancefunction whichdecreasesmonotonicallyateach recursivecall nedsothatthefunctionistrivialtoevaluatewhenthe parameterreaches  bellmanchose themaximumnumberofedges asthis additionalparameter  asinourearlieranalysis dist denotethelengthoftheshortestwalk consistingofatmost edges bellmanobservedthatthisfunction obeysthefollowing bellman sequationrecurrence dist       min dist  min dist  sassumethatthegraphhasnonegativecycles soourgoalistocompute dist  foreveryvertex hereisastraightforwarddynami evaluationofthisrecurrence dist storesthevalueof dist correctnessofthe nalsdistancesfollowsfromthecorrectnessof therecurrence andthe runningtimeisobvious thisisessentiallyhow bellmanpresentedhissalgorithm bellmanforddp dist   foreveryvertex  dist     foreveryvertex dist dist  foreveryedge dist dist  dist dist  wecantransformthisdynamicprogrammingalgorithmintoouroriginal formulationof bellmanford throughashortseriesofminoroptimizations eachiterationoftheoutermostloopconsiderseachedge exactlyonce buttheorderinwhichweconsiderthoseedgesdoesn tactuallymatter wecansafelyremoveonelevelofindentationfromthelastthreelines modi edalgorithmmayconsideredgesinadi erent order butitstillcorrectly computes dist forall  aswe llseeinthenextchapter thisisnottheonlyreasonablechoice   shortestpaths bellmanforddp2 dist   foreveryvertex  dist     foreveryvertex dist dist  foreveryedge dist dist  dist dist  nextwechangetheindicesinthelasttwolinesfrom  changemaycausethedistances dist toapproachthetrues distancesmorequicklythanbefore butthealgorithmcorrectlycomputesthe trueshortestpathdistances insteadof dist dist wenowhave dist dist forall mirroringlemmas     bellmanforddp3 dist   foreveryvertex  dist     foreveryvertex dist dist  foreveryedge dist dist  dist dist  butthisalgorithmisalittlesilly inthe thiterationoftheoutermostloop rstcopythe  throwofthearray dist tothe throw andthenmodify theelementsofthe throw sowereallydon tneedatwonalarrayat theiterationindex iscompletelyredundant inour nalmodi cation maintainonlyaononalarrayoftentativedistances bellmanfordfinal dist  foreveryvertex  dist    foreveryedge dist dist dist dist naldynamicprogrammingalgorithmisalmostidenticaltoouroriginal formulationof bellmanford rstthreelinesinitializetheshortestpath distances andthelasttwolinesrelaxtheedge ifthatedgeistense  exercises bellmanfordfinal ismissingonlytwofeaturesofourearlierformulation doesnotmaintainpredecessorpointersordetectnegativecycles fortunately addingthosefeaturesisstraightforward exercises  beadirectedgraphwitharbitraryedgeweights whichmaybepositive negative orzero possiblywithnegativecycles andlet beanarbitrary vertexof supposeeveryvertex storesanumber dist butnopredecessor pointers describeandanalyzeanalgorithmtodeterminewhether dist isthesdistancefrom foreveryvertex supposeinsteadthateveryvertex  storesapointer pred anothervertexin butnodistances describeandanalyzean algorithmtodeterminewhetherthesepredecessorpointersde nea singlurceshortestpathtreerootedat  loopedtree isaweighted directedgraphbuiltfromabinarytreebyadding anedgefromeveryleafbacktotheroot everyedgehasnoegative weight aloopedtree howmuchtimewoulddijkstra salgorithmrequiretocomputethe shortestpathbetweentwovertices inaloopedtreewith nodes describeandanalyzeafasteralgorithm  supposewearegivenadirectedgraph withweightededgesandtwo vertices describeandanalyzeanalgorithmto ndtheshortestpathfrom whenexactlyoneedgein hasnegativeweight hint modify dijkstra salgorithm ordon   shortestpaths describeandanalyzeanalgorithmto ndtheshortestpathfrom whenexactly edgesin havenegativeweight howdoestherunning timeofyouralgorithmdependon  supposewearegivenanundirectedgraph inwhichevery vertex hasa positiveweight describeandanalyzeanalgorithmto nda spanningtree minimumtotalweight thetotalweightofaspanningtreeisthesum oftheweightsofitsvertices describeandanalyzeanalgorithmto nda path fromonegiven vertex toanothergivenvertex withminimumtotalweight thetotal weightofapathisthesumoftheweightsofitsvertices hint oneoftheseproblemsistrivial  foranyedge inanygraph denotethegraphobtainedby deleting supposewearegivenagraph andtwovertices replacementpaths problemasksustocomputethes distancefrom edge theoutputisanarray distances oneforeachedgeof suppose isa directed graph andtheshortestpathfromvertex vertex passesthrough vertexof describeanalgorithmtosolve thisspecialcaseofthereplacementpathsproblemin log time ª describeanalgorithmtosolvethereplacementpathsproblemfor arbitrary undirected graphsin log time inbothsubproblems youmayassumethatalledgeweightsarenoegative hint ifwedeleteanedgeoftheoriginalshortestpath howdotheold andnewshortestpathsoverlap  beaconnecteddirectedgraphwithnoegativeedgeweights beverticesof andlet beasubgraphof obtainedbydeleting someedges supposewewanttoreinsertexactlyoneedgefrom sothattheshortestpathfrom intheresultinggraphisasshort aspossible describeandanalyzeanalgorithmthatchoosesthebestedge toreinsert log time  describeandanalyzeamodi cationofordthatactuallyreturns anegativecycleifanysuchcycleisreachablefrom oras treeifthereisnosuchcycle themodi edalgorithmshouldstillrunin time  exercises describeandanalyzeamodi cationofordthatcomputesthe correctshortestpathdistancesfrom toeveryothervertexoftheinput graph evenifthegraphcontainsnegativecycles speci cally ifany walkfrom containsanegativecycle youralgorithmshouldend dist dist shouldcontainthelengthofthe shortestpathfrom themodi edalgorithmshouldstillrunin time ª repeatparts butforford sgenericrelaxationalgorithm youmayassumethattheunmodi edalgorithmhaltsin  stepsif thereisnonegativecycle yourmodi edalgorithmsshouldalsorunin  time  considerthefollowingevenlooservariantofford sgenericrelaxation algorithm fellmanbored initsssp  towhatever man idon tcare anyedgein istense relax provethatif fellmanbored examinestheedgesofanywalk starting inorderalong thenthelastdistancelabelin isatmost thelengthof moreformally iftheedgesofanywalk    nea subsequence oftheedges    examinedby fellmanbored thenwehave dist   hint propertyisalmosteasiertoprovethanitistostatecorrectly  thisproblemconsidersseveralwaystodetectnegativecyclesusingford genericrelaxationalgorithm provethatif pred everchangesafter initsssp thentheinputgraph containsanegativecyclethrough showthat pred mightneverchangeafter initsssp evenwhenthe inputgraphcontainsanegativecyclethrough denotethecurrentgraphofpredecessoredges pred denotethesetofallcurrently seedges bothofthesesetsevolve asthealgorithmexecutes provethattheinputgraphhasnonegative cyclesifandonlyif isalwaysadag denotethesetofalledgesthathavebeenrelaxedsofar thisset growsasthealgorithmexecutes provethattheinputgraphhasno negativecyclesifandonlyif isalwaysadag   shortestpaths ª  provethatdijkstra salgorithmperforms  relaxationsintheworstcase whenedgesareallowedtohavenegativeweight eveniftheunderlying graphisacyclic speci cally foreverypositiveinteger constructa ertex dag withweightededges suchthatdijkstra salgorithmcalls relax  timeswhen istheinputgraph hint binarycounter ª  provethatford sgenericrelaxationalgorithm andthereforedijkstra algorithm haltsafteratmost  relaxations unlesstheinputgraph containsanegativecycle hint seeproblem   supposeyouaregivenadirectedgraph inwhich everyedgehasnegative weight andasourcevertex describeandanalyzeane cientalgorithm thatcomputesthesdistancesfrom toeveryothervertexin speci cally foreveryvertex isnotreachablefrom youralgorithmshouldreport dist  hasacyclethatisreachablefrom isreachablefromthatcycle thenthesdistancefrom isnotwed therearepaths formally walks ofarbitrarilylargenegative length inthiscase youralgorithmshouldreport dist ifneitherofthetwopreviousconditionsapplies youralgorithmshould reportthecorrectsdistancefrom  althoughwetypicallyspeakofshortestpathbetweentwonodes single graphcouldcontainseveralminimengthpathswiththesameendpoints evenforweightedgraphs itisoftendesirabletochooseaminimeight pathwiththefewestedges callthisa bestpath supposeweare givenadirectedgraph withpositiveedgeweightsandasourcevertex describeandanalyzeanalgorithmtocompute pathsin toeveryothervertex figure8  ofmany equal lengthshortestpaths rstpathistheshortestpath  describeandanalyzeanalgorithmtodeterminethe number ofshortest pathsfromasourcevertex toatargetvertex inanarbitrarydirected graph withweightededges youmayassumethatalledgeweightsare positiveandthatallnecessaryarithmeticoperationscanbeperformedin  exercises  time hint computeshortestpathdistancesfrom toeveryother vertex throwawayalledgesthatcannotbepartofashortestpathfrom toanothervertex sleft  youjustdiscoveredyourbestfriendfromelementaryschoolontwitbook youbothwanttomeetassoonaspossible butyouliveintwodi erent citesthatarefarapart tominimizetraveltime youagreetomeetatan intermediatecity andthenyousimultaneouslyhopinyourcarsandstart drivingtowardeachother butwhere shouldyoumeet youaregivenaweightedgraph wherethevertices represent citiesandtheedges representroadsthatdirectlyconnectcities edge hasaweight equaltothetimerequiredtotravelbetweenthe twocities youarealsogivenavertex representingyourstartinglocation andavertex representingyourfriend sstartinglocation describeandanalyzeanalgorithmto ndthetargetvertex thatallows youandyourfriendtomeetasquicklyaspossible  youarehiredasacyclistforthegigglehighwayviewproject whichwill provideevelimagesalongtheentireusnationalhighwaysystem asapilotproject youareaskedtoridethegigglehighwaview gearcarbobicyclefromgiggleplinportland oregonto esbinwilliamsburg brooklyn newyork youareahopelessca eineaddict butlikemostgiggleemployeesyou arealsoaco eesnob youonlydrinkindependentlyroasted organic swn singlespresso unadulteratedby milkorsugar thankyou aftereachespressoshot youcanbike upto milesbeforesu eringaca einwalmigraine gigglehelpfullyprovidesyouwithamapoftheunitedstates intheform ofanundirectedgraph whoseverticesrepresentco eeshopsthatsell independentlyroastededorganicswnsingl originespresso andwhoseedgesrepresenthighwayconnectionsbetween eachedge islabeledwiththelength ofthecorresponding stretchofhighway naturally thereareacceptableespressostandsatboth giggleo ces representedbytwospeci cvertices inthegraph describeandanalyzeanalgorithmtodeterminewhetheritispossible tobikefromthegiggleplextogigglesburgwithoutsu eringaca ein withdrawalmigraine youdiscoverthatbywearingamoreexpensivefedora youcanincrease thedistance thatyoucanbikebetweenespressoshots andanalyzeandalgorithmto ndtheminimumvalueof thatallows   shortestpaths youtobikefromthegiggleplextogigglesburgwithoutsu eringa einwalmigraine whenyoureporttoyoursupervisor whomgigglerecentlyhiredaway fromtheircompetitorünter thattherideisimpossible shedemands tolookatyourmap iseetheproblem thereareno starbucks thismaasyoulookoninhorror shehandsyouanupdatedgraph  thatincludesavertexforeverystarbuckslocationintheunitedstates helpfullymarkedinstarbucksgreen pantone c describeandanalyzeanalgorithmto ndtheminimumnumber ofstarbuckslocationsyoumustvisittobikefromthegiggleplexto gigglesburgwithoutsu eringaca einwalmigraine formally youralgorithmshould ndtheminimumnumberofgreen verticesonanypathin  thatusesonlyedgesoflengthat  supposeyouaregivenadirectedgraph withnoegatively weightededgesandtwovertices describeandanalyzeanalgorithm ndtheshortestwalkin possiblyrepeatingverticesand edges whosenumberofedgesisdivisibleby  forexample giventhegraphshownbelow withtheindicatedvertices andwithalledgeshavingweight  youralgorithmshouldreturn  whichisthelengthofthewalk haslength6  supposeyouaregivenadirectedgraph withnoegativelyweighted edges wheresomeedgesareredandtheremainingedgesareblue analgorithmto ndtheshortestwalkin fromonevertex toanother vertex inwhichnothreeconsecutiveedgeshavethesamecolor thatis thewalkcontainstworededgesinarow thenextedgemustbeblue andif thewalkcontainstwoblueedgesinarow thenextedgemustbered forexample giventhefollowinggraphasinput whereeveryred edgehasweight  andeveryblueedgehasweight  youralgorithm shouldreturntheinteger  becausetheshortestlegalwalkfrom  exercises  consideradirectedgraph whereeachedgehasanoegativeweight andeachedgeiscoloredeitherred white orblue awalkin iscalled french agwalk ifitssequenceofedgecolorsisred white blue red white blue andsoon moreformally awalk   isafrench agwalkif foreveryinteger theedge  isredif mod3  white mod3  andblueif mod3  describeanalgorithmto ndthe shortest french agwalksfromone startingvertex toeveryothervertexin  thereare galaxiesconnectedby intergalactictelays telayjoinstwogalaxiesandcanbetraversedinbothdirections eachtelay hasanassociatedcostof dollars isa positiveinteger atelaycanbeusedmultipletimes butthetollmust bepaideverytimeitisused judywantstotravelfromgalaxy togalaxy ascheaplyaspossible shewantsthetotalcosttobeamultipleof vedollars carryingsmallchangeisnotpleasanteither describeandanalyzeanalgorithmtocomputetheminimumtotalcost oftravelingfromgalaxy togalaxy subjecttotherestrictionthatthe totalcostisamultipleof vedollars solvepart butnowassumethatjudyhasacouponthatallowsher touseexactlyonetelayforfree  aftermovingtoanewcity youdecidetochooseawalkingroutefromyour hometoyournewo togetagooddailyworkout yourroutemust consistofanuphillpath forexercise followedbyadownhillpath tocool orjustanuphillpath orjustadownhillpath llwalkthesame pathhome soyou llgetexerciseonewayortheother butyoualsowant shortest paththatsatis estheseconditions sothatyouactuallygetto workontime yourinputconsistsofanundirectedgraph whoseverticesrepresent intersectionsandwhoseedgesrepresentroadsegments alongwithastart vertex andatargetvertex everyvertex hasanassociatedvalue whichistheheightofthatintersectionabovesealevel andeachedge uv hasanassociatedvalue uv whichisthelengthofthatroadsegment describeandanalyzeanalgorithmto ndtheshortestwnhill walkfrom assumeallvertexheightsaredistinct nowsupposeweallowsomeorallvertexheightstobeequal andanalyzeanalgorithmto ndtheshortestthendowalk youmayuse atedgesinboththeand portionsofyourwalk   shortestpaths finally supposeyoudiscoverthatthereisnopathfrom withthe structureyouwant describeanalgorithmto ndapathfrom thatalternatesbetweenandsubpathsasfewtimes aspossible andhasminimumlengthamongallsuchpaths  aftergraduatingfromsoobananauniversityyouacceptajobwith theleadingtravelingagencyforpeoplewhohateto yourjobistobuildasystemtohelpcustomersplanairplanetripsfromone citytoanother allofyourcustomersareafraidof ying andbyextension airports soanytripyouplanneedstobeasshortaspossible youknowall thedepartureandarrivaltimesofallthe ightsontheplanet supposeoneofyourcustomerswantsto yfromcity tocity describeanalgorithmto ndasequenceof ightsthatminimizesthe total timeintransit lengthoftimefromtheinitialdeparturetothe nal arrival includingtimeatintermediateairportswaitingforconnecting ights  inexercise  fromchapter  youdesignedanalgorithmtodecidewhether agiven emaze issolvable inthisproblem youwilldesign algorithmsto ndthe shortest walkthroughagivenemaze twodi erentde nitionsof completeeachanglemazebelowbytracingapathfromstartto nishthat hasonlyacuteangles yourinputisaconnectedundirectedgraph whoseverticesarepoints intheplaneandwhoseedgesarelinesegments edgesdonotintersect exceptattheirendpoints forexample adrawingoftheletter veverticesandfouredges rstmazeabovehas14verticesand21 edges youarealsogiventwovertices start finish awalkfrom start finish valid ifitcontainsonlyacuteangles ormoreformally foranytwoconsecutiveedges ü uvw ˇ  ü uvw ˇ  assumeyoucandeterminein  timewhetherthe anglebetweentwogivensegmentsisstraight obtuse oracute describeanalgorithmtocomputeavalidwalkfrom start finish traversesasfewsegmentsaspossible ifyourwalktraversesthesame segmenttwice countittwice describeanalgorithmtocomputeavalidwalkfrom start finish makesasfewturnsaspossible hint thisis thesameaspart  exercises describeanalgorithmtocomputeavalidwalkfrom start finish totaleuclideanlengthisassmallaspossible assumeyoucanalso computethelengthofanysegmentin  time  afteragruelingmidtermatthescenterforfakenewsdetection youdecidetotakethebushome sinceyouplannedahead youhavea schedulethatliststhetimesandlocationsofeverystopofeverybusin soobanana nosinglebusvisitsboththes centerandyourhome youmustchangebusesatleastonce thereare erentbuses eachbusstartsat12   makesexactly stops nallystopsrunningat11   busesalwaysrunexactlyon schedule andyouhaveanaccuratewatch finally youarefartootiredto walkbetweenbusstops describeandanalyzeanalgorithmtodeterminethesequenceofbus ridesthatgetsyouhomeasearlyaspossible yourgoalistominimize arrivaltime notthetimeyouspendtraveling themidtermwasheldonhalloween andthestreetsareinfested withzombies thesoobananamasstransitdistrictdoesn thave thefundingtoaddadditionalbusesorinstallzombifbusstops especiallyforonlyonenightayear describeandanalyzeanalgorithm todetermineasequenceofbusridesthatminimizes thetotaltimeyou spendwaitingatbusstops youdon tcarehowlateyougethomeor howmuchtimeyouspendonbuses assumeyoucanwaitinsidethe scenteruntilyour rstbusisjustabouttoleave  rstmorningafterreturningfromagloriousspringbreak alicewakes todiscoverthathercarwon tstart soshehastogettoherclassesat soobananauniversitybypublictransit shehasacompletetransit scheduleforpoobananacounty thebusroutesarerepresentedinthe schedulebyadirectedgraph whoseverticesrepresentbusstopsand whoseedgesrepresentbusroutesbetweenthosestops foreachedge theschedulerecordsthreepositiverealnumbers isthelengthofthebusridefromstop tostop inminutes isthe rsttime inminutespast12am thatabusleavesstop forstop isthetimebetweensuccessivedeparturesfromstop tostop inminutes rstbusforthisrouteleaves attime andarrivesat time thesecondbusleaves attime arrivesat attime thethirdbusleaves attime   shortestpaths  andarrivesat attime  andsoon alicewantstoleavesfromstop herhome atacertaintimeandarrive atstop thescenter asquicklyaspossible ifalicearrivesata stopononebusattheexacttimethatanotherbusisscheduledtoleave cancatchthesecondbus becauseshe sastudentatspu alicecanridethe busforfree soshedoesn tcarehowmanytimesshehastochangebuses describeandanalyzeanalgorithmto ndtheearliesttimealicecan reachherdestination yourinputconsistsofthedirectedgraph thevertices thevalues foreachedge  alice sstartingtime inminutespast12am hint inthisrareinstance itmaybeeasiertomodifythealgorithm insteadofmodifyingtheinputgraph  mulderandscullyhavecomputed foreveryroadintheunitedstates theexactprobabilitythatsomeonedrivingonthatroad beabducted byaliens agentmulderneedstodrivefromlangley virginiatoarea51 nevada whatrouteshouldhetakesothathehastheleastchanceofbeing abducted moreformally youaregivenadirectedgraph whereevery edge hasanindependentsafetyprobability safety ofapathis theproductofthesafetyprobabilitiesofitsedges designandanalyzean algorithmtodeterminethesafestpathfromagivenstartvertex toagiven targetvertex youmayassumethatallnecessaryarithmeticoperations canbeperformedin  time forexample withtheprobabilitiesshownabove ifmuldertriestodrive directlyfromlangleytoarea51 hehasa  chanceofgettingthere withoutbeingabducted ifhestopsinmemphis hehasa      chanceofarrivingsafely ifhestops rstinmemphisandtheninlasvegas hehasa          chanceofbeingabducted theygotelvis youknow  exercises  onanovernightcampingtripinsunnydalenationalpark youarewoken fromarestlesssleepbyascream asyoucrawloutofyourtenttoinvestigate aterri edparkrangerrunsoutofthewoods coveredinbloodandclutching acrumpledpieceofpapertohischest ashereachesyourtent hegasps thruststhepaperintoyourhands andfallsto theground checkinghispulse youdiscoverthattherangerisstonedead youlookdownatthepaperandrecognizeamapofthepark drawn asanundirectedgraph whereverticesrepresentlandmarksinthepark andedgesrepresenttrailsbetweenthoselandmarks trailsstartandend atlandmarksanddonotcross yourecognizeoneoftheverticesasyour currentlocation severalverticesontheboundaryofthemaparelabeled exit oncloserexamination younoticethatsomeone perhapsthepoordead parkranger haswrittenarealnumberbetween0and1nexttoeachvertex andeachedge ascrawlednoteonthebackofthemapindicatesthata numbernexttoanedgeistheprobabilityofencounteringavampirealong thecorrespondingtrail andanumbernexttoavertexistheprobabilityof encounteringavampireatthecorrespondinglandmark vampirescan standeachother scompany soyou llneverseemorethanonevampireon thesametrailoratthesamelandmark thenotewarnsyouthatstepping themarkedtrailswillresultinaslowandpainfuldeath youglancedownatthecorpseatyourfeet hisdeathcertainly lookedpainful wait wasthatatwitch arehisteethgettinglonger drivingatentstakethroughtheundeadranger sheart youwiselydecideto leavetheparkasfastaspossible describeandanalyzeane cientalgorithmto ndapathfromyour currentlocationtoanarbitraryexitnode suchthatthetotal expected number ofvampiresencounteredalongthepathisassmallaspossible suretoaccountfor thevertexprobabilities theedgeprobabilities hint evenwithoutthevertexprobabilities thisisnotthesameasthe previousproblem  thetreewhich llsthearmsgrewfromthetiniestsprout thetowerofninestoreysrosefroma small heapofearth thejourneyofathousandlicommencedwithasinglestep lao tzu taoteching chapter64 thcentury bce translatedbyjameslegge  andiwouldwalk vehundredmiles andiwouldwalk vehundredmore justtobethemanwhowalksathousandmiles tofalldownatyourdoor theproclaimers mgonnabe  sunshineonleith  almostthere almostthere redleader drewehenley starwars   pairsshortestpaths  introduction inthepreviouschapter wediscussedseveralalgorithmsto ndtheshortest pathsfromasinglesourcevertex toeveryothervertexofthegraph constructingashortestpathtreerootedat theshortestpathtreespeci twopiecesofinformationforeachnode inthegraph dist isthelengthoftheshortestpathfrom pred isthesecoastvertexintheshortestpathfrom inthischapter weconsiderthemoregeneral allpairsshortestpath problem whichasksfortheshortestpathfrom possiblesourcetoeverypossible destination foreverypairofvertices wewanttocomputethefollowing dist isthelengthoftheshortestpathfrom pred isthesecoastvertexontheshortestpathfrom   pairsshortestpaths theseintuitivede nitionsexcludeafewboundarycases allofwhichwe alreadysawinthepreviouschapter ifthereisnopathfrom thenthereisno shortest pathfrom thiscase wede dist  pred null ifthereisanegativecyclebetween thentherearepaths  witharbitrarilynegativelength inthiscase wede dist pred null finally doesnotlieonanegativecycle thentheshortestpathfrom itselfhasnoedges andthereforedoesn thavealastedge inthiscase dist  pred null thedesiredoutputoftheashortestpathproblemisapairof arrays onestoringall  sdistances  theotherstoringall  predecessors inthischapter llfocusalmostexclusivelyoncomputingthedistancearray thepredecessorarray fromwhichwecancomputetheactualshortestpaths canbecomputedwithonlyminormodi cations hint hint  lotsofsinglesources themostobvioussolutiontotheashortestpathproblemistoruna singlurceshortestpathalgorithm times onceforeachpossiblesource vertex speci cally lltheononalsubarray dist weinvokea singlurcealgorithmstartingatthesourcevertex obviousapsp foreveryvertex dist sssp therunningtimeofthisalgorithmobviouslydependsonwhichsinglurce shortestpathalgorithmweuse justasinthesinglurcesetting thereare fournaturaloptions dependingonthestructureofthegraphanditsedge weights iftheedgesofthegraphareunweighted searchgivesusan overallrunningtimeof  ifthegraphisacyclic scanningtheverticesintopologicalorderalsogives usanoverallrunningtimeof   formally walks  backwhenroadmapsusedtobeprintedonpaperandhadtobesearchedmanually wasfairlycommonforthemtoincludeatriangularancetablto ndthedistancefrom champaigntocolumbus forexample youwouldlookintherowlabeledandthe columnlabeledolumbu    reweighting ifalledgeweightsarenoegative dijkstra salgorithmgivesusarunning timeto log  log  finally inthemostgeneralsetting theordalgorithmgivesusan overallrunningtimeof    reweighting negativeedgesslowusdownsigni cantly canwegetridofthem onesimple ideathatoccurstomanypeopleisincreasingtheweightsofalltheedges bythesameamountsothatalltheweightsbecomepositive sothatwecan usedijkstra salgorithminsteadoford thissimple ideadoesn twork intuitivelybecauseourtwonaturalnotionsofare incompatiblwithmoreedgescanhavesmallertotalweightthanpaths withfeweredges ifweincreasealledgeweightsatthesamerate pathswith moreedgesgetlongerfasterthanpathswithfeweredges asaresult shortestpathbetweentwoverticesmightchange figure9  increasingalltheedgeweightsby2changestheshortestpathfrom thereisamoresubtlemethodforreweightingedgesthatdoes preserveshortestpaths thisreweightingmethodisoftenattributedtodonald johnson whodescribeditsapplicationtoshortestpathalgorithmsin1973 infact johnsonattributedthemethodtoa1972paperofjackedmondsand richardkarp thesamemethodwasalsodescribedbynobuakitomizawain  andinaslightlydi erentformbydelbertfulkersonin1961 supposeeachvertex hassomeassociated price ˇ whichmightbe positive negative orzero wecande neanewweightfunction  asfollows  ˇ ˇ togivesomeintuition imaginethatwhenweleavevertex wehavetopayan exittaxof ˇ andwhenweenter weget ˇ asanentrancegift snothardtoshowthatshortestpathswiththenewweightfunction  areexactlythesameasshortestpathswiththeoriginalweightfunction  ifwereplacethebinaryheapinourimplementationofdijkstra salgorithmwith anunsortedarray theoverallrunningtimebecomes  nomatterhowmanyedgesthe graphhas andifwereplacethebinaryheapwithafibonacciheap therunningtimedropsto log  log    pairsshortestpaths fact path fromonevertex toanothervertex wehave  ˇ ˇ wepay ˇ inexitfees plustheoriginalweightofofthepath minusthe ˇ entrancegift ateveryintermediatevertex onthepath weget ˇ asan entrancegift butthenimmediatelypayitbackasanexittax sinceallpaths changelengthbyexactlythesameamount theshortestpathfrom doesnotchange pathsbetweendi erentpairsofverticescouldchange lengthsbydi erentamounts sotheirordercouldchange  johnson salgorithm johnson sashortestpathalgorithmcomputesacost ˇ foreachvertex sothatthenewweightofeveryedgeisnoegative andthencomputesshortest pathswithrespecttothenewweightsusingdijkstra salgorithm supposetheinputgraphhasavertex thatcanreach theother vertices johnson salgorithmcomputestheshortestpathsfrom totheother vertices usingord whichdoesn tcareiftheedgeweightsaren tive andthenreweightsthegraphusingthepricefunction ˇ dist thenewweightofeveryedgeis  dist dist thesenewweightsarenoegative ordhalted recallthat anedge tense dist dist andthatsinglurce shortestpathalgorithmseliminatealltenseedges iforddetects anegativecycle johnson salgorithmaborts becauseshortestpathsarenot ifthereisnosuitablevertex thatcanreacheverything thennomatter wherewestartord someoftheresultingvertexpriceswillbein nite toavoidthisissue addanewvertex tothegraph withzeight edgesfrom totheothervertices edgesgoingbackinto thisaddition tchangetheshortestpathsbetweenanypairoforiginalvertices therearenopathsinto completepseudocodeforjohnson salgorithmisshowninfigure   runningtimeofthisalgorithmisdominatedbythecallstodijkstra salgorithm speci cally wespend timerunning bellmanford log timerunning dijkstra times timedoingotherbookkeeping theoverallrunningtimeis log  log  negativeedges tslowusdownafterall  assumingthedefaultbinpimplementation seethepreviousfootnote    dynamicprogramming johnsonapsp addanarti cialsource addanewvertex foreveryvertex addanewedge  computevertexprices dist bellmanford bellmanford foundanegativecycle failgracefully reweighttheedges foreveryedge   dist dist computereweightedshortestpathdistances foreveryvertex dist  dijkstra  computeoriginalshortest pathdistances foreveryvertex foreveryvertex dist dist  dist dist figure9  johnson sall pairsshortestpathsalgorithm  dynamicprogramming wecanalsosolvetheashortestpathproblemdirectlyusingdynamic programming insteadofinvokingasinglurcealgorithm dense graphs  thedynamicprogrammingapproacheventuallyyieldsan algorithmthatisbothsimplerand fasterthanjohnson salgorithm fortherestofthischapter iwillassumethattheinputgraphcontainsno negativecycles asusualfordynamicprogrammingalgorithms rstneedarecurrence justasinthesinglurcesetting theourecursivede nition dist  min dist onlyworkswhentheinputgraphisadag anydirectedcyclesdrivethe recurrenceintoanin niteloop wecanbreakthisin niteloopbyintroducingasanadditionalparameter exactlyaswedidforord dist denotethelengthofthe shortestpathfrom thatuses atmost edges theshortestpathbetween anytwoverticestraversesatmost  edges sothetruesdistance dist  bellman ssinglurcerecurrenceadaptstothissetting   pairsshortestpaths dist       min dist  min dist  turningthisrecurrenceintoadynamicprogrammingalgorithmisstraightf ward theresultingalgorithmrunsin   time shimbelapsp forallvertices forallvertices dist   dist     forallvertices forallvertices  dist dist  foralledges dist dist  dist dist  thisalgorithmwas rstsketchedbyalfonsoshimbelin1954  justlike bellman sformulationoford wedon tneedtheinnerloopover vertices ortheiterationindex themodi edalgorithmisshownbelow allpairsbellmanford forallvertices forallvertices dist  dist    forallvertices foralledges dist dist dist dist  shimbelassumedtheinputwasacomplete matrixofdistances sohisoriginal algorithmactuallyrunsin  timenomatterhowmanyedgesthegraphhas    divideandconquer givenhowwederivedit itshouldcomeasnosurprisethattheresulting algorithmisexactlythesameasinterleaving erentexecutionsof ford eachwithadi erentsourcevertex inparticular forallvertices afterthe thiterationofthemainfoop dist atmost thelengthofthe shortestpathfrom containingatmost edges  divideandconquer butwecanmakeamoresigni cantimprovement suggestedbymichaelfischer andalbertmeyerin1971 bellman srecurrencebreakstheshortestpathintoa slightlyshorterpathandasingleedge byconsideringallpossiblepredecessors ofthetargetvertex sbreaktheshortestpathsintotwoshorter shortestpathsatthe middle vertex thisideagivesusadi erentrecurrence forthesamefunction dist hereweneedtostopatthebasecase  insteadof  becauseapathwithatmostoneedgehasnolvertex tosimplifytherecurrenceslightly sde  foreveryvertex dist  min dist  dist  asstated thisrecurrenceonlyworkswhen isapowerof  sinceotherwisewe mighttryto ndtheshortestpathwith atmost afractionalnumberofedges butthat snotreallyaproblem dist isthetruesdistance forall  inparticular wecanuse  lg  onceagain adynamicprogrammingsolutionisstraightforward evenbefore wewritedownthealgorithm wecantelltherunningtimeis  log needtoconsider possiblevaluesof butonly lg possiblevalues inthefollowingpseudocodeforfischerandmeyer salgorithm thearray entry dist storesthevalueof dist  fischermeyerapsp forallvertices forallvertices dist   lg  forallvertices forallvertices dist  forallvertices dist dist  dist  dist dist  dist  unlikeourearlieralgorithms fischermeyerapsp thesameas invocationsofanysinglurcesalgorithm inparticular   pairsshortestpaths innermostloopdoes simplyrelaxtenseedges wecanstill removethelastdimensionofthetable dist everywhereinplaceof dist justaswedidinordandourearlierdynamicprogramming algorithm thisreducesthespacefrom   thismorepolished algorithmwasdescribedbyleyzorek etal in1957 inthesamepaperwhere theydescribedijkstra salgorithm leyzorekapsp forallvertices forallvertices dist  lg  forallvertices forallvertices forallvertices dist dist dist dist dist dist  funnymatrixmultiplication thereisaverycloseconnection rstobservedbyshimbel andlater dentlybybellman betweencomputingshortestpathsinadirectedgraphand computingpowersofasquarematrix comparethefollowingalgorithmfor squaringan matrix withtheinnerloopof fischermeyerapsp slightlymodi edthenotationinthesecondalgorithmtomakethesimilarity clearer matrixsquare        fischermeyerinnerloop forallvertices forallvertices   forallvertices  min  erencebetweenthesetwoalgorithmsisthatthesecondalgorithm usesadditioninsteadofmultiplication andminimizationinsteadofaddition thisreason theshortestpathinnerloopissometimesreferredtoas oranormatrixmultiplication    funnymatrixmultiplication oursloweralgorithm shimbelapsp isthestandarditerativealgorithmfor computingthe  thspowoftheweightmatrix rst setofloopssetsupthesidentitymatrix  sonthemaindiagonal  everywhereelse andeachiterationofthesecondmainloopcomputes thenextspow fischermeyerapsp replacesthisiterativemethod forcomputingpowerswithrepeatedsquaring exactlyaswesawattheendof chapter  onceagain weseethein uenceofancientegyptian rpedon ptai therearefasterdinqueralgorithmsfor standard matrixm plication similartokaratsuba sdinqueralgorithmformultiplying integers rstsuchalgorithm describedbyvolkerstrassenin1969 reduces theproblemofmultiplyingtwo matricesto instancesofmultiplying   matrices strassen salgorithmrunsin lg7   strassen salgorithmhasbeenimprovedmanytimesoverthelast ftyyears of2018 thefastestultiplicationalgorithmknown runsin   time  ofthesefasteralgorithmsusesubtraction andthere noequivalentofsubtraction stheinverseoperationformin soatleastforgeneralgraphs snoobviouswaytospeeduptheinnerloop ofourdynamicprogrammingalgorithms butotobvioudoesnotmeanssiblinfact thereareseveral signi cantlyfasteralgorithmsfor specialcases oftheashortestpaths problem oneofthenicestisasimplerandomizedalgorithmdiscoveredin byzvigalilandodedmargalit andfurthersimpli edin1992byraimund seidel thatcomputesashortestpath distances unweighted undirected graphsin log expected time   isthetime requiredto multiplytwo integermatrices  galil margalit seidel sapproachhassincebeenextendedtocomputeactualshortestpaths deterministically indirectedgraphs withsmallintegeredgeweights instrongly subcubictime ontheotherhand despiteconsiderableprogressinthesmaeight setting nobodyknowshowtocomputeashortestpathsformoregeneral edgeweightsin   time foranynumberof  thereis someevidencethatsuchanalgorithmisimpossible somaybeotobviou doesmeanssiblafterall  determiningtheminimumtimerequiredtomultiplytwoarbitrary matricesisa loandingopenproblem manypeoplebelievethereisanundiscoveredalgorithmthatruns  timeforany  orpossiblyevenin  time  raimundseidel ontheaprobleminunweightedundirectedgraphs journalofcomputerandsystemsciences  thisisoneofthefewalgorithms paperswhere inthe1992conferenceversionatleast thealgorithmiscompletelydescribed andanalyzed intheabstract ofthepaper seealso nogaalon zvigalil odedmargalit theexponentoftheallpairsshortestpathproblem journalofcomputerandsystemsciences    pairsshortestpaths   kleene roy floyd warshall ingerman ourfastdynamicprogrammingalgorithmisstillafactorof log slower intheworstcasethanthestandardimplementationofjohnson salgorithm adi erentformulationofshortestpathsthatremovesthislogarithmicfactor wasproposedtwicein1962 rstbyrobertfloydandlaterindependentlyby peteringerman bothslightlygeneralizinganalgorithmofstephenwarshall publishedearlierinthesameyear infact warshall salgorithmwaspreviously discoveredbybernardroyin1959 andtheunderlyingrecursionpatternwas usedbystephenkleene  in1951 warshall androy sandkleene insightwastouseadi erentthird parameterinthedynamicprogrammingrecurrence insteadofconsidering pathswithalimitednumberofedges theyconsideredpathsthatcanpass throughonlycertainvertices ssthromeansenterand leavforexample thepath startsat passesthrough andendsat numbertheverticesarbitrarilyfrom  foreverypairofvertices andeveryinteger wede neapath ˇ asfollows ˇ istheshortestpath ifany thatpasses throughonlyverticesnumberedatmost inparticular ˇ isthetrueshortestpathfrom kleeneandroy andwarshallallobservedthatthesepathshaveasimplerecursivestructure figure9  recursivestructureoftherestrictedshortestpath ˇ thepath ˇ  tpassthroughanyintermediatevertices soitmust betheedge ifany foranyinteger  ˇ passesthroughvertex oritdoesn ˇ passesthroughvertex itconsistsofasubpathfrom followedbyasubpathfrom bothofthosesubpathspassthrough onlyverticesnumberedatmost  thosesubpathsareas shortaspossiblewiththisrestriction sothetwosubpathsmustbe ˇ  ˇ   pronouncedayknnotororaorspeci cally kleenedescribedaninductiveproofthatevery niteautomatahasanequivalentregular sion kleene sinductionpatternisessentiallyidenticaltotheflwarshallrecurrence    kleene roy floyd warshall ingerman ontheotherhand ˇ doesnotpassthroughvertex thenit passesthroughonlyverticesnumberedatmost  anditmustbe shortest pathwiththisrestriction sointhiscase wemusthave ˇ ˇ  nowlet dist denotethe length ofthepath ˇ therecursive structureof ˇ immediatelyimpliesthefollowingrecurrence dist   min dist  dist  dist  ourgoalistocompute dist forallvertices onceagain thisrecurrencecanbeevaluatedbyastraightforwarddynamicprogramming algorithmin  time kleeneapsp forallvertices forallvertices dist   forallvertices forallvertices dist  dist  dist  dist dist  dist dist  dist  likeallourpreviousdynamicprogrammingalgorithmsforshortestpaths cansimplify kleeneapsp byremovingthethirddimensionofthememoization table becausewechosethevertexnumberingarbitrarily sno reasontorefertoitexplicitlyinthepseudocode nallyarriveatfloyd improvementofwarshall salgorithm floydwarshall forallvertices forallvertices dist forallvertices forallvertices forallvertices dist dist dist dist dist dist sinterestingtocompare floydwarshall withourearlier slightlyslower dynamicprogrammingalgorithm leyzorekapsp insteadof log passes   pairsshortestpaths throughalltriplesofvertices floydwarshall requiresonlyasinglepass onlybecauseitusesadi erentnestingorderforthethreeloops exercises  describeamodi cationof leyzorekapsp thatreturnsanarrayof predecessorpointers inadditiontothearrayofshortestpathdistances stillin  log time describeamodi cationof floydwarshall thatreturnsanarrayof predecessorpointers inadditiontothearrayofshortestpathdistances stillin  time  allofthealgorithmsdiscussedinthischapterfailifthegraphcontainsa negativecycle johnson salgorithmdetectsthenegativecycleintheinitia izationphase viaord andaborts thedynamicprogramming algorithmsjustreturnincorrectresults ofthesealgorithmscan bemodi edtoreturncorrectsdistances eveninthepresence ofnegativecycles speci cally forallvertices cannotreach thealgorithmshouldreturn dist  canreachanegativecyclethatcanreach thealgorithmshould return dist thereisashortestpathfrom sothealgorithmshould returnitslength describehowtomodify johnson salgorithm toreturnthecorrect sdistances evenifthegraphhasnegativecycles describehowtomodify leyzorekapsp toreturnthecorrects pathdistances evenifthegraphhasnegativecycles describehowtomodify flwarshall toreturnthecorrects distances evenifthegraphhasnegativecycles  thealgorithmsdescribedinthischaptercanalsobemodi edtoreturnan explicitdescriptionofsomenegativecycleintheinputgraph ifoneexists insteadofonlyreportingwhetherornot containsanegativecycle describehowtomodify johnson salgorithm toreturneitherthearray ofallsdistancesoranegativecycle describehowtomodify leyzorekapsp toreturneitherthearrayofall sdistancesoranegativecycle describehowtomodify flwarshall toreturneitherthearrayofall sdistancesoranegativecycle  exercises inallcases iftheinputgraphcontainsmorethanonenegativecycle algorithmsmaychooseonearbitrarily  beadirectedgraphwithweightededges edgeweightscan bepositive negative orzero buttherearenonegativecycles describeane cientalgorithmthateither ndsacycleoflengthzero orcorrectlyreportsthatnosuchcycleexists describeane cientalgorithmthatconstructsasubgraph thefollowingproperties everyvertexof isavertexof everydirectedcyclein haslength  everydirectedcycleoflength  isalsoacyclein inparticular iftherearenozesin hasnoedges  beadirectedgraphwithweightededges edgeweightscan bepositive negative orzero supposetheverticesof arepartitioned disjointsubsets   thatis everyvertexof belongsto exactlyonesubset foreach denotetheminimum sdistancebetweenverticesin andverticesin min dist   describeanalgorithmtocompute forall forfullcredit algorithmshouldrunin kv log time  inthisproblemwewilldiscoverhowyou canbeemployedby wallstreetandcauseamajoreconomiccollapse arbitrage business isamonkingschemethattakesadvantageofdi erencesincurrency exchange inparticular suppose1usdollarbuys120japaneseyen yen buys0 euros and1eurobuys1 usdollars atraderstartingwith canconverttheirmoneyfromdollarstoyen thenfromyentoeuros nallyfromeurosbacktodollars endingwith   thecycleof currencies iscalledan arbitragecycle ofcourse nding andexploitingarbitragecyclesbeforethepricesarecorrectedrequires extremelyfastalgorithms suppose erentcurrenciesaretradedinyourcurrencymarket aregiventhematrix exch   ofexchangeratesbetweeneverypair ofcurrencies foreach oneunitofcurrency canbetradedfor exch unitsofcurrency assumethat exch exch  describeanalgorithmthatreturnsanarray maxamt  maxamt isthemaximumamountofcurrency thatyoucanobtain   pairsshortestpaths bytrading startingwithoneunitofcurrency  assumingthereareno arbitragecycles describeanalgorithmtodeterminewhetherthegivenmatrixofcurrency exchangeratescreatesanarbitragecycle modifyyouralgorithmfrompart toactuallyreturnanarbitrage cycle ifitexists  mortyneedstoretrieveastabilizedplumbusfromtheclackspirelabyrinth hemustenterthelabyrinthusingrick sinterdimensionalportalgun traverse thelabyrinthtoaplumbus thentakethatplumbusthroughthelabyrinth toa eebtobestabilized nallytakethestabilizedplumbusback totheoriginalportaltoreturnhome plumbusesarestabilizedby eeb juice whichany eebwillreleaseimmediatelyafterbeingremovedfromits eebhole anunstabilizedplumbuswillexplodeifitiscarriedmorethan  inksfromitsoriginalstorageunit theclackspirelabyrinthsmellslike farts somortywantstospendaslittletimethereaspossible rickhasgivenmortyadetailedmapoftheclackspirelabyrinth consistofadirectedgraph withnoegativeedgeweights indicatingdistancein inks alongwithtwodisjointsubsets ˆ ˆ indicatingtheplumbusstorageunitsand eebholes mortyneedstoidentifyastartvertex aplumbusstorageunit  anda eebhole  suchthatthesdistancefrom isatmost  inkslong andthelengthoftheshortestwalk isasshortas describeandanalyzeanalgo burp rithmtoso burp olvemorty lem youcanassumethatitisinfactpossibleformortytosucceed  beadirectedgraphwithweightededges edgeweightscould bepositive negative orzero howwouldwedeleteanarbitraryvertex fromthisgraph changingthesdistancebetweenanyotherpairofvertices describeanalgorithmthatconstructsadirectedgraph  nf  withweightededges suchthatthesdistancebetweenany twoverticesin  isequaltothesdistancebetweenthe sametwoverticesin  time nowsupposewehavealreadycomputedallsdistancesin  describeanalgorithmtocomputethesdistancesinthe originalgraph toeveryothervertex andfromeveryother vertexto allin  time  exercises combineparts intoanotherashortestpathalgorithm thatrunsin  time theresultingalgorithmis thesameas flwarshall  suppose boolean matrices boolean product isthe matrix nedasfollows _ reducebooleanmatrixmultiplicationtosmatrixmultiplication thatis givenasubroutine minplusmultiply thatcomputesthe plusproductoftwo matricesin time describeandanalyze analgorithm booleanmatrixmultiply thatmultipliestwoboolean matricesin time reducebooleanmatrixmultiplicationtostandardmatrixmultiplication thatis givenasubroutine matrixmultiply thatcomputesthestandard productoftwo matricesin time describeandanalyze analgorithm booleanmatrixmultiply thatmultipliestwoboolean matricesin time  transitiveclosure ofadirectedgraph containsanedge ifandonly ifthereisadirectedpathfrom forthisproblem assumewe canmultiplytwo booleanmatricesin time forsomeconstant   problem  implies   describeanalgorithmtocomputethetransitiveclosureofan ertex directedgraphin log time nowsuppose isadirected acyclic graph describeanalgorithmto computethetransitiveclosureof time hint dowhatyou alwaysdowithdags andthendivideandconquer usethefactthat  finally describeanalgorithmtocomputethetransitiveclosureofan arbitrary directedgraphin time hint dowhatyoualwaysdo toturnanarbitrarydirectedgraphintoadag nowlet sreversethepreviousreduction givenasubroutine tra closure thatcomputesthetransitiveclosureofan ertexdirected graphin time forsomeconstant   describeandanalyze analgorithmforbooleanmatrixmultiplicationthatrunsin time  provethatthefollowingrecursivealgorithmcorrectlycomputesa sdistancesin  time forsimplicity youmayassume isapowerof  asusual thearray ispassed byreference tothehelper   pairsshortestpaths function recapsp hint thisisajumbledversionof floywarshall signi cantlybettercachebehavior  recursiveapsp      recapsp    return   recapsp  min  recapsp  recapsp  recapsp  recapsp  recapsp  recapsp  recapsp  recapsp  ª  beanundirected unweighted connected ertexgraph representedbyanadjacencymatrix   inthisproblem wewill deriveseidel scalgorithmtocomputethe matrix   ofsdistancesin usingfastmatrixmultiplication assumethat wehaveasubroutine matrixmultiply thatcomputesthestandardproduct oftwo matricesin time forsomeunknownconstant   denotethegraphwiththesameverticesas wheretwovertices areconnectedbyaedgeifandonlyiftheyareconnectedbyapathof lengthatmost  describeanalgorithmtocomputetheadjacency matrixof  usingasinglecallto matrixmultiply  additional time supposewediscoverthat  isacompletegraph describeanalgorithm tocomputethematrix ofshortestpathdistancesin  additionaltime supposewerecursivelycomputethematrix  ofsdistances  provethatthesdistancein fromnode tonode iseither      nowsuppose  acompletegraph  andlet deg denotethedegreeofvertex intheoriginalgraph provethatthe sdistancefromnode tonode   ifand onlyif  deg  joopark michaelpenner andviktork prasanna optimizinggraphalgorithmsfor improvedcacheperformance ieeetrans parallelanddistributedsystems  forasigni cantgeneralizationtoawiderclassofdynamicprogrammingproblems seerezaul alamchowdhuryandvijayaramachandran liviousdynamicprogramming proc th soda   exercises describeanalgorithmtocomputethematrix ofsdistances log time  gideonyuvalproposedthefollowingreductionfromsmatrixm plicationtostandardmatrixmultiplicationin1976 supposewearegiven twointegers matrices ofintegers eachofwhoseentriesis  andwewanttocomputetheirsproductmatrix nedbysetting min forallindices netwonew matrices     finally  bethe standard productof   nedbysetting    describeanalgorithmtoconstruct  usingonlystandardinteger arithmeticoperations describeanalgorithmtoextractthesproduct  onlystandardintegerarithmeticoperations  supposewecancomputethestandardproductoftwo integer tricesusing arithmeticoperations forsomeconstant   howmanyarithmeticoperationsdoesyuval salgorithmneedtocompute thesproduct givenasingle integermatrix howmanyarithmeticoperationsare requiredtocomputethe thpowerof usingyuval salgorithm recallthatif istheweightedadjacencymatrixofagraph thenthe thpowerof isthematrixofsdistances whydoesn tyuval salgorithmimplyanashortestpathalgorithm thatisfasterthanflwarshallfor arbitrary edgeweights howare wecheating  inparticular uselogarithmsordivisionorthe oorfunction trustisa canofwormsyoudo wanttoopen  aprocesscannotbeunderstoodbystoppingit understandingmustmovewith owoftheprocess mustjoinitand owwithit thefirstlawofmentat infrankherbert dune  contrarytoexpectation owusuallyhappensnotduringrelaxingmomentsof leisureandentertainment butratherwhenweareactivelyinvolvedinadif cult enterprise inataskthatstretchesourmentalandphysicalabilities flowishard toachievewithouteffort flowisnotwastingtime mihalycsíkszentmihályi flow thepsychologyofoptimalexperience  sadifferencebetweenknowingthepathandwalkingthepath morpheus laurencefishburne thematrix   maximumflows minimumcuts intheu airforceresearchertheodoree harrisandretiredu armygeneralfranks rosswroteaclassi edreportstudyingtherailnetwork thatlinkedthesovietuniontoitssatellitecountriesineasterneurope networkwasmodeledasagraphwith44vertices representinggeographic regions and105edges representinglinksbetweenthoseregionsintherail network eachedgewasgivenaweight representingtherateatwhichmaterial couldbeshippedfromoneregiontothenext essentiallybytrialanderror determinedboththemaximumamountofstu thatcouldbemovedfromrussia intoeurope aswellasthecheapestwaytodisruptthenetworkbyremoving links orinlessabstractterms blowinguptraintracks whichtheycalled bottlentheirreport whichincludedthedrawingofthenetworkin figure   wasonlydeclassi edin1999   ilearnedthisstoryfromalexanderschrijver sfascinatingsurveynthehistoryof combinatorialoptimization tillthehossreportwasdeclassi edatschrijver request fordandfulkerson whowewillmeetshortly creditharrisforformulatingthe   maximumflows minimumcuts figure10  harrisandross smapofthewarsawpactrailnetwork imagecredits attheendof thebook thisoneofthe rstrecordedapplicationsofthe maximum minimumcut problems forbothproblems theinputisadirectedgraph withtwospecialvertices calledthe source target asin previouschapters iwillwrite todenotethedirectededgefromvertex tovertex intuitively themaximum owproblemasksforthemaximumrate atwhichsomeresourcecanbemovedfrom theminimumcutproblem asksfortheminimumdamageneededtoseparate  flows orjusta ifthesourceandtargetverticesareclearfromco text isafunction thatsatis esthefollowing conservationconstraint ateveryvertex exceptpossibly inenglish thetotal owinto isequaltothetotal owoutof tokeepthe notationsimple wede  ifthereisnoedge inthegraph ofthe denoted isthetotalnet owoutofthesource vertex maximowproblem althoughtheprecisechronologyissomewhatmuddled harrisandross thankgeorgedantzigorassistanceinformulatingtheprobl    cuts snothardtoprovethat isalsoequaltothetotalnet thetarget vertex asfollows tosimplifynotation denotethetotalnet outofanyvertex theconservationconstraintimpliesthat  oreveryvertex ontheotherhand owthatleavesonevertexmustenteranothervertex wemusthave  itfollowsimmediatelythat nowsupposewehaveanotherfunction  thatassignsano negative capacity toeachedge wesaythata feasible respectto  foreveryedge mostofthetimeweconsider owsthatarefeasiblewithrespecttosome xedcapacityfunction wesay thata saturates edge avoids edge  maximum owproblem istocomputeafeasible owinagivendirected graph withagivencapacityfunction whosevalueisaslargeaspossible figure10  afeasible owwithvalue10 eachedgeislabeledwithits capacity  cuts orjust cut ifthesourceandtargetverticesareclearfromcontext isapartitionoftheverticesintodisjointsubsets   ifwehaveacapacityfunction  capacity ofacutisthesum ofthecapacitiesoftheedgesthatstartin andendin   isnotanedgeinthegraph weassume  noticethat thede nitionisasymmetric edgesthatstartin andendin areunimportant   maximumflows minimumcuts minimumcutproblem istocomputean whosecapacityisas smallaspossible figure10  cutwithcapacity15 eachedgeislabeledwithitscapacity intuitively theminimumcutisthecheapestwaytodisruptall owfrom itisnothardtoshowthefollowingrelationshipbetween ows andcuts lemma10  feasible andlet thevalueof isatmostthecapacityof ifand onlyif saturateseveryedgefrom andavoidseveryedgefrom proof chooseyourfavorite andyourfavoritecut andthenfollow thebouncinginequalities byde nition  conservationconstraint   math nitionof     removingedgesfrom     nitionofcut      byde nition inthesecondstep wearejustaddingzeros  foreveryvertex  nf inthefourthstep weareremoving owvalues    themax mincuttheorem arein becausetheyappearinbothsums positivelywhen andnegativelywhen rstinequalitiesinthisderivationisactuallyanequalityifandonlyif avoidseveryedgefrom thesecondinequalityisactuallyan equalityifandonlyif saturateseveryedgefrom thislemmaimmediatelyimpliesthatif mustbea maximum mustbeaminimumcut  themax mincuttheorem surprisingly inevery ownetwork thereisafeasible andan cut suchthat thisisthefamous max owcuttheorem rstprovedbylesterford ofsfame anddelbertfulkersonin andindependentlybypeterelias amielfeinstein andclaudeshannon ofinformatioandmazfame in1956 themax ocuttheorem inevery ownetworkwithsource target thevalueofthemaximum owis equal tothecapacityofthe minimum fordandfulkersonprovedthistheoremasfollows fixagraph vertices andacapacityfunction  theproofwillbeeasierifweassume reduced meaningthereisatmostoneedgebetweenanytwovertices inparticular   thisassumptioniseasy toenforce subdivideeachedge withanewvertex replacing withapath andde themodi graphhasthesamemaximum owvalueandminimumcutcapacityasthe originalgraph figure10  enforcingtheone directionassumption beanarbitraryfeasible owin wede neanewcapacity function calledthe residualcapacity asfollows       maximumflows minimumcuts intuitively theresidualcapacityofanedgeindicateshowmuch owcanbe pushedthroughthatedge  theseresidualcapacities arealwaysnoegative itispossibletohave  evenif isnotan edgeintheoriginalgraph wede nethe residualgraph isthesetofedgeswhoseresidualcapacityispositive mostresidual graphsare reduced inparticular  thentheresidual graph containsboth anditsreversal figure10  inaweightedgraph andthecorrespondingresidualgraph nowwehavetwocasestoconsider eitherthereisadirectedpathfromthe sourcevertex tothetargetvertex intheresidualgraph orthereisn firstsupposetheresidualgraph containsadirectedpath augmentingpath min  denotethemaximum amountof owthatwecanpushthrough wede neanew  intheoriginalgraph asfollows     figure10  anaugmentingpathwithvalue  andtheresultingaugmented  iclaimthatthisnew  isfeasiblewithrespecttotheoriginalcapacities meaning    consideranedge intheoriginal graph therearethreecasestoconsider iftheaugmentingpath      themax mincuttheorem isfeasible  byde nitionof  byde nitionof byde nitionof duh iftheaugmentingpath containsthereversededge  againbecause isfeasible  byde nitionof  byde nitionof byde nitionof  duh finally ifneither isintheaugmentingpath  andtherefore   isfeasible isindeedfeasible finally onlythe rstedgeintheaugmentingpathleaves whichimplies   isafeasible owwithlargervaluethan concludethatifthereisapathfrom intheresidualgraph amaximum ontheotherhand supposetheresidualgraph containadirected pathfrom bethesetofverticesthatarereachablefrom andlet thepartition isclearlyan foreveryvertex   wehave  thefeasibilityof implies   soinfactwe musthave   inotherwords saturateseveryedgefrom andavoidseveryedgefrom lemma   nowimpliesthat whichmeans isamaximum owand isaminimumcut thiscompletestheproof   maximumflows minimumcuts  fordandfulkerson saugmenting pathalgorithm fordandfulkerson sproofofthemax ocuttheoremimmediately gestsanalgorithmtocomputemaximum ows startingwiththezero repeatedlyaugmentthe owalong pathfrom intheresidualgraph untilthereisnosuchpath thisalgorithmhasanimportantbutstraightforwardcorollary integralitytheorem ifallcapacitiesina ownetworkareintegers thereisamaximum owsuchthatthe owthrougheveryedgeisaninteger proof wearguebyinductionthataftereachiterationoftheaugmentingpath algorithm owvaluesandallresidualcapacitiesareintegers beforethe rstiteration owvaluesare  whichisaninteger allresidualcapacitiesaretheoriginalcapacities whichareintegersby nition ineachlateriteration theinductionhypothesisimpliesthatthecapacity oftheaugmentingpathisaninteger soaugmentingchangesthe owon eachedge andthereforetheresidualcapacityofeachedge byaninteger inparticular eachiterationoftheaugmentingpathalgorithmincreasesthe valueofthe owbyapositiveinteger itfollowsthatthealgorithmeventually haltsandreturnsamaximum ifeveryedgecapacityisaninteger thenconservatively thefn algorithmhaltsafteratmost iterations istheactualmaximum ineachiteration wecanbuildtheresidualgraph andperforma whatevto ndanaugmentingpathin time inthis setting thealgorithmrunsin timeintheworstcase jackedmondsandrichardkarpobservedthatthisrunningtimeanalysis isessentiallytight considertheodenetworkinfigure   somelargeinteger themaximum owinthisnetworkisclearly  fnmightalternatebetweenpushingoneunitof owalongthe augmentingpath andthenpushingoneunitof owalongthe augmentingpath leadingtoarunningtimeof figure10  edmondsandkarp sbadexamplefortheford fulkersonalgorithm    fordandfulkerson saugmenting pathalgorithm fordandfulkerson salgorithmisusuallyfastinpractice anditisalwaysfast whenthemaximum owvalue issmall butwithoutfurtherconstraintson theaugmentingpaths thisis ane cientalgorithminworstcase edmonds andkarp sbadexamplenetworkcanbedescribedusingonly log bits therunningtimeoffnisactually exponential intheinputsize ª irrationalcapacities butwhatifthecapacitiesare integers ifwemultiplyallthecapacitiesby thesame positive constant themaximum owincreaseseverywherebythe sameconstantfactor itfollowsthatifalltheedgecapacitiesare rational thefnalgorithmeventuallyhalts althoughstillinexponentialtime inthenumberofbitsusedtodescribedtheinput ifweallow irrational capacities thealgorithmcanactuallyloop forever ndingsmallerandsmalleraugmentingpaths worseyet nitesequenceofaugmentationsmaynotevenconvergetothemaximum oreventoasigni cantfractionofthemaximum thesmallestnetwork thatexhibitsthisbadbehaviorwasdiscoveredbyurizwickin1993  considertheodenetworkshowninfigure   sixofthenineedges havesomelargeintegercapacity twohavecapacity  andonehascapacity    ˇ   chosensothat   toprovethatthe fnalgorithmcangetstuck wecanwatchtheresidualcapacitiesof thethreehorizontaledgesasthealgorithmprogresses theresidualcapacities oftheothersixedgeswillalwaysbeatleast  figure10  urizwick snon terminating owexample andthreeaugmentingpaths supposethefnalgorithmstartsbychoosingthecentrala mentingpath shownatthetopoffigure   thethreehorizontaledges  in1962 fordandfulkersondescribedamorecomplexnetwork with10verticesand48 edges withthesamebadbehavior   maximumflows minimumcuts orderfromlefttoright nowhaveresidualcapacities   suppose inductivelythatthehorizontalresidualcapacitiesare   forsome noegativeinteger  augmentalongpath adding tothe theresidualcapacitiesare    augmentalongpath adding tothe theresidualcapacitiesare    augmentalongpath adding  tothe theresidualcapacities arenow     augmentalongpath adding  tothe theresidualcapacities arenow    itfollowsbyinductionthatafter   augmentationsteps thehorizontaledges haveresidualcapacities      asthenumberofaugmentations growstoin nity thevalueofthe owconvergesto           eventhoughthemaximum owvalueisclearly    practicareadersmightwonderwhyanyoneshouldcareabout irrationalcapacities afterall computerscan trepresentanythingbut small integersor smalldyadic rationalsexactly goodquestion themathematician answeristhattherestrictiontointegercapacitiesisliterally arti cial san artifact ofdigitalcomputationalhardware orperhapstheotherwiseirrelevant lawsofphysics notaninherentfeatureoftheabstractcomputationalproblem butamorepracticalreasonisthatthebehaviorofthealgorithmwithirrational inputstellsussomethingaboutitswsebehavior inpractice pointcapacitile evenwithveryreasonablecapacities acareless implementationoffncouldenteranin niteloop simplybecause ofro error withoutevercomingclosetothecorrectanswer  combininganddecomposingflows flowsarenormallyde nedasfunctionsontheedgesofagraphsatisfyingcertain constraintsatthevertices owshaveasecondcharacterizationthat ismorenaturalandusefulincertaincontexts consideranarbitrarygraph withsourcevertex andtargetvertex anytwo ows andanytworealnumbers andconsider thefunction nedbysetting    combininganddecomposingflows foreveryedge wecanwritethisde nitionmoresimplyas straightforwardde nitiosingimpliesthat isalsoan owwithvalue moregenerally anylinearcombinationof owsisalso itturnsoutthatany owcanbewrittenasaweightedsumof ows withaspecialstructure foranydirectedpath wede nea path asfollows       straightforwardde nitiosingimpliesthatthefunction isindeed owwithvalue  iamdeliberatelyoverloadingthevariable tomean boththepath asequenceofverticesanddirectededges andtheunit alongthatpath foranydirectedcycle wede neacorresponding cycle setting       itiseasytoverifythat isan owwithvaluezero ourearlierargumentimpliesthatanylinearcombinationofpath owsand cycle owsisanother thisweightedsumiscalleda owdecomposition noegative owhasa owdecompositionwiththefollowing specialstructure flowdecompositiontheorem everynoegative canbe tenasapositivelinearcombinationofdirected anddirectedcycles adirectededge appearsinatleastoneofthesepathsorcycles ifandonlyif  andthetotalnumberofpathsandcyclesisatmost thenumberofedgesinthenetwork proof weprovethetheorembyinductiononthenumberofedgescarrying noero intuitivelybyrunningthefnalgorithmbackward aslongasatleastoneedgeinthegraphcarriespositive wecan ndeither oradirectedcyclethatcarries subtractingasmuch aspossiblefromthatpathorcycleemptiesatleastoneedge sotherecursion fairycangiveustherestofthedecomposition toformalizethisargument rstconsiderthespecialcaseof circulations theseare owswithvalue  owisconservedat vertex fixan   maximumflows minimumcuts figure10  decomposingacirculationintoweighteddirectedcycles arbitrarycirculation inanarbitrary ownetwork andlet denotethe numberofedges suchthat  weprovethat canbedecomposed intoapositivelinearcombinationofatmost max   cycles byinduction therearethreecasestoconsider  isvacuouslyalinearcombinationofzerocycles suppose  forasingledirectedcycleofedges  istriviallyalinearcombinationofonecycle pickanarbitraryedge  consideran trarywalk      suchthat   foreveryindex theconservationconstraintimpliesthateveryvertexwith incoming owalsohasoutgoing sowecanmakethiswalkarbitrarily long inparticular thewalkmusteventuallyvisitsomevertexmorethan bethesmallestindexsuchthat forsomeindex thesubwalk  isasimpledirectedcycle min  andconsiderthefunction  moreverbosely   straightforwardde nitiosingshowsthat  isanotherfeasible lationin thereisatleastoneedge  suchthat   whichimplies   sincefeweredgescarry owin  thanin therecursionfairycandecompose  intoatmost    cycles adding unitsof owaroundcycle givesusa owdecompositionfor moresuccinctly     combininganddecomposingflows nowlet beanarbitrary owinanarbitrary ownetwork suchthat  addanedge tothenetwork andde neacirculation  bysetting   foreveryoriginaledge observethat    thepreviousargumentimpliesthatthecirculation  isa positivelinearcombinationofatmost   directedcycles deletingtheedge givesusadecompositionoftheoriginal intoatmost   pathsandcycles speci cally cyclesin  thatinclude andcyclesin  thatdonotinclude remaincyclesin theproofoftheflowdecompositiontheoremimpliesstrongerresultsin twointerestingspecialcases anycirculationcanbedecomposedintoaweightedsumofcycles nopaths arenecessary acyclic owcanbedecomposedintoaweightedsumof nocyclesarenecessary bycanceling owcyclesuntilnomoreremain wecantransformany owintoanacyclic owwiththesamevalue inparticular ownetwork supportsamaximum owthatisacyclic theproofalsoimmediatelytranslatesdirectlyintoanalgorithm tofn todecomposeany owintopathsandcycles algorithmrepeatedlyseekseitheradirected oradirectedcycleinthe remaining andthensubtractsasmuch owaspossiblealongthatpathor cycle untilthe owisempty wecan nda owpathorcyclein timeas ifanyedgeleaving haspositive followanarbitrarywalkfrom inthe owgraphuntiliteitherreaches givingusa owpath orreachessome vertexforthesecondtime givingusa owcycle ifnoedgeleaving haspositive ndanyothervertex withpositive andfollowanarbitrarywalkfrom inthe owgraphuntilitreaches somevertexforthesecondtime givingusa owcycle inbothcases theconservationconstraintimpliesthatthisalgorithmwillnever getstuck eachiterationtakes timeandremovesatleastoneedgefrom owgraph theentiredecompositionalgorithmrunsin time flowdecompositionsprovideanaturallowerboundontherunningtimeof anymaximowalgorithmthatbuildsthe owonepathorcycleatatime owcanbedecomposedintoatmost pathsandcycles eachofwhichuses atmost edges sotheoverallcomplexityofthe owdecompositionis itiseasytoconstruct owsforwhich owdecomposition hascomplexity anymaximowalgorithmthatexplicitly constructsa owonepathorcycleataparticular anyimplementation   maximumflows minimumcuts offordandfulkerson saugmentingpathausttake timein theworstcase  edmondsandkarp salgorithms fordandfulkerson salgorithmdoesnotspecifywhichpathintheresidual graphtoaugment thepoorwsebehaviorofthealgorithmcanbeblamed onpoorchoicesfortheaugmentingpath intheearly1970s jackedmondsand richardkarppublishedtwonaturalrulesforchoosingaugmentingpaths ofwhichledtomoree cientalgorithms fattestaugmentingpaths edmondsandkarp rstruleisessentiallyagreedyalgorithm choosetheaugmentingpathwithlargestbottleneckvalue snothardtoshowthatthemaximeneck inadirectedgraph canbecomputedin log timeusingatraversal similarto jarník sminimalgorithmordijkstra ssalgorithm thealgorithmgrowsadirectedtree rootedat onevertexatatime repeatedlyaddingthepacityedgeleaving apathfrom alternately onecouldemulatekruskal edgesoneatatimeindecreasingcapacityorderuntilthereisapathfrom lthoughthisapproachislesse cient atleastwhenthegraphisdirected tocompletetheanalysisofthe owalgorithm weneedan upperboundonthenumberofiterationsbeforethealgorithmhalts infact forarbitraryrealcapacities thealgorithmmay halt seeexercise  integercapacities wecanboundthenumberofiterationsasafunction ofthemaximum owvalue asfollows beany owin andlet  bethemaximum inthecurrent residualgraph atthebeginningofthealgorithm  wehavealreadyprovedthat  canbedecomposedintoatmost pathsand cycles asimpleaveragingargumentimpliesthatatleastoneofthepathsinthis decompositionmustcarryatleast  unitsof itfollowsimmediately thatthe fattest carriesatleast  unitsof augmenting alongthemaximeneckpathin multiplies thevalueoftheremainingmaximum owin byafactorofatmost   inotherwords theresidualmaximum owvalue decaysexponentially withthe numberofiterations iterations themaximum owvaluein isatmost       edmondsandkarp salgorithms seuler sconstant nottheedge inparticular iterations theresidualmaximum owvalueislessthan  ifallcapacitiesare integers theresidualmaximum owvalueisalsoaninteger soitmustbe  otherwords isamaximum weconcludethatforgraphswithintegercapacities theedmo attestalgorithmrunsin  log log time unlikethewse runningtimeofrawfn thistimeboundisactuallyapolynomial functionoftheinputsize justliketheoriginalfnalgorithm fattestpath algorithm cangetstuckinanin niteloopinnetworkswitharbitraryrealcapacities ouranalysisimpliesthatevenifthealgorithmneverhalts itmaintains thatapproachesamaximum owinthelimit shortestaugmentingpaths thesecondedmorulewasactuallyproposedasapracticalheuristic byfordandfulkersonintheiroriginalmaximowpaper avariantofthis rulewasindependentlyproposedin1970bytherussianmathematicianye dinitz  choosetheaugmentingpathwiththesmallestnumberofedges theshortestaugmentingpathcanbefoundin timebyrunning searchintheresidualgraph surprisingly theresultingalgorithmhaltsaftera polynomialnumberofiterations independentoftheactualedgecapacities theproofofthispolynomialupperboundreliesontwoobservations abouttheevolutionoftheresidualgraph bethecurrent owafter augmentationsteps bethecorrespondingresidualgraph inparticular  iszeroeverywhereand  foreachvertex level denotethe unweightedsdistancefrom orequivalently level inasearchtreeof rootedat inparticular ifthereisno pathfrom level  min  rstobservationisthatthelevelofavertexcanonlyincreaseovertime lemma10  level level  forallvertices andallintegers  proof fixanarbitrarypositiveinteger  andanarbitraryvertex provetheclaimbyinductionon level ontheinteger asan inductivehypothesis assumeforeveryvertex suchthat level level level level  therearethreecasestoconsider  speci cally dinitzdiscoveredamorecomplexmaximowalgorithm whilehewas astudentinanalgorithmsclasstaughtbygeorgyadelsovelsky theavinavltrees responsetoanassexercise dinitz salgorithmalsopushes owsalongshortestpaths withadditionalbookkeepingtoreducetherunningtimefrom     maximumflows minimumcuts weimmediatelyhave level level   ifthereisnopathfrom level  level  beanyunweightedshortestpathfrom thegraph becausethisisashortestpath wehave level level  sotheinductivehypothesisimplies level level  tocompletethe proof weneedtoshowthat level  level   wehavetwo subcasestoconsider isanedgein  level  level   becausethe levelsarede nedbytraversal ontheotherhand isnotanedgein  thenitsreversal mustbeanedgeinthe thaugmentingpath whichbyde nition istheshortestpathfrom  itfollowsthat level  level   level   inbothsubcases weconcludethat level level  level   level  wheneverweaugmentthe thebottleneckedgeintheaugmenting pathdisappearsfromtheresidualgraph andsomeedgesinthe reversal ofthe augmentingpathmayppear oursecondobservationisthatanedge cannotappearordisappeartoomanytimes lemma10  duringtheexecutionoftheedmons pathalgorithm eachedge disappearsfromtheresidualgraph atmost  times proof suppose isintworesidualgraphs  butnotinanyof theintermediateresidualgraphs  forsome beinthe thaugmentingpath level level  mustbe onthe thaugmentingpath level level  thepreviouslemma impliesthat level level  level  level  inotherwords betweenthedisappearanceandreappearanceof distancefrom increasedbyatleast  becauseeveryleveliseitherless orin nite thenumberofdisappearancesisatmost  nowwecanderiveanupperboundonthenumberofiterations becauseeach edgedisappearsatmost  times thereareatmost  edgedisappearances butatleastoneedgedisappearsoneachiteration sothealgorithm musthaltafteratmost  iterations finally eachiterationrequires time sotheoverallalgorithmrunsin  time    furtherprogress  furtherprogress thisisnowhereneartheendofthestoryformaximowalgorithms decades offurtherresearchhaveledtoseveralfasteralgorithms someofwhichare summarizedinfigure    allthelistedalgorithmslistedcomputea maximum owinseveraliterations mostofthesealgorithmshavetwovariants asimplerversionthatperformseachiterationbybruteforce andafaster variantthatusessophisticateddatastructurestomaintainaspanningtreeof ownetwork sothateachiterationcanbeperformed andthespanning treeupdated inlogarithmictime thereisnoreasontobelievethatthebest algorithmsknownsofarareoptimal maximum owsarestillavery activeareaofresearch techniquedirectwithdynamictreessource blocking  log dinitz karzanov evenanditai sleatorandtarjan networksimplex  log dantzig goldfarbandhao goldberg grigoriadis andtarjan push relabel generic  goldbergandtarjan push relabel fifo  log  goldbergandtarjan push relabel highestlabel  cheriyanandmaheshwari tunçel push relabel addgames log log cheriyanandhagerup king rao andtarjan pseudo  log hochbaum pseudo highestlabel  log  hochbaumandorlin incrementalbfs  log  goldberg held kaplan tarjan andwerneck compactnetworks orlin figure10  severalpurelycombinatorialmaximum owalgorithmsandtheirrunningtimes thefastestknown purelycombinatorial maximowalgorithm nouncedbyjamesorlinin2012 runsin time exactlymatchingthe wsecomplexityofa owdecomposition thedetailsoforlin salgorithm arefarbeyondthescopeofthisbook inadditiontohisownnewtechniques orlinusesseveralolderalgorithmsanddatastructuresasblackboxes mostof whicharethemselvesquitecomplicated inparticular orlin salgorithmdoes constructanexplicit owdecomposition infact forgraphswithonly edges anextensionofhisalgorithmactuallyrunsinonly  log time forpurposesofanalyzingalgorithmsthat maximum ows  tokeepthistableshort ihavedeliberatelyomittedalgorithmswhoserunningtimedepends onedgecapacitiesorthemaximum owvalue evenwiththisrestriction thelistisembarrassingly incomplete   maximumflows minimumcuts thisisthetimeboundyoushouldcite sowritethefollowingsentenceonyour cheatsheetsandciteitinyourhomeworks maximum owscanbecomputedin time finally fastermaximowalgorithmsareknownfor pacity works whereeveryedgehascapacity  in1973 alexanderkarzanovproved thatdinitz sblowa rstalgorithmlistedinthetable abovin min     timeinthissetting thistimebound appearstobreakthe owdecompositionbarrier butinfactkarzanov analysisimpliesthatany owinapacitynetworkcanbedecomposed intopathswithtotalcomplexity min     thiswasthefastest algorithmknowninthissettingforfourdecades karzanov srecordwas nally brokenin2013 whenaleksanderm dryannouncedatrulyremarkablealgorithm thatcomputesmaximum owsinpacitynetworksin   polylog time thedetailsofm dry salgorithmarefarbeyondthescopeofthis book orindeedtheexpertiseofitsauthor exercises  supposeyouaregivenadirectedgraph twovertices acapacityfunction andasecondfunction analgorithmtodeterminewhether isamaximum owin   betwofeasible owsina ownetwork suchthat  provethatthereisafeasible owwithvalue  inthe residualnetwork  beanarbitraryedgeinanarbitrary ownetwork provethatif thereisaminimum suchthat   thenthereis minimumcut   suchthat        beminimum insome ownetwork prove     arealsominimum  bea ownetworkthatcontainsanopposingpairofedges bothwithpositivecapacity  bethe ownetworkobtainedfrom bydecreasingthecapacitiesofbothoftheseedgesby min inotherwords changethecapacityof anddelete  exercises changethecapacityof anddelete finally deleteboth figure10  enforcingtheone directionassumption provethateverymaximum owin  isalsoamaximum bysimplifying opposingpairofedgesin weobtain anewreduced ownetworkwiththesamemaximum owvalueas provethateveryminimum isalsoaminimum  andviceversa provethatthereisatleastonemaximum owin thatis maximum owin   describeane cientalgorithmtodeterminewhetheragiven networkcontainsa unique maximum describeane cientalgorithmtodeterminewhetheragiven networkcontainsa unique minimum describea ownetworkthatcontainsauniquemaximum owbut doesnotcontainauniqueminimum describea ownetworkthatcontainsauniqueminimum doesnotcontainauniquemaximum  owinanetwork acyclic iftherearenodirectedcycleswhere everyedgehasapositive owvalue thatis thesubgraphofedgeswith positive owvalueisadag describeandanalyzeanalgorithmtocomputean acyclic maximum owinagiven ownetwork youralgorithmshouldhavethesame asymptoticrunningtimeasfn describeandanalyzeanalgorithmtodeterminewhether maximum owinagiven ownetworkisacyclic  bea ownetworkinwhicheveryedgehascapacity  thesdistancefrom isatleast   maximumflows minimumcuts provethatthevalueofthemaximum owisatmost nowsupposethat simple meaningthatforallvertices isatmostoneedgefrom flownetworkscanhaveparalleledges provethatthevalueofthemaximum owisatmost   hint howmanynodesareintheaveragelevelofabfstreerooted  supposewearegivena ownetwork inwhicheveryedgehas capacity  togetherwithaninteger describeandanalyzeanalgorithm toidentify edgesin suchthatafterdeletingthose edges thevalueof themaximum owintheremaininggraphisassmallaspossible  theanalysisinourproofofthe flowdecompositiontheorem canbe tightened beanarbitrary ownetwork andlet bean arbitrary owin provethatif  istheweightedsumofatmost  directedcycles  foreveryedge ineachofthesecycles provethatif  istheweightedsumofatmost  directedpathsanddirectedcycles  foreveryedge eachofthesepathsandcycles provethatbothofthepreviousupperboundsaretight therearegraphs inwhichsomecirculationscannotbedecomposedintolessthan  cycles andsome owscannotbedecomposedintolessthan  pathsandcycles hint thisiseasy  ourobservationthatanylinearcombinationof owsisitselfan owimpliesthatthesetofall notnecessarilyfeasible owsinany graphactuallyde neareal vectorspace whichwecancallthe owspace thegraph provethatthe owspaceofanyconnectedgraph sion  beanyspanningtreeof provethatthefollowingcollectionof pathsandcyclesde neabasisforthe owspace theuniquepathin theuniquecyclein foreveryedge  beanyspanningtreeof andlet betheforestobtainedby deletinganysingleedgein provethatthefollowingcollectionof pathsandcyclesde neabasisforthe owspace theuniquepathin foreveryedge  thathas oneendpointineachcomponentof  exercises theuniquecyclein foreveryedge  withbothendpoints inthesamecomponentof proveordisprovethefollowingclaim everyconnected ownetwork hasa owbasisthatconsistsentirelyofsimplepathsfrom  cutsaresometimesde nedassubsetsoftheedgesofthegraph insteadof aspartitionsofitsvertices inthisproblem youwillprovethatthesetwo nitionsare equivalent wesaythatasubset directed edges separates ifevery directedpathfrom containsatleastone directed edgein forany subset vertices denotethesetofdirectededgesleaving thatis   provethatif isan separates beanarbitrarysubsetofedgesthatseparates provethat thereisan suchthat bea minimal subsetofedgesthatseparates suchaset ofedgesissometimescalleda bond provethatthereisan suchthat  supposeinsteadofcapacities weconsidernetworkswhereeachedge hasanoegative demand nowan feasible ifand onlyif foreveryedge feasible owvaluescannow bearbitrarilylarge anaturalprobleminthissettingisto ndafeasible owof minimum describeane cientalgorithmtocomputeafeasible thegraph thedemandfunction andthevertices asinput hint finda owthatisnoeroeverywhere andthenscaleituptomakeit feasible supposeyouhaveaccesstoasubroutine maxflow thatcomputes maximum owsinnetworkswithedgecapacities describeane cient algorithmtocomputea minimum owinagivennetworkwithedge demands youralgorithmshouldcall maxflow exactlyonce stateandproveananalogueoftheowtheoremforthis setting dominimum owscorrespondtomaximumcuts  forany ownetwork andanyvertices bottleneck denote themaximum overallpaths ˇ oftheminimpacity edgealong ˇ   maximumflows minimumcuts describeandanalyzeanalgorithmtocompute bottleneck log time thisistheamountof owthattheedmo falgorithmpushesinthe rstiteration nowsupposethe ownetwork isundirected equivalently suppose foreverypairofvertices describeandanalyze analgorithmtocompute bottleneck time hint themedianedgecapacity whydoesn tthisspeedupworkfordirected graphs ª supposethe ownetwork isundirected describeand alyzeanalgorithmtoconstructaspanningtree suchthat bottleneck bottleneck vertices edgesin inherittheircapacitiesfrom forfullcredit youralgorithmshould runin time  supposeyouaregivena ownetwork integer edgecapacitiesand integer maximum describealgorithmsforthefollowing operations increment increasethecapacityofedge  andupdatethe maximum decrement decreasethecapacityofedge  andupdatethe maximum bothalgorithmsshouldmodify sothatitisstillamaximum quicklythanrecomputingamaximum owfromscratch  beanetworkwithintegeredgecapacities anedgein upper binding ifincreasingitscapacityby  alsoincreasesthevalueofthemaximum owin anedgeis lower ifdecreasingitscapacityby  alsodecreasesthevalueofthemaximum owin doeseverynetwork haveatleastoneedge proveyour answeriscorrect doeseverynetwork haveatleastonelowedge proveyour answeriscorrect describeanalgorithmto ndalledgesin givenboth andamaximum owin asinput time describeanalgorithmto ndalllowedgesin givenboth andamaximum owin asinput time  agiven ownetwork mayhavemorethanoneminimum nethe minimum tobeanyminimumcut withthe smallestnumberofedgescrossingfrom  exercises describeane cientalgorithmto ndthebestminimum thecapacitiesareintegers describeane cientalgorithmto ndthebestminimum arbitrary edgecapacities describeane cientalgorithmtodeterminewhetheragiven networkcontainsaunique minimum  anewassistantprofessor teachingmaximum owsforthe rsttime suggests thefollowinggreedymodi cationtothegenericfnaugmenting pathalgorithm insteadofmaintainingaresidualgraph  reducethe capacityofedgesalongtheaugmentingpath inparticular wheneverwe saturateanedge justremoveitfromthegraph whoneedsallthatresidual graphnonsense greedyflow foreveryedge  whilethereisapathfrom ˇ anarbitrarypathfrom minimumcapacityofanyedgein ˇ foreveryedge ˇ remove return showthat greedyflow doesnotalwayscomputeamaximum showthat greedyflow isnotevenguaranteedtocomputeagood approximationtothemaximum thatis foranyconstant  thereisa ownetwork suchthatthevalueofthemaximum owis morethan timesthevalueofthe owcomputedby greedyflow hint assumethat greedyflow choosestheworstpossiblepath ˇ eachiteration  in1980mauricequeyrannepublishedanexampleofa ownetwork whereedmondsandkarp sattestheuristicdoesnothalt inzwick sbadexamplefortheoriginalfnalgorithm denotes theinversegoldenratio    thethreeverticaledgesplayessentially thesameroleasthehorizontaledgesinzwick sexample  theadverb isalmostalwayssubconsciousshorthandfortoolazyto gureoutthe details butyoushouldbelievemeanywaormoresuccinctly isprobablywrosee simply   maximumflows minimumcuts figure10  queyranne snetwork andasequenceofpathaugmentations showthatthefollowingin nitesequenceofpathaugmentationsisa validexecutionoftheedmoattestalgorithm seethe bottomoffigure   queyrannefatpaths   push   unitsof owalong push   unitsof owalong push  unitsof owalong describeasequenceof  pathaugmentationsthatyieldsamaximum owinqueyranne snetwork ª  llel graphisadirectedacyclicgraphwithtwo guishedvertices andwithoneofthefollowingstructures basecase asingledirectededgefrom series theunionofan llelgraphanda parallelgraphthatshareacommonvertex butnootherverticesor edges parallel theunionoftwosmaller llelgraphswith thesamesource andtarget butwithnootherverticesoredgesin common llelgraph canberepresentedbya decomposition tree whichisabinarytreewiththreetypesofnodes leaves correspondingtoedgesin seriesnodes whichcorrespondtovertices otherthan andparallelnodes thesameserillelgraph couldberepresentedbymanydi erentdecompositiontrees supposeyouaregivenadirectedgraph withtwospecialvertices describeandanalyzeanalgorithmthateitherbuildsadecomposition treefor orcorrectlyreportsthat isnot llel hint buildthetreefromthebottomup  exercises figure10  aseries parallelgraphandacorrespondingdecompositiontree squaresinthedecom positiontreeareleaves diamondsareparallelnodes describeandanalyzeanalgorithmtocomputeamaximum owin agiven llel ownetworkwitharbitraryedgecapacities hint inlightofpart youcanassumethatyouareactuallygiven thedecompositiontree firstcomputethemaximowvalue computeanactualmaximum  wecanspeeduptheedmoattestalgorithm atleastfor networkswithsmallintegercapacities byrelaxingourrequirementsfor thenextaugmentingpath insteadof ndingtheaugmentingpathwith maximumbottleneckcapacity ndapathwhosebottleneckcapacityis atleasthalfofmaximum usingthefollowing capacityscaling algorithm thisalgorithmwasactuallyproposedbyedmondsandkarp assumealltheedgecapacitiesarepositiveintegerslessthan  someinteger thescalingalgorithmmaintainsabottleneckthreshold initially weset ineach phase thealgorithmaugmentsalongpaths inwhicheveryedgehasresidualcapacityatleast whenthere isnosuchpath thephaseends weset  andthenextphase thealgorithmendswhen  howmanyphaseswillthisalgorithmexecuteintheworstcase bethe owattheendofaphaseforaparticularvalueof prove thatthecapacityofaminimumcutintheresidualgraph isatmost provethatineachphaseofthescalingalgorithm thereareatmost  augmentations whatistheoverallrunningtimeofthecapacityscalingalgorithm  foralongtimeitpuzzledmehowsomethingsoexpensive soleadingedge couldbeso useless andthenitoccurredtomethatacomputerisastupidmachinewiththeability todoincrediblysmartthings whilecomputerprogrammersaresmartpeoplewiththe abilitytodoincrediblystupidthings theyare inshort aperfectmatch billbryson notesfromabigcountry  shortlyaftertheoncurtainfellin1990 anamericanandarussian whohadboth workedonthedevelopmentofweapons met theamericanasked developedthebomb howwereyouabletoperformsuchanenormousamountof computingwithyourweaktherussianresponded eusedbetter algorithms ye mdinitz inalgorithm theoriginalversion andeven sversion  soi mthebadguynowihear becauseidon tgowiththe tevergowiththe bethe jay streamofconsciousness may16   applicationsofflowsandcuts  edge disjointpaths oneoftheeasiestapplicationsofmaximum owsiscomputingthemaximum numberofintpathsbetweentwospeci edvertices ina directedgraph usingmaximum ows asetofpathsin int eachedgein appearsinatmostoneofthepaths severalintpaths maypassthroughthesamevertex ifwegiveeachedgecapacity  thenthemaximum owfrom pushes   unitsof owalongeachedge ompositiontheorem impliesthatthesubgraph ofsaturatededgesistheunionofseveral disjointpathsandcycles thenumberofpathsinthisdecomposition isexactlyequaltothevalueofthe extractingtheactualpathsfrom straightforwollowanydirectedpathin removethatpath andrecurse conversely wecantransformanycollectionof intpathsintoa   applicationsofflowsandcuts owbypushingoneunitof owalongeachpathfrom thevalueofthe owisexactly itfollowsthatanymaximum owalgorithmactually computesthelargestpossiblesetofintpaths ifweuseorlin salgorithmtocomputemaximum ows wecancompute intpathsin time butorlin salgorithmisoverkillforthis simpleapplication thecut nf hascapacityatmost  sothe maximum owhasvalueatmost  fordandfulkerson soriginal augmentingpathalgorithmalreadyrunsin time thesamealgorithmcanalsobeusedto ndintpathsin undirected graphs replaceeveryundirectededge uv withapairofdirected edges eachwithunitcapacity andcalltheresultingdirected graph  computeamaximum  usingfn foranyedge uv saturatesbothdirectededges  wecanremove edgesfromthe owwithoutchangingitsvalue generally wecan ndan acyclic maximum owin  bycancelingallcycles notonlycyclesoflength  withoutlossofgenerality assignsa uniquedirectiontoeachsaturatededge finally wecanextracttheint pathsbysearchingthesubgraphofdirectededgessaturatedby  vertexcapacitiesandvertex disjointpaths nowsupposetheverticesoftheinputgraph havecapacities notjustthe edges inadditiontoourotherconstraints foreachvertex otherthan werequirethetotal owinto andthereforethetotal owoutof tobeat mostsomenoegativevalue canwestillcomputemaximum owswiththesenewvertexconstraints in1962 fordandfulkersonproposedthefollowingreductiontoa network withonlyedgecapacities replaceeveryvertex withtwovertices connectedbyanedge withcapacity andthenreplace everydirectededge withtheedge keepingthesamecapacity routinede nitiosingimpliesthateveryfeasible owin equivalenttoafeasible owwiththesamevalueintheoriginalgraph andviceversa inparticular everymaximum owin isequivalenttoa maximum owin thereductionfrom takes time afterwhich wecancomputethemaximum owin usingorlin salgorithm altogether computingthemaximum owin requires time itisnoweasytocomputethemaximumnumberof vertex intpaths time assigncapacity  toeveryvertexandcomputea maximum    bipartitematching figure11  reducingvertex disjointpathsin toedge disjointpathsin  bipartitematching anothernaturalapplicationofmaximum owsis ndingmaximum matchings inbipartitegraphs amatchingisasubgraphinwhicheveryvertexhasdegree atmostone orequivalently acollectionofedgessuchthatnotwosharea vertex theproblemisto ndamatchingwiththemaximumnumberofedges forexample supposewehaveasetofdoctorswhoarelookingforjobs asetofhospitalswhoarelookingfordoctors eachdoctorlistsallhospitals wheretheyarewillingtowork andeachhospitallistsalldoctorstheyare willingtohire ourtaskisto ndthelargestsubsetofdoctspitalhiresthat everyoneiswillingtoaccept  thisproblemisequivalentto ndingamaximum matchinginabipartitegraphwhoseverticesarethedoctorsandhospitals thereisanedgebetweenadoctorandahospitalifandonlyifeach ndthe otheracceptable wecansolvethisproblembyreducingittoamaximum owproblem bethegivenbipartitegraphwithvertexset suchthatevery edgejoinsavertexin toavertexin wecreateanew directed graph   orientingeachedgefrom  addinganewsourcevertex edgestoeveryvertexin  addinganewtargetvertex withedges fromeveryvertexin finally weassigneveryedgein  acapacityof  anymatching canbetransformedintoa  asfollows foreachedge uw pushoneunitof owalongthepath pathsaredisjointexceptat sotheresulting owsatis esthecapacity constraints thevalueoftheresulting owisequaltothenumberof edgesin conversely considerany  computedusingthef fulkersonaugmentingpathalgorithm becausetheedgecapacitiesareintegers thefnalgorithmassignsaninteger owtoeveryedge thisiseasy toverifybyinduction hint hint sinceeachedgehas unit capacity thecomputed oweithersaturates  oravoids  everyedge  thisproblemisverydi erentfromthestablematchingproblemwesawinchapter  becausewearen ttryingtomakeeachdoctorandhospitalashappyaspossible   applicationsofflowsandcuts  finally sinceatmostoneunitof owcanenteranyvertexin orleave anyvertexin thesaturatededgesfrom formamatchingin sizeofthismatchingisexactly thesizeofthemaximummatchingin isequaltothevalueofthe maximum owin  andprovidedwecomputethemax owusingaugmenting paths wecanconverttheactualmax owintoamaximummatchingin time wecancomputethemaximum owin time usingeitherorlin algorithmoro helffn figure11  amaximummatchinginabipartitegraph andthecorrespondingmaximum owin  itisenlighteningtointerpretthebehavioroffnin  interms oftheoriginalbipartitegraph thealgorithmmaintainsamatching whichisinitiallyempty theedgesof correspondtoedgesin  thatcarry callavertexof matched ifisanendpointofsomeedgein unmatched ineachiterationofthealgorithm welookforan alternatingpath pathfromanunmatchedvertexof toanunmatchedvertexin alternatesbetweenedgesin andedgesnotin alternatingpathsin correspondexactlytoaugmentingpathsforthecurrent owin  ifwe anaugmentingpath weupdate tothesymmetricdi erence increasesthenumberofedgesin  andcontinuetothenextiteration ifthereisnoalternatingpath themax ocuttheoremimpliesthat isamaximummatching sothealgorithmends findingasinglealternating pathrequires time andthealgorithmhaltsafteratmost iterations theoverallalgorithmrunsin time figure   showsthisalgorithmin action thischaracterizationofmaximumbipartitematchingsintermsofalternating pathswasprovedbyclaudebergein1957 independentlyofthemax ocut theorem althoughitwasalreadyimplicitinalgorithmsdescribedbyharald kuhnin1955 bydénesk nigin1916 andbycarljacobiaround1836 amoresophisticatedalgorithm proposedbyjohnhopcroftandrichard karpin1973 computesmaximummatchingsinbipartitegraphsinonly time ndingseveraldisjointalternatingpathsineachiteration    tupleselection figure11  anincreasingsequenceofmatchingsconnectedbyalternatingpaths  tupleselection thebipartitemaximummatchingproblemisthesimplestexampleofabroader classofproblemsthaticall tupleselection  theinputtoatupleselection problemconsistsofseveral nitesets   eachrepresentingadi erent discreteresource ourtaskistoselectthelargestpossiblesetof containingexactlyoneelementfromeachset subjecttoseveral capacity constraintsofthefollowingform foreachindex eachelement  canappearinatmost selected tuples foreachindex anytwoelements    canappearinat selectedtuples eachoftheupperbounds iseithera typicallysmall negativeintegeror  inthemaximproblem wehave  resources eachel ment hascapacity  andeachpair hascapacity   dependingonwhetherornot xy isanedgeintheunderlying bipartitegraph  icouldn ndastandardnamefortheseproblems soimadeupmyown theseare sometimescalledssignmentproblbutit smorecommonforthephraseassignment probltorefertotheproblemof ndingamaxim weight bipartitematchinginan weightedbipartitegraph   applicationsofflowsandcuts becausetheresourcesarelinearlyordered andonlypairsofobjectsin adjacent subsets  areconstrained  thetupleselectionproblemcan bereducedtoamaximowprobleminadirectedgraph nedasfollows containsavertexforeachelementofeachset aswellasasource vertex andatargetvertex eachvertex hascapacity containsanedge foreachelement   anedge foreach element  andanedge withcapacity foreachpairof elements    forall optionally wecanomitedges  everypathfrom correspondsto ora ethatwe select conversely everyselectable ethatsatis esthestatedconstraints correspondsto orapathfrom figure11  ownetworkforatupleselectionproblem moregenerally beanarbitraryfeasibleinteger owin allcapacitiesareintegersor  theflowdecompositiontheoremimplies isthesumof pathsfrom eachcarryingexactlyoneunitof straightforwardde nitiosingimpliesthattheresultingsetoftuples satis esallthecapacityconstraints conversely foranysetof tuplesthat satis esthecapacityconstraints thesumofthe correspondingpathsisa feasibleinteger owwithvalue wecanselectthemaximumnumberoftuplesthatsatisfythegiven capacityconstraintsbycomputingamaximum andthen computinga owdecompositionof becauseall nitecapacitiesin integers wecanassumewithoutlossofgeneralitythat isaninteger bythepreviousparagraph correspondstoavalidsetof tuples examscheduling thefollowinglwschedulingproblemmighthelpclarifyourgeneral reduction  ifpairsofobjectsfromevenonenopairofsubsets  arealsoconstrained theproblembecomesnpbyastraightforwardreductionfrom exa dimensionalmatching lldiscussnpessinthenextchapter    tupleselection soobananauniversityhashiredyoutowriteanalgorithmtoschedule nalexams thereare erentclasses eachofwhichneedstoschedule nalexaminoneof roomsduringoneof erenttimeslots atmostone class nalexamcanbescheduledineachroomduringeachtimeslot conversely classescannotbesplitintomultipleroomsormultipletimes exammustbeoverseenbyoneof proctors  eachproctorcanoverseeatmost oneexamatatime eachproctorisavailableforonlycertaintimeslots andno proctorisallowedoverseemorethan  examstotal theinputtothescheduling problemconsistsofthreearrays anintegerarray  isthenumberofstudentsenrolledin thclass anintegerarray  isthenumberofseatsinthe room thclass nalexam beheldinthe throomifandonlyif abooleanarray   true ifandonlyifthe proctorisavailableduringthe thtimeslot  denotethetotalsizeoftheinput yourjobistodesignan algorithmthateitherschedulesaroom atimeslot andaproctorforevery class nalexam orcorrectlyreportsthatnosuchscheduleispossible thisisastandardtuplectionproblemwithfourresources classes rooms timeslots andproctors tosolvethisproblem weconstructa network withsixtypesofvertisourcevertex  avertex foreachclass avertex foreachroom avertex foreachtimeslot avertex foreach proctor andatargetvertex  vetypesofedges asshowninfigure   figure11  ownetworkfortheexamschedulingproblem anedge  withcapacity  foreachclass achclasscanholdatmost nal  orastheyarebetterknownoutsidetheus invigilators  arguably thisinformationisbetterrepresentedasagraph butithoughtthatwouldmake thereductionmoreconfusing   applicationsofflowsandcuts anedge withcapacity  foreachclass androom suchthat ass canholdexamsinroom ifandonlyiftheroomhas enoughthisistheonlyplacewheretheenrollments andseat numbers areused anedge withcapacity  foreachroom andtimeslot atmost oneexamcanbeheldinroom attime anedge withcapacity  fortimeslot andproctor suchthat true aproctorcanoverseeatmostoneexamatanytime onlyduringtimesthattheyareavailabl anedge  withcapacity  foreachproctor achproctorcanoversee atmost  mcallingthesourceandtargetvertices   insteadof becausetheproblemstatementalreadyusesthevariable todenotethe numberoftimeslots altogether  verticesand  edges eachpathfrom   representsauniquevalidchoiceofclass room time andproctorforone nalexam speci cally theclass tsintotheroom andtheproctorisavailableatthattime conversely foreachvalidchoice class room time proctor thereisacorrespondingpathfrom   wecanconstructavalidscheduleforthemaximumpossiblenumberofexams bycomputinganmaximum   decomposing intopaths   andthentranscribingeachpathintoaclaor assignment wecanreturntheresultingschedule cancorrectlyreportthatschedulingall nalexamsisimpossible constructing fromthegiveninputdatabybruteforcetakes time wecancomputethemaximum owin timeusingeitherfn ororlin salgorithm andwecancomputethe decompositionin time theoverallalgorithmrunsin  time  disjoint pathcovers pathcover ofadirectedgraph isacollectionofdirectedpathsin suchthat everyvertexof lieson atleast onepath disjo pathcoverof isapath coversuchthateveryvertexof lieson onepath everydirectedgraph hasatrivialdisjocoverconsistingofseveralpathsoflengthzero sboring slookfordisjocoversthatcontainasfewpaths aspossible thisproblemisnpingeneragraphhasadisjo coverofsize  ifandonlyifitcontainsahamiltonianutthereisan cient osedalgorithmfordirected acyclic graphs    disjoint pathcovers tosolvethisproblemforagivendirectedacyclicgraph constructanewbipartitegraph    asfollows containstwovertices foreveryvertex containsanundirectededge foreverydirectededge isrepresentedasanadjacencymatrix  isthebipartitegraph representedbythesameadjacencymatrix figure11  reducingminimumdisjoint pathcoverofadagtomaximumbipartitematching squares anddiamondsaresharp nowiclaimthat canbecoveredby disjointpathsifandonlyifthenew graph  hasamatchingofsize asusual weprovetheequivalencein twostages suppose hasadisjointpathcover paths thinkof asasubgraph everyvertexin haseither   thereisexactly onevertexwith  ineachpathin itfollowsthat hasexactly edges nowde neasubset oftheedgesof  asfollows    byde nitionofdisjocover everyvertexof hasatmostone incomingedgein andatmostoneoutgoingedgein weconcludethat everyvertexof  isincidenttoatmostoneedgein thatis isa matchingofsize suppose  hasamatching ofsize weproject  backto ningasubgraph     byde nitionofmatching everyvertexof hasatmostoneincomingedge andatmostoneoutgoingedgein itfollowsthat isacollection ofdisjointdirectedpathsin includeseveryvertex nesan disjointpathcoverwith edges thenumberofpathsin isequalto thenumberofverticesin thathavenoincomingedgein  weconclude containsexactly paths   applicationsofflowsandcuts itfollowsimmediatelythatwecan ndaminimumdisjocoverin computingamaximummatchingin  usingfn smaximow algorithm   time despiteitsformulationintermsofdagsandpaths thisisreallyamaximum matchingproblem wewantto match asmanyverticesaspossibletodistinct successors inthegraph thenumberofpathsrequiredtocoverthedagisequal tothenumberofverticeswithnosuccessor andofcourse everybipartite maximummatchingproblemisreallya owproblem minimalfacultyhiring sgobacktosoobananauniversityforanotherscheduling problem  spuo ersseveralthousandcourseseveryday duetoextremebudget cuts theuniversityneedstosigni cantlyreducethesizeofitsfaculty becausestudentspaytuition andtheuniversitycannota ordlawyers universitymustretainenoughprofessorstoguaranteethateveryclassadvertised inthecoursecatalogisactuallytaught howfewprofessorscanspugetaway eachremainingfacultymemberwillbeassignedasequenceofclassesto teachonanygivenday theclassesassignedtoeachprofessormustnotoverlap theremustbeenoughslackineachprofessor sscheduleforthemto walkfromoneclasstothenext forpurposesofthisproblem sassumethat everyprofessoriscapableofteachingeveryclass andthatprofessorswillnot haveo cehours lunches orbathroombreaks  concretely supposethereare classeso eredin erentlocations inputtoourproblemconsistsofthefollowingdata anarray  ofclasses whereeachclass hasthree elds startingtime start theendingtime andthelocation loc atwonalarray   isthetimerequired towalkfromlocation tolocation wewantto ndtheminimumnumberofprofessorsthatcancollectivelyteach everyclass suchthatwheneveraprofessorisassignedtoteachtwoclasses start start weactuallyhave start loc loc wecansolvethisproblembyreducingittoadisjocoverproblemas weconstructadag whoseverticesareclassesandwhose edgesrepresentpairsofclassesthatarescheduledfarenoughaparttobetaught  forasomewhatmorerealistic andlessdepressing formulationofthisproblem airplanesand ights orbusesandbusroutes insteadofprofessorsandclasses  theywill beexpectedtoanswerstudentemailsastheywalkbetweenclasses    baseballelimination bythesameprofessor speci cally adirectededge indicatesthatthesame professorcanteachclass andthenclass itiseasytoconstructthisdagin  timebybruteforce thenwe ndadisjocoverof usingthe matchingalgorithmdescribedabove eachdirectedpathin representsalegal classscheduleforoneprofessor theentirealgorithmrunsin   time  despiteitsinitialdescriptionintermsofintervalsanddistances thisisreally amaximummatchingproblem whichmeansit reallyamaximow problem speci cally wewantto match asmanyclassesaspossibletothe classtaughtbythesameprofessor thenumberofprofessorsweneedis equaltothenumberofclasseswithnoassignedsuccessor eachclasswithout anassignedsuccessoristhelastclassthatsomeprofessorteaches  baseballelimination everyyearmillionsofamericanbaseballfanseagerlywatchtheirfavoriteteam hopingtheywillwinaspotintheplayo andultimatelytheworldseries sadly mostteamsarehematicallyelimindaysorevenweeksbeforethe regularseasonends itiseasytospotwhenateamiselimin twinenoughgamestocatchuptothecurrentleaderintheirdivision butsometimesthesituationismoresubtle forexample herearetheactual standingsfromtheamericanleagueeastonaugust30  teamwon lostleft nyybalbostordet newyorkyankees283873 baltimoreorioles283274 bostonredsox278200 torontobluejays277700 detroittigers273400 detroitisclearlybehind butsomeditigersfansmayholdouthope thattheirteamcanstillwin afterall ifdetroitwinsall27oftheirremaining games theywillendtheseasonwith76wins morethananyotherteamhas soaslongaseveryotherteamloseseverygame butthat snotpossible  ifweassumethateverytimeinterval isequal  thisschedulingproblemcanactually besolvedin log timeusingasimplegreedyalgorithm  manyamericanuniversitiesscheduleutebreaksbetweenclasses underthe ablebeliefthatahumanbeingcanwalkfromanyclassroomtoanyotherclassroomonthesame campusintenminutes iinviteanyonewhothinksthisbeliefisrealistictovisitmycampusand walkfromonesiebelcentertotheother   applicationsofflowsandcuts becausesomeofthoseotherteamsstillhavetoplayeachother hereisone completeargument  bywinningalloftheirremaininggames detroitcan nishtheseasonwitharecordof and86 iftheyankeeswinjust2moregames thentheywill nishtheseasonwith a77and85recordwhichwouldputthemaheadofdetroit ssupposethetigers goundefeatedfortherestoftheseasonandtheyankeesfailtowinanothergame theproblemwiththisscenarioisthatnewyorkstillhas8gamesleftwithboston iftheredsoxwinallofthesegames theywillendtheseasonwithatleast77wins puttingthemaheadofthetigers theonlywayfordetroittoevenhaveachance nishingin rstplace isfornewyorktowinexactlyoneofthe8gameswithboston andlosealltheirothergames thesoxmustloseallthegamestheyplay againstteamsotherthannewyork thisputsthemina3 waytiefor rstplace nowlet slookatwhathappenstotheoriolesandbluejaysinourscenario balti morehas2gamesleftwithwithbostonand3withnewyork ifeverythinghappens asdescribedabove theorioleswill nishwithatleast76wins detroitcancatch baltimoreonlyiftheorioleslosealltheirgamestoteamsotherthannewyorkand boston inparticular thismeansthatbaltimoremustloseall7ofitsremaininggames withtoronto thebluejaysalsohave7gamesleftwiththeyankeesandwehaveal readyseenthatfordetroitto nishin rstplace torontomustwillallofthesegames butifthathappens thebluejayswillwinatleast14moregamesgivingthemat nal recordof77and85orbetterwhichmeanstheywill nishaheadofthetigers matterwhathappensfromthispointintheseasonon detroitcannot nishin rst placeintheamericanleagueeast therehastobeabetterwayto gurethisout hereisamoreabstractformulationoftheproblem ourinputconsistsof twoarrays    isthenumberofgames team hasalreadywon isthenumberofupcominggamesbetween teams wewanttodeterminewhetherteam canendtheseasonwith themostwins possiblytiedwithotherteams  inthebenjaminschwartzobservedthatthisquestioncanbe modeledasamaximum owproblem about20yearslater dangus eld charles martel anddavidfernsimpli edschwartz owformulationto apairselectionproblem speci cally wewanttoknowwhetheritispossible select awinnerforeachgame sothatteam comesin rstplace denotethenumberofremaininggamesforteam wewill assumethatteam winsall ofitsremaininggames thenteam cancome rstplaceifandonlyifeveryotherteam winsatmost ofits remaininggames sincewewantto select awinningteamforeachgame westartbybuilding abipartitegraph whosenodesrepresentthegamesandtheteams wehave  boththeexampleandthisargumentaretakenfromeliolinick swebsite https smu olinick riot detroit html whichisbasedonolinick sjointresearchwithilanadler alan erera anddorithochbaum  weareimplicitlyassumingthatnogameendsinatieandthateverygameisactuallyplayed bothassumptionsareconsistentwithmajorleaguebaseballrules atleastforgamesthata ect postseasonstanding barringwars naturaldisasters orswarmsofbees    baseballelimination  game nodes oneforeachpair   team nodes oneforeach  foreachpair weaddedges nite capacity weaddasourcevertex andedges withcapacity foreachpair finally weaddatargetnode andedges capacity foreachteam figure   showsthegraphderivedfromthe1996americanleagueeast standings isthedetroittigers allunlabelededgeshave nitecapacity figure11  cubswin cubswin theorem team canendtheseasonin rstplaceifandonlyifthereisa feasible owinthisgraphthatsaturateseveryedgeleaving proof supposeitispossibleforteam toendtheseasonin rstplace everyteam winsatmost oftheremaininggames eachgamebetweenteam andteam thatteam wins addoneunitof alongthepath becausethereareexactly gamesbetween teams everyedgeleaving issaturated becauseeachteam winsat games theresulting owisfeasible conversely beafeasible owthatsaturateseveryedgeoutof supposeteam winsexactly gamesagainstteam forall thenteams play games soeveryupcominggameisplayed eachteam winsatotalof upcominggames andtherefore atmost gamesoverall ifteam winalltheirupcoming games theyendtheseasonin rstplace insummary todecidewhetherourfavoriteteamcanwin weconstructthe ownetwork computeamaximum andreportwhetherthanmaximum owsaturateseveryedgeoutof forexample inthegraphinfigure   thetotalcapacityoftheedgesleaving is27 becausethereare27remaining games ontheotherhand thetotalcapacityoftheedgesentering isonly26   applicationsofflowsandcuts whichimpliesthatthemaximum owvalueisatmost26 weconcludethat detroitismathematicallyeliminated  ownetworkhas  verticesand  edges anditcanbe constructedin  time usingorlin salgorithm wecancomputethe maximum owin  time thisisnotthefastestalgorithmforthebaseballeliminationproblem  kevinwayneprovedthatonecandetermine teamsthatare icallyeliminatedinonly  time essentiallyusingasinglemaximow computation  projectselection inour nalexample supposewearegivenasetof projectsthatwecould possiblyperform someprojectscannotbestarteduntilcertainotherprojects arecompleted theprojectsandtheirdependenciesaredescribedbyadirected acyclicgraph whoseverticesaretheprojects whereeachedge thatproject cannotbeperformedbeforeproject thisisexactlytheformof dependencygraphsweconsideredinchapter   finally eachproject anassociated pro whichwillbegiventousiftheprojectiscompleted someprojectshavenegativepro whichweinterpretaspositive costs wecan chooseto nishanysubset oftheprojectsthatincludesallitsdependents thatis foreveryproject  everyprojectthat dependsonisalsoin ourgoalisto ndavalidsubsetoftheprojectswhosetotalpro tisaslargeas inparticular ifallofthejobshavenegativepro thecorrectanswer istodonothing figure11  adependencygraphforasetofeightprojects diamondsindicatepro tableprojects squaresindicatecostlyprojects eachedge dependson atahighlevel ourtasktopartitiontheprojectsintotwosubsets thejobswe select andthejobswe turndown sointuitively dliketomodel ourproblemasaminimumcutprobleminacertaingraph butinwhichgraph howdoweenforceprerequisites wewantto maximize pro butweonly knowhowto minimum cuts andhowdoweconvertnegativepro tsinto positivecapacities  wegot luckyhere itispossibleforateamtobeeliminatedevenifthetotalcapacityof alledgesinto isnosmallerthanthetotalcapacityofedgesoutof    projectselection totransformourgivenconstraintgraph intoa ownetwork  weadda sourcevertex andatargetvertex tothedependencygraph withanedge foreverypro tablejob  andanedge foreverycostly job  intuitively wecanthinkof asanewjoblwith pro cost  thatwemustperformlast weassigncapacitiestotheedgesof  asfollows foreverypro tablejob foreverycostlyjob  foreverydependencyedge allpacitiesarepositive sothisisavalidinputtothemaximumcut problem nowconsideranarbitrary  foranyedge inthe originaldependencygraph    wecan legallyselectthejobsin ifandonlyifthecapacityofthecut nite figure11  ownetworkfortheexampledependencygraph alongwithitsminimumcut cuthascapacity   sothetotalpro tfortheselectedjobsis  infact itturnsoutthatcutswithsmallercapacitycorrespondtojob selectionswithhigherpro speci cally iclaimthatselectingthejobsin earnsatotalpro tof isthesumofallthepositivepro max   wecanprovethisclaimbystraightforwardde nitiosing asfollows anysubset ofprojects wede nethreevalues asusual wede  isnotanedge cost    yield      applicationsofflowsandcuts pro  yield cost byde nition yield yield yield becausethecut nitecapacity onlyedgesoftheform cancrossthecut construction everyedge pointstoapro tablejobandeachedge points fromacostlyjob cost yield weimmediatelyconclude yield cost pro asclaimed itfollowsimmediatelythatwecan maximize ourtotalpro tbycomputinga minimum cutin  wecaneasilyconstruct  time andwe cancomputetheminimum  timeusingorlin salgorithm weconcludethattheentireectionalgorithmrunsin time exercises  beadirectedgraphwhereforeachvertex andoof areequal suppose intpaths fromsomevertex toanothervertex undertheseconditions intpathsfrom giveaprooforacounterexample withexplanation  givenanundirectedgraph withthreevertices describeandanalyzeanalgorithmtodeterminewhetherthereisapath thatpassesthrough hint wereadirectedgraph problemwouldbe  consideradirectedgraph withseveralsourcevertices   andtargetvertices   wherenovertexisbothasourceanda target mal isafunction  thatsatis esthe conservationconstraintateveryvertexthatisneitherasourcenoratarget thevalue ofamal owisthetotalexcess owoutof sourcevertices  asusual weareinterestedin nding owswithmaximumvalue subjectto capacityconstraintsontheedges inparticular wedon tcarehowmuch owmovesfromanyparticularsourcetoanyparticulartarget considerthefollowingalgorithmforcomputingmal ows thevariables  represent owfunctions thesubroutine maxflow solvesthestandardmaximum owproblemwith source andtarget  exercises maxmultiflow    initializethe    maxflow  updatethe return provethatthisalgorithmcorrectlycomputesamaximummal owin describeamoree cientalgorithmtocomputeamaximumm terminal owin  theislandofsodorishometoalargenumberoftownsandvillages connectedbyanextensiverailnetwork severalcasesofadeadly contagiousdisease eitherswine uorzombies reportsareunclear beenreportedinthevillageofskarloey thecontrollerofthesodorrailway planstoclosedowncertainrailwaystationstopreventthediseasefrom spreadingtotidmouth hishometown notrainscanpassthroughaclosed station tominimizeexpense andpublicnotice hewantstoclosedown asfewstationsaspossible hecannotclosetheskarloeystation becausethatwouldexposehimtothedisease andhecannotclosethe tidmouthstation becausethenhecouldn tvisithisfavoritepub describeandanalyzeanalgorithmto ndtheminimumnumberof stationsthatmustbeclosedtoblockallrailtravelfromskarloeytotidmouth thesodorrailnetworkisrepresentedbyanundirectedgraph withavertex foreachstationandanedgeforeachrailconnectionbetweentwostations twospecialvertices representthestationsinskarloeyandtidmouth forexample giventhefollowinginputgraph youralgorithmshould returntheinteger   gridisanundirectedgraphwith  verticesorganizedinto rows columns wedenotethevertexinthe throwandthe thcolumn everyvertex hasexactlyfourneighbors     exceptthe boundary vertices forwhich       bedistinctvertices called terminals inthe grid escapeproblem istodeterminewhetherthereare   applicationsofflowsandcuts vintpathsinthegridthatconnecttheterminalstoany distinct boundaryvertices figure11  apositiveinstanceoftheescapeproblem anditssolution describeandanalyzeane cientalgorithmtosolvetheescapeproblem therunningtimeofyouralgorithmshouldbeasmallpolynomialfunction nowsupposetheinputtotheescapeproblemconsistsofasingleinteger andthelistof terminalvertices isverysmall thepreviousrunning timeisactually exponential intheinputsize describeandanalyzean algorithmtosolvetheescapeproblemintime polynomialin ª modifythepreviousalgorithmtooutputanexplicitdescriptionofthe escapepaths iftheyexist stillintimepolynomialin  thespucommutersilencedepartmentisinstallingacoursein thebasementofthescenter theplaying eldisaclosedpolygon boundedby horizontalandverticallinesegments meetingatrightangles thecoursehas startingpoints holes inonnecorrespondence itisalwayspossiblehittheballalongastraightlinedirectlyfromeach startingpointtothecorrespondinghole withouttouchingtheboundary oftheplaying eld playersarenotallowedtobouncegolfballso walls toomuchglass startingpointsand holesareallatdistinct locations sadly thearchitect scomputercrashedjustasconstructionwasaboutto thankstotheherculeane ortsoftheirsysadmins theywereableto recoverthe locations ofthestartingpointsandtheholes butallinformation aboutwhichstartingpointscorrespondtowhichholeswaslost describeandanalyzeanalgorithmtocomputeaonnecorrespo dencebetweenthestartingpointsandtheholesthatmeetsthee requirement ortoreportthatnosuchcorrespondenceexists theinput consistsofthe atesofthe cornersoftheplaying eld startingpoints andthe holes assumeyoucandetermineinconstant timewhethertwolinesegmentsintersect giventhe ates oftheirendpoints  exercises figure11  amini golfcoursewith vestartingpoints andholes andalegalcorrespondence betweenthem  cyclecover ofagivendirectedgraph isasetofvint cyclesthatcovereveryvertexin describeandanalyzeane cient algorithmto ndacyclecoverforagivengraph orcorrectlyreportthatno cyclecoverexists hint usebipartitematching  supposeyouaregivenan checkerboardwithsomeofthesquares deleted youhavealargesetofdominos justtherightsizetocover twosquaresofthecheckerboard describeandanalyzeanalgorithmto determinewhetheronetiletheboardwithdominodominomust coverexactlytwoundeletedsquares andeachundeletedsquaremustbe coveredbyexactlyonedomino yourinputisabooleanarray deleted   deleted true ifandonlyifthesquareinrow andcolumn hasbeendeleted youroutputisasingleboolean youdo havetocomputetheactual placementofdominos forexample fortheboardshowninfigure   youralgorithmshouldreturn true figure11  coveringapartialcheckerboardwithdominos  supposewearegivenan squaregrid someofwhosesquaresare coloredblackandtherestwhite describeandanalyzeanalgorithmto determinewhethertokenscanbeplacedonthegridsothat everytokenisonawhitesquare everyrowofthegridcontainsexactlyonetoken everycolumnofthegridcontainsexactlyonetoken   applicationsofflowsandcuts yourinputisatwodimensionalarray iswhite   ofbooleans indicatingwhichsquaresarewhite youroutputisasingleboolean giventhegridinfigure   asinput youralgorithmshould return true figure11  markingeveryrowandcolumninagrid  supposewearegivenasetofboxes eachspeci edbytheirheight width anddepthincentimeters allthreesidelengthsofeveryboxliestrictly between10cmand20cm asyoushouldexpect oneboxcanbeplaced insideanotherifthe rstboxcanberotatedsothatitsheight width deptharerespectivelysmallerthantheheight width anddepthofthe secondbox boxescanbenestedrecursively callaboxis visible ifitisnot insideanotherbox describeandanalyzeanalgorithmtonesttheboxessothatthenumber ofvisibleboxesisassmallaspossible  supposewearegivenan grid someofwhosecellsaremarked thegrid isrepresentedbyanarray   ofbooleans true ifandonlyifcell ismarked monotone paththroughthegridstarts attheteftcell movesonlyrightordownateachstep andendsat thebottocell ourgoalistocoverthemarkedcellswithasfew monotonepathsaspossible figure11  greedilycoveringthemarkedcellsinagridwithfourmonotonepaths describeanalgorithmto ndamonotonepaththatcoversthelargest numberofmarkedcells  exercises thereisanaturalgreedyheuristicto ndasmallcoverbymonotone paths ifthereareanymarkedcells ndamonotonepath ˇ thatcovers thelargestnumberofmarkedcells unmarkanycellscoveredby ˇ markedcells andrecurse showthatthisalgorithmdoes computeanoptimalsolution describeandanalyzeane cientalgorithmtocomputethesmallestset ofmonotonepathsthatcoverseverymarkedcell  thefacultysenateatsoobananauniversityhasdecidedtoconvenea committeetodeterminewhetherunclegabby professorbobocornelius ormofothepsychicgorillashouldreplacetherecentlydisgracedbaron factotumasthenewo cial mascot symbol ofspu sathleticteams fightingphs exactlyonefacultymembermustbechosenfromeach academicdepartmenttoserveonthiscommittee somefacultymembers haveappointmentsinmultipledepartments buteachcommitteemember canrepresentonlyonedepartment forexample ifprof blagojevichis liatedwithboththedepartmentofcorruptionandthedepartmentof stupidity andheischosenasthestupidityrepresentative thensomeone elsemustrepresentcorruption finally universitypolicyrequiresthat everyfacultycommitteemustcontainexactlythesamenumberofassistant professors associateprofessors andfullprofessors fortunately thenumber ofdepartmentsisamultipleof3 describeandanalyzeanalgorithmtochooseasubsetofthespufaculty tosta thepoactotumsimian mascot symbol committee orcorrectly reportthatnovalidcommitteeispossible yourinputisabipartitegraph indicatingwhichprofessorsbelongtowhichdepartments eachprofessor vertexislabeledwiththatprofessor srank assistant associate orfull  thedepartmentofcommutersilenceatsoobananauniversityhas exiblecurriculumwithacomplexsetofgraduationrequirements departmento ers erentcourses andthereare erentrequirements eachrequirementspeci esasubsetofthe coursesandthenumberof coursesthatmustbetakenfromthatsubset thesubsetsfordi erent requirementsmayoverlap buteachcoursecanbeusedtosatisfy atmost requirement forexample supposethereare  courses  graduationrequirements youmusttakeatleast  coursesfromthesubset youmusttakeatleast  coursesfromthesubset thenastudentwhohasonlytakencourses cannotgraduate buta studentwhohastakeneither cangraduate   applicationsofflowsandcuts describeandanalyzeanalgorithmtodeterminewhetheragivenstudent cangraduate theinputtoyouralgorithmisthelistof requirements eachspecifyingasubsetofthe coursesandthenumberofcoursesthat mustbetakenfromthatsubset andthelistofcoursesthestudenthastaken  reorganizingthefirstannualspucommutersilenceourdance exchange tobeheldalldayfriday saturday andsunday severalute setsofmusicwillbeplayedduringtheevent andalargenumberofdjs haveappliedtoperform youneedtohiredjsaccordingtothefollowing constraints setsofmusicmustbeplayedeachday andthus  sets altogether eachsetmustbeplayedbyasingledjinaconsistentmusicgenre ambient bubblegum dubstep horrorcore kkwaito mariachi headjazz nashvillecountry parapara ska eachgenremustbeplayedatmostonceperday eachcandidatedjhasgivenyoualistofgenrestheyarewillingtoplay eachdjcanplayatmostthreesetsduringtheentireevent supposethereare candidatedjsand erentmusicalgenresavailable describeandanalyzeane cientalgorithmthateitherassignsadjanda genretoeachofthe  sets orcorrectlyreportsthatnosuchassignmentis  supposeyouarerunningawebsitethatisvisitedbythesamesetofpeople everyday eachvisitorclaimsmembershipinoneormore demographic groups forexample avisitormightdescribehimselfasmale years afather aresidentofillinois anacademic ablogger andafanofgilbert andsullivan  yoursiteissupportedbyadvertisers eachadvertiserhas toldyouwhichdemographicgroupsshouldseeitsadsandhowmanyofits adsyoumustshoweachday altogether thereare visitors demographic groups advertisers describeane cientalgorithmtodetermine givenallthedatadescribed inthepreviousparagraph whetheryoucanshoweachvisitorexactly adperday sothateveryadvertiserhasitsdesirednumberofadsdisplayed andeveryadisseenbysomeoneinanappropriatedemographicgroup  supposewearegivenanarray   ofnoegativerealnumbers wewantto round toanintegermatrix byreplacingeachentry  iamaverygoodtheoreticalcomputerscientist speci cally ageometricalgorithmspecialist  exercises witheither withoutchangingthesumofentriesinanyrowor columnof forexample                            describeandanalyzeane cientalgorithmthateitherrounds inthis fashion orreportscorrectlythatnosuchroundingispossible provethatalegalroundingispossible ifandonlyif thesumofentries ineachrowisaninteger andthesumofentriesineachcolumnisan integer inotherwords provethateitheryouralgorithmfrompart returnsalegalrounding oralegalroundingis impossible ª supposeweareguaranteedthatnoneoftheentriesintheinputmatrix isaninteger describeandanalyzeanevenfasteralgorithmthateither rounds orreportscorrectlythatnosuchroundingispossible forfull credit youralgorithmmustrunin time hint ows  networks aremadeupofloweredwirelessdevices ciple  thesenetworkscanbeusedonbattle elds inregionsthathave recentlysu eredfromnaturaldisasters andinotherareas theideaisthatalargecollectionofcheap simpledevicescouldbe utedthroughtheareaofinterest forexample bydroppingthemfroman airplane thedeviceswouldthenautomaticallycon gurethemselvesintoa functioningwirelessnetwork thesedevicescancommunicateonlywithinalimitedrange weassume allthedevicesareidentical thereisadistance suchthattwodevicescan communicateifandonlyifthedistancebetweenthemisatmost wewouldlikeournetworktobereliable butbecausethedevices arecheapandlowered theyfrequentlyfail ifadevicedetectsthat itislikelytofail itshouldtransmititsinformationtosomeother backup devicewithinitscommunicationrange werequireeachdevice tohave potentialbackupdevices allwithindistance wecallthese devices backupset wedonotwantanydevicetobeinthebackup setoftoomanyotherdevices asinglefailuremighta ectalarge fractionofthenetwork sosupposewearegiventhecommunicationradius parameters andanarray   ofdistances isthedistance betweendevice anddevice describeanalgorithmthateithercomputes  butnotsomuchinpractice   applicationsofflowsandcuts abackupsetofsize foreachofthe devices suchthatnodeviceappears inmorethan backupsets orreports correctly thatnogoodcollectionof backupsetsexists  facedwiththethreatofbrutallyseverebudgetcuts potemkinuniversity hasdecidedtohireactorstositinclassesastoensurethat everyclasstheyo eriscompletelyfull becauseactorsareexpensive universitywantstohireasfewofthemaspossible buildingontheirpreviousleadershipexperienceatthenounct soobananauniversity theadministratorsatpotemkinhavegiven youadirectedacyclicgraph whoseverticesrepresentclasses andwhereeachedge indicatesthatthesamecanattend class andthenlaterattendclass inaddition youarealsogivenanarray cap  listingthemaximumnumberofwhocantakeeach class describeananalyzeanalgorithmtocomputetheminimumnumber ofthatwouldalloweveryclasstobe lledtocapacity  quentin alice andtheotherbrakebillsphysicalkidsareplanningan excursionthroughtheneitherlandstofillory theneitherlandsisavast desertedcitycomposedofseveralplazas eachcontainingasinglefountain thatcanmagicallytransportpeopletoadi erentworld adjacentplazasare connectedbygates whichhavebeencursedbythebeast thegatesbetween plazasareopenonlyfor veminuteseveryhour allsimultaneousm  to12  thenfrom1 to1  andsooareotherwiselocked duringthose veminutes ifmorethanonepersonpassesthroughanysingle gate thebeastwilldetecttheirpresence  anyoneattempting toopenalockedgate orattemptingtopassthroughmorethanonegate withinthesame vuteperiodwillturnintoani  numberofpeoplecansafelypassthrough erent gatesatthesametime orpassthroughthesamegateat erent times youaregivenamapoftheneitherlands whichisagraph witha vertexforeachfountainandanedgeforeachgate withthefountainsto earthandfilloryclearlymarked supposeyouarealsogivenapositiveinteger describeandanalyze analgorithmtocomputethemaximumnumberofpeoplethatcanwalk fromtheearthfountaintothefilloryfountaininatmost afterthegateshaveopenedatmost utanyonealerting thebeastorturningintoani therunningtimeofyouralgorithm shoulddependon hint buildadi erentgraph  thisisverybad  thisisveryverybad  exercises ª describeananalyzeanalgorithmforpart whoserunningtimeis polynomialin dependenceon ontheotherhand supposeyouarealsogivenaninteger andanalyzeanalgorithmtocomputetheminimumnumberofhoursthat peopletowalkfromtheearthfountaintothefilloryfountain withoutanyonealertingthebeastorturningintoani hint ª  beabipartitegraph whoseleftvertices areindexed   andwhoserightverticesareindexed   ing nossing foreverypairofedges   wehave  ifandonlyif  describeandanalyzeanalgorithmto ndthelargestnossing matchingin hint thisisnotreallya owproblem describeandanalyzeanalgorithmto ndthesmallestnumberofno crossingmatchings   suchthateachedgein isinexactly onematching hint thisisreallya owproblem ª  beabipartitegraph whoseleftvertices areindexed   insomearbitraryorder amatching dense iftherearenoconsecutiveunmatched verticesin thatis foreachindex atleastoneofthevertices  isincidenttoanedgein describeanalgorithmtodetermine hasadensematching amatching sparse iftherearenoconsecutive matched vertices thatis foreachindex atleastoneofthevertices  incidenttoanedgein inparticular theemptymatchingis sparse describeanalgorithmto ndthelargestsparsematchingin amatching palindromic foreveryindex  arebothincidenttoedgesin orneither  isincident toanedgein inparticular theemptymatchingispalindromic describeanalgorithmto ndthelargestpalindromicmatchingin noneoftheseproblemsrestrictwhichverticesin arematchedor matched ª  rootedtree isadirectedacyclicgraph inwhicheveryvertexhasexactly oneincomingedge exceptforthe root whichhasnoincomingedges equivalently arootedtreeconsistsofarootvertex whichhasedgespointing totherootsofzeroormoresmallerrootedtrees describeane cient algorithmtocompute giventworootedtrees thelargestrooted   applicationsofflowsandcuts treethatisisomorphictobothasubgraphof andasubgraphof brie describeanalgorithmto ndthelargestcommonsubtreeoftwo rootedtrees hint thiswouldbearelativelystraightforwarddynamicprogramming problemifeithereverynodehad  childrenorthechildrenofeachnode wereorderedfromlefttoright butforunorderedtreeswithlargedegree youneedanothertechniquetocombinerecursivesubproblemse ciently  nhisshortandbrokentreatiseheprovidesaneternaloflaws evenofmethod forthereisnomethodexcepttobeveryintelligent butof intelligenceitselfswiftlyoperatingtheanalysisofsensationtothepointof principleandde nition eliotonaristotle perfectcritic thesacredwood  thenicethingaboutstandardsisthatyouhavesomanytochoosefrom ifyoudonotlikeanyofthem youcanjustwaitfornextyear smodel andrews tannenbaum computernetworks  itisararemindindeedthatcanrenderthehithertonon existentblindinglyobvious thecrycouldhavethoughtofisaverypopularandmisleadingone forthe factisthattheydidn andaverysigni cantandrevealingfactitistoo dirkgentlytorichardmcduff indouglasadams dirkgently sholisticdetectiveagency  ifaproblemhasnosolution itmaynotbeaproblem butafact nottobesolved buttobecopedwithovertime shimonperes asquotedbydavidrumsfeld rumsfeld srules   np hardness  agameyoucan twin imaginethatasalesmaninaredsuit wholookssuspiciouslyliketomwaits presentsyouwithablacksteelboxwith binaryswitchesonthefrontand alightbulbontop thesalesmantellsyouthatthestateofthelightbulbis controlledbyacomplex booleancircuit collectionof gates connectedbywires withoneinputwireforeachswitchandasingleoutput wireforthebulb hethenasksyouasimplequestion isitpossibletoset theswitchessothatthelightbulbturnson ifyoucananswerthisquestion correctly hewillgiveyou onemillion onehundredbilliondollars ifyouanswer incorrectly orifyoudiewithoutanswering hewilltakeyoursoul figure12  gate gate anda gate   np hardness figure12  abooleancircuit inputsenterfromtheleft andtheoutputleavestotheright asfarasyoucantell theadversaryhasn tconnectedtheswitchestothe lightbulbatall sonomatterhowyousettheswitches thelightbulbwillstay ifyoudeclarethatit possibletoturnonthelight theadversarywillopen theboxandrevealthatthereisnocircuitatall butifyoudeclarethatitis possibletoturnonthelight beforetestingall  settings theadversary willmagicallycreateacircuitinsidetheboxthatturnsonthelight ifandonly theswitchesareinoneofthesettingsyouhaven ttested andthen ipthe switchestothatsetting turningonthelight youcan tdetecttheadversary cheating becauseyoucan tseeinsidetheboxuntiltheend theonlyway provably answertheadversary squestioncorrectlyistotryall  settings youquicklyrealizethatthiswilltake longerthanyouexpectto live soyougracefullydeclinetheadversary theadversarysmilesandsays inagrowllikeheathledger sjokerafter smokingacartonofmarlboros ofcourse youhavenoreasontotrust butperhapsicansetyourmindateahehandsyoualargerollof chyouhopewasmadefrom sheep sacircuitdiagram drawn orperhapstattooed onit erearethecompleteplansforthecircuit insidethebox feelfreetopokearoundinsidetheboxtomakesuretheplans arecorrect orbuildyourowncircuitfromtheseplans orwriteacomputer programtosimulatethecircuit whateveryoulike ifyoudiscoverthatthe plansdon tmatchtheactualcircuitinthebox youwinthehundredbillion buafewspotchecksconvinceyouthattheplanshavenoobvious aws subtlecheatingappearstobeimpossible butyoushouldstilldeclinetheadversary serouo theproblem thattheadversaryisposingiscalled circuitsatis ability circuitsat abooleancircuit isthereasetofinputsthatmakesthecircuitoutput true conversely whetherthecircuit outputs false forany input setting wecancalculatetheoutputofthecircuitinpolynomial linear timeusingbutnobodyknowshowtosolve circuitsat faster thantryingall  possibleinputstothecircuitbybruteforce whichrequires exponentialtime admittedly nobodyhasactuallyformally proved thatwecan    pversusnp beatbrutefybe sacleveralgorithmthatjusthasn beendiscoveredutnobodyhasactuallyformallyprovedthatvity unicornsdon texist forallpracticalpurposes ssafetoassumethat thereisnofastalgorithmfor circuitsat youtellthesalesmanno hesmilesandsays resmarterthanyoulook andthen iesawayonhisvityunicorn  pversusnp aminimalrequirementforanalgorithmtobeconsideredciisthatits runningtimeisboundedbyapolynomialfunctionoftheinputsize someconstant isthesizeoftheinput  researchersrecognized earlyonthatnotallproblemscanbesolvedthisquickly buthadahardtime guringoutexactlywhichonescouldandwhichonescouldn thereare severallled problems whichmostpeoplebelieve besolved inpolynomialtime eventhoughnobodycanproveaomiallower bound decisionproblem isaproblemwhoseoutputisasinglebooleanvalue letmede nethreeclassesofdecisionproblems isthesetofdecisionproblemsthatcanbesolvedinpolynomialtime intuitively pisthesetofproblemsthatcanbesolvedquickly np isthesetofdecisionproblemswiththefollowingproperty iftheanswer thenthereisa proof ofthisfactthatcanbecheckedinpolynomial time intuitively npisthesetofdecisionproblemswherewecanverifya answerquicklyifwehavethesolutioninfrontofus isessentiallytheoppositeofnp iftheanswertoaproblemin thenthereisaproofofthisfactthatcanbecheckedinpolynomial time forexample thecircuitsatis abilityproblemisinnp ifagivenbooleancircuit issatis thenanysetof inputvaluesthatproduces true outputisa proofthatthecircuitissatis wecanchecktheproofbyevaluatingthe circuitinpolynomialtime itiswidelybelievedthatcircuitsatis abilityis inporinbutnobodyactuallyknows everydecisionprobleminpisalsoinnp ifaproblemisinp wecanverify answersinpolynomialtimerecomputingtheanswerfromscratch everyprobleminpisalsoin  thisnotionofe ciencywasindependentlyformalizedbyalancobhamin1965 jack edmondsin1965 andmichaelrabinin1966 althoughsimilarnotionswereconsideredmore thanadecadeearlierbykurtgödel johnnash andjohnvonneumann   np hardness perhapsthesinglemostimportantunansweredquestionintheoretical computersciennotallofcomputersciennotallof science whetherthecomplexityclassespandnpareactuallydi erent intuitively itseemsobvioustomostpeoplethatp  np thehomeworksandexamsin youralgorithmsanddatastructuresclasseshave ihope convincedyouthat problemscanbeincrediblyhardtosolve evenwhenthesolutionsaresimple inretrospect scompletelyobvious ofcourse solvingproblemsfromscratch isharderthanverifyingthatagivensolutioniscorrect wecanreasonably mostalgorithmdesigners statement  asa lawofnature similartootherlawsofnaturelikemaxwell sequations general relativity andthesunrisingtomorrowmorningthatarestronglysupportedby evidence buthavenomathematicalproof butifwe rebeingmathematicallyrigorous wehavetoadmitthatnobody knowshowto prove thatthatp  np infact therehasbeenlittleornoreal progresstowardaprooffordecades  theclaymathematicsinstitutelists persuasthe rstofitssevenmillenniumprizeproblems eringa   rewardforitssolution andyes infact severalpeople lost theirsouls oratleasttheirsanity attemptingtosolvethisproblem amoresubtlebutstillopenquestioniswhetherthecomplexityclassesnp andaredi erent evenifwecanverifyevery answerquickly noreasontobelievewecanalsoverify answersquickly forexample asfar asweknow thereisnoshortproofthatabooleancircuitis satis itis generallybelievedthatnp  butagain nobodyknowshowtoproveit figure12  whatwe theworldlookslike  np hard np easy andnp complete aproblem ifapolynomiaalgorithmfor wouldimplya polynomiaalgorithmfor everyprobleminnp inotherwords canbesolvedinpolynomialtime thenp np  perhapsthemostsigni cantprogresshastakentheformof barrier whichimplythat entireavenuesofattackaredoomedtofail inaveryrealsense notonlydowehavenoidea howtoprovep  np butwecanactually prove thatwehavenoideahowtoprovep  np    np hard np easy andnp complete intuitively ifwecouldsolveoneparticularproblemquickly thenwe couldquicklysolve problemwhosesolutioniseasytounderstand thesolutiontothatonespecialproblemasasubroutine problemsare atleastashardaseveryprobleminnp finally aproblemis mplete ifitisbothandanelementof np orinformally mpleteproblemsarethehardestproblems innp apolynomiaalgorithmforevenonempleteproblemwould immediatelyimplyapolynomiaalgorithmfor mpleteproblem literally thousands ofproblemshavebeenshowntobemplete soa polynomiaalgorithmforone andthereforeall ofthemseemsincredibly callingaproblemislikesayingiownadog thenitcanspeak uentenglisyouprobablydon tknowwhetherornotiownadog butibet reprettysurethatidon towna talking dog nobodyhasamathematical proof thatdogscan tspeakenglisfactthatnoonehaseverheardadog speakenglishis evidence asarethehundredsofexaminationsofdogsthat lackedthepropermouthshapeandbrainpower butmereevidenceisnota mathematical proof nosanepersonwouldbelievemeifisaidi ownedadogthatspoke uentenglish  sothestatementiownadog itcanspeak uentenglishasanaturalcorollary nooneintheirrightmind shouldbelievethatiownadog ifaproblemisnoonein theirrightmindshouldbelieveitcanbesolvedinpolynomialtime figure12  moreofwhatwe theworldlookslike itisnotimmediatelyobviousthat problemsarethef lowingremarkabletheoremwas rstpublishedbystephencookin1971and independentlybyleonidlevinin1973   thedepartmentchairshakeshisheadsadlyandsays comeon thatjustsounds likebarking askaquestion whowasthegreatestcomplexitytheoristofallthe dogcockshishead pausesforafewseconds andthensaysafterthechairchasesthem outofhiso thedogturnstoitsownerandsays ybeishouldhavesaidimpagliazz  levin rstreportedhisresultsatseminarsinmoscowin1971 whilestillaphdstudent news ofcook sresultdidnotreachthesovietunionuntilatleast1973 afterlevin sannouncementof hisresultshadbeenpublished inaccordancewithstigler slaw thisresultisoftencalledook levinwasdeniedhisphdatmoscowuniversityforpoliticalreasons heemigratedto theusin1978andearnedaphdatmitayearlater cookwasdeniedtenurebytheberkeley   np hardness thecevintheorem circuitsatis abilityis iwon tevensketchaproofhere becausei vebeen deliberately vague aboutthede nitions  ª  formalde nitions hcsvntdracones formally thecomplexityclassesp np andarede nedintermsof languages turingmachines alanguageisasetofstringsoversome nite alphabet withoutlossofgenerality wecanassumethat   aturing machineisaveryrestrictivetypeofco aatemachine withanunboundedmemorytaseprecisede nitionissurprisingly unimportant pisthesetoflanguagesthatcanbedecidedin olynomialtime byadeterministicsinglapeturingmachine npisthesetofall languagesthatcanbedecidedinpolynomialtimebyanondeterministicturing machine npisanabbreviationfor ondeterministic olynomia therequirementofpolynomialtimeissu cientlycrudethatwedonot havetospecifythepreciseformofturingmachine numberoftapes number ofheads numberoftracks sizeofthetapealphabet andsoon infact algorithmthatrunsonarandomachine  timecanbesimulated byasinglape singlsinglturingmachinethatrunsin  time thissimulationresultallowsustoargueformallyaboutcomputational complexityintermsofstandardevelprogrammingconstructslikearrays andloopsandrecursion insteadofdescribingeverythingdirectlyintermsof turingmachines formally aproblem isnpifandonlyif foreverylanguage   np thereisapolynomia turingreduction  aturingreduction meansareductionthatcanbeexecutedonaturingmachine thatis aturing machine thatcansolve  usinganotherturingmachine  ablsubroutine turingreductionsarealsocalled oraclereductions polynomiaturingreductionsarealsocalled cookreductions mathematicsdepartmentin1970 justoneyearbeforepublishinghisseminalpaper butnot levin laterwontheturingawardforhisproof  interestedreaders ndaproofinmylecturenotesonnondeterministicturingmachinesat algorithms wtf orinboazbarak sexcellent introductiontotheoreticalcomputerscience  randomachinesareamodelofcomputationthatmorefaithfullymodelsphysical computers astandardrandomachinehasunboundedrandomemory modeled asanunboundedarray   whereeachaddress holdsasingle integer xedinteger andcanreadtoorwritefromanymemoryaddressesinconstanttime ramalgorithmsareformallywritteninassemblanguage usinginstructionslike add meaning indir meaning if0goto meaning  gotoline butthepreciseinstructionsetissurprisinglyirrelevant nition eachinstructionexecutesinunittime inpractice ramalgorithmscanbefaithfully describedusingevelpseudocode aslongaswe recarefulaboutarithmeticprecision    reductionsand sat researchersincomplexitytheoryprefertode neessintermsof polynomia manynereductions whicharealsocalled karpreductions manyne reductionfromonelanguage  toanotherlanguage isafunction suchthat   ifandonlyif  thenwecan nea language tobeifandonlyif foranylanguage   np isanereductionfrom  thatcanbecomputedinpolynomialtime everykarpreductionacookreduction butnotviceversa speci cally anykarpreductionfromonedecisionproblem toanotherdecision  equivalenttotransformingtheinputto intotheinputfor  invokingan oracle thatis asubroutine  andthenreturningtheanswerverbatim asfarasweknow noteverycookreductioncanbesimulatedbya karpreduction complexitytheoristspreferkarpreductionsprimarilybecausenpisclosed underkarpreductions butis closedundercookreductions np whichisconsideredunlikely therearenaturalproblemsthatare  withrespecttocookreductions  withrespecttokarp reductionsonlyifp np onetrivialexampleofsuchaproblemis unsat abooleanformula isit alwaysfalse ontheotherhand nereductions apply todecisionproblems ormoreformally tolanguages formally optimizationorconstructionproblemis tomakethingsevenmoreconfusing bothcookandkarporiginallyde ned essintermsof logarithmipace reductions everylogarithmipace reductionisapolynomiareduction asfarasweknow notvice versa itisanopenquestionwhetherrelaxingthesetofallowed cookor karp reductionsfromlogarithmipacetopolynomiachangesthesetof problems fortunately noneofthesesubtletiesreartheiruglyheadsinpracti everyreductiondescribedinthischaptercanbeformalizedasa logarithmipacenereductioyoucanwakeupnow  reductionsand sat toprovethatanyproblemotherthancircuitsatis abilityisweusea reductionargument reducingproblematoanotherproblembmeansdescribing analgorithmtosolveproblemaundertheassumptionthatanalgorithmfor problembalreadyexists vealreadybeendoingreductionforyears beforestartingthisbook onlyyouprobablycalledthemsomethingelse subroutinesorutilityfunctionsormodularprogrammingorusingacalculator toprovesomethingiswedescribeasimilartransformationbetween problems butnotinthedirectionthatmostpeopleexpect   np hardness youshouldtattoothefollowingruleofontothebackofyourhand nexttoyourmom sbirthdayandthe actual rulesofmonopoly  toprovethatproblem reduceaknownproblemto inotherwords toprovethatyourproblemishard youneedtodescribean cientalgorithmtosolvea erent problem whichyoualreadyknowis hard usinganhypotheticale cientalgorithmfor problemasabl subroutine theessentiallogicisaproofbycontradiction thereduction impliesthatifyourproblemwereeasy thentheotherproblemwouldbeeasy whichitain equivalently sinceyouknowtheotherproblemishard reductionimpliesthatyourproblemmustalsobehard yourhypothetical cientalgorithmdoesnotactuallyexist asacanonicalexample considerthe formulasatis ability problem justcalled sat theinputto sat isaboolean formula _ _ _ _ _  andthequestioniswhetheritispossibletoassignbooleanvaluestothevariables sothattheentireformulaevaluatesto true toprovethat sat isweneedtogiveareductionfromaknown problem theonlyproblemweknowissofaris circuitsat solet sstartthere beanarbitrarybooleancircuit wecantransform ormoreaccurately transcribe intoabooleanformula asfollows labeleachinteriorwire byanewvariable andlabeltheoutputwirewithanewvariable formula consistsofalistofequations oneforeachgate separatedby followedbya nal figure   showstheresultingtranscriptionforour examplecircuit nowweclaimthattheoriginalcircuit issatis ifandonlyif resultingformula issatis likeeveryotherandonlyifstatement provethisclaimintwosteps  ifaplayerlandsonanavailablepropertyanddeclines orisunable tobuyit thatproperty isimmediatelyauctionedo tothehighestbidder theplayerwhooriginallydeclinedtheproperty maybid andbidsmaybearbitrarilyhigherorlowerthanthelistprice playersinjailcanstill buyandsellproperty buyandsellhousesandhotels andcollectrent thegamehas32houses and12hotels oncethey regone regone inparticular ifallhousesarealreadyonthe board youcannotdowngradeahoteltofourhouses youmustrazeallthehotelsinthegroup totheground playerscansellorexchange undeveloped propertieswitheachother butcannot sellpropertybacktothebank ontheotherhand playerscansellbuildingstothebank athalf price butcannotsellorexchangebuildingswitheachother allpenaltiesarepaiddirectlyto thebank aplayerlandingonfreeparkingdoesnotwinanything aplayerlandingongogets  nomore railroadsarenotmagictransporters finally je getstheboot notthetexorthe boot dammit    reductionsand sat           _        _     figure12  transcribingabooleancircuitasabooleanformula givenasetofinputsthatsatisfythecircuit wecanderiveasatisfying assignmentfortheformula bycomputingtheoutputofeverygatein givenasatisfyingassignmentfortheformula wecanobtainasatisfying inputthecircuitbysimplyignoringtheinternalwirevariables andthe outputvariable theentiretransformationfromcircuittoformulacanbecarriedoutinlinear time thesizeoftheresultingformulaisatmostaconstantfactor largerthananyreasonablerepresentationofthecircuit nowsuppose forthesakeofargument thereisanalgorithmthatcan determineinpolynomialtimewhetheragivenbooleanformulaissatis thengivenanybooleancircuit wecandecidewhether issatis ableby rst transforming intoabooleanformula asdescribedabove andthenasking ourmagicalmystery sat algorithmwhether issatis assuggestedbythe followingcartoon eachboxrepresentsanalgorithm theredboxontheleftis thetransformationsubroutine theboxontherightisthehypotheticalmagic sat algorithm bemagic becauseithasa rainbow onit  ifyouprefermagicpseudocodetomagicboxes  kayerickson personalcommunication  forthoseofyoureadingbl printedcopies thatroundthingisarainbow   np hardness circuitsat transcribe intoabooleanformula return sat transcribing requiresonlypolynomialtime infact linear time butwhatever sotheentire circuitsat algorithmalsorunsinpolynomialtime circuitsat sat weconcludethatanypolynomiaalgorithmfor sat wouldgiveusa polynomiaalgorithmfor circuitsat whichinturnwouldimplyp np sat   sat circuitsat aspecialcaseof sat thatisparticularlyusefulinprovingessresultsis called cnfat ormoreoftensimply sat abooleanformulaisin conjunctivenormalform cnf ifitisaconjunction ofseveral clauses eachofwhichisthedisjunction ofseveral literals eachofwhichiseitheravariableoritsnegation forexample clause _ _ _ _ _ _ _ _ cnf formulaisacnfformulawithexactlythreeliteralsperclause previousexampleisnota3cnfformula sinceits rstclausehasfourliterals anditslastclausehasonlytwo sat istherestrictionof sat to3cnfformulas givena3cnfformula isthereanassignmenttothevariablesthatmakesthe formulaevaluateto true wecouldprovethat sat isbyareductionfromthemoregeneral sat problem butit sactuallyeasiertostartoverfromscratch byreducing directlyfrom circuitsat figure12  apolynomial timereductionfrom circuitsat sat givenanarbitrarybooleancircuit wetransform intoanequivalent cnfformulainseveralstages exceptfortheverylaststage thisreduction    sat circuitsat wasactuallydescribedbygrigoriitseitinin1966 veyearsbeforecookand levinreportedtheirproofsofthecevintheorem inthesame1966 paper tseitindescribedtheproblemwenowcall cnfat possiblyforthe rst time aswedescribeeachstage wewillalsoprovethatstageiscorrect makesureevery gatein hasexactlytwoinputs ifanygatehas  inputs replaceitwithabinarytreeof  binarygates callthe resultingcircuit  thecircuits  arelogicallyequivalentcircuits soeverysatisfyinginputfor isasatisfyinginputfor  andviceversa transcribe  intoabooleanformula  withoneclausepergate exactlyasin ourpreviousreductionto sat wealreadyprovedthateverysatisfyinginput  canbetransformedintoasatisfyingassignmentfor  andviceversa replaceeachclausein  withacnfformula thereareonlythreetypesof clausesin  oneforeachtypeofgatein  _ _ _ _ _ _ _ _ _ _ _ calltheresultingcnfformula    arelogicallyequivalent formulas everysatisfyingassignmentfor  isalsoasatisfyingassignment  andviceversa replaceeachclausein  witha3cnfformula everyclausein  atmost threeliterals butweneedclauseswith threeliterals toobtaina cnfformula weexpandeachtwlclausein  intotwol clausesbyintroducingonenewvariable andweexpandthe nalonl clausein  intofourlclausesbyintroducingtwonewvariables _ _ _ _ _ _ _ _ _ _ _ _ _ calltheresulting3cnfformula  everysatisfyingassignmentfor  canbe transformedintoasatisfyingassignmentfor  byassigning arbitrary values tothenewvariables conversely everysatisfyingassignment  canbetransformedintoasatisfyingassignmentfor  byignoring thenewvariables forexample ourexamplecircuitistransformedintothefollowing3cnfformula comparewithfigure     np hardness  _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _   _  _  yikes rstglance thisformulamightlooka lot morecomplicatedthanthe originalcircuit butinfact sonlylargerbyaconstantfactor speci cally simpli edcircuit  hasatmosttwiceasmanywiresastheoriginalcircuit eachbinarygatein  istransformedintoatmost veclausesin  evenifthe formulasizewerealarge polynomial function  ofthecircuitsize wouldstillhaveavalidreduction ourreductiontransformsanarbitrarybooleancircuit intoa3cnff mula  inpolynomialtime infact inlineartime anysatisfying inputfortheinputcircuit canbetransformedintoasatisfyingassignment  andanysatisfyingassignmentfor  canbetransformedintoasatisfying inputfor inotherwords issatis ableifandonlyif  issatis sat canbesolvedinpolynomialtime circuitsat canbesolvedin polynomialtime whichimpliesthatp np weconcludethat sat  maximumindependentset sat forthenextfewproblemsweconsider theinputisasimple unweighted undirectedgraph andtheproblemasksforthesizeofthelargestorsmallest subgraphsatisfyingsomestructuralproperty beanarbitrarygraph independentset isasubsetofthe verticesof withnoedgesbetweenthem maximumindependentset problem whichi llabbreviate maxindset asksforthesizeofthelargest independentsetinagivengraph iwillprovethat maxindset isusing areductionfrom sat assuggestedbyfigure   givenanarbitrary3cnfformula weconstructagraph asfollows denotethenumberofclausesin thegraph containsexactly  vertices oneforeachliteralin twoverticesin areconnectedbyan edgeifandonlyifeither  theycorrespondtoliteralsinthesameclause  theycorrespondtoavariableanditsinverse forexample theformula _ _ _ _ _ _ _ _ istransformedintothegraph showninfigure      maximumindependentset sat figure12  apolynomial timereductionfrom sat maxindset _ _ _ _ _ _ _ _ figure12  agraphderivedfromthesatis able3cnfformulawith4clauses andanindependent setofsize4 eachindependentsetin containsatmostonevertexfromeachclause triangle becauseanytwoverticesineachtriangleareconnected largestindependentsetin hassize atmost iclaimthat containsan independentsetofsize ifandonlyiftheoriginalformula issatis asusualforandonlyifstatements theproofconsistsoftwoparts suppose issatis fixanarbitrarysatisfyingassignment byde nition eachclausein containsatleastone true literal wecanchoose asubset verticesin thatcontainsexactlyonevertexperclause triangle suchthatthecorresponding literalsareall true becauseeach trianglecontainsatmostonevertexin notwoverticesin areconnected byatriangleedge becauseeveryliteralcorrespondingtoavertexin true notwoverticesin areconnectedbyanegationedge weconclude isanindependentsetofsize ontheotherhand suppose containsanindependentset ofsize vertexin mustlieinadi erentclausetriangle supposeweassignthe true toeachliteralin becausecontradictoryliteralsareconnected byedges thisassignmentisconsistent theremaybevariables suchthat correspondstoavertexin wecansetthesevariablesto   np hardness anyvaluewelike containsonevertexineachclausetriangle eachclausein atleast true literal weconcludethat satis transformingthe3cnfformula intothegraph takespolynomialtime evenifwedoeverythingbybruteforce ifwecouldsolve maxindset inpolynomialtime thenwecouldalsosolve sat inpolynomialtime transformingtheinputformula intoagraph andcomparingthesizeofthe largestindependentsetin withthenumberofclausesin butthatwould implyp np whichisridiculous weconcludethat maxindset  thegeneralpattern allnpessproofmoregenerally allpolynomiareductio followthesamegeneraloutline toreduceproblem toproblem inpolynomial time weneedtodothreethings  describeapolynomiaalgorithmtotransforman arbitrary instance intoa special instance  provethatif isainstanceof isainstanceof  provethatif isainstanceof isainstanceof thisisusuallythepartthatcausesthemosttrouble ofcourse developing acorrectreductiondoesn tmeanhandlingthesethree tasksoneatatime writingdownanalgorithmthat toworkand tryingprovethatit worksisrarelysuccessful especiallyin settingslikeexams developthealgorithm theproof andthe nlyifproofsimultaneously toquotethelategreatrickyjay  thisisan acquired skill onepointthatconfusesmanystudentsisthatthereductionalgorithmonly orksonewam utthecorrectnessproofneedstoorkboth waybutthecorrectnessproofsarenotactuallysymmetric theproof needstohandle arbitrary instancesof butthenlyifonlyneedstohandle special instancesof producedbythereductionalgorithm exploitingthis asymmetryisthekeytosuccessfullydesigningcorrectreductions nditusefultothinkintermsoftransforming certi cates fsthata giveninstanceislongwiththeinstancesthemselves forexample acerti catefor circuitsat isasetofinputsthatturnsonthelightbulb acerti catefor sat sat isasatisfyingassignment acerti catefor maxindset isalargeindependentset toreduce weactuallyneedtodesign algorithms oneforeachofthefollowingtasks  fromhis1996o ayshow rickyjayandhis52assistants    thegeneralpattern transformanarbitraryinstance intoaspecialinstance polynomialtime transformanarbitrarycerti catefor intoacerti catefor transformanarbitrarycerti catefor intoacerti catefor thesecondandthirdtasksrefertotheinputandoutputofthe rstalgorithm certi cate transformationneedstobereversible notthe instance transformation weneverhavetotransforminstancesof andwedon tneedtothinkabout arbitrary instancesof atall onlythe rstalgorithmneedstoruninpolynomial time althoughinpractice thesecondandthirdalgorithmsarealmostalways simplerthanthe rst forexample ourreductionfrom circuitsat sat consistsofthree algorithms rsttransformsan arbitrary booleancircuit intoaspecial3cnf booleanformula  inpolynomialtime encodeeachwireasavariable andeachgateasaormula andthenexpandeachormulainto cnf thesecondtransformsan arbitrary satisfyinginputfor intoasatisfying assignmentfor  tracetheinputthroughthecircuit transfervaluesfrom eachwiretothecorrespondingvariable andgiveanyadditionalvariables arbitraryvalues thethirdtransformsan arbitrary satisfyingassignmentfor  intoa isfyinginputfor transfervaluesfromeachwirevariablein  tothe correspondingwirein thereductionworksbecausethe rstalgorithm encodes anybooleancircuit intoahighlystructured3cnfformula  thespeci cstructureof  restricts itcanbesatis everysatisfyingassignmentfor  mustmefro somesatisfyinginputfor wedon thavetothinkaboutarbitrary3cnf formulasatall ourreductionfrom sat maxindset consistsofthreealgorithms rsttransformsan arbitrary cnfformula intoaspecialgraph aspeci cinteger inpolynomialtime thesecondtransformsan arbitrary satisfyingassignmentfor intoan independentsetin ofsize thethirdtransformsan arbitrary independentsetin ofsize intoa satisfyingassignmentfor rsttransformation encodes theinputformula intoahighly structuredgraph andaspeci cinteger thestructureof ensuresthat everyindependentsetofsize mesfroasatisfyingassignmentfor tconsiderarbitrarygraphsorarbitraryindependentsetsizesatall   np hardness  cliqueandvertexcover fromindependentset clique isanothernameforacompletegraph thatis agraphwhereevery pairofverticesisconnectedbyanedge maxclique problemasksforthe numberofnodesinitslargestcompletesubgraphinagivengraph vertex cover ofagraphisasetofverticesthattoucheseveryedgeinthegraph minvertexcover problemasksforthesizeofthesmallestvertexcoverina givengraph figure12  agraphwhoselargestindependentset largestclique andsmallestvertexcoverallhave size4 wecanprovethat maxclique isusingthefollowingeasyreduction maxindset anygraph hasan mplement withthesame vertices butwithexactlytheoppositesetof uv isanedgein ifand onlyif uv anedgein asetofverticesisindependentin ifand onlyifthesameverticesde neacliquein thelargestindependentin hasthesamevertices andthusthesamesize asthelargestcliqueinthe complementof figure12  aneasyreductionfrom maxindset maxclique theproofthat minvertexcover isisevensimpler becauseitrelies onthefollowingeasyobservation isanindependentsetinagraph ifandonlyifitscomplement isavertexcoverofthesamegraph largest independentsetinanygraphisthecomplementofthe smallest vertex coverofthesamegraph ifthesmallestvertexcoverinan ertexgraph hassize thenthelargestindependentsethassize    graphcoloring sat figure12  aneveneasierreductionsfrom maxindset minvertexcover  graphcoloring sat proper oring ofagraph isafunction   thatassignsoneof toeachvertex sothateveryedgehastwodi erent colorsatitsendpoints thearereallyarbitrarylabels whichfor simplicitywerepresentbysmallpositiveintegers ratherthanelectromagnetic frequencies cmykvectors orpantonenumbers forexample thegraph coloringproblemasksforthesmallestpossiblenumberofcolorsinalegal coloringofagivengraph toprovethatgraphcoloringisitsu cestoconsiderthedecision problem color givenagraph doesithaveaproper  oring weprove color isusingareductionfrom sat sat becauseithasa3 init youprobablythinki mjoking buti mnot givena3cnfformula constructagraph thatisorableifandonlyif issatis assuggested bytheusualdiagram wedescribethereductionusingastandardstrategyofdecomposingthe outputgraph gadgets subgraphsthatenforcevarioussemanticsofthe inputformula inthelanguageofgraphcoloring decomposingreductions intoseparategadgetsisnotonlyhelpfulforunderstandingexistingreductions andprovingthemcorrect butfordesigningnewessreductions   ourreductionfrom circuitsat sat encodingeachgateintheinputcircuitasaclause intheoutputformula theseclausesaresimilarly ourreductionfrom sat maxindset usedtwotypeofgadgets ause triangles andariable edges betweencontradictingliterals   np hardness ourformulphreductionusesthreetypesofgadgets thereisasingle truthgadget atrianglewiththreevertices whichintuitivelystandfor true false sincethesevertices areallconnected theymusthavedi erentcolorsinany  oring forthe sakeofconvenience wewill thosecolors true false whenwesaythatanodeiscolored true wemeanthatithasthe samecolorasvertex foreachvariable thegraphcontainsa variablegadget whichisatriangle joiningtwonewnodeslabeled tonode inthetruthgadget node mustbecoloredeither true false andthereforenode mustbecolored false true figure12  thetruthgadgetandavariablegadgetfor finally foreachclausein thegraphcontainsa clausegadget eachclause gadgetjoinsthreeliteralnodes fromthecorrespondingvariablegadgets tonode fromthetruthgadget venewunlabelednodesandten edges asshownbelow figure12  aclausegadgetfor _ _ ine ect eachtriangleintheclausegadgetbehaveslikeay inanyvalidoring ifthetwoverticestotheleftofthetriangle havethesamecolor therightmostvertexofthetrianglemusthavethesame color ontheotherhand ifthetwoleftverticeshavedi erentcolors coloroftherightvertexcanbechosenarbitrarily seefigure   itfollowsthatthereisnovalidoringofaclausegadgetwhereall threeliteralnodesarecolored false ontheotherhand anycoloringofthe literalnodeswithmorethanonecolorcanbeextendedtoavalidoring oftheclausegadget thevariablegadgetsforceeachliteralnodetobe coloredeither true false inanyvalidoringoftheclause gadget atleastoneliteralnodeiscolored true    graphcoloring sat figure12  allvalid3 coloringsofauptopermutationsofthecolors nalgraph containsexactly node node andexactly nodes foreachvariable forexample figure   showsthegraph thatresultsfromthesame3cnfformula _ _ _ _ _ _ _ _ thatwepreviouslyusedtoillustratethe maxindset reductionin figure   theoringisoneofseveralthatcorrespondtothesatisfying assignment true false _ _ _ _ _ _ _ _ figure12  the3 colorablegraphderivedfromasatis able3cnfformula vealreadydonemostoftheworkforaproofofcorrectness iftheformula issatis thenwecancolortheliteralnodesaccordingtoanysatisfying assignment andthen becauseeachclauseissatis extendthecoloring acrosseveryclausegadget ontheotherhand ifthegraphisorable wecanextractasatisfyingassignmentfromanyleastoneofthe threeliteralnodesineveryclausegadgetiscolored true color isaspecialcaseofthemoregeneralgraphcoloringprobl   np hardness whatistheminimumnumberofcolmoregeneraloptimizationproblem isalso  hamiltoniancycle hamiltoniancycle inagraphisacyclethatvisitseveryvertexexactlyonce thisisverydi erentfroman eulercircuit whichisaclosed walk thattraverses edge exactlyonce eulercircuitsareeasyto ndandconstructinlinear timeusingsearch hereweconsidertwodi erentproofsthatthe hamiltoniancycleproblemin directed graphsis fromvertexcover rstessproofreducesfromthedecisionversionofthevertexcover problem givenan undirected graph andaninteger weconstructa directed graph suchthat hasahamiltoniancycleifandonlyif hasavertexcover ofsize asinourpreviousreductions theoutputgraph iscomposedof severalgadgets eachcorrespondingtocertainfeaturesoftheinputs foreachundirectededge uv thedirectedgraph containsan edge gadget consistingoffourvertices andsixdirectededges asshowninfigure   eachvertexhasanadditionalincomingedge andeachvertexhasanadditionaloutgoingedge anyhamiltonian cyclein mustpassthroughanedgegadgetinoneofthreeway straightthroughonbothsides orwithadetourfromonesidetotheother andback eventually theseoptionswillcorrespondtoboth oronly belongingtosomevertexcover foreachvertex alltheedgegadgetsforincidentedges uv connectedin intoasingledirectedpath whichwecalla vertexchain speci cally supposevertex neighbors    additionaledges  foreach      hamiltoniancycle figure12  anedgegadgetanditsonlypossibleintersectionswithahamiltoniancycle finally alsocontains coververtices   eachcoververtexhas adirectededgetothe rstvertexineachvertexchain andadirectededge fromthelastvertexineachvertexchain figure   showsacompleteexampleofourtransformation eachdoubl arrowedbluesegmentrepresentsapairofdirectededges figure12  exampleofourreductionfrom vertexcover directedhamcycle asusual weproveourreductioniscorrectintwostages suppose   isavertexcoverof ofsize wecan constructahamiltoniancyclein asfollows foreach  wetraverseapathfromcoververtex throughthe vertexchainfor tocoververtex  orcoververtex  aswe traversethechainforeachvertex wedeterminehowtoproceedfrom eachnode asfollows  followtheedge  detourthrough foreachedge uv thehamiltoniancyclevisits aspartof svertexchainif  andaspartof svertexchain seefigure     np hardness figure12  everyvertexcoverofsize correspondstoahamiltoniancyclein andviceversa ontheotherhand suppose containsahamiltoniancycle cyclemustcontainanedgefromeachcoververtextothestartofsome vertexchain ourcaseanalysisofedgegadgetsinductivelyimpliesthat entersthevertexchainforsomevertex itmusttraversethe tirevertexchain speci cally ateachvertex thecyclemust containeitherthesingleedge orthedetourpath followedbyanedgetothenext edgegadgetin svertexchain ortoacoververtexifthisisthelastedge gadgetin svertexchain inparticular containsthedetouredge itcannotcontainedgesbetweenanycoververtexand vertexchain itfollowsthat traversesexactly vertexchains thesevertexchainsdescribeavertexcoveroftheoriginalgraph visitsthevertex foreveryedge uv weconcludethat hasavertexcoverofsize ifandonlyif containsa hamiltoniancycle thetransformationfrom takesatmost  time itfollowsthatthedirectedhamiltoniancycleproblemis sat wecanalsoprovethatthedirectedhamiltoniancycleproblemisby reducingdirectlyfrom sat givenanarbitrary3cnfformula variables   clauses   weconstructadirectedgraph containsahamiltoniancycleifandonlyif issatis asfollows foreachvariable weconstructa variablegadget whichconsistsofa doublistof  vertices    connectedbyedges   foreachindex weconnectthe rstand    hamiltoniancycle lastnodesineachadjacentpairofvariablegadgetsbyaddingedges             foreachindex wealsoconnecttheendpointsofthe rstandlastvariable gadgetswiththeedges             theresultinggraph hasexactly  hamiltoniancycles oneforeachassignment ofbooleanvaluestothe variablesof speci cally foreach wetraversethe thvariablegadgetfromlefttorightif true andrighttoleftif false seefigure   figure12  left variablegadgetsandconnectorsin foranyformulawith4variablesand4clauses thehamiltoniancyclein correspondingtotheassignment true false nowweextend toalargergraph byaddinga clausevertex foreach clause connectedtothevariablegadgetsbysixedges asshowninfigure   foreachpositiveliteral weaddtheedges    foreachnegativeliteral weaddtheedges    connectionstotheclauseverticesguaranteethatahamiltoniancyclein canbeextendedtoahamiltoniancyclein ifandonlyifthecorresponding variableassignmentsatis exhaustivecaseanalysisnowimpliesthat ahamiltoniancycleifandonlyif issatis transformingtheformula intothegraph takes kn time whichisat mostquadraticinthetotallengthoftheformula weconcludethatthedirected hamiltoniancycleproblemis variantsandextensions trivialmodi cationsofthepreviousreductionsimplythatthehamiltonian path problemindirectedgraphsisalsoahamiltonianpathinagraph ofcourseasimplepaththatvisitseveryvertexof exactlyonce infact   np hardness figure12  left clausegadgetsfortheformula _ _ _ _ _ _ _ _ ahamiltoniancyclein correspondingtothesatisfyingassignment true false aresimplepolynomiareductionsfromthehamiltoniancycleproblemto thehamiltonianpathproblemandviceversa llleavethedetailsofthese reductionsasexercises bothofthepreviousreductionsdealwithdirectedgraphs butthe spondingquestioninundirectedgraphisalsoinfact thereisa relativelysimplereductionfromthedirectedhamiltoniancycle pathproblem totheundirectedhamiltoniancycle pathproblem llleavethedetails ofthisreductionasanexercise finally theinfamous travelingsalesmanproblem asksto ndtheshortest hamiltoniancycle orpath inagraphwithweightededges ndingthe shortestcycle pathisobviouslyharderthandeterminingifacycle pathexists ataonsideragraphwhereeveryedgehasweight  travelingsalesman isalso  subsetsum fromvertexcover thenextproblemthatweproveisthe subsetsum problemconsidered inchapter  givenaset ofpositiveintegersandaninteger determine hasasubsetwhoseelementssumto weonceagainreducefrom vertexcover givenagraph andaninteger weneedtocomputeaset ofpositiveintegersandaninteger suchthat hasasubsetthatsumsto ifandonlyif hasanvertexcoverofsize transformationusesonlytwotypesofwhichare integers representing theverticesandedgesin numberthe edges arbitrarilyfrom   ourset containsthe    subsetsum fromvertexcover integer  foreachedge andtheinteger    foreachvertex isthesetofedgesthathave hasanendpoint alternately wecanthinkofeachintegerin asan  numberwritten inbase  thdigitis  iftheintegerrepresentsavertex  andforeach thdigitis  iftheintegerrepresentsedge oroneofits endpoints  finally wesetthetargetsum      nowlet sprovethatthereductioniscorrect suppose hasavertexcover ofsize considerthesubset   edge hasexactlyoneendpointin thesumoftheelementsof  writteninbase4 hasmostsigni cantdigit andallotherdigitsequalto  theelementsof  sumtoexactly ontheotherhand supposethereisasubset  thatsumsto speci cally wemusthave     forsomesubsets   ifwesumthesebanumbers therearenocarriesinthe rst digits becauseforeach thereareonly threenumbersin thdigitis  eachedgenumber contributes onlyone  tothe thdigitofthesum butthe thdigitof  eachedgein atleastoneofitsendpointsmustbein  inotherwords  isavertexcover ontheotherhand onlyvertexnumbersarelarger    hasatmost elements infact snot hardtoseethat  elements forexample giventhefoertexgraph uv uw vw vx wx ourset mightcontainthefollowingbaintegers    uv       uw       vw       vx    wx      np hardness ifwearelookingforavertexcoverofsize  ourtargetsumwouldbe    thevertexcover correspondstothesubset uv uw vx wx whosesumis        thereductioncanclearlybeperformedinpolynomialtime vealready provedthat vertexcover issoitfollowsthat subsetsum caveatreductor onesubtlepointmustbeemphasizedhere  methingpagesago backin chapter  wedevelopedadynamicprogrammingalgorithmtosolve subsetsum time tthisapolynomiaalgorithm twejustprovethat np hey smymilliondollars alas lifeisnotsosimple true therunningtimeisapolynomialfunction ofthevariables buttoqualifyasatruepolynomiaalgorithm runningtimemustbeapolynomialfunctionofthe inputsize numberof bits requiredtorepresenttheinput values oftheelementsof andthetarget sum couldbeexponentiallylargerthanthenumberofinputbits thereductionwejustdescribedproducesavalueof thatisexponentially largerthanthesizeofouroriginalinputgraph whichforcesourdynamic programmingalgorithmtoruninexponentialtime algorithmslikethisaresaidtorunin omialtime andany problemwithsuchanalgorithmiscalled weakly equivalently aweaklyproblemisaproblemthatcanbesolvedinpolynomialtime whenallinputnumbersarerepresentedin unary asasumof  butbecomes whenallinputnumbersarerepresentedin binary ifaproblemis evenwhenalltheinputnumbersarerepresentedinunary wesay thattheproblemis agoodexampleofa np problemis travelingsalesman whichremainsnpeveniftheinputgraph iscompleteandalledgeweightsareequalto    otherusefulnp hardproblems literallythousandsofproblemshavebeenprovedtobehereiwilllist afewproblemsthatareusefulinderivingreductions  iwon tdescribe theessproofsfortheseproblemsindetail butyoucan ndmostof themingareyandjohnson sclassic scaryblackbookofompleteness   assomedayitmayhappenareductionmustbefound vegotalittlelist vegotalittle list ofsomeherculeanproblemswecanusetolowerbound fastsolutionsdon texist proofstheycanassist  michaelgareyanddavidjohnson computersandintractability aguidetothetheoryof ompleteness freemanandco  andyes itreallyisblack    otherusefulnp hardproblems oftheproblemsi vediscussedsofar andmostoftheproblemsinthefollowing list rstprovednpinasinglelandmark1972paperbyrichardkarp  planarcircuitsat givenabooleancircuitthatcanbeembeddedinthe planesothatnotwowirescross isthereaninputthatmakesthecircuit output true thisproblemcanbeprovedbyreductionfromthe generalcircuitsatis abilityproblem byreplacingeachcrossingwithasmall assemblageofgates givena3cnfformula isthereanassignmentofvaluestothe variablessothateachclausecontains true literal thisproblem canbeprovedbyreductionfromtheusual sat notallequal3sat givena3cnfformula isthereanassignmentof valuestothevariablessothateveryclausecontainsatleastone true literal atleastone false literal thisproblemcanbeprovedby reductionfromtheusual sat planar3sat givena3cnfbooleanformula considerabipartitegraph whoseverticesaretheclausesandvariables whereanedgeindicatesthat avariable oritsnegation appearsinaclause ifthisgraphisplanar cnfformulaisalsocalledplanar planar3sat problemasks givena planar3cnfformula whetherithasasatisfyingassignment thisproblem canbeprovedbyreductionfrom planarcircuitsat  exact3dimensionalmatching x3m givenaset andacollectionof ementsubsetsof called triples isthereaectionofdisjoint triplesthatexactlycover thisproblemcanbeprovedbya reductionfrom sat becauseithasa3init partition givenaset integers aretheresubsets suchthat   thisproblemcanbeprovedbyasimplereductionfrom subsetsum subsetsum partition problemisonlyweakly partition givenaset  integers canitbepartitionedinto disjoint ementsubsets suchthateverysubsethasexactlythesamesum despitethesimilarnames thisproblemis erentfrom partition ididn tmakeupthenames thisproblemcanbeproved byreductionfromx3m becauseithasa3init partition partition problemis itremainsevenifevery inputnumberisatmost   laterperformedo ayas richardkarpandhis21assistants forwhichkarpwona tonyturingaward  surprisingly planarnotallequal3sat issolvableinpolynomialtime   np hardness setcover givenacollectionofsets   ndthesmallest ectionof sthatcontainsalltheelementsof thisproblemis ageneralizationofboth vertexcover andx3m hittingset givenacollectionofsets   ndthe mumnumberofelementsof thathiteverysetin thisproblemis alsoageneralizationof vertexcover longestpath givenanoegativelyweightedgraph eitherdirected orundirected andtwovertices whatisthelongestsimplepath inthegraph apathis simple ifitvisitseachvertexatmost thisproblemisageneralizationofthecorrespondinghamiltonian pathproblem ofcourse thecorresponding shortest pathproblemcanbe solvedinpolynomialtime steinertree givenaweighted undirectedgraph withsomeofthe verticesmarked whatistheminimeightsubtreeof thatcontains everymarkedvertex vertexismarked theminimumsteinertree istheminimumspanningtree ifexactlytwoverticesaremarked minimumsteinertreeistheshortestpathbetweenthem thisproblemcan beprovedbyreductionfrom vertexcover max2sat givenabooleanformulainconjunctivenormalform withexactly literalsperclause ndavariableassignmentthatmaximizesthenumber ofclauseswithatleastone true literal thisproblemcanbeprovednp byreductionfrom sat eventhoughitdoesn thavea3init simplerdecisionproblem sat whichasksifthereisanassignmentthat satis clause canactuallybesolvedinpolynomialtime maxcut givenanundirectedgraph ndasubset ˆ maximizesthenumberofedgeswithexactlyoneendpointin equivalently ndthelargestbipartitesubgraphof thisproblemcanbeproved byreductionfrom max2sat inadditiontothesedrybutusefulproblems mostinterestingpuzzlesand tairegameshavebeenshowntobeortohavegeneralizations arguably ifagameorpuzzleisn tatleastitisn tinteresting aresomeexamplesyoumay ndfamiliar minesweeper circuitsat  sudoku utlimatelyfrom sat   richardkaye minesweeperismplete mathematicalintelligencer  butseealso allanscott ulrikestege andirisvanrooij minesweepermaynotbenpmplete butishardnonetheless mathematicalintelligencer   takayukiyatoandtakahiroseta complexityandcompletenessof ndinganothersolution anditsapplicationtopuzzles ieicetransactionsonfundamentalsofelectronics communications andcomputersciences  tokyo jp yato data2 masterthesis pdf    choosingtherightproblem tetris partition  klondike akaolit sat  hamiltoniancycle  supermariobrothers sat  candycrushsaga fromavariantof sat  threes sat ofcourse  trainyard dominatingset seeexercise   shortest rubik scubesolution sat viaaspecialcaseof planarundirectedhamcycle  cookieclicker partition partition  thislistisnecessarilyincomplete thankstoalimitedfootnotebudget  ofjune2019 nobodyhaspublishedaproofthatageneralizationofultimate paperclips linerider twister orcardsagainsthumanityisnpbuti sureit sonlyamatteroftime  choosingtherightproblem oneofthemostdi cultstepsinprovingthataproblemisischoosing thebestproblemtoreducefrom thecevintheoremimpliesthatifthere isareductionfrom problemtoproblemx thenthereisareduction  ronbreukelaar erikd demaine susanhohenberger hendrikj hoogeboom waltera kosters anddavidowell tetrisishard eventoapproximate internationaljournalof computationalgeometryandapplications   luclongpréandpierremckenzie thecomplexityofsolitaire proceedingsofthe32nd internationalmathematicalfoundationsofcomputerscience   giovanniviglietta gamingisahardjob butsomeonehastodoit theoryofcomputing systems  giovanniviglietta papers gaming2 pdf  gregaloupis erikd demaine alanguo andgiovanniviglietta classicnintendogames computationally hard theoreticalcomputerscience  arxiv org abs    lucianogualà stefanoleucci emanuelenatale bejeweled candycrushandother threegamesare proc ieeeconferenceoncomputationalintelligenceandgames  arxiv org abs    stefanlangermanandyushiuno threes fives  and2048arehard proc th internationalconferenceonfunwithalgorithms  https arxiv org abs    matteoalmanza stefanoleucci andalessandropanconesi trainyardisard proc thinternationalconferenceonfunwithalgorithms  https arxiv org abs    erikd demaine saraheisenstat andmikhailrudoy solvingtherubik scubeoptimally isnpmplete proc thsymposiumontheoreticalaspectsofcomputerscience  https arxiv org abs    erikd demaine hiroito stefanlangerman jaysonlynch mikhailrudoy andkaixiao cookieclicker preprint august2018 https arxiv org abs    https xkcd    np hardness mpleteproblemtoproblemx butsomeproblemsareeasier toworkwiththanothers snosystematicmethodforchoosingtheright problem buthereareafewusefulrulesofthumb iftheproblemaskshowtoassignbitstoobjects ortochooseasubsetof objects ortopartitionobjectsintotwodi erentsubsets tryreducingfrom someversionof sat partition iftheproblemaskshowtoassignlabelstoobjectsfromasmall xedset ortopartitionobjectsintoasmallnumberofsubsets tryreducingfrom color oreven color iftheproblemaskstoarrangeasetofobjectsinaparticularorder reducingfrom directedhamcycle directedhampath travelin salesman iftheproblemasksto nda small subsetsatisfyingsomeconstraints reducingfrom minvertexcover iftheproblemasksto nda large subsetsatisfyingsomeconstraints reducingfrom maxindset maxclique max2sat iftheproblemaskstopartitionobjectsintoalargenumberofsmallsubsets tryreducingfrom partition ifthenumber  appearsnaturallyintheproblem sat color x3m partition thisisnotajoke ifallelsefails sat oreven circuitsat idonotrecommendtryingtoreducefrom tetris supermariobros trainyard youreallywanttochooseastartingproblemthatisassimpleas whilestillcapturing featureofyourproblemthatmakesitdi cult tosolve  afrivolousreal worldexample draughts isafamilyofboardgamesthathavebeenplayedforthousandsof years mostamericansarefamiliarwiththeversioncalled checkers english draughts butthemostcommonvariantworldwide knownas international draughts polishdraughts originatedinthenetherlandsinthe16thcentury foracompletesetofrules thereadershouldconsult wikipedia hereafew importantdi erencesfromtheanglcangame flyingkings asincheckers apiecethatendsamoveintherowclosestto theopponentbecomesa king andgainstheabilitytomovebackward incheckers akingininternationaldraughtscanmoveanydistance alongadiagonallineinasingleturn aslongastheintermediatesquares areemptyorcontainexactlyoneopposingpiece whichiscaptured    afrivolousreal worldexample forcedmaximumcapture ineachturn themovingplayermustcapture asmanyopposingpiecesaspossible thisisdistinctfromthefpture ruleincheckers whichrequiresonlythateachplayermustcaptureifpossible andthatacapturingmoveendsonlywhenthemovingpiececannotcapture inotherwords checkersrequirescapturinga locallymaximal setof opposingpiecesoneachturn internationaldraughtsrequiresa globallymaximum capture capturesubtleties asincheckers capturedpiecesareremovedfromthe boardonlyattheendoftheturn anypiececanbecapturedatmostonce whenanopposingpieceisjumped thatpieceremainsontheboard butcannotbejumpedagain untiltheendoftheturn forexample inthe rstpositionshownbelow eachcirclerepresentsapiece anddoubledcirclesrepresentkings black makethe rstindicatedmove capturing vewhitepieces becauseitisnotpossibletocapturemorethan pieces andthereisnoothermovethatcaptures blackcannotextend hiscapturefurther eithernortheastorsoutheast becausethecapturedwhite piecesremainontheboarduntilhisturnisover thenwhite makethe secondindicatedmove therebywinningthegame figure12  twoforced movesininternationaldraughts doubledcirclesarekings theactualgame whichisplayedona   boardwith20piecesofeach color iscomputationallytrivial wecanprecomputetheoptimalmoveforboth playersineverypossibleboardcon gurationandtheresultsintoa lookuptableofconstantsize big constant butit sstillaconstant butconsiderthenaturalgeneralizationofinternationaldraughtstoan board inthissetting ndingalegalmoveisactually thefollowing reductionfromthehamiltoniancycleproblemindirectedgraphswasdiscovered bybobhearnin2010  inmosttwayergames ndingthe moveis orworse thisistheonlyexampleiknowofamoreover arealgameplayedbymillionsofpeopleforcenturi merelyfollowing therules givenanundirectedgraph vertices weconstructaboardco gurationforinternationaldraughts suchthatwhitecancaptureacertain  seetheoreticalcomputersciencestackexchange cstheory stackexchange     np hardness numberofblackpiecesinasinglemoveifandonlyif hasahamiltonian cycle wetreat asadirectedgraph withtwoarcs inplaceof eachundirectededge uv numbertheverticesarbitrarilyfrom  nal draughtscon gurationhasseveralgadgets theverticesof arerepresentedbyrabhaped vertexgadgets areevenlyspacedalongahorizontalline eacharc isrepresentedbya pathoftwodiagonallinesegmentsfromtheeftofvertexgadget theofvertexgadget thepathforarc islocatedabovethe vertexgadgetsif andbelowthevertexgadgetsif figure12  ahigh leveloverviewofthereductionfromhamiltoniancycletointernationaldraughts thebulkofeachvertexgadgetisadiamohapedregioncalleda vault thewallsofthevaultarecomposedoftwosolidlayersofblackpieces whichcannotbecaptured thesepiecesaredrawnasgraycirclesinthe gures thereare capturableblackpiecesinsideeachvault forsome largeinteger tobedeterminedlater awhitekingcanenterthevault throughthecaptureeveryinternalpiece andthenexitthrough theeftbothearsarehallways againwithwallstwopiecesthick withgapswherethearcpathsendtoallowthewhitekingtoenterand leave thelengthsofthecaneasilybeadjustedtoalignwiththe othergadgets foreacharc wehavea cornergadget whichallowsawhitekingleaving vertexgadget toberedirectedtovertexgadget finally wherevertwoarcpathscross wehavea crossinggadget gadgetsallowthewhitekingtotraverseeitherarcpath butforbidswitching fromonearcpathtotheother asinglewhitekingstartsatthebottomcornerofoneofthevaults inany legalmove thiskingmustalternatebetweentraversingentirearcpathsand clearingvaults thekingcantraversethevariousgadgetsbackward entering    afrivolousreal worldexample figure12  left avertexgadgetwiththreeentrancesandthreeexits awhitekingemptying thevault graycirclesareblackpiecesthatcannotbecaptured figure12  left oneoftwopathsthroughacornergadget oneoftwopathsthrougha crossinggadget eachvaultthroughtheexitandviceversa butthereversalofahamiltonian cyclein isanotherhamiltoniancyclein sowalkingbackwardis ifthereisahamiltoniancyclein thewhitekingcancaptureatleast blackpiecesbyvisitingeachoftheothervaultsandreturningtothestarting vault ontheotherhand ifthereisnohamiltoniancyclein thewhiteking cancaptureatmosthalfofthepiecesinthestartingvault andthuscancapture atmost    enemypiecesaltogether  termaccounts forthecornerandcrossinggadgets eachedgepassesthroughonecornergadget andatmost   crossinggadgets tocompletethereduction weset  summingup weobtainan   boardcon guration  blackpiecesandonewhiteking wecanclearlyconstructthisboardcon gurationbybruteforceinpolynomial time figure   showsacompleteexampleoftheconstruction itisstillopenwhetherthefollowingrelatedquestionisgivenan boardcon gurationforinternationaldraughts andtherefore whitecapture theblackpieces therebywinningthegame inasingleturn   np hardness figure12  naldraughtscon gurationforthe4 vertexgraphinfigure   thegreenarrows arenotactuallypartofthecon guration ª  onbeyondzebra pandnpareonlythe rsttwostepsinanenormoushierarchyofcomplexity classes toclosethischapter andthebook letmedescribeafewmoreclasses ofinterest polynomialspace pspace isthesetofdecisionproblemsthatcanbesolvedusingpolynomial space everyprobleminnp andthereforeinp isalsoinpspace itisgenerally believedthat np  pspace butnobodycanevenprovethat  pspace aproblem pspa foranyproblem  thatcanbesolvedusing polynomial space thereisapolynomia time nereductionfrom  ifanypspaproblemisinnp thenpspace np ifany pspaproblemisinp thenpspace  ª   onbeyondzebra thecanonicalpspaproblemisthe quanti edbooleanformula problem qbf givenabooleanformula thatmayincludeanynumber ofuniversalorexistentialquanti ers butnofreevariables equivalentto true forexample thefollowingexpressionisavalidinputtoqbf     _ _ _ _  _  sat isequivalenttothespecialcaseofqbfwheretheinputformulacontains onlyexistentialquanti ers  qbfremainspspaevenwhentheinput formulamusthaveallitsquanti ersatthebeginning thequanti ersstrictly alternatebetween   andthequanti edpropositionisinconjunctive normalform withexactlythreeliteralsineachclause forexample     _ _ _ _ _ _ _ _ thisrestrictedversionofqbfcanalsobephrasedasatwayerstrategy question supposetwoplayers aliceandbob aregivena3cnfpredicate withfreevariables   theplayersalternatelyassignvaluestothe variablesinorderbyceassignsavalueto  bobassignsavalue  andsoon aliceeventuallyassignsvaluestoeveryvariablewithan oddindex andbobeventuallyassignsvaluestoeveryvariablewithaneven alicewantstomaketheexpression true andbobwantstomake false assumingaliceandbobplayperfectly whowinsthisgame surprisingly mosttwayergames  liketioe reversi checkers chess andmancalmoreaccurately appropriategeneralizationsofthese constzegamestoarbitraryboardsizpspa anothercanonicalpspaproblemis nfatotality givenano deterministicateautomaton oversomealphabet accept everystringin thecloselyrelatedproblems nfaequivalence dotwogiven nfasacceptthesamelanguage nfaminimization findthesmallestnfa thatacceptsthesamelanguageasagivennfa arealsopspaasare thecorrespondingquestionsaboutregularexpressions thecorresponding questionsabout deterministic ateautomataareactuallysolvablein polynomialtime exponentialtime thenextsigni cantlylargercomplexityclass exp alsocalledexptime thesetofdecisionproblemsthatcanbesolvedinexponentialtime thatis usingatmost  stepsforsomeconstant  everyprobleminpspace  foragood butinevitablyaging overviewofknownresultsonthecomputationalcomplexity ofgamesandpuzzles seeerikdemaineandbobhearn smonograph games puzzles computation crcpress    np hardness thereforeinnp andthereforeinp isalsoinexp itisgenerallybelieved pspace exp butnobodycanevenprovethat np  exp aproblem exp foranyproblem  thatcanbesolvedin exponential time thereis polynomial nereductionfrom  ifanyexpproblemis inpspace thenexp pspace ifanyexpproblemisinnp exp np knowthat  exp inparticular noexpproblemisinp naturalgeneralizationsofmanyinterestingayercheckers chess mancala andactuallyexptheboundarybetweenpspa completegamesandexpgamesisrathersubtle forexample thereare threewaystodrawinchess thestandard   game stalemate theplayerto moveisnotincheckbuthasnolegalmoves repeatingthesameboardposition threetimes ormoving ftytimeswithoutcapturingormovingapawn generalizationofchessiseitherinpspaceorexpdependingon howwegeneralizetheserules ifwedeclareadrawafter  moves theneverygamemustendafterapolynomialnumberofmoves sowe cansimulateallpossiblegamesfromanygivenpositionusingonlypolynomial space ontheotherhand ifweignorethecamoveruleentirely resultinggamecanlastanexponentialnumberofmoves sotherenoobvious waytodetectarepeatingpositionusingonlypolynomialspace versionof chessisexp excelsior naturally evenexponentialtimeisnottheendofthestory nexp istheclass ofdecisionproblemsthatcanbesolvein nondeterministic exponentialtime equivalently adecisionproblemisinnexpifandonlyif forevery instance thereisa proof ofthisfactthatcanbecheckedinexponentialtime expspace isthesetofdecisionproblemsthatcanbesolvedusingexponential space theselargercomplexityclasseshavehardproblems forexample ifweaddthe intersectionoperator tothesyntaxofregularexpressions decidingwhether twosuchexpressionsdescribethesamelanguageisexpspabeyond expspacearecomplexityclasseswith doubly nentialresourcebounds eexp neexp andeexpspace triply exponentialresourcebounds eeexp neeexp andeeexpspace andsoonadin nitum allthesecomplexityclassescanbeorderedbyinclusion np pspace exp nexp expspace eexp neexp mostcomplexitytheoristsstronglybelievethateveryinclusioninthissequence isstrict thatis notwoofthesecomplexityclassesareequal strongestresultthathasbeenprovedisthateveryclassinthissequenceisstrictly containedintheclass stepslaterinthesequence forexample wehave  exercises proofsthatp  expandpspace  expspace butnotwhetherp  pspaceor np  exp thelimitofthisseriesofincreasinglyexponentialcomplexityclassesisthe class elementary ofdecisionproblemsthatcanbesolvedusingtimeorspace boundedbyafunctiontheform  forsomeconstantinteger      forexample        itmaybetemptingtoconjecturethat naturaldecidableproblemcan besolvedinelementarytime butinfactthisconjectureisincorrect generalizedregularexpressions nedbyrecursivelycombining stringsoversome nitealphabetbyconcatenation xy union kleeneclosure andnegation forexample thegeneralizedregular expression       representsthesetofstringsin   thatdo containtwo  sinarow itispossibletodeterminealgorithmicallywhether twogeneralizedregularexpressionsdescribeidenticallanguages byrecursively convertingeachexpressionintoanequivalentnfa convertingeachnfaintoa dfa andthenminimizingthedfa therunningtimeofthisalgorithm hasthenoementarybound   intuitivelybecauseeachlayerof recursivenegationcanexponentiallyincreasethenumberofstates infact larrystockmeyerprovedin1974thatthisproblem besolvedinmerely elementarytime evenifweforbidkleeneclosure exercises  describeandanalyzeandalgorithmtosolve partition intime nm isthesizeoftheinputsetand isthesumoftheabsolute valuesofitselements whydoesn tthisalgorithmimplythatp np  considerthefollowingproblem called boxdepth givenasetof alignedrectanglesintheplane howbigisthelargestsubsetofthese rectanglesthatcontainacommonpoint describeapolynomiareductionfrom boxdepth maxclique describeandanalyzeapolynomiaalgorithmfor boxdepth hint  timeshouldbeeasy log timeispossible whydon tthesetworesultsimplythatp np   np hardness  abooleanformulaisin disjunctivenormalform dnf ifitconsistsofa disjunction orseveral terms eachofwhichistheconjunction oneormoreliterals forexample theformula _ _ isindisjunctivenormalform dnf sat asks givenabooleanformulain disjunctivenormalform whetherthatformulaissatis describeapolynomiaalgorithmtosolvednf sat whatistheerrorinthefollowingargumentthatp np supposewearegivenabooleanformulainconjunctivenormalformwith atmostthreeliteralsperclause andwewanttoknowifitissatis wecanusethedistributivelawtoconstructanequivalentformulaindis junctivenormalform forexample _ _ _ _ _ _ nowwecanusethealgorithmfrompart todetermine inpolynomial time whethertheresultingdnfformulaissatis wehavejustsolved sat inpolynomialtime sat isnp hard wemustconcludethat np  theproblem allornothing3sat asks givena3cnfbooleanformula whetherthereisanassignmenttothevariablessuchthateachclauseeither hasthree true literalsorhasthree false literals describeapolynomiaalgorithmtosolve allornothing3sat sat isnpwhydoesn ttheexistenceofthisalgorithmprove thatp np  supposeyouaregivenamagicblackboxthatcandetermine nomialtime givenanarbitraryweightedgraph thelengthofthe shortesthamiltoniancyclein describeandanalyzea polynomia time algorithmthatcomputes givenanarbitraryweightedgraph theshortesthamiltoniancyclein usingthismagicblackboxasa subroutine supposeyouaregivenamagicblackboxthatcandetermine nomialtime givenanarbitrarygraph thenumberofverticesinthe largestcompletesubgraphof describeandanalyzea polynomia time algorithmthatcomputes givenanarbitrarygraph acomplete subgraphof ofmaximumsize usingthismagicblackboxasasubro tine  exercises supposeyouaregivenamagicblackboxthatcandetermine nomialtime givenanarbitrarygraph  orable describeandanalyzea polynomia algorithmthateitherco putesaproper  oringofagivengraphorcorrectlyreportsthatno suchcoloringexists usingthemagicblackboxasasubroutine hint theinputtothemagicblackboxisagraph onlyagraph verticesand edges nothingelse supposeyouaregivenamagicblackboxthatcandetermine inpolyn mialtime givenanarbitrarybooleanformula issatis describeandanalyzea polynomia algorithmthateithercomputes asatisfyingassignmentforagivenbooleanformulaorcorrectlyreports thatnosuchassignmentexists usingthemagicblackboxasasubroutine supposeyouaregivenamagicblackboxthatcandetermine inpolyn mialtime givenanarbitraryset ofpositiveintegers bepartitionedintotwosets suchthat describeand analyzea polynomia algorithmthateithercomputesanequal partitionofagivensetofpositiveintegersorcorrectlyreportsthatno suchpartitionexists usingthemagicblackboxasasubroutine ª supposeyouaregivenamagicblackboxthatcandetermine nomialtime givenanarbitrarygeneralizedregularexpression nedjustbeforetheexercises matchesanystring scribeandanalyzea polynomia algorithmthateither ndsa singlestringthatmatchesagivengeneralizedregularexpressionor correctlyreportsthatnosuchstringexists usingthemagicblackboxas asubroutine  ssomethingspecialaboutthenumber  describeandanalyzeapolynomiaalgorithmfor partition aset  positiveintegers youralgorithmwilldetermineinpolyn mialtimewhethertheelementsof canbesplitinto disjointpairs whosesumsareallequal describeandanalyzeapolynomiaalgorithmfor color givenan undirectedgraph youralgorithmwilldetermineinpolynomialtime hasapropercoloringthatusesonlytwocolors describeandanalyzeapolynomiaalgorithmfor sat givena booleanformula inconjunctivenormalform withexactly literals perclause youralgorithmwilldetermineinpolynomialtimewhether hasasatisfyingassignment hint thisproblemisstronglyconnected totopicsdescribedinanearlierchapter   np hardness  snothingspecialaboutthenumber  theproblem partition isde nedasfollows givenaset  positiveintegers determinewhethertheelementsof canbesplitinto subsets eachwith  elements whosesumsareallequal provethat partition hint reducefrom partition itmaybe easiertoconsidermultisets rst theproblem color isde nedasfollows givenanundirectedgraph determinewhetherwecancoloreachvertexwithoneoftwelvecolors sothateveryedgetouchestwodi erentcolors provethat color hint reducefrom color theproblem12satisde nedasfollows givenabooleanformula inconjunctivenormalform withexactlytwelveliteralsperclause determinewhether hasasatisfyingassignment provethat sat hint reducefrom sat  therearetwodi erentversionsofthehamiltoniancycleproblem onefor directedgraphsandoneforundirectedgraphs earlierinthischapteryou ndtwoproofsthatthe directed hamiltoniancycleproblemisnp describeapolynomiareductionfromthe undirected hamiltonian cycleproblemtothe directed hamiltoniancycleproblem proveyour reductioniscorrect describeapolynomiareductionfromthe directed hamiltonian cycleproblemtothe undirected hamiltoniancycleproblem proveyour reductioniscorrect whichofthesetworeductionsimpliesthatthe undirected hamiltonian cycleproblemisnp  describeapolynomiareductionfrom undirectedhamiltonia cycle directedhamiltoniancycle describeapolynomiareductionfrom directedhamiltonia cycle undirectedhamiltoniancycle  describeapolynomiareductionfromthe hamiltonianpath lemto hamiltoniancycle describeapolynomiareductionfromthe hamiltoniancycle problemto hamiltonianpath hint apolynomiareductioncan calltheblsubroutinemorethanonce butitdoesn thaveto  considerthefollowingsubtlevariantsof cnfsat foreachproblem inputisabooleanformula inconjunctivenormalform andthegoalisto determinewhether hasasatisfyingassignment  exercises supposeeveryclauseof atmost threeliteralsandeach variableappearsinatmost clauses provethatthisvariantof cnfsat supposeeveryclauseof threeliteralsandeach variableappearsinatmost clauses provethatthisvariantof sat hint solvepart rst ª supposeeveryclauseof cancontain anynumberof literals buteach variableappearsinatmost clauses describeapolynomia algorithmforthisvariantof cnfsat ª supposeeveryclauseof threeliteralsandeachvariable appearsinatmost clauses provethat mustbesatis thisvariantof sat iscompletelytrivial  provethat notallequal3sat provethat  abooleanformulain exclusivconjunctivenormalform xcnf isa conjunction ofseveral clauses eachofwhichisthe exclusive severalliterals thatis aclauseistrueifandonlyifitcontainsanoddnumber oftrueliterals xcnfat problemaskswhetheragivenxcnfformula issatis eitherdescribeapolynomiaalgorithmfor xcnfat provethat xcnfat hint donottrytodoboth ª  considerthefollowingvariantof sat called majority3sat justlike sat theinputto majority3sat isabooleanformula inconjunctivenormal form withexactlythreeliteralserclause majority3sat askswhether thereisanassignmenttothevariablesof suchthateveryclausecontains atleasttwo true literals eitherdescribeanalgorithmthatsolves majority3sat inpolynomial timeorprovethat majority3sat isnp hint donottrytodoboth ª  foranysubset     considerthefollowingproblem whichi sat theinputisabooleanformula inconjunctivenormalform withexactlythreeliteralsineachclause theproblemistodecidewhether thereisanassignmenttothevariablesof suchthatineachclauseof thenumberof true literalsisintheset forexample    sat isthestandard sat problem   sat isthesameas allornothing3sat seeexercise    sat isusuallycalled notallequal3sat seeexercise   sat isusuallycalled seeexercise    np hardness   sat isusuallycalled xcnfat seeexercise    sat isusuallycalled majority3sat seeexercise  giveacompletelistofallsubsets     suchthat sat issolvable inpolynomialtime assuming  np hint tgive  erent arguments  provethatthefollowingproblemsare givenanundirectedgraph containasimplepaththatvisits allbut17vertices givenanundirectedgraph haveaspanningtreeinwhich everynodehasdegreeatmost23 givenanundirectedgraph haveaspanningtreewithatmost leaves givenanundirectedgraph whatisthesizeofthelargest subsetofvertices suchthatatmost374edgesin haveboth endpointsin givenanundirectedgraph whatisthesizeofthelargest subsetofvertices suchthateachvertexin hasatmost473 neighborsin givenanundirectedgraph isitpossibletocolortheverticesof threedi erentcolors sothatatmost31337edgeshavebothendpoints thesamecolor  provethatthefollowingvariantsoftheminimumspanningtreeproblem givenagraph computethe maximameter spanningtreeof thediameterofatree isthelengthofthelongestpathin givenagraph withweightededges computetheminimeight spanningtreeof givenagraph withweightededgesandasubset ofverticesof computetheminimeightspanningtreeallofwhoseleavesarein givenagraph withweightededgesandaninteger computethe minimeightspanningtreewithatmost leaves givenagraph withweightededgesandaninteger computethe minimeightspanningtreewhereeverynodehasdegreeatmost  usingthegadgetinfigure   provethatdecidingwhetheragiven planar graphisorableis hint showthatthegadget canbeored andthenreplaceanycrossingsinaplanarembedding withthegadgetappropriately  exercises usingpart andthegadgetinfigure   provethatdeciding whetheraplanargraph withmaximumdegree4 isorableis hint replaceanyvertexwithdegreegreaterthan4withacollection ofgadgetsconnectedsothatnodegreeisgreaterthanfour figure12  gadgetforplanar3 colorability gadgetfordegree planar3 colorability  provethat planarcircuitsat hint constructagadgetfor crossingwires  describeapolynomiareductionfrom sat sat describeapolynomiareductionfrom sat sat ª  describeadirectpolynomiareductionfrom color color isalotharderthantheoppositedirection  domino isa   rectangledividedintotwosquares eachofwhichis labeledwithaninteger  ina legalarrangement ofdominos thedominos arelinedupsothatthenumbersonadjacentendsmatch figure12  alegalarrangementofdominosinwhicheveryintegerbetween0and6appearstwice foreachofthefollowingproblems eitherdescribeapolynomia algorithmorprovethattheproblemis givenanarbitrarybag ofdominos istherealegalarrangementof thedominosin givenanarbitrarybag ofdominos istherealegalarrangementofa dominosfrom inwhicheveryintegerbetween  appearsexactly  theseintegersareusuallyrepresentedbypips exactlylikedice onastandarddomino numberofpipsoneachsideisbetween0and6 althoughonecanbuysetswithupto9oreven pipsoneachside wewillallowarbitraryintegerlabels astandardsetofdominoscontains exactlyonedominoforeachpossibleunorderedpairoflabels wedo assumethattheinputs toourproblemshavethisproperty   np hardness ª givenanarbitrarybag ofdominos whatisthelargestnumberof dominoswecantakefrom tomakealegalarrangement  pebbling isasolitairegameplayedonanundirectedgraph whereeach vertexhaszeroormore pebbles asingle pebblingmove consistsofremoving twopebblesfromavertex andaddingonepebbletoanarbitraryneighbor thevertex musthaveatleasttwopebblesbeforethemove pebbledestruction problemasks givenagraph anda pebblecount foreachvertex whetheristhereasequenceofpebbling movesthatremovesallbutonepebble provethat pebbledestruction  recallthataoringofagraph isafunctionthatassignseachvertex afromtheset      suchthatforanyedge uv vertices areassigneddi erentaoringis careful ifthecolors assignedtoadjacentverticesarenotonlydistinct butdi erbymorethan  mod5 provethatdecidingwhetheragivengraphhasacareful  oring hint reducefromthestandard color problem figure12  acareful5 coloring  asubset ofverticesinanundirectedgraph half eachvertexin isadjacentto atmostone othervertexin provethat ndingthesizeofthelargesthalfsetofverticesinagiven undirectedgraphisnp asubset ofverticesinanundirectedgraph ifeachvertexin isadjacentto atmost374 otherverticesin prove ndingthesizeofthelargestfsetofverticesin agivenundirectedgraphisnp asubset ofverticesinanundirectedgraph almostindependent ifat most374edgesin havebothendpointsin provethat ndingthesize ofthelargestalmosetofverticesinagivenundirected graphisnp  beagraph dominatingset isasubset ofthevertices suchthateveryvertexin iseitherin oradjacenttoavertexin  exercises dominatingset problemasks givenagraph andaninteger asinput containsadominatingsetofsize provethatthisproblemis figure12  adominatingsetofsize  inthepetersengraph  asubset ofverticesinanundirectedgraph triangl forevery tripleofvertices  atleastoneofthethreeedges uv uw vw absent provethat ndingthesizeofthelargesttrianglsubset ofverticesinagivenundirectedgraphis figure12  atriangle freesubsetof7vertices thisisnotthelargestsuchsubsetinthisgraph  rectangletiling problemisde nedasfollows givenonelarge rectangleandseveralsmallerrectangles determinewhetherthesmaller rectanglescanbeplacedinsidethelargerectanglewithnogapsoroverlaps provethat rectangletiling provethat rectangletiling figure12  apositiveinstanceofthe rectangletiling problem  asubset ofverticesinagraph isa burrset ifremovingeveryvertex leavesasubgraphthatdoesnotcontainahamiltonianpath provethat ndingthesmallestburrsetinagivengraphisnp asubset ofverticesinagraph isa schuylerset ifremovingevery vertexin leavesasubgraphthat containahamiltonian   np hardness path provethat ndingthesmallestschuylersetinagivengraphis np  tonianpath inagraph isapaththatgoesthroughatleasthalfof theverticesof showthatdeterminingwhetheragraphhasatonian pathis toniancycle inagraph isacyclethatgoesthroughatleasthalfof theverticesof showthatdeterminingwhetheragraphhasatonian cycleis hint usepart ornot  beanundirectedgraphwithweightededges heavyhamiltonian cycle isacycle thatpassesthrougheachvertexof exactlyonce suchthat thetotalweightoftheedgesin ismorethanhalfofthetotalweightofall edgesin provethatdecidingwhetheragraphhasaheavyhamiltonian cycleis figure12  aheavyhamiltoniancycle thecyclehastotalweight34 thegraphhastotalweight67  foreachofthefollowingproblems eitherdescribeapolynomia algorithmorprovethattheproblemis doubluleriantour inanundirectedgraph isaclosedwalkthat traverseseveryedgein exactlytwice givenagraph havea doubluleriantour doublamiltoniantour inanundirectedgraph isaclosedwalk thatvisitseveryvertexin exactlytwice givenagraph adoublamiltoniantour doublamiltonian circuit inanundirectedgraph isaclosedwalk thatvisitseveryvertexin exactlytwice andtraverseseachedgein mostonce givenagraph haveadoublamiltoniancircuit tripluleriantour inanundirectedgraph isaclosedwalkthat traverseseveryedgein exactlythreetimes givenagraph haveatripluleriantour  exercises triplamiltoniantour inanundirectedgraph isaclosedwalkthat visitseveryvertexin exactlythreetimes givenagraph haveatriplamiltoniantour  thisexerciseasksyoutoprovethatacertainreductionfrom vertexcover steinertree iscorrect supposewewantto ndthesmallestvertex coverinagivenundirectedgraph weconstructanewgraph   asfollows    isanendpointof  vz  equivalently weconstruct bysubdividingeachedgein withanew vertex andthenconnectingalltheoriginalverticesof toanew apex vertex provethat hasavertexcoverofsize ifandonlyifthereisasubtree  verticesthatcontainseveryvertexin  considerthefollowingsolitairegame thepuzzleconsistsofan gridofsquares whereeachsquaremaybeempty occupiedbyaredstone oroccupiedbyabluestone thegoalofthepuzzleistoremovesomeof thegivenstonessothattheremainingstonessatisfytwoconditions  everyrowcontainsatleastonestone  nocolumncontainsstonesof bothcolors forsomeinitialcon gurationsofstones reachingthisgoalis impossible asolvablepuzzleandoneofitsmanysolutions anunsolvablepuzzle provethatitistodetermine givenaninitialcon gurationof redandbluestones whetherthepuzzlecanbesolved  eachofthefollowinggamesinvolvesan gridofsquares whereeach squareiseitheremptyoroccupiedbyastone inasinglemove youcan remove thestonesinanarbitrarycolumn provethatitisto ndthe smallest subsetofcolumnsthatcan beclearedsothat atmost onestoneremainsineachrowofthegrid provethatitisto ndthe largest subsetofcolumnsthatcanbe clearedsothat atleast onestoneremainsineachrowofthegrid   np hardness ª provethatitistodeterminewhether subsetofcolumnscan beclearedsothat onestoneremainsineachrowofthegrid  je triestomakehisstudentshappy atthebeginningofclass hepassesout aquestionnairethatlistsanumberofpossiblecoursepoliciesinareaswhere heis exible everystudentisaskedtorespondtoeachpossiblecourse policywithoneofnglyfavostlyneutralornglyoppo eachstudentmayrespondwithnglyfavornglyoppotoat vequestions becauseje sstudentsareveryunderstanding studentishappyif butonlyif heorsheprevailsinatleastoneoftheir strongpolicypreferences eitherdescribeapolynomiaalgorithmfor settingcoursepolicytomaximizethenumberofhappystudents orshow thattheproblemis  reinchargeofchoreographingamusicalforyourlocalcommunity theater andit stimeto gureoutthe nalposeofthebigshoopping numberattheend vedecidedthateachofthe cast membersintheshowwillbepositionedinabiglinewhenthesong nishes allwiththeirarmsextendedandshowingo theirbestspirit ngers thedirectorhasdeclaredthatduringthe nal ourish eachcastmember musteitherpointboththeirarmsuporpointboththeirarmsdown yourjobto gureoutwhopointsupandwhopointsdown directorhasalsogivenyoualistofarrangementsthatwillupsethisdelicate artistictemperament eachforbiddenarrangementisasubsetofthecast memberspairedwitharmpositions forexample maynotpointher armsupwhilened apu andsmitherspointtheirarmsdo provethat ndinganacceptablearrangementofarmpositionsis  thenexttimeyouareataparty oneoftheguestswillsuggesteveryoneplaya roundofwaymumbletypeg agameofskillanddexteritythatrequires threeteamsandaknife theo cialrulesofwaymumbletypeg xedduringtheholyromanwaymumbletypegcouncilin1625 requirethat  eachteam haveatleastoneperson  anytwopeople onthesameteam knoweachother  everyonewatchingthe game beononeofthethreeteams ofcourse itwillbeareally fun party nobodywillwanttoleave therewillbeseveralpairsofpeopleat thepartywhodon tknoweachother thehostoftheparty havingheard thrillingtalesofyourprowessinallthingsalgorithmic willhandyoualist ofwhichpairsofpartknoweachotherandaskyoutochoosethe teams whilehesharpenstheknife  exercises eitherdescribeandanalyzeapolynomialtimealgorithmtodetermine whetherthepartcanbesplitintothreelegalwaymumbletypeg teams orprovethattheproblemis  thepartyyouareattendingisgoinggreat butnowit stimetolineupfor thealgorithmmarch thisdancewasoriginally developedbythejapanesecomedyduoitsumokokokara forthechildren stelevisionshowpythagoraswitch thealgorithmmarchisperformedbyalineofpeople eachpersoninline startsaspeci csequenceofmovementsonemeasurelaterthantheperson directlyinfrontofthem themarchisthedanceequivalentofa musicalroundorcanon likeowrowrowyouror frèrejacques properetiquettedictatesthateachmarchermustknowtheperson directlyinfrontoftheminline lestaminormistakeleadtohorrible embarrassmentbetweenstrangers supposeyouaregivenacompletelist ofwhichpeopleatyourpartyknoweachother provethatitis todeterminethelargestnumberofpartthatcanparticipateinthe algorithmmarch youmayassumewithoutlossofgeneralitythatthereare noninjasatyourparty  provethatthefollowingproblemsaboutnondeterministicatea tomataandregularexpressionsare givenannfa overthealphabet   isthereastringin accept givenan acyclic nfa overthealphabet   whatisthelength ofthe shortest stringin accept givenaregularexpression overthealphabet   istherea stringin match givena star regularexpression overthealphabet   isthelengthofthe shortest stringin match infact problems arepspamplete evenprovingthatthese problemsareinpspaceisnontrivial  describeapolynomiaalgorithmforthefollowingproblem annfa overthealphabet   isthereastringin accept describeapolynomiaalgorithmforthefollowingproblem aregularexpression overthealphabet   isthereastring match   np hardness thecomplementofanyregularlanguageisanotherregularlanguage sowhydon tthesetwoalgorithms togetherwiththenpessresults inproblem  provethatp np  charonneedstoferry recentlydeceasedpeopleacrosstheriveracheron intohades certainpairsofthesepeopleareswornenemies whocannot betogetheroneithersideoftheriverunlesscharonisalsopresent iftwo enemiesareleftalone onewillstealtheobolfromtheother smouth leaving themtowanderthebanksoftheacheronasaghostforalleternity justsaythisisaverybadthing theferrycanholdatmost passengers atatime includingcharon andonlycharoncanpilottheferry  provethatitistodecidewhethercharoncanferryall people acrosstheacheronunharmed asidefrombeing youknow dead inputforcharon sproblemconsistsoftheintegers andan ertex graph describingthepairsofenemies theoutputiseither true false pleasedonotwriteyoursolutioninclassicallatin  thisproblemisageneralizationofthewownwolfbbagepuzzle rstknownappearanceisintheremarkablemedievalmanuscript propositionesadacuendos juvenes problemstosharpentheyoung xviii propositiodehomineetcapraetlvpo homoquidamdebebatultra uuiumtransferrelupum capram etfasciculumcauli nonpotuitaliamnaueminuenire nisiquaeduostantumexipsisferreualebat praeceptum itaqueeifuerat utomniahaecultraillaesaomninotransferret dicat quipotest quomodo eisillaesistransirepotuit solutio similinamquetenoreducerempriuscaprametdimitteremforislupumetcaulum tumdeindeuenirem lupumquetransferrem lupoqueforismissocapramnauireceptamultra reducerem capramqueforismissamcaulumtransueheremultra atqueiterumremigassem capramqueassumptamultraduxissem sicquefaciendofactaeritremigatiosalubris absque uoraginelacerationis forthosefewreaderswhoseclassicallatinisalittlerusty hereisanenglishtranslation xviii theproblemoftheman thegoat andthewolf amanneededtotransferawolf agoat andabundleofcabbageacrossariver hefoundthathisboatcouldonlybeartheweightoftwo objectsatatime includingthe man andhehadtogeteverythingacrossunharmed tellmeifyoucan howtheywere abletocrossunharmed solution inasimilarfashion asanearlierproblem iwould rsttakethegoatacross andleavethewolfandcabbageontheoppositebank theniwouldtakethewolfacross leavingthewolfonshore iwouldretrievethegoatandbringitbackagain theniwould leavethegoatandtakethecabbageacross andtheniwouldrowacrossagainandgetthe goat inthiswaythecrossingwouldgowell withoutanythreatofslaughter themostlikelyauthorofthe propositiones istheproli cenglishscholaralcuinof york theevidenceforalcuin sauthorshipofthistreatiseissomewhatcircumstantial wedoknowfromhiscorrespondencewithcharlemagnethathesenttheemperorsomee arithmeticalproblemsforfmostmodernscholarsbelievethatevenifalcuindidwritethe propositiones hedidnotinventalloftheproblemshimself butrathercollectedthemfromeven earliersources somethingsneverchange  ifwehadanindex wecouldlookitupintheindex leunder teganjovanka janetfielding ovalva doctorwho season19 january4  istartedwiththephonebook lookingupmensawasnotgoingtobeeasy withhavingtofollowthestrictalphabetizingrulesthataresocommonnowadays ipreferasofter morefuzzyalphabetizingscheme onethatallowsthemindto oatfreeandupontheword thereisprideinthat thedictionaryisa perfectexampleofover alphabetization withitsharshrulesandeverylittleword neatlyinplace italmostmakesmeneverwanttoeatagain stevemartin ijoinedmensa thenewyorker july21  forsometopicswithmultiplereferences boldpagenumbersindicatethe primaryreference humansandpseudocodeareindexedseparately  game  color  partition  sat   cnfformula  color  reductionfrom sat  partition  sat  reductionfrom circuitsat    reductionto color  reductionto directedhamcycle  reductionto maxindset    ruleofthree       academicjobmarket  activevertexsearch  acyclicgraph forest  acyclicmaximum    networks  additionchains  incrementanddoubleonly  additionalrecurrenceparameter    adjacencymatrix  adjacentvertices  airlinescheduling  alternatingpath  amortizedanalysis   theannouncer stest  antanairesis euclid salgorithm antarctica    apsp shortestpaths arbitrage  arithmetictakestime   arpedonaptai   arrownotation  articulationpoint cutvertex arti cialsourcevertex     aryabhat spulverizer euclid algorithm assignment matching tuple selection augmentingpath  veragecaanalysis   backedgesearch  backtracking  recursivebruteforce  sequenceofdecisions  summaryofpastdecisions  backwardinduction dynamic programming baguenaudier  balancedbrackets   barleymo  basecase  baseballelimination  beamillionaireandneverpaytaxes reductionfrom beamillionaire   asdynamicprogramming  moore svariant  laba himbel bellman sequation recurrence caanalysis  search  dijkstra salgorithm  jarník salgorithm  algorithm edmo   bfs search binarysearchtrees  aatrees   avltrees    optimal  recon guration  lacktrees   leaning aatrees binarytodecimalconversion  bipartitegraph  bipartitemaximummatching  bitonic  blackbox     seealso noneofyourbusiness bob smamaseesaukulele  bond minimaledgecut  booleancircuits   booleanformula  booleanmatrixmultiplication  bor vka salgorithm  advantages  bostonpoolalgorithm  bottleneck seealso minimumcut bottleneckdistance   bottleneckspanningtree  search    bridgesofkönigsburg  seealso eulertour  bst binarysearchtrees bubbaseesabanana  busscheduling  residualcapacity  camelot  candycrushsaga  capacityscaling  carefulgraphcoloring  centralvertexofatree  checkerboard    checkers draughts children ssongs  choosingtherightproblemto reducefrom  circuitsatis ability circuitsat circuitsat  reductionto sat    reductionto sat  circulation  clause  clausegadget     clique  closedwalkinagraph  cnf conjunctivenormalform cnfat sat  compassandstraightedge  component  computationescanonicaetlegalis  condensation strongcomponent graph gurationgraph    conjunctivenormalform  connectedcomponent component connectedgraph  conservationconstraint  convenience       cookreduction  cookieclicker  countinggraphcomponents  covergadget  crossedgesearch  crossinggadget  cursuspublicus  cut vertexpartition  cutcapacity  cutvertex  cyclecover  cycle  cycleinagraph  dag directedacyclicgraph dancedancerevolution  datastructuresforgraphs graphs decisionproblem  decisiontree  decisionversusoptimization  degreeofavertex  denile  dependencygraph        order preorder postorder search      dfa ateautomaton dfs search dijkstra salgorithm   withnegativeedges  exponentialrunningtime   withnonegativeedges  dinic dinitz algorithm  directedacyclicgraph   directedcycle  directedgraph  directedhamcycle  reductionfrom sat   reductionfrom vertexcover  directedhampath  inadirectedacyclicgraph  inatournament  reductiontoshortestsimple path  directedpath  directedwalk  disconnectedgraphtraversal  disjointpaths int  vint  disjocover  indirectedacyclicgraphs  npingeneralgraphs  disjodatastructure   disjunctivenormalform  dist lengthofshortestwalk withatmost edges  dist  dist tentativedistance  distancemultiplication smatrix multiplication distancetables  divideandconquer        domaintransformation   dominatingset   inintervalgraphs  dominos   ttrytobeclever     deadpool dynamic programming seuss theodorsuessgiesel onbeyondzebra  seuss theodoresuessgiesel thecatinthehatcomesback  draughts   english  international  reductionfrom undirectedhamcycle  drinkingsongs    duplationandmediation     dynamicprogramming        aspostordertraversal   beforebellman  boilerplate  indirectedacyclicgraphs   intrees  betterthan memoization  sequential  spaceoptimization  haped  edge pairofvertices  edgecapacity  edgecontraction  edgedemands  edgegadget    edgereweighting  mplement  intpaths  editdistance       edmoalgorithms fattestaugmentingpaths  shortestaugmentingpaths  edvac  egyptianmultiplication duplationandmediation elementary  elves recursionfairy emptyedge ows   endpointsofanedge  epiphany   errors vii escapeproblem  ethiopianpeasantmultiplication duplationand mediation euclid salgorithm  eulertour     evaluationorder     aspostorder  singleanddoublearrows   exact3dimensionalmatching  exp exponentialtime  exp  exponentialdecay     exponentiation  owvalue  factorial  fagame  fantasticmr fox  fastfouriertransform  feasible  fft fastfouriertransform fibonacciheaps   fibonaccinumbers    fightclub  nishedvertexsearch  ateautomaton    noc  pspaproblems  firstmakeitwork thenmakeit fast              firstwhat thenhow  fizzbuzz standardinterview question  ood   owdecomposition   algorithm  owvalue  owvectorspace  yingkings    canrunforever    exponentialrunningtime  fattestaugmentingpaths  shortestaugmentingpaths  ford srelaxationalgorithm  exponentialrunningtime  forest acyclicgraph  formulasatis ability sat forwardedgesearch  french agwalk  frenchinvasionofindochina  funnymatrixmultiplication smatrix multiplication residualgraph  gadgets  galhapleyalgorithm  gamestate   gametrees      garbagecollection  gategadgets  generalpatterns backtracking  divideandconquer  dynamicprogramming  graphtraversal  greedyexchangearguments  minim algorithms   npessproofs  salgorithms  genericgraphtraversal whatevsearch georgeofthejungle  giggle   gilbertandsullivan hmspinafore  themikado  thepiratesofpenzance  goldenratio    goodpivot   medianofmedians  graphcoloring  inintervalgraphs  graphembedding  graphreduction   graphtraversal    disconnectedgraphs    graphicalstatics  graphs datastructures adjacencylist   adjacencymatrix   comparison  implicit    historicalexamples  modernexamples  terminology  greatestcommondivisor  greedyalgorithms  areusuallywrong  thatdon twork        trydynamicprogramming rst  greedyexchangearguments         guillotinesubdivision  seealso gulliver stravels      hamiltoniancycle directedhamcycle undirectedhamcycle nition   hamiltonianpath directedhampath undirectedhampath nition  handshakelemma  hashtags  headofanedge  hellenisticsnobbery  helpfuldrawings evaluationorderarrows   npessreduction  recursiontrees  heuristic   seealso algorithmthatdoesn work hittingset  howdoi choosetherightproblemto reducefrom  deriveadynamicprogramming algorithm  designabacktracking algorithm  provethatagreedyalgorithm iscorrect  provethataproblemis np   mancodes   huntingtoalgorithm  hyperboleandahalf   hypercube  ibm  implicitgraphrepresentation  ofavertex   incorrectproofsthatp np    independentset maxindset  indexformulation    indice dammit induction                           backward dynamic programming seealso recursion inductionhypothesis recursion fairy niteloop        inputsize  integermaximum    integermultiplication dinquer  duplationandmediation  karatsuba salgorithm  tooookalgorithm  viafastfouriertransform  integermultiplicationlattice algorithm  integralitytheorem maximum ows  internationaldraughts draughts interpuncts word spacing  intersectiongraph  intervalgraph  interviewquestions    inverseackermanfunction  inversioncounting  jarník salgorithm   je actuallydidthis   johnson salgorithm  jumpinthemiddle     kanielthedane  karpreduction   seealso guillotinesubdivision klondike  knightsandknaves  kohariralgorithm  kruskal salgorithm  kublakhan  kut aka euclid salgorithm labelofapath   labelinggraphcomponents  language setofstrings  largestcommonsubtree  latin    latticemultiplication  lawsofphysics irrelevanceof  letthatwhichdoesnotmatter trulyslide     levelofavertex  levenshteindistance edit distance linebreaking  linselection    listofnpproblems  literal  localmaximum  localminimum  logarithmipacereduction  logicgates  longestcommonincreasing subsequence  longestcommonsubsequence    longestincreasingdigital subsequence  longestincreasingsubsequence     longestpath  indirectedacyclicgraphs     reductionfrom travelingsalesman  loopinvariant induction hypothesis low  lowerboundviaadversary argument  magnetictape  majority3sat  majoritygate  nereduction  marketingbuzzwords  mastertheorem recursiontrees matching  nossing  otherspecialcases  atr avr tta  matrice matrix dammit matrixmultiplication boolean  inctime     standard   matrixrounding   max2sat  maxclique  reductionfrom maxindset  maxcut  maxindset  incirculararcgraphs  inintervalgraphs  intrees  reductionfrom sat    reductionto maxclique  reductionto minvertexcover  maximum ows  acyclic   integer  multiplesourcesandtargets  withvertexcapacities  maximumindependentset maxindset maximummatchinginbipartite graphs  maximumsubarrayproblem  twonal  maxwonadiagrams  mazes     number  median selection medifansselection   mediffans selection  medifheuristic   memoization      seealso dynamicprogramming memoizedrecursionis search  mergesort  mergesortrecurrence    metagraph strongcomponent graph methodischestatonnieren  minvertexcover  reductionfrom maxindset  reductionto directedhamcycle  reductionto subsetsum  smatrixmultiplication    minesweeper  minimumcliquecover incirculararcgraphs  inintervalgraphs   minimumcuts  minimumspanningtrees   uniqueness   minty salgorithm dijkstra algorithm mom medianofmedians mondegreen  monopoly actualrulesof  moore salgorithm  morsecode   mountainclimbingproblem  mst minimumspanningtrees multigraph  queens    nadirianars   napoleondynamite  nationalresidentmatching program  eedlwunalgorithm  negativecycledetection    negativecycles   negativeedges  neighbor  neitherlands themagicians  nestingboxes  newvertexsearch  nfa ateautomaton nobelprizein algorithms economics  node vertex noneofyourbusiness      seealso blackbox notallequal3sat  np nondeterministicpolynomial time  npversus  npversusexp  npversuspspace  npmplete  np          formalde nition  weakly   obvious       ohyeah wealreadydidthis   onquicksort quickselect openproblems ashortestpaths  matrixmultiplcation  optimaladditionchains  optimalpancake ipping  pversusnp  sortingbinarytreesbyswaps androtations  winninginternationaldraughts inoneturn  mining seeprojectselection  optimalbinarytrees binarysearchtrees   variants   expressiontrees   binarycodes  optimalsubstructure seealso correctrecurrence  orderedsubtree  orlin salgorithm  oofavertex  polynomialtime  pversusnp  pversuspspace   npasalawofnature   palindrome       pancakesorting   parallelassignment  parent    seealso mom partition npproblem  subroutineinquicksortand quickselect  partyplanning  pathcompression  path  pathinagraph  peasantmultiplication duplationandmediation pebbling  peckingorder  pixels  planar3sat  planarcircuitsat  planargraph  planarnotallequal3sat  plankalkül   plumbus  politics academic     illinois  renaissanceitalian   soviet  postorder  treetraversal    power exponentiation pred  pred tentativepredecessor  predecessorofavertex  pre  binarycode  preorder  treetraversal   prerequisites references prim salgorithm jarník algorithm projectselection  proper oring  propersubgraph  propositionesadacuendosjuvenes  prosody  seealso fibonaccinunbers seealso morsecode omialtime   pspace polynomialspace  pspaceversusexp  pspa  punchedcards  qbf quanti edbooleanformula  quickselect  quicksort  quicksortrecurrence   racetrack  rainbow  randcorporation  randomachine  reach  reach   reachability   directed  reciprocaldiagrams  recommendedcoursepolicies   recon gurationproblems           recurrences fullhistory   removing oorsandceilings  scary   solvingwithrecursiontrees  recursion     backtracking  search  divideandconquer  smart dynamic programming  seealso induction recursionfairy       recursiontrees    alllevelsequal       backtracking   exponentialdecay      exponentialgrowth      path   weird   recursivebruteforce backtracking reduced ownetwork   reduction      regularexpressions  generalized    pspaproblems  relaxingatenseedge  repeatedsquaring     replacementpaths  repricing vertexreweighting residualcapacity  residualgraph  resultsbyrandresearchers     resultsbystudents          revelation  reversal rev ofdirectedgraph  reversetopologicalorder postorder rickandmorty  roadmaps    rockclimbing    rootedsubtree  rubik scube  ruleofthree        rulerfunction   russianpeasantmultiplication duplationandmediation cutcapacity    safeedge  sat  reductionfrom circuitsat  satis ability circuit circuitsat formula sat saturatededge ows  scc strongcomponentgraph  scheduling  greedyalgorithmsthatdon work  viadynamicprogramming  viagreedyalgorithm   viamaximum ows   scrabble  scriptiocontinua   seidel salgorithm   selection   medifans   mediff medians  quickselect  selfvesentence  selfuction  nnectedgraph  sequencealignment edit distance sequenceofdecisions   serillelgraph  setcover  soobananauniversity       shimbel salgorithm shortestcommonsupersequence   shortestpathtree  shortestpaths   analogalgorithms  indirectedacyclicgraphs  inunweightedgraphs  singlurce  versusshortestwalks  withnegativeedges   inundirectedgraphs  withnoegativeedges  shortestsimplepath reductionfrom directedhampath  shu  simplegraph  sink vertexwitho   sinkcomponent   snails  snakesandladders  soapbox vi   sollin salgorithm bor vka algorithm solvingamoregeneralproblem   solvingtherightproblem      sortingalgorithms mergesort  quicksort  source ina ownetwork  source vertexwith   sourcecomponent  spanningforest  spanningtree  squaringandmediation  sssp shortestpaths singlurce stablematching   startingtimeofavertex search   steinertree  stigler slawofeponymy          strassen salgorithm  strongcomponentgraph  strongcomponents  connectedinforest  inlineartime  koharir  tarjan salgorithm  strongconnectivity  stronglyconnectedcomponents strongcomponents stronglyconnectedgraph  subgraph  subsequence  subsetconstruction  subsetsum        dynamicprogramming algorithm  inomialtime  reductionfrom vertexcover  successorofavertex  sudoku  su  sumerianclaytablets  summaryofpastdecisions  supermariobrothers  tabulapeutingeriana  tailofanedge  talkingdogjoke   tapesorting   target ina ownetwork  tarjan salgorithm  tâtonner  tenseedge   tetris  textsegmentation       theseus mazrobot   threes game  tibetanmemorytrick announcer stest tokensearch  token moore salgorithm  topologicalorder reverse postorder topologicalsort  implicit  towerofhanoi   gurationgraph  novesolutions  recurrence     variants    trainyard  transformingcerti cates  transitiveclosure   transitivereduction  travelingsalesman  dynamicprogramming  euclidean convexposition  reductionfrom directedhamcycle  reductionto longestpath  tree connectedacyclicgraph  equivalentde nitions  treeedgesearch  treetraversal   postorder  trivialbutuseless  algorithms   truthgadget  tsp travelingsalesman tupleselection  turingmachines  turingreduction  twitbook   typography   ulamdistance editdistance undecidededge  undirectedgraph  undirectedhamcycle  inahypercube  reductiontointernational draughts  undirectedhampath  unio disjodata structure unorderedsubtree  unsat  usefuldeliberateignorance    uselessedge  vacuousbasecase     valueofanodeinarecursiontree  vankin skilometer  vankin smile  variablegadget     vertex  vertexcover  vertexgadget    vintpaths  vertice vertex dammit vidrachitkyleda  walkinagraph  wavefront    weaklynp   weightedmedian  wfs whatevsearch whackbat  whatevsearch   priorityqueue search  queue  stack  widestpaths   wordrammodel  x3m  xcnfat  xkcd  zerocycles   dicebatbernarduscarnotensisnosessequasinanosgigantiumhumeris insidentes utpossimuspluraeisetremotioravidere nonutiquepropriivisus acumine auteminentiacorporis sedquiainaltumsubvehimuretextollimur magnitudinegigantea bernardofchartresusedtosaythatwewerelikedwarfsseatedontheshoulders ofgiants hepointedoutthatweseemoreandfartherthanourpredecessors becausewehavekeenervisionorgreaterheight butbecauseweareliftedupand bornealoftontheirgiganticstature johnofsalisbury metalogicon  translatedbydanield mcgarry  thesecrettoproductivityisgettingdeadpeopletodoyourworkforyou robertj lang  indexofpeople adelsovelsky georgy    adler ilan  aliumi  adversary owerfulmalicious     alcuinofyork  alice  alighieri dante  alon noga  andersson arne   apolloniusofperga  approximatemedianfairy   archimedes  atlas charles  augustineofhippo  bayer rudolf   bellman richard   berge claude  blagojevich rod  blum manuel  bob  bor vka otakar  brahmagupta  brosh allie   cayley arthur  cegªowski maciej   indexofpeople chaucer geo rey  chazelle bernard  chazelle damien  choquet gustav  chowdhury rezaul  cicero marcustullius  claus desiam lucas édouard cli william  cobham alan  cook stephen   couper archibald  cremona luigi  culmann carl  dantzig george     demaine erik  dijkstra edsger     dimaggio joe  dinitz ye  durden tyler  dweighter harry pseudonymof jacobgoodman  edmonds jack     elias peter  echarli wilson charleserwin eppstein david  erera alan  erickson hannah   erickson kay  euclid   euler leonhard   eutociusofascalon  fürer martin  fahlberg constantin  fano robert  feinstein amiel  ferndavid  fibonacci leonardoofpisa fischer michael   floyd robert   fontana giovanni  ford lester   frederickii holyromanemperor  fredman micheal  frisius gemma  fulkerson delbert   gödel kurt  gale david  galil zvi  garey michael  gates  gauÿ karlfriedrich   goldstine herman  goodrich michael  gregoryix pope  grimm jacobandwilhelm  guibas leonidas   gus eld dan  harris theodore  harvey david  hearn robert   herotodus  hierholzer carl   hillier john  hoare tony   hochbaum dorit  vanderhoeven joris  hopcroft john  man david  ingerman peter  jacobi carl  jarník vojt  jay ricky  johnson david  johnson donald   nig dénes   kalaba robert  kane daniel  karatsuba anatoli ˇ  karp richard      karzanov alexander  kekulé august  arizm ˇ muh ammadibn  kirchho gustav  kleene stephen  kolmogorov andrei  kosaraju rao  kruskal joseph  kuhn harald  lamport leslie  landisevgenii   laquière emmanuel  ledger heath  lee chinyang  leonardoofpisa       levin leonid  leyzorek michael   loberman harry   lucas édouard    ukaszewicz józef  dry aleksander  margalit oded  marston john  martel charles  martin alainj  martin steve  massé pierre  maxwell jamesclerk  mckenna terence  meyer albert  michie donald   miller gary  minty george    mom  moore edward     moreno jacob  morgenstern oskar  murena luciuslicinius  musk elon  nash john  nauck franz  okasaki chris  olinick eli  orlin james  pacioli luca  papadimitriou christos  pappusofalexandria  park joo  peirce charlessanders  penner michael  peranson elliott  ngala    pinker steven  pitt lenny  prasanna viktor  pratt vaughan  prim robert   queyranne maurice  rabin michael  ramachandran vijaya  rebaudi ovidio  recursionfairy        remsen ira  rivest ronald  ross frank  roy bernard  rudrat  aguë andré  sallows lee   indexofpeople samuel arthur  saxel jind ich  schönhage arnold  scholten carels  schrijver lex  schumacher heinrich  schwartz benjamin  sedgewick robert    shannon claude      shapley lloyd  sharir micha  shier douglas  shimbel alfonso   siedel raimund  skiena steve vii smullyan raymond  snell willebrod  sollin george  steele guy  ste ens elisabeth  stevin simon  stigler stephen  stockmeyer larry  strassen volker   aabubakrmuhammadbin yahya  sulpiciusrufus servius  sylvester james  tarjan robert    tarry gaston  tomizawa nobuaki  toom andrei  trémaux charles  tseitin grigorii  turing alan  varignon pierre  virah ka   vonneumann john    vonstaudt karl  wagner robert  waits tom  warshall stephen  wayne kevin  weinberger arnold   weiss markallen   whiting peter  whittlesey kim  wiener christian  wilson charleserwin  witzgall christoph  woodbury max  yuval gideon  zermelo ernst  zuse konrad   zwick uri   weshouldexplain beforeproceeding thatitisnotourobjecttoconsiderthis programwithreferencetotheactualarrangementofthedataonthevariablesof theengine butsimplyasanabstractquestionofthe nature number ofthe operations requiredtobeperformedduringitscompletesolution adaaugustabyronking countessoflovelace translator snotesforluigif menabrea etchoftheanalyticalengineinventedbycharlesbabbage esq  howtoplaythe ute picksupa ute hereweare youblowthereandyoumoveyour ngersupanddownhere alan johncleese todo montypython sflyingcircus episode28 airedoctober26  indexofpseudocode thisindexincludesonlyalgorithmswithexplicitpseudocode seethemain indexforothernamedalgorithms addallsafeedges  addsafeedges  allpairsbellmanford  alouette  apportioncongress  beamillionaireandneverpaytaxes  bellmanford   bellmanforddp  bellmanforddp2  bellmanforddp3  bellmanfordfinal  bfs  bfswithtoken  binarygcd  bor vka   bottlesofbeer  circuitsat  collectstep  computeoptcost  constructsubset  countandlabel  countcomponents  cruel   indexofpseudocode dagsssp  dfs     dfsall   dijkstra  dynamicprogramming  eagerwfs  euclidgcd  factorial  falling  fasteuclidgcd  fastlis  fastlis2  fastmultiply  fastrecfibo  fastsplittable  fastsubsetsum  fellmanbored  fetchbit  fibonaccimultiply  findlow  findlowdfs  findsafeedges  fischermeyerapsp  floydwarshall  fordsssp  garbagecollect  greedyflow  greedyschedule  hanoi  hhguess  initf  initsssp  isacyclic  isacyclicdfs  iterativedfs  iterfibo  iterfibo2  jarník  jarníkinit  jarníkloop  johnsonapsp  kleeneapsp  kosarajusharir  kruskal  labelone  leyzorekapsp  lis   lisbigger  lisfirst  longestpath   markeveryvertexduh  memfibo  memoize  merge  mergesort  momomselect  momselect  mom select  moore  multiplyordivide  mutate  nonnegativedijkstra  obviousapsp  optimalbst  optimalbst2  optimalbst3  partition  peasantmultiply   peasantpower  ngalapower  placequeens  playanygame  postprocess  postprocessdag  postprocessdagdfs  postprocessdfs  postvisit   preprocess  previsit  pushdagsssp  queyrannefatpaths  quickselect  quicksort  recfibo  rectarry  rectarry2  recursivedfs  relax  rightangle  rulerhanoi  shimbelapsp  shorteredge  slowpower  splitmultiply  splittable  sqrtsort  stoogesort  strongcomponents  subsetsum   tarjan  tarjandfs  tarry  tarry2  threecolorqueuesearch  threecolorqueuestep  threecolorsearch  threecolorstacksearch  threecolorstackstep  threecolorstep  topologicalsort   topsortdfs  treemis  unusual  wfsall  whateverfirstsearch   whotargetswhom   awiselychosenillustrationisalmostessentialtofastenthetruthuponthe ordinarymind andnoteachercanaffordtoneglectthispartofhispreparation howardcrosby  oneshowingisworthahundredsayings alanwatts misquotingachineseproverb thewayofzen  pleasedonotthinkthatthisisaneutralmatterandthattheonlyadvantageof doingwithoutpicturesisthatofsavingspace picturesintextbooksactually interferewiththelearningprocess nevillemartingwynne gwynne sgrammar  imagecredits guresinthisbook includingthefrontcover areoriginalworksofthe author exceptthoselistedbelow alllistedworksareinthepublicdomain unlessotherwiseindicated figure    bibliotecanazionalebraidense milano atena beic webclient deliverymanager pid  figure    internetarchive https archive org details archimedisopera05eutogoog n377 figure    internetarchive https archive org details p1rcrationsm00lucauoft  figure    derivedfromacrayonportraitoftheauthorbytina erickson  includedwithpermissionoftheartist figure    wikimediacommons https commons wikimedia org wiki file tabula_peutingerian_miller jpg figure    galleryofegalt publishedbytheyalelaw libraryunderacreativecommonslicence https ickr photos yalelawlibrary albums  figure    internetarchive https archive org details a077240124 n261 exercises       originalpuzzlesbythe author inspiredbyjasonbattersonandshannonrogers beastacademy math practice3a  https beastacademy pdf printables anglemazes pdf https beastacademy resources printables figure    homas harrisandf rank ross talsofamethodforevaluatingrailnetcapacities therandcorporation researchmemorandumoctober24  unitedstatesgov mentworkinthepublicdomain dtic mil dtic fulltext u2  pdf  havesomethingtosay  sayit  stopwhenyouhavesaidit  givethepaperapropertitle johnshawbillings anaddressonourmedicalliterature internationalmedicalcongress london  youknow icouldwriteabook andthisbookwouldbethickenoughtostunanox laurieanderson bigscience  colophon thisbookwaseditedintexshop version4  andtypesetwithpdfl mactexusingthe memoir documentclass madsen chapterstyle komalike headstyle ruled pagestyle severalstandardpackages cluding amsmath babel enumitem imakeidx mathdesign microtype standalone andanembarrassingamountofcustomizationandt xing thetextistypesetinbitstreamcharter artemisða roboto inconsolata exceptasindicatedintheimagecredits guresweredrawnbytheauthor usingomnigra epro exportedatpdf andincludedusingthe graphicx xpackage portionsofourprogramminghavebeenmechanicallyreproduced andwe nowconcludeourbroadcastday