trees tree data structure based binary tree unrooted dynamic trees path operations simple divide conquer algorithms augmented maintain dynamically properties tree diameter center median tree ℜ displaystyle defined underlying tree displaystyle mathcal set displaystyle partial vertices called external boundary vertices glossary boundary node boundary vertex boundary vertex vertex connected subtree boundary vertex connected vertex subtree edge external boundary vertices pair vertices tree ℜ displaystyle called external boundary vertices thought boundary vertices cluster represents entire tree cluster cluster connected subtree boundary vertices set boundary vertices cluster displaystyle mathcal denoted displaystyle partial cluster displaystyle mathcal user associate meta displaystyle mathcal methods maintain internal operations path cluster π displaystyle mathcal edge displaystyle mathcal called path cluster point cluster leaf cluster leaf cluster π displaystyle mathcal edge displaystyle mathcal boundary vertex displaystyle mathcal called leaf cluster edge cluster cluster single edge called edge cluster leaf edge cluster leaf original cluster represented cluster single boundary vertex called leaf edge cluster path edge cluster edge clusters boundary nodes called path edge cluster internal node node displaystyle mathcal displaystyle partial called internal node displaystyle mathcal cluster path path boundary vertices displaystyle mathcal called cluster path displaystyle mathcal denoted π displaystyle mathcal mergeable clusters clusters displaystyle mathcal displaystyle mathcal mergeable displaystyle mathcal cap mathcal singleton set node common displaystyle mathcal cup mathcal cluster introduction trees maintaining dynamic forest set trees link cut operations basic idea maintain balanced binary tree ℜ displaystyle logarithmic height number nodes original tree displaystyle mathcal log displaystyle mathcal log time tree essentially represents recursive subdivision original tree displaystyle mathcal clusters general tree displaystyle mathcal weight edges correspondence edges original tree displaystyle mathcal leaf nodes tree ℜ displaystyle internal node ℜ displaystyle represents cluster formed union clusters children tree data structure initialized displaystyle mathcal time tree ℜ displaystyle displaystyle mathcal displaystyle partial binary tree nodes ℜ displaystyle clusters displaystyle mathcal displaystyle partial leaves ℜ displaystyle edges displaystyle mathcal sibling clusters neighbours sense intersect single vertex parent cluster union root ℜ displaystyle tree displaystyle mathcal set external boundary vertices tree single vertex tree edge single node trees freely augmentable allowing user wide variety flexibility productivity details internal workings data structure referred black box dynamic operations user allowable forest updates link displaystyle displaystyle vertices trees displaystyle mathcal displaystyle mathcal returns single tree representing ℜ displaystyle displaystyle cup ℜ displaystyle displaystyle cup cut removes edge displaystyle tree displaystyle mathcal tree ℜ displaystyle turning trees displaystyle mathcal displaystyle mathcal returning trees ℜ displaystyle ℜ displaystyle expose called subroutine implementing queries tree displaystyle vertices original external vertices normal vertices vertices displaystyle external boundary vertices tree displaystyle nonempty returns root cluster displaystyle mathcal displaystyle partial expose fails vertices trees internal operations forest updates carried sequence log displaystyle mathcal log internal operations sequence computed log displaystyle mathcal log time happen tree update leaf cluster change path cluster converse updates tree exclusively internal operations displaystyle mathcal updated calling user defined function internal operation merge displaystyle mathcal mathcal displaystyle mathcal displaystyle mathcal mergeable clusters returns displaystyle mathcal parent cluster displaystyle mathcal displaystyle mathcal boundary vertices boundary vertices displaystyle mathcal cup mathcal computes displaystyle mathcal displaystyle mathcal displaystyle mathcal split displaystyle mathcal displaystyle mathcal root cluster displaystyle mathcal cup mathcal updates displaystyle mathcal displaystyle mathcal displaystyle mathcal deletes cluster displaystyle mathcal ℜ displaystyle split implemented clean displaystyle mathcal method calls user method updates displaystyle mathcal displaystyle mathcal displaystyle mathcal updates displaystyle mathcal pending update needed children displaystyle mathcal discarded calling user defined functions clean required queries split split clean subroutine clean required achieved overhead combining merge split functions analogous base clusters create displaystyle creates cluster displaystyle mathcal edge displaystyle sets displaystyle partial partial displaystyle displaystyle mathcal computed scratch eradicate displaystyle mathcal displaystyle mathcal edge cluster displaystyle user defined function called process displaystyle mathcal cluster displaystyle mathcal deleted tree local search user define choose displaystyle mathcal operation root nonleaf cluster selects child clusters tree blackbox search displaystyle mathcal routine organizes choose queries reorganization tree internal operations locates edge intersection selected clusters search limited path variant nonlocal search purposes external boundary vertices root cluster displaystyle mathcal edge searched path π displaystyle mathcal sufficient modification root cluster children path cluster selected default calling choose operation examples local search finding edge longer path displaystyle displaystyle displaystyle mathcal expose search displaystyle mathcal choose implement choose global variable representing displaystyle global variable representing displaystyle choose selects cluster displaystyle mathcal displaystyle partial iff length π displaystyle mathcal displaystyle support operation length maintained displaystyle task formulated graph edges nonunit lengths case distance address edge vertex edges define choose edge leading vertex returned case defined update increasing edge lengths path constant scenario updates constant time root cluster clean required distribute delayed update children clean called search invoked maintain length displaystyle case require maintain unitlength displaystyle finding center tree vertex displaystyle finding bicenter edge edge center endpoint edge displaystyle mathcal expose search displaystyle mathcal choose choose selects children displaystyle mathcal displaystyle mathcal displaystyle partial cap partial child higher maxdistance displaystyle support operation maximal distance cluster subtree boundary vertex maintained displaystyle requires maintenance cluster path length interesting applications number interesting applications originally implemented methods easily implemented tree interface include sleator tarjan maintain dynamic collection weighted trees log displaystyle mathcal log time link cut supporting queries maximum edge weight vertices log displaystyle log time proof outline involves maintaining node maximum weight max_wt cluster path point cluster max_wt displaystyle mathcal initialised displaystyle infty cluster union clusters maximum merged clusters max wt displaystyle displaystyle displaystyle mathcal expose displaystyle report max_wt displaystyle mathcal sleator tarjan scenario application add common weight displaystyle edges path displaystyle displaystyle log displaystyle mathcal log time proof outline introduce weight called extra displaystyle mathcal edges π displaystyle mathcal maintained appropriately split displaystyle mathcal requires path child displaystyle mathcal displaystyle mathcal set max_wt max_wt displaystyle mathcal extra displaystyle mathcal extra displaystyle mathcal extra displaystyle mathcal extra displaystyle mathcal displaystyle mathcal join displaystyle mathcal displaystyle mathcal set max_wt displaystyle mathcal max max_wt displaystyle mathcal max_wt displaystyle mathcal extra displaystyle mathcal finally maximum weight path displaystyle displaystyle set displaystyle mathcal expose displaystyle return max_wt displaystyle mathcal goldberg maximum weight underlying tree vertex displaystyle log displaystyle mathcal log time proof outline requires maintaining additional maximum weight cluster path edge cluster merge split operations distance vertices displaystyle displaystyle log displaystyle mathcal log time length expose displaystyle proof outline maintain length length displaystyle mathcal cluster path length maintained maximum weight displaystyle mathcal created join merge length displaystyle mathcal sum lengths stored path children queries diameter tree subsequent maintenance takes log displaystyle mathcal log time center median maintained link merge cut split operations queried local search log displaystyle mathcal log time graph maintained allowing update edge set queries edge connectivity amortized complexity updates log displaystyle log queries implemented faster algorithm trivial displaystyle mathcal θ log displaystyle theta log space holm lichtenberg thorup graph maintained allowing update edge set queries vertex connectivity amortized complexity updates log displaystyle log queries implemented faster algorithm trivial displaystyle mathcal θ log displaystyle theta log space holm lichtenberg thorup trees compress trees worse dag compression exponentially implementation trees implemented variety ways include implementation multilevel partition trees dynamic graph algorithms jacob holm kristian lichtenberg technical report sleator tarjan trees typically amortized time bounds frederickson topology trees worst case time bounds alstrup maintaining fully dynamic trees trees amortized implementations simple small multiplicative factors time complexity contrary worst case implementations speeding queries switching unneeded info updates query implemented persistence techniques query answered original state tree query version discarded multilevel partitioning partitioning clusters tree displaystyle mathcal represented cluster partition tree cpt displaystyle mathcal replacing cluster tree displaystyle mathcal edge strategy partitioning displaystyle mathcal cpt cpt displaystyle mathcal recursively till edge remains notice nodes tree ℜ displaystyle uniquely mapped edges multilevel partition edges multilevel partition correspond node tree edges represent single child level simple cluster edges correspond composite clusters correspond nodes tree ℜ displaystyle partitioning strategy partition tree displaystyle mathcal clusters careful strategy ensures log displaystyle mathcal log height multilevel partition tree number edges subsequent levels decrease constant factor lower level changed update update constant number insertions deletions partitioning strategy ensures maintenance tree log displaystyle mathcal log time