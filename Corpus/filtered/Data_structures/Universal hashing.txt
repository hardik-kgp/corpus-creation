universal hashing mathematics computing universal hashing randomized algorithm data structure refers selecting hash function random family hash functions mathematical property definition guarantees low number collisions expectation data chosen adversary universal families hashing integers vectors strings evaluation efficient universal hashing numerous computer science implementations hash tables randomized algorithms cryptography introduction assume map keys universe displaystyle displaystyle bins labelled   displaystyle  dots  algorithm handle data set displaystyle subseteq displaystyle keys advance goal hashing low number collisions keys displaystyle land bin deterministic hash function offer guarantee adversarial setting size displaystyle greater displaystyle cdot adversary choose displaystyle precisely preimage bin data keys land bin making hashing useless deterministic hash function rehashing input data turns bad hash function collisions change hash function solution problems pick function randomly family hash functions family functions displaystyle called universal family  displaystyle forall neq _ leq frac  keys universe collide probability  displaystyle  hash function displaystyle drawn randomly displaystyle probability collision expect hash function assigned random hash codes key definition relaxed collision probability  displaystyle  concept introduced carter wegman  numerous applications computer science upper bound ϵ  displaystyle epsilon  collision probability ϵ displaystyle epsilon universality universal families stronger uniform difference property displaystyle forall neq displaystyle drawn randomly family displaystyle difference mod displaystyle bmod uniformly distributed displaystyle note definition universality concerned  displaystyle  counts collisions uniform difference property stronger universal family xor universal displaystyle forall neq mod displaystyle oplus bmod uniformly distributed displaystyle displaystyle oplus bitwise exclusive operation displaystyle power stronger condition pairwise independence property displaystyle forall neq probability displaystyle hash pair hash values   displaystyle z_  z_  perfectly random     displaystyle z_  land z_    pairwise independence called strong universality property uniformity family uniform hash values equally  displaystyle  hash displaystyle universality imply uniformity strong universality imply uniformity family uniform distance property produce pairwise independent universal hash family adding uniformly distributed random constant values displaystyle hash functions displaystyle power achieve pairwise independence xor universal hash family exclusive uniformly distributed random constant shift constant irrelevant applications hash tables careful distinction uniform distance property pairwise independent applications hash tables bits hash values universal family universal guaranteed displaystyle universal family  displaystyle  family functions mod  displaystyle bmod  displaystyle universal displaystyle leq true universal families family identity function displaystyle universal family function mod  displaystyle bmod  fails universal umac poly1305 aes message authentication code algorithms based universal hashing applications software chooses hash function message based unique nonce message hash table implementations based universal hashing applications typically software chooses hash function notices keys collided hash function continues collision resolution schemes dynamic perfect hashing pick hash function time collision collision resolution schemes cuckoo hashing  choice hashing number collisions picking hash function survey fastest universal universal hash functions integers vectors strings mathematical guarantees fixed set displaystyle displaystyle keys universal family guarantees properties fixed displaystyle displaystyle expected number keys bin displaystyle displaystyle implementing hash tables chaining number proportional expected running time operation involving key displaystyle query insertion deletion expected number pairs keys displaystyle displaystyle displaystyle neq collide displaystyle bounded   displaystyle  m order  displaystyle  number bins displaystyle chosen linear displaystyle determined function ω displaystyle omega expected number collisions displaystyle hashing  displaystyle  bins collisions probability half expected number keys bins displaystyle keys bounded    displaystyle n   capacity bin capped times average size  displaystyle n total number keys overflowing bins displaystyle holds hash family collision probability bounded  displaystyle  weaker definition bounding  displaystyle  result longer true guarantees hold fixed set displaystyle hold data set chosen adversary adversary choice independent algorithm random choice hash function adversary observe random choice algorithm randomness serves purpose situation deterministic hashing guarantee typically conjunction rehashing instance randomized algorithm prepared handle displaystyle number collisions observes collisions chooses random displaystyle family repeats universality guarantees number repetitions geometric random variable constructions computer data represented machine generally hash functions types domains machine integers fixed length vectors machine variable length vectors strings hashing integers refers case hashing integers fit machines operations multiplication addition division cheap machine level instructions universe hashed   displaystyle  dots  original proposal carter wegman pick prime displaystyle geq define mod mod displaystyle h_ bmod bmod displaystyle randomly chosen integers modulo displaystyle  displaystyle neq  single iteration linear congruential generator displaystyle h_ universal family note displaystyle holds mod displaystyle equiv cdot pmod integer displaystyle  displaystyle   displaystyle  displaystyle neq difference displaystyle nonzero inverse modulo displaystyle solving displaystyle yields  mod displaystyle equiv cdot cdot  pmod  displaystyle  choices displaystyle  displaystyle  excluded varying displaystyle allowed range  displaystyle lfloor  rfloor values hand collision probability      displaystyle lfloor  rfloor  leq    displaystyle universal family notion statistical distance write difference displaystyle mod mod displaystyle equiv bmod pmod displaystyle nonzero displaystyle uniformly distributed  displaystyle  dots displaystyle modulo displaystyle uniformly distributed  displaystyle  dots distribution mod displaystyle bmod uniform difference probability  displaystyle  samples result statistical distance uniform family displaystyle negligible displaystyle gg family simpler hash functions mod mod displaystyle h_ bmod bmod universal  displaystyle h_ h_ leq  displaystyle neq analysis tight carter wegman     displaystyle h_  h_  geq    mod  displaystyle  bmod  avoiding modular arithmetic state art hashing integers multiply shift scheme dietzfelbinger  avoiding modular arithmetic method easier implement runs faster practice factor scheme assumes number bins power  displaystyle  displaystyle number bits machine word hash functions parametrised odd positive integers  displaystyle  fit word displaystyle bits evaluate displaystyle h_ multiply displaystyle displaystyle modulo  displaystyle  high order displaystyle bits hash code mathematical notation mod   displaystyle h_ cdot bmod  mathrm div  implemented programming languages displaystyle h_ size_t scheme satisfy uniform difference property  displaystyle  universal displaystyle neq  displaystyle h_ h_ leq  understand behavior hash function notice mod  displaystyle bmod  mod  displaystyle bmod  highest order bits mod  displaystyle bmod    highest order bits depending mod  displaystyle bmod  mod  displaystyle bmod  larger assume set bit displaystyle appears position displaystyle displaystyle random odd integer odd integers inverses ring  displaystyle z_  mod  displaystyle bmod  uniformly distributed displaystyle bit integers set bit position displaystyle probability bits      displaystyle    hand displaystyle higher order bits mod  displaystyle bmod    displaystyle neq finally displaystyle bit displaystyle mod  displaystyle bmod   displaystyle h_ h_ bits   displaystyle  ldots   probability     displaystyle     analysis tight   displaystyle    displaystyle x universal hash function multiply add shift scheme mod   displaystyle h_ bmod  mathrm div  implemented programming languages displaystyle h_ size_t displaystyle random odd positive integer  displaystyle  displaystyle random negative integer  displaystyle  choices displaystyle displaystyle  displaystyle h_ h_ leq  mod  displaystyle equiv pmod  differs importantly mistranslation english paper hashing vectors concerned hashing fixed length vector machine interpret input vector   displaystyle bar x_  dots x_  displaystyle machine integers displaystyle bits displaystyle universal family uniform difference property family dating carter wegman uniform difference property universal   mod displaystyle bar left sum _   h_ x_ bmod displaystyle h_ chosen independently random displaystyle power replace summation exclusive practice double precision arithmetic instantiated multiply shift hash family initialize hash function vector   displaystyle bar a_  dots a_  random odd integers  displaystyle w bits number bins  displaystyle  displaystyle leq   mod     displaystyle h_ bar bar left big sum _   x_ cdot a_ big bmod  w mathrm div  w halve number multiplications roughly translates fold speed practice initialize hash function vector   displaystyle bar a_  dots a_  random odd integers  displaystyle w bits hash family universal         mod     displaystyle h_ bar bar left big sum _  lceil  rceil x_ i a_ i cdot x_ i  a_ i  big bmod  w mathrm div  w double precision operations interpret input vector half  displaystyle  bit integers algorithm  displaystyle lceil  rceil multiplications displaystyle number half vector algorithm runs rate multiplication word input scheme hashing integers interpreting bits vectors bytes variant vector technique tabulation hashing practical alternative multiplication based universal hashing schemes strong universality high speed initialize hash function vector  displaystyle bar a_  dots a_ random integers  displaystyle w bits compute     mod    displaystyle h_ bar bar mathrm strong a_  sum _   a_  x_ bmod  w mathrm div  result universal displaystyle bits experimentally   cpu cycle byte intel processors  displaystyle  hashing strings refers hashing variable sized vector machine length string bounded small number vector solution conceptually padding vector zeros upper bound space required maximal length string time evaluate displaystyle length displaystyle long zeroes forbidden string padding evaluating hash function universality note zeroes allowed string append fictitious  character strings prior padding ensure universality assume hash  ℓ displaystyle bar x_  dots x_ ell good bound ℓ displaystyle ell priori universal family proposed treats string displaystyle coefficients polynomial modulo large prime displaystyle x_ max displaystyle geq max prime define  ℓ ℓ mod displaystyle h_ bar h_ mathrm int left big sum _  ell x_ cdot ell big bmod displaystyle uniformly random displaystyle h_ mathrm int chosen randomly universal family mapping integer domain displaystyle mapsto properties modular arithmetic computed producing large numbers large strings rabin karp rolling hash based linear congruential generator algorithm multiplicative hash function practice mod operator parameter avoided altogether simply allowing integer overflow equivalent mod max int  programming languages table values chosen initialize popular implementations strings displaystyle bar bar ℓ displaystyle ell length longer analysis shorter string conceptually padded zeros length ℓ displaystyle ell collision applying displaystyle h_ mathrm int implies displaystyle root polynomial coefficients displaystyle bar bar polynomial ℓ displaystyle ell roots modulo displaystyle collision probability ℓ displaystyle ell probability collision random displaystyle h_ mathrm int brings total collision probability  ℓ displaystyle frac  frac ell prime displaystyle large compared length strings hashed family close universal statistical distance universal families hash functions hash unknown length strings fixed length hash values include rabin fingerprint buzhash avoiding modular arithmetic mitigate computational penalty modular arithmetic tricks practice chooses prime displaystyle close power mersenne prime arithmetic modulo displaystyle implemented division faster operations addition shifts instance modern architectures work    displaystyle    displaystyle x_  bit values apply vector hashing blocks instance applies vector hashing  word block string applies string hashing  displaystyle lceil  rceil slower string hashing applied smaller vector essentially fast vector hashing chooses power divisor allowing arithmetic modulo  displaystyle  implemented division faster operations bit masking nh hash function family takes approach